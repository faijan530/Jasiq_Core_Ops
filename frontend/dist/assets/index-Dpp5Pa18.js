function qh(t,s){for(var a=0;a<s.length;a++){const n=s[a];if(typeof n!="string"&&!Array.isArray(n)){for(const l in n)if(l!=="default"&&!(l in t)){const r=Object.getOwnPropertyDescriptor(n,l);r&&Object.defineProperty(t,l,r.get?r:{enumerable:!0,get:()=>n[l]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function a(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(l){if(l.ep)return;l.ep=!0;const r=a(l);fetch(l.href,r)}})();function Yh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lx={exports:{}},ri={},rx={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rl=Symbol.for("react.element"),Gh=Symbol.for("react.portal"),Qh=Symbol.for("react.fragment"),Jh=Symbol.for("react.strict_mode"),Kh=Symbol.for("react.profiler"),Xh=Symbol.for("react.provider"),Zh=Symbol.for("react.context"),ep=Symbol.for("react.forward_ref"),tp=Symbol.for("react.suspense"),sp=Symbol.for("react.memo"),ap=Symbol.for("react.lazy"),Yc=Symbol.iterator;function np(t){return t===null||typeof t!="object"?null:(t=Yc&&t[Yc]||t["@@iterator"],typeof t=="function"?t:null)}var ix={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ox=Object.assign,dx={};function En(t,s,a){this.props=t,this.context=s,this.refs=dx,this.updater=a||ix}En.prototype.isReactComponent={};En.prototype.setState=function(t,s){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,s,"setState")};En.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function cx(){}cx.prototype=En.prototype;function Md(t,s,a){this.props=t,this.context=s,this.refs=dx,this.updater=a||ix}var Rd=Md.prototype=new cx;Rd.constructor=Md;ox(Rd,En.prototype);Rd.isPureReactComponent=!0;var Gc=Array.isArray,mx=Object.prototype.hasOwnProperty,Td={current:null},ux={key:!0,ref:!0,__self:!0,__source:!0};function xx(t,s,a){var n,l={},r=null,o=null;if(s!=null)for(n in s.ref!==void 0&&(o=s.ref),s.key!==void 0&&(r=""+s.key),s)mx.call(s,n)&&!ux.hasOwnProperty(n)&&(l[n]=s[n]);var d=arguments.length-2;if(d===1)l.children=a;else if(1<d){for(var c=Array(d),m=0;m<d;m++)c[m]=arguments[m+2];l.children=c}if(t&&t.defaultProps)for(n in d=t.defaultProps,d)l[n]===void 0&&(l[n]=d[n]);return{$$typeof:Rl,type:t,key:r,ref:o,props:l,_owner:Td.current}}function lp(t,s){return{$$typeof:Rl,type:t.type,key:s,ref:t.ref,props:t.props,_owner:t._owner}}function Pd(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rl}function rp(t){var s={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(a){return s[a]})}var Qc=/\/+/g;function Li(t,s){return typeof t=="object"&&t!==null&&t.key!=null?rp(""+t.key):s.toString(36)}function vr(t,s,a,n,l){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Rl:case Gh:o=!0}}if(o)return o=t,l=l(o),t=n===""?"."+Li(o,0):n,Gc(l)?(a="",t!=null&&(a=t.replace(Qc,"$&/")+"/"),vr(l,s,a,"",function(m){return m})):l!=null&&(Pd(l)&&(l=lp(l,a+(!l.key||o&&o.key===l.key?"":(""+l.key).replace(Qc,"$&/")+"/")+t)),s.push(l)),1;if(o=0,n=n===""?".":n+":",Gc(t))for(var d=0;d<t.length;d++){r=t[d];var c=n+Li(r,d);o+=vr(r,s,a,c,l)}else if(c=np(t),typeof c=="function")for(t=c.call(t),d=0;!(r=t.next()).done;)r=r.value,c=n+Li(r,d++),o+=vr(r,s,a,c,l);else if(r==="object")throw s=String(t),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return o}function $l(t,s,a){if(t==null)return t;var n=[],l=0;return vr(t,n,"","",function(r){return s.call(a,r,l++)}),n}function ip(t){if(t._status===-1){var s=t._result;s=s(),s.then(function(a){(t._status===0||t._status===-1)&&(t._status=1,t._result=a)},function(a){(t._status===0||t._status===-1)&&(t._status=2,t._result=a)}),t._status===-1&&(t._status=0,t._result=s)}if(t._status===1)return t._result.default;throw t._result}var Pt={current:null},br={transition:null},op={ReactCurrentDispatcher:Pt,ReactCurrentBatchConfig:br,ReactCurrentOwner:Td};function hx(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:$l,forEach:function(t,s,a){$l(t,function(){s.apply(this,arguments)},a)},count:function(t){var s=0;return $l(t,function(){s++}),s},toArray:function(t){return $l(t,function(s){return s})||[]},only:function(t){if(!Pd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Fe.Component=En;Fe.Fragment=Qh;Fe.Profiler=Kh;Fe.PureComponent=Md;Fe.StrictMode=Jh;Fe.Suspense=tp;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=op;Fe.act=hx;Fe.cloneElement=function(t,s,a){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=ox({},t.props),l=t.key,r=t.ref,o=t._owner;if(s!=null){if(s.ref!==void 0&&(r=s.ref,o=Td.current),s.key!==void 0&&(l=""+s.key),t.type&&t.type.defaultProps)var d=t.type.defaultProps;for(c in s)mx.call(s,c)&&!ux.hasOwnProperty(c)&&(n[c]=s[c]===void 0&&d!==void 0?d[c]:s[c])}var c=arguments.length-2;if(c===1)n.children=a;else if(1<c){d=Array(c);for(var m=0;m<c;m++)d[m]=arguments[m+2];n.children=d}return{$$typeof:Rl,type:t.type,key:l,ref:r,props:n,_owner:o}};Fe.createContext=function(t){return t={$$typeof:Zh,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Xh,_context:t},t.Consumer=t};Fe.createElement=xx;Fe.createFactory=function(t){var s=xx.bind(null,t);return s.type=t,s};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(t){return{$$typeof:ep,render:t}};Fe.isValidElement=Pd;Fe.lazy=function(t){return{$$typeof:ap,_payload:{_status:-1,_result:t},_init:ip}};Fe.memo=function(t,s){return{$$typeof:sp,type:t,compare:s===void 0?null:s}};Fe.startTransition=function(t){var s=br.transition;br.transition={};try{t()}finally{br.transition=s}};Fe.unstable_act=hx;Fe.useCallback=function(t,s){return Pt.current.useCallback(t,s)};Fe.useContext=function(t){return Pt.current.useContext(t)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(t){return Pt.current.useDeferredValue(t)};Fe.useEffect=function(t,s){return Pt.current.useEffect(t,s)};Fe.useId=function(){return Pt.current.useId()};Fe.useImperativeHandle=function(t,s,a){return Pt.current.useImperativeHandle(t,s,a)};Fe.useInsertionEffect=function(t,s){return Pt.current.useInsertionEffect(t,s)};Fe.useLayoutEffect=function(t,s){return Pt.current.useLayoutEffect(t,s)};Fe.useMemo=function(t,s){return Pt.current.useMemo(t,s)};Fe.useReducer=function(t,s,a){return Pt.current.useReducer(t,s,a)};Fe.useRef=function(t){return Pt.current.useRef(t)};Fe.useState=function(t){return Pt.current.useState(t)};Fe.useSyncExternalStore=function(t,s,a){return Pt.current.useSyncExternalStore(t,s,a)};Fe.useTransition=function(){return Pt.current.useTransition()};Fe.version="18.3.1";rx.exports=Fe;var i=rx.exports;const Ca=Yh(i),dp=qh({__proto__:null,default:Ca},[i]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cp=i,mp=Symbol.for("react.element"),up=Symbol.for("react.fragment"),xp=Object.prototype.hasOwnProperty,hp=cp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,pp={key:!0,ref:!0,__self:!0,__source:!0};function px(t,s,a){var n,l={},r=null,o=null;a!==void 0&&(r=""+a),s.key!==void 0&&(r=""+s.key),s.ref!==void 0&&(o=s.ref);for(n in s)xp.call(s,n)&&!pp.hasOwnProperty(n)&&(l[n]=s[n]);if(t&&t.defaultProps)for(n in s=t.defaultProps,s)l[n]===void 0&&(l[n]=s[n]);return{$$typeof:mp,type:t,key:r,ref:o,props:l,_owner:hp.current}}ri.Fragment=up;ri.jsx=px;ri.jsxs=px;lx.exports=ri;var e=lx.exports,Ao={},fx={exports:{}},Gt={},gx={exports:{}},vx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function s(O,F){var W=O.length;O.push(F);e:for(;0<W;){var $=W-1>>>1,M=O[$];if(0<l(M,F))O[$]=F,O[W]=M,W=$;else break e}}function a(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var F=O[0],W=O.pop();if(W!==F){O[0]=W;e:for(var $=0,M=O.length,P=M>>>1;$<P;){var V=2*($+1)-1,U=O[V],B=V+1,Q=O[B];if(0>l(U,W))B<M&&0>l(Q,U)?(O[$]=Q,O[B]=W,$=B):(O[$]=U,O[V]=W,$=V);else if(B<M&&0>l(Q,W))O[$]=Q,O[B]=W,$=B;else break e}}return F}function l(O,F){var W=O.sortIndex-F.sortIndex;return W!==0?W:O.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var o=Date,d=o.now();t.unstable_now=function(){return o.now()-d}}var c=[],m=[],g=1,x=null,j=3,h=!1,f=!1,u=!1,b=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(O){for(var F=a(m);F!==null;){if(F.callback===null)n(m);else if(F.startTime<=O)n(m),F.sortIndex=F.expirationTime,s(c,F);else break;F=a(m)}}function S(O){if(u=!1,w(O),!f)if(a(c)!==null)f=!0,I(N);else{var F=a(m);F!==null&&G(S,F.startTime-O)}}function N(O,F){f=!1,u&&(u=!1,p(A),A=-1),h=!0;var W=j;try{for(w(F),x=a(c);x!==null&&(!(x.expirationTime>F)||O&&!k());){var $=x.callback;if(typeof $=="function"){x.callback=null,j=x.priorityLevel;var M=$(x.expirationTime<=F);F=t.unstable_now(),typeof M=="function"?x.callback=M:x===a(c)&&n(c),w(F)}else n(c);x=a(c)}if(x!==null)var P=!0;else{var V=a(m);V!==null&&G(S,V.startTime-F),P=!1}return P}finally{x=null,j=W,h=!1}}var E=!1,v=null,A=-1,T=5,C=-1;function k(){return!(t.unstable_now()-C<T)}function D(){if(v!==null){var O=t.unstable_now();C=O;var F=!0;try{F=v(!0,O)}finally{F?R():(E=!1,v=null)}}else E=!1}var R;if(typeof y=="function")R=function(){y(D)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,_=L.port2;L.port1.onmessage=D,R=function(){_.postMessage(null)}}else R=function(){b(D,0)};function I(O){v=O,E||(E=!0,R())}function G(O,F){A=b(function(){O(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){f||h||(f=!0,I(N))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return j},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(O){switch(j){case 1:case 2:case 3:var F=3;break;default:F=j}var W=j;j=F;try{return O()}finally{j=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,F){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var W=j;j=O;try{return F()}finally{j=W}},t.unstable_scheduleCallback=function(O,F,W){var $=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?$+W:$):W=$,O){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=W+M,O={id:g++,callback:F,priorityLevel:O,startTime:W,expirationTime:M,sortIndex:-1},W>$?(O.sortIndex=W,s(m,O),a(c)===null&&O===a(m)&&(u?(p(A),A=-1):u=!0,G(S,W-$))):(O.sortIndex=M,s(c,O),f||h||(f=!0,I(N))),O},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(O){var F=j;return function(){var W=j;j=F;try{return O.apply(this,arguments)}finally{j=W}}}})(vx);gx.exports=vx;var fp=gx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gp=i,Yt=fp;function oe(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,a=1;a<arguments.length;a++)s+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bx=new Set,ul={};function Ta(t,s){gn(t,s),gn(t+"Capture",s)}function gn(t,s){for(ul[t]=s,t=0;t<s.length;t++)bx.add(s[t])}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lo=Object.prototype.hasOwnProperty,vp=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jc={},Kc={};function bp(t){return Lo.call(Kc,t)?!0:Lo.call(Jc,t)?!1:vp.test(t)?Kc[t]=!0:(Jc[t]=!0,!1)}function jp(t,s,a,n){if(a!==null&&a.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return n?!1:a!==null?!a.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Np(t,s,a,n){if(s===null||typeof s>"u"||jp(t,s,a,n))return!0;if(n)return!1;if(a!==null)switch(a.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function It(t,s,a,n,l,r,o){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=n,this.attributeNamespace=l,this.mustUseProperty=a,this.propertyName=t,this.type=s,this.sanitizeURL=r,this.removeEmptyString=o}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){wt[t]=new It(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];wt[s]=new It(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){wt[t]=new It(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){wt[t]=new It(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){wt[t]=new It(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){wt[t]=new It(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){wt[t]=new It(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){wt[t]=new It(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){wt[t]=new It(t,5,!1,t.toLowerCase(),null,!1,!1)});var Id=/[\-:]([a-z])/g;function Od(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(Id,Od);wt[s]=new It(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(Id,Od);wt[s]=new It(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(Id,Od);wt[s]=new It(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){wt[t]=new It(t,1,!1,t.toLowerCase(),null,!1,!1)});wt.xlinkHref=new It("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){wt[t]=new It(t,1,!1,t.toLowerCase(),null,!0,!0)});function _d(t,s,a,n){var l=wt.hasOwnProperty(s)?wt[s]:null;(l!==null?l.type!==0:n||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(Np(s,a,l,n)&&(a=null),n||l===null?bp(s)&&(a===null?t.removeAttribute(s):t.setAttribute(s,""+a)):l.mustUseProperty?t[l.propertyName]=a===null?l.type===3?!1:"":a:(s=l.attributeName,n=l.attributeNamespace,a===null?t.removeAttribute(s):(l=l.type,a=l===3||l===4&&a===!0?"":""+a,n?t.setAttributeNS(n,s,a):t.setAttribute(s,a))))}var Bs=gp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vl=Symbol.for("react.element"),Ka=Symbol.for("react.portal"),Xa=Symbol.for("react.fragment"),Bd=Symbol.for("react.strict_mode"),Do=Symbol.for("react.profiler"),jx=Symbol.for("react.provider"),Nx=Symbol.for("react.context"),Fd=Symbol.for("react.forward_ref"),Mo=Symbol.for("react.suspense"),Ro=Symbol.for("react.suspense_list"),Ud=Symbol.for("react.memo"),qs=Symbol.for("react.lazy"),yx=Symbol.for("react.offscreen"),Xc=Symbol.iterator;function Fn(t){return t===null||typeof t!="object"?null:(t=Xc&&t[Xc]||t["@@iterator"],typeof t=="function"?t:null)}var lt=Object.assign,Di;function Kn(t){if(Di===void 0)try{throw Error()}catch(a){var s=a.stack.trim().match(/\n( *(at )?)/);Di=s&&s[1]||""}return`
`+Di+t}var Mi=!1;function Ri(t,s){if(!t||Mi)return"";Mi=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(m){var n=m}Reflect.construct(t,[],s)}else{try{s.call()}catch(m){n=m}t.call(s.prototype)}else{try{throw Error()}catch(m){n=m}t()}}catch(m){if(m&&n&&typeof m.stack=="string"){for(var l=m.stack.split(`
`),r=n.stack.split(`
`),o=l.length-1,d=r.length-1;1<=o&&0<=d&&l[o]!==r[d];)d--;for(;1<=o&&0<=d;o--,d--)if(l[o]!==r[d]){if(o!==1||d!==1)do if(o--,d--,0>d||l[o]!==r[d]){var c=`
`+l[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=d);break}}}finally{Mi=!1,Error.prepareStackTrace=a}return(t=t?t.displayName||t.name:"")?Kn(t):""}function yp(t){switch(t.tag){case 5:return Kn(t.type);case 16:return Kn("Lazy");case 13:return Kn("Suspense");case 19:return Kn("SuspenseList");case 0:case 2:case 15:return t=Ri(t.type,!1),t;case 11:return t=Ri(t.type.render,!1),t;case 1:return t=Ri(t.type,!0),t;default:return""}}function To(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xa:return"Fragment";case Ka:return"Portal";case Do:return"Profiler";case Bd:return"StrictMode";case Mo:return"Suspense";case Ro:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Nx:return(t.displayName||"Context")+".Consumer";case jx:return(t._context.displayName||"Context")+".Provider";case Fd:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ud:return s=t.displayName||null,s!==null?s:To(t.type)||"Memo";case qs:s=t._payload,t=t._init;try{return To(t(s))}catch{}}return null}function wp(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return To(s);case 8:return s===Bd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function da(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function wx(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Sp(t){var s=wx(t)?"checked":"value",a=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),n=""+t[s];if(!t.hasOwnProperty(s)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var l=a.get,r=a.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return l.call(this)},set:function(o){n=""+o,r.call(this,o)}}),Object.defineProperty(t,s,{enumerable:a.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function zl(t){t._valueTracker||(t._valueTracker=Sp(t))}function Sx(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var a=s.getValue(),n="";return t&&(n=wx(t)?t.checked?"true":"false":t.value),t=n,t!==a?(s.setValue(t),!0):!1}function Mr(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Po(t,s){var a=s.checked;return lt({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??t._wrapperState.initialChecked})}function Zc(t,s){var a=s.defaultValue==null?"":s.defaultValue,n=s.checked!=null?s.checked:s.defaultChecked;a=da(s.value!=null?s.value:a),t._wrapperState={initialChecked:n,initialValue:a,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function kx(t,s){s=s.checked,s!=null&&_d(t,"checked",s,!1)}function Io(t,s){kx(t,s);var a=da(s.value),n=s.type;if(a!=null)n==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+a):t.value!==""+a&&(t.value=""+a);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?Oo(t,s.type,a):s.hasOwnProperty("defaultValue")&&Oo(t,s.type,da(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function em(t,s,a){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var n=s.type;if(!(n!=="submit"&&n!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,a||s===t.value||(t.value=s),t.defaultValue=s}a=t.name,a!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,a!==""&&(t.name=a)}function Oo(t,s,a){(s!=="number"||Mr(t.ownerDocument)!==t)&&(a==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+a&&(t.defaultValue=""+a))}var Xn=Array.isArray;function mn(t,s,a,n){if(t=t.options,s){s={};for(var l=0;l<a.length;l++)s["$"+a[l]]=!0;for(a=0;a<t.length;a++)l=s.hasOwnProperty("$"+t[a].value),t[a].selected!==l&&(t[a].selected=l),l&&n&&(t[a].defaultSelected=!0)}else{for(a=""+da(a),s=null,l=0;l<t.length;l++){if(t[l].value===a){t[l].selected=!0,n&&(t[l].defaultSelected=!0);return}s!==null||t[l].disabled||(s=t[l])}s!==null&&(s.selected=!0)}}function _o(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(oe(91));return lt({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function tm(t,s){var a=s.value;if(a==null){if(a=s.children,s=s.defaultValue,a!=null){if(s!=null)throw Error(oe(92));if(Xn(a)){if(1<a.length)throw Error(oe(93));a=a[0]}s=a}s==null&&(s=""),a=s}t._wrapperState={initialValue:da(a)}}function Ex(t,s){var a=da(s.value),n=da(s.defaultValue);a!=null&&(a=""+a,a!==t.value&&(t.value=a),s.defaultValue==null&&t.defaultValue!==a&&(t.defaultValue=a)),n!=null&&(t.defaultValue=""+n)}function sm(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function Cx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bo(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?Cx(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Wl,Ax=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,a,n,l){MSApp.execUnsafeLocalFunction(function(){return t(s,a,n,l)})}:t}(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(Wl=Wl||document.createElement("div"),Wl.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=Wl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function xl(t,s){if(s){var a=t.firstChild;if(a&&a===t.lastChild&&a.nodeType===3){a.nodeValue=s;return}}t.textContent=s}var sl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kp=["Webkit","ms","Moz","O"];Object.keys(sl).forEach(function(t){kp.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),sl[s]=sl[t]})});function Lx(t,s,a){return s==null||typeof s=="boolean"||s===""?"":a||typeof s!="number"||s===0||sl.hasOwnProperty(t)&&sl[t]?(""+s).trim():s+"px"}function Dx(t,s){t=t.style;for(var a in s)if(s.hasOwnProperty(a)){var n=a.indexOf("--")===0,l=Lx(a,s[a],n);a==="float"&&(a="cssFloat"),n?t.setProperty(a,l):t[a]=l}}var Ep=lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fo(t,s){if(s){if(Ep[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(oe(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(oe(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(oe(61))}if(s.style!=null&&typeof s.style!="object")throw Error(oe(62))}}function Uo(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $o=null;function $d(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Vo=null,un=null,xn=null;function am(t){if(t=Il(t)){if(typeof Vo!="function")throw Error(oe(280));var s=t.stateNode;s&&(s=mi(s),Vo(t.stateNode,t.type,s))}}function Mx(t){un?xn?xn.push(t):xn=[t]:un=t}function Rx(){if(un){var t=un,s=xn;if(xn=un=null,am(t),s)for(t=0;t<s.length;t++)am(s[t])}}function Tx(t,s){return t(s)}function Px(){}var Ti=!1;function Ix(t,s,a){if(Ti)return t(s,a);Ti=!0;try{return Tx(t,s,a)}finally{Ti=!1,(un!==null||xn!==null)&&(Px(),Rx())}}function hl(t,s){var a=t.stateNode;if(a===null)return null;var n=mi(a);if(n===null)return null;a=n[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(a&&typeof a!="function")throw Error(oe(231,s,typeof a));return a}var zo=!1;if(Ps)try{var Un={};Object.defineProperty(Un,"passive",{get:function(){zo=!0}}),window.addEventListener("test",Un,Un),window.removeEventListener("test",Un,Un)}catch{zo=!1}function Cp(t,s,a,n,l,r,o,d,c){var m=Array.prototype.slice.call(arguments,3);try{s.apply(a,m)}catch(g){this.onError(g)}}var al=!1,Rr=null,Tr=!1,Wo=null,Ap={onError:function(t){al=!0,Rr=t}};function Lp(t,s,a,n,l,r,o,d,c){al=!1,Rr=null,Cp.apply(Ap,arguments)}function Dp(t,s,a,n,l,r,o,d,c){if(Lp.apply(this,arguments),al){if(al){var m=Rr;al=!1,Rr=null}else throw Error(oe(198));Tr||(Tr=!0,Wo=m)}}function Pa(t){var s=t,a=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,s.flags&4098&&(a=s.return),t=s.return;while(t)}return s.tag===3?a:null}function Ox(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function nm(t){if(Pa(t)!==t)throw Error(oe(188))}function Mp(t){var s=t.alternate;if(!s){if(s=Pa(t),s===null)throw Error(oe(188));return s!==t?null:t}for(var a=t,n=s;;){var l=a.return;if(l===null)break;var r=l.alternate;if(r===null){if(n=l.return,n!==null){a=n;continue}break}if(l.child===r.child){for(r=l.child;r;){if(r===a)return nm(l),t;if(r===n)return nm(l),s;r=r.sibling}throw Error(oe(188))}if(a.return!==n.return)a=l,n=r;else{for(var o=!1,d=l.child;d;){if(d===a){o=!0,a=l,n=r;break}if(d===n){o=!0,n=l,a=r;break}d=d.sibling}if(!o){for(d=r.child;d;){if(d===a){o=!0,a=r,n=l;break}if(d===n){o=!0,n=r,a=l;break}d=d.sibling}if(!o)throw Error(oe(189))}}if(a.alternate!==n)throw Error(oe(190))}if(a.tag!==3)throw Error(oe(188));return a.stateNode.current===a?t:s}function _x(t){return t=Mp(t),t!==null?Bx(t):null}function Bx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=Bx(t);if(s!==null)return s;t=t.sibling}return null}var Fx=Yt.unstable_scheduleCallback,lm=Yt.unstable_cancelCallback,Rp=Yt.unstable_shouldYield,Tp=Yt.unstable_requestPaint,dt=Yt.unstable_now,Pp=Yt.unstable_getCurrentPriorityLevel,Vd=Yt.unstable_ImmediatePriority,Ux=Yt.unstable_UserBlockingPriority,Pr=Yt.unstable_NormalPriority,Ip=Yt.unstable_LowPriority,$x=Yt.unstable_IdlePriority,ii=null,ys=null;function Op(t){if(ys&&typeof ys.onCommitFiberRoot=="function")try{ys.onCommitFiberRoot(ii,t,void 0,(t.current.flags&128)===128)}catch{}}var cs=Math.clz32?Math.clz32:Fp,_p=Math.log,Bp=Math.LN2;function Fp(t){return t>>>=0,t===0?32:31-(_p(t)/Bp|0)|0}var Hl=64,ql=4194304;function Zn(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ir(t,s){var a=t.pendingLanes;if(a===0)return 0;var n=0,l=t.suspendedLanes,r=t.pingedLanes,o=a&268435455;if(o!==0){var d=o&~l;d!==0?n=Zn(d):(r&=o,r!==0&&(n=Zn(r)))}else o=a&~l,o!==0?n=Zn(o):r!==0&&(n=Zn(r));if(n===0)return 0;if(s!==0&&s!==n&&!(s&l)&&(l=n&-n,r=s&-s,l>=r||l===16&&(r&4194240)!==0))return s;if(n&4&&(n|=a&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=n;0<s;)a=31-cs(s),l=1<<a,n|=t[a],s&=~l;return n}function Up(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $p(t,s){for(var a=t.suspendedLanes,n=t.pingedLanes,l=t.expirationTimes,r=t.pendingLanes;0<r;){var o=31-cs(r),d=1<<o,c=l[o];c===-1?(!(d&a)||d&n)&&(l[o]=Up(d,s)):c<=s&&(t.expiredLanes|=d),r&=~d}}function Ho(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Vx(){var t=Hl;return Hl<<=1,!(Hl&4194240)&&(Hl=64),t}function Pi(t){for(var s=[],a=0;31>a;a++)s.push(t);return s}function Tl(t,s,a){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-cs(s),t[s]=a}function Vp(t,s){var a=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<a;){var l=31-cs(a),r=1<<l;s[l]=0,n[l]=-1,t[l]=-1,a&=~r}}function zd(t,s){var a=t.entangledLanes|=s;for(t=t.entanglements;a;){var n=31-cs(a),l=1<<n;l&s|t[n]&s&&(t[n]|=s),a&=~l}}var Ge=0;function zx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Wx,Wd,Hx,qx,Yx,qo=!1,Yl=[],Zs=null,ea=null,ta=null,pl=new Map,fl=new Map,Gs=[],zp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rm(t,s){switch(t){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":ea=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":pl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":fl.delete(s.pointerId)}}function $n(t,s,a,n,l,r){return t===null||t.nativeEvent!==r?(t={blockedOn:s,domEventName:a,eventSystemFlags:n,nativeEvent:r,targetContainers:[l]},s!==null&&(s=Il(s),s!==null&&Wd(s)),t):(t.eventSystemFlags|=n,s=t.targetContainers,l!==null&&s.indexOf(l)===-1&&s.push(l),t)}function Wp(t,s,a,n,l){switch(s){case"focusin":return Zs=$n(Zs,t,s,a,n,l),!0;case"dragenter":return ea=$n(ea,t,s,a,n,l),!0;case"mouseover":return ta=$n(ta,t,s,a,n,l),!0;case"pointerover":var r=l.pointerId;return pl.set(r,$n(pl.get(r)||null,t,s,a,n,l)),!0;case"gotpointercapture":return r=l.pointerId,fl.set(r,$n(fl.get(r)||null,t,s,a,n,l)),!0}return!1}function Gx(t){var s=ya(t.target);if(s!==null){var a=Pa(s);if(a!==null){if(s=a.tag,s===13){if(s=Ox(a),s!==null){t.blockedOn=s,Yx(t.priority,function(){Hx(a)});return}}else if(s===3&&a.stateNode.current.memoizedState.isDehydrated){t.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}t.blockedOn=null}function jr(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var a=Yo(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(a===null){a=t.nativeEvent;var n=new a.constructor(a.type,a);$o=n,a.target.dispatchEvent(n),$o=null}else return s=Il(a),s!==null&&Wd(s),t.blockedOn=a,!1;s.shift()}return!0}function im(t,s,a){jr(t)&&a.delete(s)}function Hp(){qo=!1,Zs!==null&&jr(Zs)&&(Zs=null),ea!==null&&jr(ea)&&(ea=null),ta!==null&&jr(ta)&&(ta=null),pl.forEach(im),fl.forEach(im)}function Vn(t,s){t.blockedOn===s&&(t.blockedOn=null,qo||(qo=!0,Yt.unstable_scheduleCallback(Yt.unstable_NormalPriority,Hp)))}function gl(t){function s(l){return Vn(l,t)}if(0<Yl.length){Vn(Yl[0],t);for(var a=1;a<Yl.length;a++){var n=Yl[a];n.blockedOn===t&&(n.blockedOn=null)}}for(Zs!==null&&Vn(Zs,t),ea!==null&&Vn(ea,t),ta!==null&&Vn(ta,t),pl.forEach(s),fl.forEach(s),a=0;a<Gs.length;a++)n=Gs[a],n.blockedOn===t&&(n.blockedOn=null);for(;0<Gs.length&&(a=Gs[0],a.blockedOn===null);)Gx(a),a.blockedOn===null&&Gs.shift()}var hn=Bs.ReactCurrentBatchConfig,Or=!0;function qp(t,s,a,n){var l=Ge,r=hn.transition;hn.transition=null;try{Ge=1,Hd(t,s,a,n)}finally{Ge=l,hn.transition=r}}function Yp(t,s,a,n){var l=Ge,r=hn.transition;hn.transition=null;try{Ge=4,Hd(t,s,a,n)}finally{Ge=l,hn.transition=r}}function Hd(t,s,a,n){if(Or){var l=Yo(t,s,a,n);if(l===null)Wi(t,s,n,_r,a),rm(t,n);else if(Wp(l,t,s,a,n))n.stopPropagation();else if(rm(t,n),s&4&&-1<zp.indexOf(t)){for(;l!==null;){var r=Il(l);if(r!==null&&Wx(r),r=Yo(t,s,a,n),r===null&&Wi(t,s,n,_r,a),r===l)break;l=r}l!==null&&n.stopPropagation()}else Wi(t,s,n,null,a)}}var _r=null;function Yo(t,s,a,n){if(_r=null,t=$d(n),t=ya(t),t!==null)if(s=Pa(t),s===null)t=null;else if(a=s.tag,a===13){if(t=Ox(s),t!==null)return t;t=null}else if(a===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return _r=t,null}function Qx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Pp()){case Vd:return 1;case Ux:return 4;case Pr:case Ip:return 16;case $x:return 536870912;default:return 16}default:return 16}}var Js=null,qd=null,Nr=null;function Jx(){if(Nr)return Nr;var t,s=qd,a=s.length,n,l="value"in Js?Js.value:Js.textContent,r=l.length;for(t=0;t<a&&s[t]===l[t];t++);var o=a-t;for(n=1;n<=o&&s[a-n]===l[r-n];n++);return Nr=l.slice(t,1<n?1-n:void 0)}function yr(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function Gl(){return!0}function om(){return!1}function Qt(t){function s(a,n,l,r,o){this._reactName=a,this._targetInst=l,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var d in t)t.hasOwnProperty(d)&&(a=t[d],this[d]=a?a(r):r[d]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Gl:om,this.isPropagationStopped=om,this}return lt(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Gl)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Gl)},persist:function(){},isPersistent:Gl}),s}var Cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yd=Qt(Cn),Pl=lt({},Cn,{view:0,detail:0}),Gp=Qt(Pl),Ii,Oi,zn,oi=lt({},Pl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==zn&&(zn&&t.type==="mousemove"?(Ii=t.screenX-zn.screenX,Oi=t.screenY-zn.screenY):Oi=Ii=0,zn=t),Ii)},movementY:function(t){return"movementY"in t?t.movementY:Oi}}),dm=Qt(oi),Qp=lt({},oi,{dataTransfer:0}),Jp=Qt(Qp),Kp=lt({},Pl,{relatedTarget:0}),_i=Qt(Kp),Xp=lt({},Cn,{animationName:0,elapsedTime:0,pseudoElement:0}),Zp=Qt(Xp),ef=lt({},Cn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),tf=Qt(ef),sf=lt({},Cn,{data:0}),cm=Qt(sf),af={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rf(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=lf[t])?!!s[t]:!1}function Gd(){return rf}var of=lt({},Pl,{key:function(t){if(t.key){var s=af[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=yr(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?nf[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gd,charCode:function(t){return t.type==="keypress"?yr(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yr(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),df=Qt(of),cf=lt({},oi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mm=Qt(cf),mf=lt({},Pl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gd}),uf=Qt(mf),xf=lt({},Cn,{propertyName:0,elapsedTime:0,pseudoElement:0}),hf=Qt(xf),pf=lt({},oi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ff=Qt(pf),gf=[9,13,27,32],Qd=Ps&&"CompositionEvent"in window,nl=null;Ps&&"documentMode"in document&&(nl=document.documentMode);var vf=Ps&&"TextEvent"in window&&!nl,Kx=Ps&&(!Qd||nl&&8<nl&&11>=nl),um=" ",xm=!1;function Xx(t,s){switch(t){case"keyup":return gf.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Za=!1;function bf(t,s){switch(t){case"compositionend":return Zx(s);case"keypress":return s.which!==32?null:(xm=!0,um);case"textInput":return t=s.data,t===um&&xm?null:t;default:return null}}function jf(t,s){if(Za)return t==="compositionend"||!Qd&&Xx(t,s)?(t=Jx(),Nr=qd=Js=null,Za=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Kx&&s.locale!=="ko"?null:s.data;default:return null}}var Nf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hm(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!Nf[t.type]:s==="textarea"}function e0(t,s,a,n){Mx(n),s=Br(s,"onChange"),0<s.length&&(a=new Yd("onChange","change",null,a,n),t.push({event:a,listeners:s}))}var ll=null,vl=null;function yf(t){m0(t,0)}function di(t){var s=sn(t);if(Sx(s))return t}function wf(t,s){if(t==="change")return s}var t0=!1;if(Ps){var Bi;if(Ps){var Fi="oninput"in document;if(!Fi){var pm=document.createElement("div");pm.setAttribute("oninput","return;"),Fi=typeof pm.oninput=="function"}Bi=Fi}else Bi=!1;t0=Bi&&(!document.documentMode||9<document.documentMode)}function fm(){ll&&(ll.detachEvent("onpropertychange",s0),vl=ll=null)}function s0(t){if(t.propertyName==="value"&&di(vl)){var s=[];e0(s,vl,t,$d(t)),Ix(yf,s)}}function Sf(t,s,a){t==="focusin"?(fm(),ll=s,vl=a,ll.attachEvent("onpropertychange",s0)):t==="focusout"&&fm()}function kf(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return di(vl)}function Ef(t,s){if(t==="click")return di(s)}function Cf(t,s){if(t==="input"||t==="change")return di(s)}function Af(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var us=typeof Object.is=="function"?Object.is:Af;function bl(t,s){if(us(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var a=Object.keys(t),n=Object.keys(s);if(a.length!==n.length)return!1;for(n=0;n<a.length;n++){var l=a[n];if(!Lo.call(s,l)||!us(t[l],s[l]))return!1}return!0}function gm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function vm(t,s){var a=gm(t);t=0;for(var n;a;){if(a.nodeType===3){if(n=t+a.textContent.length,t<=s&&n>=s)return{node:a,offset:s-t};t=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=gm(a)}}function a0(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?a0(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function n0(){for(var t=window,s=Mr();s instanceof t.HTMLIFrameElement;){try{var a=typeof s.contentWindow.location.href=="string"}catch{a=!1}if(a)t=s.contentWindow;else break;s=Mr(t.document)}return s}function Jd(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function Lf(t){var s=n0(),a=t.focusedElem,n=t.selectionRange;if(s!==a&&a&&a.ownerDocument&&a0(a.ownerDocument.documentElement,a)){if(n!==null&&Jd(a)){if(s=n.start,t=n.end,t===void 0&&(t=s),"selectionStart"in a)a.selectionStart=s,a.selectionEnd=Math.min(t,a.value.length);else if(t=(s=a.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var l=a.textContent.length,r=Math.min(n.start,l);n=n.end===void 0?r:Math.min(n.end,l),!t.extend&&r>n&&(l=n,n=r,r=l),l=vm(a,r);var o=vm(a,n);l&&o&&(t.rangeCount!==1||t.anchorNode!==l.node||t.anchorOffset!==l.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(s=s.createRange(),s.setStart(l.node,l.offset),t.removeAllRanges(),r>n?(t.addRange(s),t.extend(o.node,o.offset)):(s.setEnd(o.node,o.offset),t.addRange(s)))}}for(s=[],t=a;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<s.length;a++)t=s[a],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Df=Ps&&"documentMode"in document&&11>=document.documentMode,en=null,Go=null,rl=null,Qo=!1;function bm(t,s,a){var n=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Qo||en==null||en!==Mr(n)||(n=en,"selectionStart"in n&&Jd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),rl&&bl(rl,n)||(rl=n,n=Br(Go,"onSelect"),0<n.length&&(s=new Yd("onSelect","select",null,s,a),t.push({event:s,listeners:n}),s.target=en)))}function Ql(t,s){var a={};return a[t.toLowerCase()]=s.toLowerCase(),a["Webkit"+t]="webkit"+s,a["Moz"+t]="moz"+s,a}var tn={animationend:Ql("Animation","AnimationEnd"),animationiteration:Ql("Animation","AnimationIteration"),animationstart:Ql("Animation","AnimationStart"),transitionend:Ql("Transition","TransitionEnd")},Ui={},l0={};Ps&&(l0=document.createElement("div").style,"AnimationEvent"in window||(delete tn.animationend.animation,delete tn.animationiteration.animation,delete tn.animationstart.animation),"TransitionEvent"in window||delete tn.transitionend.transition);function ci(t){if(Ui[t])return Ui[t];if(!tn[t])return t;var s=tn[t],a;for(a in s)if(s.hasOwnProperty(a)&&a in l0)return Ui[t]=s[a];return t}var r0=ci("animationend"),i0=ci("animationiteration"),o0=ci("animationstart"),d0=ci("transitionend"),c0=new Map,jm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ma(t,s){c0.set(t,s),Ta(s,[t])}for(var $i=0;$i<jm.length;$i++){var Vi=jm[$i],Mf=Vi.toLowerCase(),Rf=Vi[0].toUpperCase()+Vi.slice(1);ma(Mf,"on"+Rf)}ma(r0,"onAnimationEnd");ma(i0,"onAnimationIteration");ma(o0,"onAnimationStart");ma("dblclick","onDoubleClick");ma("focusin","onFocus");ma("focusout","onBlur");ma(d0,"onTransitionEnd");gn("onMouseEnter",["mouseout","mouseover"]);gn("onMouseLeave",["mouseout","mouseover"]);gn("onPointerEnter",["pointerout","pointerover"]);gn("onPointerLeave",["pointerout","pointerover"]);Ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ta("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var el="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tf=new Set("cancel close invalid load scroll toggle".split(" ").concat(el));function Nm(t,s,a){var n=t.type||"unknown-event";t.currentTarget=a,Dp(n,s,void 0,t),t.currentTarget=null}function m0(t,s){s=(s&4)!==0;for(var a=0;a<t.length;a++){var n=t[a],l=n.event;n=n.listeners;e:{var r=void 0;if(s)for(var o=n.length-1;0<=o;o--){var d=n[o],c=d.instance,m=d.currentTarget;if(d=d.listener,c!==r&&l.isPropagationStopped())break e;Nm(l,d,m),r=c}else for(o=0;o<n.length;o++){if(d=n[o],c=d.instance,m=d.currentTarget,d=d.listener,c!==r&&l.isPropagationStopped())break e;Nm(l,d,m),r=c}}}if(Tr)throw t=Wo,Tr=!1,Wo=null,t}function Xe(t,s){var a=s[ed];a===void 0&&(a=s[ed]=new Set);var n=t+"__bubble";a.has(n)||(u0(s,t,2,!1),a.add(n))}function zi(t,s,a){var n=0;s&&(n|=4),u0(a,t,n,s)}var Jl="_reactListening"+Math.random().toString(36).slice(2);function jl(t){if(!t[Jl]){t[Jl]=!0,bx.forEach(function(a){a!=="selectionchange"&&(Tf.has(a)||zi(a,!1,t),zi(a,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[Jl]||(s[Jl]=!0,zi("selectionchange",!1,s))}}function u0(t,s,a,n){switch(Qx(s)){case 1:var l=qp;break;case 4:l=Yp;break;default:l=Hd}a=l.bind(null,s,a,t),l=void 0,!zo||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(l=!0),n?l!==void 0?t.addEventListener(s,a,{capture:!0,passive:l}):t.addEventListener(s,a,!0):l!==void 0?t.addEventListener(s,a,{passive:l}):t.addEventListener(s,a,!1)}function Wi(t,s,a,n,l){var r=n;if(!(s&1)&&!(s&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var d=n.stateNode.containerInfo;if(d===l||d.nodeType===8&&d.parentNode===l)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===l||c.nodeType===8&&c.parentNode===l))return;o=o.return}for(;d!==null;){if(o=ya(d),o===null)return;if(c=o.tag,c===5||c===6){n=r=o;continue e}d=d.parentNode}}n=n.return}Ix(function(){var m=r,g=$d(a),x=[];e:{var j=c0.get(t);if(j!==void 0){var h=Yd,f=t;switch(t){case"keypress":if(yr(a)===0)break e;case"keydown":case"keyup":h=df;break;case"focusin":f="focus",h=_i;break;case"focusout":f="blur",h=_i;break;case"beforeblur":case"afterblur":h=_i;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=dm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Jp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=uf;break;case r0:case i0:case o0:h=Zp;break;case d0:h=hf;break;case"scroll":h=Gp;break;case"wheel":h=ff;break;case"copy":case"cut":case"paste":h=tf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=mm}var u=(s&4)!==0,b=!u&&t==="scroll",p=u?j!==null?j+"Capture":null:j;u=[];for(var y=m,w;y!==null;){w=y;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,p!==null&&(S=hl(y,p),S!=null&&u.push(Nl(y,S,w)))),b)break;y=y.return}0<u.length&&(j=new h(j,f,null,a,g),x.push({event:j,listeners:u}))}}if(!(s&7)){e:{if(j=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",j&&a!==$o&&(f=a.relatedTarget||a.fromElement)&&(ya(f)||f[Is]))break e;if((h||j)&&(j=g.window===g?g:(j=g.ownerDocument)?j.defaultView||j.parentWindow:window,h?(f=a.relatedTarget||a.toElement,h=m,f=f?ya(f):null,f!==null&&(b=Pa(f),f!==b||f.tag!==5&&f.tag!==6)&&(f=null)):(h=null,f=m),h!==f)){if(u=dm,S="onMouseLeave",p="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(u=mm,S="onPointerLeave",p="onPointerEnter",y="pointer"),b=h==null?j:sn(h),w=f==null?j:sn(f),j=new u(S,y+"leave",h,a,g),j.target=b,j.relatedTarget=w,S=null,ya(g)===m&&(u=new u(p,y+"enter",f,a,g),u.target=w,u.relatedTarget=b,S=u),b=S,h&&f)t:{for(u=h,p=f,y=0,w=u;w;w=Ha(w))y++;for(w=0,S=p;S;S=Ha(S))w++;for(;0<y-w;)u=Ha(u),y--;for(;0<w-y;)p=Ha(p),w--;for(;y--;){if(u===p||p!==null&&u===p.alternate)break t;u=Ha(u),p=Ha(p)}u=null}else u=null;h!==null&&ym(x,j,h,u,!1),f!==null&&b!==null&&ym(x,b,f,u,!0)}}e:{if(j=m?sn(m):window,h=j.nodeName&&j.nodeName.toLowerCase(),h==="select"||h==="input"&&j.type==="file")var N=wf;else if(hm(j))if(t0)N=Cf;else{N=kf;var E=Sf}else(h=j.nodeName)&&h.toLowerCase()==="input"&&(j.type==="checkbox"||j.type==="radio")&&(N=Ef);if(N&&(N=N(t,m))){e0(x,N,a,g);break e}E&&E(t,j,m),t==="focusout"&&(E=j._wrapperState)&&E.controlled&&j.type==="number"&&Oo(j,"number",j.value)}switch(E=m?sn(m):window,t){case"focusin":(hm(E)||E.contentEditable==="true")&&(en=E,Go=m,rl=null);break;case"focusout":rl=Go=en=null;break;case"mousedown":Qo=!0;break;case"contextmenu":case"mouseup":case"dragend":Qo=!1,bm(x,a,g);break;case"selectionchange":if(Df)break;case"keydown":case"keyup":bm(x,a,g)}var v;if(Qd)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Za?Xx(t,a)&&(A="onCompositionEnd"):t==="keydown"&&a.keyCode===229&&(A="onCompositionStart");A&&(Kx&&a.locale!=="ko"&&(Za||A!=="onCompositionStart"?A==="onCompositionEnd"&&Za&&(v=Jx()):(Js=g,qd="value"in Js?Js.value:Js.textContent,Za=!0)),E=Br(m,A),0<E.length&&(A=new cm(A,t,null,a,g),x.push({event:A,listeners:E}),v?A.data=v:(v=Zx(a),v!==null&&(A.data=v)))),(v=vf?bf(t,a):jf(t,a))&&(m=Br(m,"onBeforeInput"),0<m.length&&(g=new cm("onBeforeInput","beforeinput",null,a,g),x.push({event:g,listeners:m}),g.data=v))}m0(x,s)})}function Nl(t,s,a){return{instance:t,listener:s,currentTarget:a}}function Br(t,s){for(var a=s+"Capture",n=[];t!==null;){var l=t,r=l.stateNode;l.tag===5&&r!==null&&(l=r,r=hl(t,a),r!=null&&n.unshift(Nl(t,r,l)),r=hl(t,s),r!=null&&n.push(Nl(t,r,l))),t=t.return}return n}function Ha(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ym(t,s,a,n,l){for(var r=s._reactName,o=[];a!==null&&a!==n;){var d=a,c=d.alternate,m=d.stateNode;if(c!==null&&c===n)break;d.tag===5&&m!==null&&(d=m,l?(c=hl(a,r),c!=null&&o.unshift(Nl(a,c,d))):l||(c=hl(a,r),c!=null&&o.push(Nl(a,c,d)))),a=a.return}o.length!==0&&t.push({event:s,listeners:o})}var Pf=/\r\n?/g,If=/\u0000|\uFFFD/g;function wm(t){return(typeof t=="string"?t:""+t).replace(Pf,`
`).replace(If,"")}function Kl(t,s,a){if(s=wm(s),wm(t)!==s&&a)throw Error(oe(425))}function Fr(){}var Jo=null,Ko=null;function Xo(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Zo=typeof setTimeout=="function"?setTimeout:void 0,Of=typeof clearTimeout=="function"?clearTimeout:void 0,Sm=typeof Promise=="function"?Promise:void 0,_f=typeof queueMicrotask=="function"?queueMicrotask:typeof Sm<"u"?function(t){return Sm.resolve(null).then(t).catch(Bf)}:Zo;function Bf(t){setTimeout(function(){throw t})}function Hi(t,s){var a=s,n=0;do{var l=a.nextSibling;if(t.removeChild(a),l&&l.nodeType===8)if(a=l.data,a==="/$"){if(n===0){t.removeChild(l),gl(s);return}n--}else a!=="$"&&a!=="$?"&&a!=="$!"||n++;a=l}while(a);gl(s)}function sa(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function km(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var a=t.data;if(a==="$"||a==="$!"||a==="$?"){if(s===0)return t;s--}else a==="/$"&&s++}t=t.previousSibling}return null}var An=Math.random().toString(36).slice(2),js="__reactFiber$"+An,yl="__reactProps$"+An,Is="__reactContainer$"+An,ed="__reactEvents$"+An,Ff="__reactListeners$"+An,Uf="__reactHandles$"+An;function ya(t){var s=t[js];if(s)return s;for(var a=t.parentNode;a;){if(s=a[Is]||a[js]){if(a=s.alternate,s.child!==null||a!==null&&a.child!==null)for(t=km(t);t!==null;){if(a=t[js])return a;t=km(t)}return s}t=a,a=t.parentNode}return null}function Il(t){return t=t[js]||t[Is],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function sn(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(oe(33))}function mi(t){return t[yl]||null}var td=[],an=-1;function ua(t){return{current:t}}function Ze(t){0>an||(t.current=td[an],td[an]=null,an--)}function Ke(t,s){an++,td[an]=t.current,t.current=s}var ca={},Lt=ua(ca),Ft=ua(!1),Aa=ca;function vn(t,s){var a=t.type.contextTypes;if(!a)return ca;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===s)return n.__reactInternalMemoizedMaskedChildContext;var l={},r;for(r in a)l[r]=s[r];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=l),l}function Ut(t){return t=t.childContextTypes,t!=null}function Ur(){Ze(Ft),Ze(Lt)}function Em(t,s,a){if(Lt.current!==ca)throw Error(oe(168));Ke(Lt,s),Ke(Ft,a)}function x0(t,s,a){var n=t.stateNode;if(s=s.childContextTypes,typeof n.getChildContext!="function")return a;n=n.getChildContext();for(var l in n)if(!(l in s))throw Error(oe(108,wp(t)||"Unknown",l));return lt({},a,n)}function $r(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ca,Aa=Lt.current,Ke(Lt,t),Ke(Ft,Ft.current),!0}function Cm(t,s,a){var n=t.stateNode;if(!n)throw Error(oe(169));a?(t=x0(t,s,Aa),n.__reactInternalMemoizedMergedChildContext=t,Ze(Ft),Ze(Lt),Ke(Lt,t)):Ze(Ft),Ke(Ft,a)}var Ds=null,ui=!1,qi=!1;function h0(t){Ds===null?Ds=[t]:Ds.push(t)}function $f(t){ui=!0,h0(t)}function xa(){if(!qi&&Ds!==null){qi=!0;var t=0,s=Ge;try{var a=Ds;for(Ge=1;t<a.length;t++){var n=a[t];do n=n(!0);while(n!==null)}Ds=null,ui=!1}catch(l){throw Ds!==null&&(Ds=Ds.slice(t+1)),Fx(Vd,xa),l}finally{Ge=s,qi=!1}}return null}var nn=[],ln=0,Vr=null,zr=0,Kt=[],Xt=0,La=null,Ms=1,Rs="";function ja(t,s){nn[ln++]=zr,nn[ln++]=Vr,Vr=t,zr=s}function p0(t,s,a){Kt[Xt++]=Ms,Kt[Xt++]=Rs,Kt[Xt++]=La,La=t;var n=Ms;t=Rs;var l=32-cs(n)-1;n&=~(1<<l),a+=1;var r=32-cs(s)+l;if(30<r){var o=l-l%5;r=(n&(1<<o)-1).toString(32),n>>=o,l-=o,Ms=1<<32-cs(s)+l|a<<l|n,Rs=r+t}else Ms=1<<r|a<<l|n,Rs=t}function Kd(t){t.return!==null&&(ja(t,1),p0(t,1,0))}function Xd(t){for(;t===Vr;)Vr=nn[--ln],nn[ln]=null,zr=nn[--ln],nn[ln]=null;for(;t===La;)La=Kt[--Xt],Kt[Xt]=null,Rs=Kt[--Xt],Kt[Xt]=null,Ms=Kt[--Xt],Kt[Xt]=null}var qt=null,Ht=null,et=!1,ds=null;function f0(t,s){var a=Zt(5,null,null,0);a.elementType="DELETED",a.stateNode=s,a.return=t,s=t.deletions,s===null?(t.deletions=[a],t.flags|=16):s.push(a)}function Am(t,s){switch(t.tag){case 5:var a=t.type;return s=s.nodeType!==1||a.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,qt=t,Ht=sa(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,qt=t,Ht=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(a=La!==null?{id:Ms,overflow:Rs}:null,t.memoizedState={dehydrated:s,treeContext:a,retryLane:1073741824},a=Zt(18,null,null,0),a.stateNode=s,a.return=t,t.child=a,qt=t,Ht=null,!0):!1;default:return!1}}function sd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ad(t){if(et){var s=Ht;if(s){var a=s;if(!Am(t,s)){if(sd(t))throw Error(oe(418));s=sa(a.nextSibling);var n=qt;s&&Am(t,s)?f0(n,a):(t.flags=t.flags&-4097|2,et=!1,qt=t)}}else{if(sd(t))throw Error(oe(418));t.flags=t.flags&-4097|2,et=!1,qt=t}}}function Lm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;qt=t}function Xl(t){if(t!==qt)return!1;if(!et)return Lm(t),et=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!Xo(t.type,t.memoizedProps)),s&&(s=Ht)){if(sd(t))throw g0(),Error(oe(418));for(;s;)f0(t,s),s=sa(s.nextSibling)}if(Lm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(oe(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var a=t.data;if(a==="/$"){if(s===0){Ht=sa(t.nextSibling);break e}s--}else a!=="$"&&a!=="$!"&&a!=="$?"||s++}t=t.nextSibling}Ht=null}}else Ht=qt?sa(t.stateNode.nextSibling):null;return!0}function g0(){for(var t=Ht;t;)t=sa(t.nextSibling)}function bn(){Ht=qt=null,et=!1}function Zd(t){ds===null?ds=[t]:ds.push(t)}var Vf=Bs.ReactCurrentBatchConfig;function Wn(t,s,a){if(t=a.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(oe(309));var n=a.stateNode}if(!n)throw Error(oe(147,t));var l=n,r=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===r?s.ref:(s=function(o){var d=l.refs;o===null?delete d[r]:d[r]=o},s._stringRef=r,s)}if(typeof t!="string")throw Error(oe(284));if(!a._owner)throw Error(oe(290,t))}return t}function Zl(t,s){throw t=Object.prototype.toString.call(s),Error(oe(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function Dm(t){var s=t._init;return s(t._payload)}function v0(t){function s(p,y){if(t){var w=p.deletions;w===null?(p.deletions=[y],p.flags|=16):w.push(y)}}function a(p,y){if(!t)return null;for(;y!==null;)s(p,y),y=y.sibling;return null}function n(p,y){for(p=new Map;y!==null;)y.key!==null?p.set(y.key,y):p.set(y.index,y),y=y.sibling;return p}function l(p,y){return p=ra(p,y),p.index=0,p.sibling=null,p}function r(p,y,w){return p.index=w,t?(w=p.alternate,w!==null?(w=w.index,w<y?(p.flags|=2,y):w):(p.flags|=2,y)):(p.flags|=1048576,y)}function o(p){return t&&p.alternate===null&&(p.flags|=2),p}function d(p,y,w,S){return y===null||y.tag!==6?(y=Zi(w,p.mode,S),y.return=p,y):(y=l(y,w),y.return=p,y)}function c(p,y,w,S){var N=w.type;return N===Xa?g(p,y,w.props.children,S,w.key):y!==null&&(y.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===qs&&Dm(N)===y.type)?(S=l(y,w.props),S.ref=Wn(p,y,w),S.return=p,S):(S=Lr(w.type,w.key,w.props,null,p.mode,S),S.ref=Wn(p,y,w),S.return=p,S)}function m(p,y,w,S){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=eo(w,p.mode,S),y.return=p,y):(y=l(y,w.children||[]),y.return=p,y)}function g(p,y,w,S,N){return y===null||y.tag!==7?(y=Ea(w,p.mode,S,N),y.return=p,y):(y=l(y,w),y.return=p,y)}function x(p,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Zi(""+y,p.mode,w),y.return=p,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Vl:return w=Lr(y.type,y.key,y.props,null,p.mode,w),w.ref=Wn(p,null,y),w.return=p,w;case Ka:return y=eo(y,p.mode,w),y.return=p,y;case qs:var S=y._init;return x(p,S(y._payload),w)}if(Xn(y)||Fn(y))return y=Ea(y,p.mode,w,null),y.return=p,y;Zl(p,y)}return null}function j(p,y,w,S){var N=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return N!==null?null:d(p,y,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Vl:return w.key===N?c(p,y,w,S):null;case Ka:return w.key===N?m(p,y,w,S):null;case qs:return N=w._init,j(p,y,N(w._payload),S)}if(Xn(w)||Fn(w))return N!==null?null:g(p,y,w,S,null);Zl(p,w)}return null}function h(p,y,w,S,N){if(typeof S=="string"&&S!==""||typeof S=="number")return p=p.get(w)||null,d(y,p,""+S,N);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Vl:return p=p.get(S.key===null?w:S.key)||null,c(y,p,S,N);case Ka:return p=p.get(S.key===null?w:S.key)||null,m(y,p,S,N);case qs:var E=S._init;return h(p,y,w,E(S._payload),N)}if(Xn(S)||Fn(S))return p=p.get(w)||null,g(y,p,S,N,null);Zl(y,S)}return null}function f(p,y,w,S){for(var N=null,E=null,v=y,A=y=0,T=null;v!==null&&A<w.length;A++){v.index>A?(T=v,v=null):T=v.sibling;var C=j(p,v,w[A],S);if(C===null){v===null&&(v=T);break}t&&v&&C.alternate===null&&s(p,v),y=r(C,y,A),E===null?N=C:E.sibling=C,E=C,v=T}if(A===w.length)return a(p,v),et&&ja(p,A),N;if(v===null){for(;A<w.length;A++)v=x(p,w[A],S),v!==null&&(y=r(v,y,A),E===null?N=v:E.sibling=v,E=v);return et&&ja(p,A),N}for(v=n(p,v);A<w.length;A++)T=h(v,p,A,w[A],S),T!==null&&(t&&T.alternate!==null&&v.delete(T.key===null?A:T.key),y=r(T,y,A),E===null?N=T:E.sibling=T,E=T);return t&&v.forEach(function(k){return s(p,k)}),et&&ja(p,A),N}function u(p,y,w,S){var N=Fn(w);if(typeof N!="function")throw Error(oe(150));if(w=N.call(w),w==null)throw Error(oe(151));for(var E=N=null,v=y,A=y=0,T=null,C=w.next();v!==null&&!C.done;A++,C=w.next()){v.index>A?(T=v,v=null):T=v.sibling;var k=j(p,v,C.value,S);if(k===null){v===null&&(v=T);break}t&&v&&k.alternate===null&&s(p,v),y=r(k,y,A),E===null?N=k:E.sibling=k,E=k,v=T}if(C.done)return a(p,v),et&&ja(p,A),N;if(v===null){for(;!C.done;A++,C=w.next())C=x(p,C.value,S),C!==null&&(y=r(C,y,A),E===null?N=C:E.sibling=C,E=C);return et&&ja(p,A),N}for(v=n(p,v);!C.done;A++,C=w.next())C=h(v,p,A,C.value,S),C!==null&&(t&&C.alternate!==null&&v.delete(C.key===null?A:C.key),y=r(C,y,A),E===null?N=C:E.sibling=C,E=C);return t&&v.forEach(function(D){return s(p,D)}),et&&ja(p,A),N}function b(p,y,w,S){if(typeof w=="object"&&w!==null&&w.type===Xa&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Vl:e:{for(var N=w.key,E=y;E!==null;){if(E.key===N){if(N=w.type,N===Xa){if(E.tag===7){a(p,E.sibling),y=l(E,w.props.children),y.return=p,p=y;break e}}else if(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===qs&&Dm(N)===E.type){a(p,E.sibling),y=l(E,w.props),y.ref=Wn(p,E,w),y.return=p,p=y;break e}a(p,E);break}else s(p,E);E=E.sibling}w.type===Xa?(y=Ea(w.props.children,p.mode,S,w.key),y.return=p,p=y):(S=Lr(w.type,w.key,w.props,null,p.mode,S),S.ref=Wn(p,y,w),S.return=p,p=S)}return o(p);case Ka:e:{for(E=w.key;y!==null;){if(y.key===E)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){a(p,y.sibling),y=l(y,w.children||[]),y.return=p,p=y;break e}else{a(p,y);break}else s(p,y);y=y.sibling}y=eo(w,p.mode,S),y.return=p,p=y}return o(p);case qs:return E=w._init,b(p,y,E(w._payload),S)}if(Xn(w))return f(p,y,w,S);if(Fn(w))return u(p,y,w,S);Zl(p,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(a(p,y.sibling),y=l(y,w),y.return=p,p=y):(a(p,y),y=Zi(w,p.mode,S),y.return=p,p=y),o(p)):a(p,y)}return b}var jn=v0(!0),b0=v0(!1),Wr=ua(null),Hr=null,rn=null,ec=null;function tc(){ec=rn=Hr=null}function sc(t){var s=Wr.current;Ze(Wr),t._currentValue=s}function nd(t,s,a){for(;t!==null;){var n=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,n!==null&&(n.childLanes|=s)):n!==null&&(n.childLanes&s)!==s&&(n.childLanes|=s),t===a)break;t=t.return}}function pn(t,s){Hr=t,ec=rn=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&s&&(Bt=!0),t.firstContext=null)}function as(t){var s=t._currentValue;if(ec!==t)if(t={context:t,memoizedValue:s,next:null},rn===null){if(Hr===null)throw Error(oe(308));rn=t,Hr.dependencies={lanes:0,firstContext:t}}else rn=rn.next=t;return s}var wa=null;function ac(t){wa===null?wa=[t]:wa.push(t)}function j0(t,s,a,n){var l=s.interleaved;return l===null?(a.next=a,ac(s)):(a.next=l.next,l.next=a),s.interleaved=a,Os(t,n)}function Os(t,s){t.lanes|=s;var a=t.alternate;for(a!==null&&(a.lanes|=s),a=t,t=t.return;t!==null;)t.childLanes|=s,a=t.alternate,a!==null&&(a.childLanes|=s),a=t,t=t.return;return a.tag===3?a.stateNode:null}var Ys=!1;function nc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function N0(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ts(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function aa(t,s,a){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,He&2){var l=n.pending;return l===null?s.next=s:(s.next=l.next,l.next=s),n.pending=s,Os(t,a)}return l=n.interleaved,l===null?(s.next=s,ac(n)):(s.next=l.next,l.next=s),n.interleaved=s,Os(t,a)}function wr(t,s,a){if(s=s.updateQueue,s!==null&&(s=s.shared,(a&4194240)!==0)){var n=s.lanes;n&=t.pendingLanes,a|=n,s.lanes=a,zd(t,a)}}function Mm(t,s){var a=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,a===n)){var l=null,r=null;if(a=a.firstBaseUpdate,a!==null){do{var o={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};r===null?l=r=o:r=r.next=o,a=a.next}while(a!==null);r===null?l=r=s:r=r.next=s}else l=r=s;a={baseState:n.baseState,firstBaseUpdate:l,lastBaseUpdate:r,shared:n.shared,effects:n.effects},t.updateQueue=a;return}t=a.lastBaseUpdate,t===null?a.firstBaseUpdate=s:t.next=s,a.lastBaseUpdate=s}function qr(t,s,a,n){var l=t.updateQueue;Ys=!1;var r=l.firstBaseUpdate,o=l.lastBaseUpdate,d=l.shared.pending;if(d!==null){l.shared.pending=null;var c=d,m=c.next;c.next=null,o===null?r=m:o.next=m,o=c;var g=t.alternate;g!==null&&(g=g.updateQueue,d=g.lastBaseUpdate,d!==o&&(d===null?g.firstBaseUpdate=m:d.next=m,g.lastBaseUpdate=c))}if(r!==null){var x=l.baseState;o=0,g=m=c=null,d=r;do{var j=d.lane,h=d.eventTime;if((n&j)===j){g!==null&&(g=g.next={eventTime:h,lane:0,tag:d.tag,payload:d.payload,callback:d.callback,next:null});e:{var f=t,u=d;switch(j=s,h=a,u.tag){case 1:if(f=u.payload,typeof f=="function"){x=f.call(h,x,j);break e}x=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=u.payload,j=typeof f=="function"?f.call(h,x,j):f,j==null)break e;x=lt({},x,j);break e;case 2:Ys=!0}}d.callback!==null&&d.lane!==0&&(t.flags|=64,j=l.effects,j===null?l.effects=[d]:j.push(d))}else h={eventTime:h,lane:j,tag:d.tag,payload:d.payload,callback:d.callback,next:null},g===null?(m=g=h,c=x):g=g.next=h,o|=j;if(d=d.next,d===null){if(d=l.shared.pending,d===null)break;j=d,d=j.next,j.next=null,l.lastBaseUpdate=j,l.shared.pending=null}}while(!0);if(g===null&&(c=x),l.baseState=c,l.firstBaseUpdate=m,l.lastBaseUpdate=g,s=l.shared.interleaved,s!==null){l=s;do o|=l.lane,l=l.next;while(l!==s)}else r===null&&(l.shared.lanes=0);Ma|=o,t.lanes=o,t.memoizedState=x}}function Rm(t,s,a){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var n=t[s],l=n.callback;if(l!==null){if(n.callback=null,n=a,typeof l!="function")throw Error(oe(191,l));l.call(n)}}}var Ol={},ws=ua(Ol),wl=ua(Ol),Sl=ua(Ol);function Sa(t){if(t===Ol)throw Error(oe(174));return t}function lc(t,s){switch(Ke(Sl,s),Ke(wl,t),Ke(ws,Ol),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Bo(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=Bo(s,t)}Ze(ws),Ke(ws,s)}function Nn(){Ze(ws),Ze(wl),Ze(Sl)}function y0(t){Sa(Sl.current);var s=Sa(ws.current),a=Bo(s,t.type);s!==a&&(Ke(wl,t),Ke(ws,a))}function rc(t){wl.current===t&&(Ze(ws),Ze(wl))}var tt=ua(0);function Yr(t){for(var s=t;s!==null;){if(s.tag===13){var a=s.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Yi=[];function ic(){for(var t=0;t<Yi.length;t++)Yi[t]._workInProgressVersionPrimary=null;Yi.length=0}var Sr=Bs.ReactCurrentDispatcher,Gi=Bs.ReactCurrentBatchConfig,Da=0,at=null,pt=null,gt=null,Gr=!1,il=!1,kl=0,zf=0;function kt(){throw Error(oe(321))}function oc(t,s){if(s===null)return!1;for(var a=0;a<s.length&&a<t.length;a++)if(!us(t[a],s[a]))return!1;return!0}function dc(t,s,a,n,l,r){if(Da=r,at=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Sr.current=t===null||t.memoizedState===null?Yf:Gf,t=a(n,l),il){r=0;do{if(il=!1,kl=0,25<=r)throw Error(oe(301));r+=1,gt=pt=null,s.updateQueue=null,Sr.current=Qf,t=a(n,l)}while(il)}if(Sr.current=Qr,s=pt!==null&&pt.next!==null,Da=0,gt=pt=at=null,Gr=!1,s)throw Error(oe(300));return t}function cc(){var t=kl!==0;return kl=0,t}function bs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?at.memoizedState=gt=t:gt=gt.next=t,gt}function ns(){if(pt===null){var t=at.alternate;t=t!==null?t.memoizedState:null}else t=pt.next;var s=gt===null?at.memoizedState:gt.next;if(s!==null)gt=s,pt=t;else{if(t===null)throw Error(oe(310));pt=t,t={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},gt===null?at.memoizedState=gt=t:gt=gt.next=t}return gt}function El(t,s){return typeof s=="function"?s(t):s}function Qi(t){var s=ns(),a=s.queue;if(a===null)throw Error(oe(311));a.lastRenderedReducer=t;var n=pt,l=n.baseQueue,r=a.pending;if(r!==null){if(l!==null){var o=l.next;l.next=r.next,r.next=o}n.baseQueue=l=r,a.pending=null}if(l!==null){r=l.next,n=n.baseState;var d=o=null,c=null,m=r;do{var g=m.lane;if((Da&g)===g)c!==null&&(c=c.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),n=m.hasEagerState?m.eagerState:t(n,m.action);else{var x={lane:g,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};c===null?(d=c=x,o=n):c=c.next=x,at.lanes|=g,Ma|=g}m=m.next}while(m!==null&&m!==r);c===null?o=n:c.next=d,us(n,s.memoizedState)||(Bt=!0),s.memoizedState=n,s.baseState=o,s.baseQueue=c,a.lastRenderedState=n}if(t=a.interleaved,t!==null){l=t;do r=l.lane,at.lanes|=r,Ma|=r,l=l.next;while(l!==t)}else l===null&&(a.lanes=0);return[s.memoizedState,a.dispatch]}function Ji(t){var s=ns(),a=s.queue;if(a===null)throw Error(oe(311));a.lastRenderedReducer=t;var n=a.dispatch,l=a.pending,r=s.memoizedState;if(l!==null){a.pending=null;var o=l=l.next;do r=t(r,o.action),o=o.next;while(o!==l);us(r,s.memoizedState)||(Bt=!0),s.memoizedState=r,s.baseQueue===null&&(s.baseState=r),a.lastRenderedState=r}return[r,n]}function w0(){}function S0(t,s){var a=at,n=ns(),l=s(),r=!us(n.memoizedState,l);if(r&&(n.memoizedState=l,Bt=!0),n=n.queue,mc(C0.bind(null,a,n,t),[t]),n.getSnapshot!==s||r||gt!==null&&gt.memoizedState.tag&1){if(a.flags|=2048,Cl(9,E0.bind(null,a,n,l,s),void 0,null),bt===null)throw Error(oe(349));Da&30||k0(a,s,l)}return l}function k0(t,s,a){t.flags|=16384,t={getSnapshot:s,value:a},s=at.updateQueue,s===null?(s={lastEffect:null,stores:null},at.updateQueue=s,s.stores=[t]):(a=s.stores,a===null?s.stores=[t]:a.push(t))}function E0(t,s,a,n){s.value=a,s.getSnapshot=n,A0(s)&&L0(t)}function C0(t,s,a){return a(function(){A0(s)&&L0(t)})}function A0(t){var s=t.getSnapshot;t=t.value;try{var a=s();return!us(t,a)}catch{return!0}}function L0(t){var s=Os(t,1);s!==null&&ms(s,t,1,-1)}function Tm(t){var s=bs();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:El,lastRenderedState:t},s.queue=t,t=t.dispatch=qf.bind(null,at,t),[s.memoizedState,t]}function Cl(t,s,a,n){return t={tag:t,create:s,destroy:a,deps:n,next:null},s=at.updateQueue,s===null?(s={lastEffect:null,stores:null},at.updateQueue=s,s.lastEffect=t.next=t):(a=s.lastEffect,a===null?s.lastEffect=t.next=t:(n=a.next,a.next=t,t.next=n,s.lastEffect=t)),t}function D0(){return ns().memoizedState}function kr(t,s,a,n){var l=bs();at.flags|=t,l.memoizedState=Cl(1|s,a,void 0,n===void 0?null:n)}function xi(t,s,a,n){var l=ns();n=n===void 0?null:n;var r=void 0;if(pt!==null){var o=pt.memoizedState;if(r=o.destroy,n!==null&&oc(n,o.deps)){l.memoizedState=Cl(s,a,r,n);return}}at.flags|=t,l.memoizedState=Cl(1|s,a,r,n)}function Pm(t,s){return kr(8390656,8,t,s)}function mc(t,s){return xi(2048,8,t,s)}function M0(t,s){return xi(4,2,t,s)}function R0(t,s){return xi(4,4,t,s)}function T0(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function P0(t,s,a){return a=a!=null?a.concat([t]):null,xi(4,4,T0.bind(null,s,t),a)}function uc(){}function I0(t,s){var a=ns();s=s===void 0?null:s;var n=a.memoizedState;return n!==null&&s!==null&&oc(s,n[1])?n[0]:(a.memoizedState=[t,s],t)}function O0(t,s){var a=ns();s=s===void 0?null:s;var n=a.memoizedState;return n!==null&&s!==null&&oc(s,n[1])?n[0]:(t=t(),a.memoizedState=[t,s],t)}function _0(t,s,a){return Da&21?(us(a,s)||(a=Vx(),at.lanes|=a,Ma|=a,t.baseState=!0),s):(t.baseState&&(t.baseState=!1,Bt=!0),t.memoizedState=a)}function Wf(t,s){var a=Ge;Ge=a!==0&&4>a?a:4,t(!0);var n=Gi.transition;Gi.transition={};try{t(!1),s()}finally{Ge=a,Gi.transition=n}}function B0(){return ns().memoizedState}function Hf(t,s,a){var n=la(t);if(a={lane:n,action:a,hasEagerState:!1,eagerState:null,next:null},F0(t))U0(s,a);else if(a=j0(t,s,a,n),a!==null){var l=Tt();ms(a,t,n,l),$0(a,s,n)}}function qf(t,s,a){var n=la(t),l={lane:n,action:a,hasEagerState:!1,eagerState:null,next:null};if(F0(t))U0(s,l);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=s.lastRenderedReducer,r!==null))try{var o=s.lastRenderedState,d=r(o,a);if(l.hasEagerState=!0,l.eagerState=d,us(d,o)){var c=s.interleaved;c===null?(l.next=l,ac(s)):(l.next=c.next,c.next=l),s.interleaved=l;return}}catch{}finally{}a=j0(t,s,l,n),a!==null&&(l=Tt(),ms(a,t,n,l),$0(a,s,n))}}function F0(t){var s=t.alternate;return t===at||s!==null&&s===at}function U0(t,s){il=Gr=!0;var a=t.pending;a===null?s.next=s:(s.next=a.next,a.next=s),t.pending=s}function $0(t,s,a){if(a&4194240){var n=s.lanes;n&=t.pendingLanes,a|=n,s.lanes=a,zd(t,a)}}var Qr={readContext:as,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},Yf={readContext:as,useCallback:function(t,s){return bs().memoizedState=[t,s===void 0?null:s],t},useContext:as,useEffect:Pm,useImperativeHandle:function(t,s,a){return a=a!=null?a.concat([t]):null,kr(4194308,4,T0.bind(null,s,t),a)},useLayoutEffect:function(t,s){return kr(4194308,4,t,s)},useInsertionEffect:function(t,s){return kr(4,2,t,s)},useMemo:function(t,s){var a=bs();return s=s===void 0?null:s,t=t(),a.memoizedState=[t,s],t},useReducer:function(t,s,a){var n=bs();return s=a!==void 0?a(s):s,n.memoizedState=n.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},n.queue=t,t=t.dispatch=Hf.bind(null,at,t),[n.memoizedState,t]},useRef:function(t){var s=bs();return t={current:t},s.memoizedState=t},useState:Tm,useDebugValue:uc,useDeferredValue:function(t){return bs().memoizedState=t},useTransition:function(){var t=Tm(!1),s=t[0];return t=Wf.bind(null,t[1]),bs().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,a){var n=at,l=bs();if(et){if(a===void 0)throw Error(oe(407));a=a()}else{if(a=s(),bt===null)throw Error(oe(349));Da&30||k0(n,s,a)}l.memoizedState=a;var r={value:a,getSnapshot:s};return l.queue=r,Pm(C0.bind(null,n,r,t),[t]),n.flags|=2048,Cl(9,E0.bind(null,n,r,a,s),void 0,null),a},useId:function(){var t=bs(),s=bt.identifierPrefix;if(et){var a=Rs,n=Ms;a=(n&~(1<<32-cs(n)-1)).toString(32)+a,s=":"+s+"R"+a,a=kl++,0<a&&(s+="H"+a.toString(32)),s+=":"}else a=zf++,s=":"+s+"r"+a.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},Gf={readContext:as,useCallback:I0,useContext:as,useEffect:mc,useImperativeHandle:P0,useInsertionEffect:M0,useLayoutEffect:R0,useMemo:O0,useReducer:Qi,useRef:D0,useState:function(){return Qi(El)},useDebugValue:uc,useDeferredValue:function(t){var s=ns();return _0(s,pt.memoizedState,t)},useTransition:function(){var t=Qi(El)[0],s=ns().memoizedState;return[t,s]},useMutableSource:w0,useSyncExternalStore:S0,useId:B0,unstable_isNewReconciler:!1},Qf={readContext:as,useCallback:I0,useContext:as,useEffect:mc,useImperativeHandle:P0,useInsertionEffect:M0,useLayoutEffect:R0,useMemo:O0,useReducer:Ji,useRef:D0,useState:function(){return Ji(El)},useDebugValue:uc,useDeferredValue:function(t){var s=ns();return pt===null?s.memoizedState=t:_0(s,pt.memoizedState,t)},useTransition:function(){var t=Ji(El)[0],s=ns().memoizedState;return[t,s]},useMutableSource:w0,useSyncExternalStore:S0,useId:B0,unstable_isNewReconciler:!1};function is(t,s){if(t&&t.defaultProps){s=lt({},s),t=t.defaultProps;for(var a in t)s[a]===void 0&&(s[a]=t[a]);return s}return s}function ld(t,s,a,n){s=t.memoizedState,a=a(n,s),a=a==null?s:lt({},s,a),t.memoizedState=a,t.lanes===0&&(t.updateQueue.baseState=a)}var hi={isMounted:function(t){return(t=t._reactInternals)?Pa(t)===t:!1},enqueueSetState:function(t,s,a){t=t._reactInternals;var n=Tt(),l=la(t),r=Ts(n,l);r.payload=s,a!=null&&(r.callback=a),s=aa(t,r,l),s!==null&&(ms(s,t,l,n),wr(s,t,l))},enqueueReplaceState:function(t,s,a){t=t._reactInternals;var n=Tt(),l=la(t),r=Ts(n,l);r.tag=1,r.payload=s,a!=null&&(r.callback=a),s=aa(t,r,l),s!==null&&(ms(s,t,l,n),wr(s,t,l))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var a=Tt(),n=la(t),l=Ts(a,n);l.tag=2,s!=null&&(l.callback=s),s=aa(t,l,n),s!==null&&(ms(s,t,n,a),wr(s,t,n))}};function Im(t,s,a,n,l,r,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,r,o):s.prototype&&s.prototype.isPureReactComponent?!bl(a,n)||!bl(l,r):!0}function V0(t,s,a){var n=!1,l=ca,r=s.contextType;return typeof r=="object"&&r!==null?r=as(r):(l=Ut(s)?Aa:Lt.current,n=s.contextTypes,r=(n=n!=null)?vn(t,l):ca),s=new s(a,r),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=hi,t.stateNode=s,s._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=l,t.__reactInternalMemoizedMaskedChildContext=r),s}function Om(t,s,a,n){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(a,n),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(a,n),s.state!==t&&hi.enqueueReplaceState(s,s.state,null)}function rd(t,s,a,n){var l=t.stateNode;l.props=a,l.state=t.memoizedState,l.refs={},nc(t);var r=s.contextType;typeof r=="object"&&r!==null?l.context=as(r):(r=Ut(s)?Aa:Lt.current,l.context=vn(t,r)),l.state=t.memoizedState,r=s.getDerivedStateFromProps,typeof r=="function"&&(ld(t,s,r,a),l.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(s=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),s!==l.state&&hi.enqueueReplaceState(l,l.state,null),qr(t,a,l,n),l.state=t.memoizedState),typeof l.componentDidMount=="function"&&(t.flags|=4194308)}function yn(t,s){try{var a="",n=s;do a+=yp(n),n=n.return;while(n);var l=a}catch(r){l=`
Error generating stack: `+r.message+`
`+r.stack}return{value:t,source:s,stack:l,digest:null}}function Ki(t,s,a){return{value:t,source:null,stack:a??null,digest:s??null}}function id(t,s){try{console.error(s.value)}catch(a){setTimeout(function(){throw a})}}var Jf=typeof WeakMap=="function"?WeakMap:Map;function z0(t,s,a){a=Ts(-1,a),a.tag=3,a.payload={element:null};var n=s.value;return a.callback=function(){Kr||(Kr=!0,gd=n),id(t,s)},a}function W0(t,s,a){a=Ts(-1,a),a.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var l=s.value;a.payload=function(){return n(l)},a.callback=function(){id(t,s)}}var r=t.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(a.callback=function(){id(t,s),typeof n!="function"&&(na===null?na=new Set([this]):na.add(this));var o=s.stack;this.componentDidCatch(s.value,{componentStack:o!==null?o:""})}),a}function _m(t,s,a){var n=t.pingCache;if(n===null){n=t.pingCache=new Jf;var l=new Set;n.set(s,l)}else l=n.get(s),l===void 0&&(l=new Set,n.set(s,l));l.has(a)||(l.add(a),t=cg.bind(null,t,s,a),s.then(t,t))}function Bm(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function Fm(t,s,a,n,l){return t.mode&1?(t.flags|=65536,t.lanes=l,t):(t===s?t.flags|=65536:(t.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(s=Ts(-1,1),s.tag=2,aa(a,s,1))),a.lanes|=1),t)}var Kf=Bs.ReactCurrentOwner,Bt=!1;function Rt(t,s,a,n){s.child=t===null?b0(s,null,a,n):jn(s,t.child,a,n)}function Um(t,s,a,n,l){a=a.render;var r=s.ref;return pn(s,l),n=dc(t,s,a,n,r,l),a=cc(),t!==null&&!Bt?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~l,_s(t,s,l)):(et&&a&&Kd(s),s.flags|=1,Rt(t,s,n,l),s.child)}function $m(t,s,a,n,l){if(t===null){var r=a.type;return typeof r=="function"&&!jc(r)&&r.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(s.tag=15,s.type=r,H0(t,s,r,n,l)):(t=Lr(a.type,null,n,s,s.mode,l),t.ref=s.ref,t.return=s,s.child=t)}if(r=t.child,!(t.lanes&l)){var o=r.memoizedProps;if(a=a.compare,a=a!==null?a:bl,a(o,n)&&t.ref===s.ref)return _s(t,s,l)}return s.flags|=1,t=ra(r,n),t.ref=s.ref,t.return=s,s.child=t}function H0(t,s,a,n,l){if(t!==null){var r=t.memoizedProps;if(bl(r,n)&&t.ref===s.ref)if(Bt=!1,s.pendingProps=n=r,(t.lanes&l)!==0)t.flags&131072&&(Bt=!0);else return s.lanes=t.lanes,_s(t,s,l)}return od(t,s,a,n,l)}function q0(t,s,a){var n=s.pendingProps,l=n.children,r=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(dn,Wt),Wt|=a;else{if(!(a&1073741824))return t=r!==null?r.baseLanes|a:a,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,Ke(dn,Wt),Wt|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=r!==null?r.baseLanes:a,Ke(dn,Wt),Wt|=n}else r!==null?(n=r.baseLanes|a,s.memoizedState=null):n=a,Ke(dn,Wt),Wt|=n;return Rt(t,s,l,a),s.child}function Y0(t,s){var a=s.ref;(t===null&&a!==null||t!==null&&t.ref!==a)&&(s.flags|=512,s.flags|=2097152)}function od(t,s,a,n,l){var r=Ut(a)?Aa:Lt.current;return r=vn(s,r),pn(s,l),a=dc(t,s,a,n,r,l),n=cc(),t!==null&&!Bt?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~l,_s(t,s,l)):(et&&n&&Kd(s),s.flags|=1,Rt(t,s,a,l),s.child)}function Vm(t,s,a,n,l){if(Ut(a)){var r=!0;$r(s)}else r=!1;if(pn(s,l),s.stateNode===null)Er(t,s),V0(s,a,n),rd(s,a,n,l),n=!0;else if(t===null){var o=s.stateNode,d=s.memoizedProps;o.props=d;var c=o.context,m=a.contextType;typeof m=="object"&&m!==null?m=as(m):(m=Ut(a)?Aa:Lt.current,m=vn(s,m));var g=a.getDerivedStateFromProps,x=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function";x||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(d!==n||c!==m)&&Om(s,o,n,m),Ys=!1;var j=s.memoizedState;o.state=j,qr(s,n,o,l),c=s.memoizedState,d!==n||j!==c||Ft.current||Ys?(typeof g=="function"&&(ld(s,a,g,n),c=s.memoizedState),(d=Ys||Im(s,a,d,n,j,c,m))?(x||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(s.flags|=4194308)):(typeof o.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=n,s.memoizedState=c),o.props=n,o.state=c,o.context=m,n=d):(typeof o.componentDidMount=="function"&&(s.flags|=4194308),n=!1)}else{o=s.stateNode,N0(t,s),d=s.memoizedProps,m=s.type===s.elementType?d:is(s.type,d),o.props=m,x=s.pendingProps,j=o.context,c=a.contextType,typeof c=="object"&&c!==null?c=as(c):(c=Ut(a)?Aa:Lt.current,c=vn(s,c));var h=a.getDerivedStateFromProps;(g=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(d!==x||j!==c)&&Om(s,o,n,c),Ys=!1,j=s.memoizedState,o.state=j,qr(s,n,o,l);var f=s.memoizedState;d!==x||j!==f||Ft.current||Ys?(typeof h=="function"&&(ld(s,a,h,n),f=s.memoizedState),(m=Ys||Im(s,a,m,n,j,f,c)||!1)?(g||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,f,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,f,c)),typeof o.componentDidUpdate=="function"&&(s.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof o.componentDidUpdate!="function"||d===t.memoizedProps&&j===t.memoizedState||(s.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||d===t.memoizedProps&&j===t.memoizedState||(s.flags|=1024),s.memoizedProps=n,s.memoizedState=f),o.props=n,o.state=f,o.context=c,n=m):(typeof o.componentDidUpdate!="function"||d===t.memoizedProps&&j===t.memoizedState||(s.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||d===t.memoizedProps&&j===t.memoizedState||(s.flags|=1024),n=!1)}return dd(t,s,a,n,r,l)}function dd(t,s,a,n,l,r){Y0(t,s);var o=(s.flags&128)!==0;if(!n&&!o)return l&&Cm(s,a,!1),_s(t,s,r);n=s.stateNode,Kf.current=s;var d=o&&typeof a.getDerivedStateFromError!="function"?null:n.render();return s.flags|=1,t!==null&&o?(s.child=jn(s,t.child,null,r),s.child=jn(s,null,d,r)):Rt(t,s,d,r),s.memoizedState=n.state,l&&Cm(s,a,!0),s.child}function G0(t){var s=t.stateNode;s.pendingContext?Em(t,s.pendingContext,s.pendingContext!==s.context):s.context&&Em(t,s.context,!1),lc(t,s.containerInfo)}function zm(t,s,a,n,l){return bn(),Zd(l),s.flags|=256,Rt(t,s,a,n),s.child}var cd={dehydrated:null,treeContext:null,retryLane:0};function md(t){return{baseLanes:t,cachePool:null,transitions:null}}function Q0(t,s,a){var n=s.pendingProps,l=tt.current,r=!1,o=(s.flags&128)!==0,d;if((d=o)||(d=t!==null&&t.memoizedState===null?!1:(l&2)!==0),d?(r=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(l|=1),Ke(tt,l&1),t===null)return ad(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(s.mode&1?t.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(o=n.children,t=n.fallback,r?(n=s.mode,r=s.child,o={mode:"hidden",children:o},!(n&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=gi(o,n,0,null),t=Ea(t,n,a,null),r.return=s,t.return=s,r.sibling=t,s.child=r,s.child.memoizedState=md(a),s.memoizedState=cd,t):xc(s,o));if(l=t.memoizedState,l!==null&&(d=l.dehydrated,d!==null))return Xf(t,s,o,n,d,l,a);if(r){r=n.fallback,o=s.mode,l=t.child,d=l.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&s.child!==l?(n=s.child,n.childLanes=0,n.pendingProps=c,s.deletions=null):(n=ra(l,c),n.subtreeFlags=l.subtreeFlags&14680064),d!==null?r=ra(d,r):(r=Ea(r,o,a,null),r.flags|=2),r.return=s,n.return=s,n.sibling=r,s.child=n,n=r,r=s.child,o=t.child.memoizedState,o=o===null?md(a):{baseLanes:o.baseLanes|a,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=t.childLanes&~a,s.memoizedState=cd,n}return r=t.child,t=r.sibling,n=ra(r,{mode:"visible",children:n.children}),!(s.mode&1)&&(n.lanes=a),n.return=s,n.sibling=null,t!==null&&(a=s.deletions,a===null?(s.deletions=[t],s.flags|=16):a.push(t)),s.child=n,s.memoizedState=null,n}function xc(t,s){return s=gi({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function er(t,s,a,n){return n!==null&&Zd(n),jn(s,t.child,null,a),t=xc(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function Xf(t,s,a,n,l,r,o){if(a)return s.flags&256?(s.flags&=-257,n=Ki(Error(oe(422))),er(t,s,o,n)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(r=n.fallback,l=s.mode,n=gi({mode:"visible",children:n.children},l,0,null),r=Ea(r,l,o,null),r.flags|=2,n.return=s,r.return=s,n.sibling=r,s.child=n,s.mode&1&&jn(s,t.child,null,o),s.child.memoizedState=md(o),s.memoizedState=cd,r);if(!(s.mode&1))return er(t,s,o,null);if(l.data==="$!"){if(n=l.nextSibling&&l.nextSibling.dataset,n)var d=n.dgst;return n=d,r=Error(oe(419)),n=Ki(r,n,void 0),er(t,s,o,n)}if(d=(o&t.childLanes)!==0,Bt||d){if(n=bt,n!==null){switch(o&-o){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(n.suspendedLanes|o)?0:l,l!==0&&l!==r.retryLane&&(r.retryLane=l,Os(t,l),ms(n,t,l,-1))}return bc(),n=Ki(Error(oe(421))),er(t,s,o,n)}return l.data==="$?"?(s.flags|=128,s.child=t.child,s=mg.bind(null,t),l._reactRetry=s,null):(t=r.treeContext,Ht=sa(l.nextSibling),qt=s,et=!0,ds=null,t!==null&&(Kt[Xt++]=Ms,Kt[Xt++]=Rs,Kt[Xt++]=La,Ms=t.id,Rs=t.overflow,La=s),s=xc(s,n.children),s.flags|=4096,s)}function Wm(t,s,a){t.lanes|=s;var n=t.alternate;n!==null&&(n.lanes|=s),nd(t.return,s,a)}function Xi(t,s,a,n,l){var r=t.memoizedState;r===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:n,tail:a,tailMode:l}:(r.isBackwards=s,r.rendering=null,r.renderingStartTime=0,r.last=n,r.tail=a,r.tailMode=l)}function J0(t,s,a){var n=s.pendingProps,l=n.revealOrder,r=n.tail;if(Rt(t,s,n.children,a),n=tt.current,n&2)n=n&1|2,s.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Wm(t,a,s);else if(t.tag===19)Wm(t,a,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Ke(tt,n),!(s.mode&1))s.memoizedState=null;else switch(l){case"forwards":for(a=s.child,l=null;a!==null;)t=a.alternate,t!==null&&Yr(t)===null&&(l=a),a=a.sibling;a=l,a===null?(l=s.child,s.child=null):(l=a.sibling,a.sibling=null),Xi(s,!1,l,a,r);break;case"backwards":for(a=null,l=s.child,s.child=null;l!==null;){if(t=l.alternate,t!==null&&Yr(t)===null){s.child=l;break}t=l.sibling,l.sibling=a,a=l,l=t}Xi(s,!0,a,null,r);break;case"together":Xi(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Er(t,s){!(s.mode&1)&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function _s(t,s,a){if(t!==null&&(s.dependencies=t.dependencies),Ma|=s.lanes,!(a&s.childLanes))return null;if(t!==null&&s.child!==t.child)throw Error(oe(153));if(s.child!==null){for(t=s.child,a=ra(t,t.pendingProps),s.child=a,a.return=s;t.sibling!==null;)t=t.sibling,a=a.sibling=ra(t,t.pendingProps),a.return=s;a.sibling=null}return s.child}function Zf(t,s,a){switch(s.tag){case 3:G0(s),bn();break;case 5:y0(s);break;case 1:Ut(s.type)&&$r(s);break;case 4:lc(s,s.stateNode.containerInfo);break;case 10:var n=s.type._context,l=s.memoizedProps.value;Ke(Wr,n._currentValue),n._currentValue=l;break;case 13:if(n=s.memoizedState,n!==null)return n.dehydrated!==null?(Ke(tt,tt.current&1),s.flags|=128,null):a&s.child.childLanes?Q0(t,s,a):(Ke(tt,tt.current&1),t=_s(t,s,a),t!==null?t.sibling:null);Ke(tt,tt.current&1);break;case 19:if(n=(a&s.childLanes)!==0,t.flags&128){if(n)return J0(t,s,a);s.flags|=128}if(l=s.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Ke(tt,tt.current),n)break;return null;case 22:case 23:return s.lanes=0,q0(t,s,a)}return _s(t,s,a)}var K0,ud,X0,Z0;K0=function(t,s){for(var a=s.child;a!==null;){if(a.tag===5||a.tag===6)t.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};ud=function(){};X0=function(t,s,a,n){var l=t.memoizedProps;if(l!==n){t=s.stateNode,Sa(ws.current);var r=null;switch(a){case"input":l=Po(t,l),n=Po(t,n),r=[];break;case"select":l=lt({},l,{value:void 0}),n=lt({},n,{value:void 0}),r=[];break;case"textarea":l=_o(t,l),n=_o(t,n),r=[];break;default:typeof l.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Fr)}Fo(a,n);var o;a=null;for(m in l)if(!n.hasOwnProperty(m)&&l.hasOwnProperty(m)&&l[m]!=null)if(m==="style"){var d=l[m];for(o in d)d.hasOwnProperty(o)&&(a||(a={}),a[o]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(ul.hasOwnProperty(m)?r||(r=[]):(r=r||[]).push(m,null));for(m in n){var c=n[m];if(d=l!=null?l[m]:void 0,n.hasOwnProperty(m)&&c!==d&&(c!=null||d!=null))if(m==="style")if(d){for(o in d)!d.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(a||(a={}),a[o]="");for(o in c)c.hasOwnProperty(o)&&d[o]!==c[o]&&(a||(a={}),a[o]=c[o])}else a||(r||(r=[]),r.push(m,a)),a=c;else m==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,d=d?d.__html:void 0,c!=null&&d!==c&&(r=r||[]).push(m,c)):m==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(m,""+c):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(ul.hasOwnProperty(m)?(c!=null&&m==="onScroll"&&Xe("scroll",t),r||d===c||(r=[])):(r=r||[]).push(m,c))}a&&(r=r||[]).push("style",a);var m=r;(s.updateQueue=m)&&(s.flags|=4)}};Z0=function(t,s,a,n){a!==n&&(s.flags|=4)};function Hn(t,s){if(!et)switch(t.tailMode){case"hidden":s=t.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?t.tail=null:a.sibling=null;break;case"collapsed":a=t.tail;for(var n=null;a!==null;)a.alternate!==null&&(n=a),a=a.sibling;n===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Et(t){var s=t.alternate!==null&&t.alternate.child===t.child,a=0,n=0;if(s)for(var l=t.child;l!==null;)a|=l.lanes|l.childLanes,n|=l.subtreeFlags&14680064,n|=l.flags&14680064,l.return=t,l=l.sibling;else for(l=t.child;l!==null;)a|=l.lanes|l.childLanes,n|=l.subtreeFlags,n|=l.flags,l.return=t,l=l.sibling;return t.subtreeFlags|=n,t.childLanes=a,s}function eg(t,s,a){var n=s.pendingProps;switch(Xd(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(s),null;case 1:return Ut(s.type)&&Ur(),Et(s),null;case 3:return n=s.stateNode,Nn(),Ze(Ft),Ze(Lt),ic(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Xl(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,ds!==null&&(jd(ds),ds=null))),ud(t,s),Et(s),null;case 5:rc(s);var l=Sa(Sl.current);if(a=s.type,t!==null&&s.stateNode!=null)X0(t,s,a,n,l),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!n){if(s.stateNode===null)throw Error(oe(166));return Et(s),null}if(t=Sa(ws.current),Xl(s)){n=s.stateNode,a=s.type;var r=s.memoizedProps;switch(n[js]=s,n[yl]=r,t=(s.mode&1)!==0,a){case"dialog":Xe("cancel",n),Xe("close",n);break;case"iframe":case"object":case"embed":Xe("load",n);break;case"video":case"audio":for(l=0;l<el.length;l++)Xe(el[l],n);break;case"source":Xe("error",n);break;case"img":case"image":case"link":Xe("error",n),Xe("load",n);break;case"details":Xe("toggle",n);break;case"input":Zc(n,r),Xe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!r.multiple},Xe("invalid",n);break;case"textarea":tm(n,r),Xe("invalid",n)}Fo(a,r),l=null;for(var o in r)if(r.hasOwnProperty(o)){var d=r[o];o==="children"?typeof d=="string"?n.textContent!==d&&(r.suppressHydrationWarning!==!0&&Kl(n.textContent,d,t),l=["children",d]):typeof d=="number"&&n.textContent!==""+d&&(r.suppressHydrationWarning!==!0&&Kl(n.textContent,d,t),l=["children",""+d]):ul.hasOwnProperty(o)&&d!=null&&o==="onScroll"&&Xe("scroll",n)}switch(a){case"input":zl(n),em(n,r,!0);break;case"textarea":zl(n),sm(n);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(n.onclick=Fr)}n=l,s.updateQueue=n,n!==null&&(s.flags|=4)}else{o=l.nodeType===9?l:l.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Cx(a)),t==="http://www.w3.org/1999/xhtml"?a==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(a,{is:n.is}):(t=o.createElement(a),a==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,a),t[js]=s,t[yl]=n,K0(t,s,!1,!1),s.stateNode=t;e:{switch(o=Uo(a,n),a){case"dialog":Xe("cancel",t),Xe("close",t),l=n;break;case"iframe":case"object":case"embed":Xe("load",t),l=n;break;case"video":case"audio":for(l=0;l<el.length;l++)Xe(el[l],t);l=n;break;case"source":Xe("error",t),l=n;break;case"img":case"image":case"link":Xe("error",t),Xe("load",t),l=n;break;case"details":Xe("toggle",t),l=n;break;case"input":Zc(t,n),l=Po(t,n),Xe("invalid",t);break;case"option":l=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},l=lt({},n,{value:void 0}),Xe("invalid",t);break;case"textarea":tm(t,n),l=_o(t,n),Xe("invalid",t);break;default:l=n}Fo(a,l),d=l;for(r in d)if(d.hasOwnProperty(r)){var c=d[r];r==="style"?Dx(t,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ax(t,c)):r==="children"?typeof c=="string"?(a!=="textarea"||c!=="")&&xl(t,c):typeof c=="number"&&xl(t,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(ul.hasOwnProperty(r)?c!=null&&r==="onScroll"&&Xe("scroll",t):c!=null&&_d(t,r,c,o))}switch(a){case"input":zl(t),em(t,n,!1);break;case"textarea":zl(t),sm(t);break;case"option":n.value!=null&&t.setAttribute("value",""+da(n.value));break;case"select":t.multiple=!!n.multiple,r=n.value,r!=null?mn(t,!!n.multiple,r,!1):n.defaultValue!=null&&mn(t,!!n.multiple,n.defaultValue,!0);break;default:typeof l.onClick=="function"&&(t.onclick=Fr)}switch(a){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Et(s),null;case 6:if(t&&s.stateNode!=null)Z0(t,s,t.memoizedProps,n);else{if(typeof n!="string"&&s.stateNode===null)throw Error(oe(166));if(a=Sa(Sl.current),Sa(ws.current),Xl(s)){if(n=s.stateNode,a=s.memoizedProps,n[js]=s,(r=n.nodeValue!==a)&&(t=qt,t!==null))switch(t.tag){case 3:Kl(n.nodeValue,a,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Kl(n.nodeValue,a,(t.mode&1)!==0)}r&&(s.flags|=4)}else n=(a.nodeType===9?a:a.ownerDocument).createTextNode(n),n[js]=s,s.stateNode=n}return Et(s),null;case 13:if(Ze(tt),n=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(et&&Ht!==null&&s.mode&1&&!(s.flags&128))g0(),bn(),s.flags|=98560,r=!1;else if(r=Xl(s),n!==null&&n.dehydrated!==null){if(t===null){if(!r)throw Error(oe(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(oe(317));r[js]=s}else bn(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Et(s),r=!1}else ds!==null&&(jd(ds),ds=null),r=!0;if(!r)return s.flags&65536?s:null}return s.flags&128?(s.lanes=a,s):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(s.child.flags|=8192,s.mode&1&&(t===null||tt.current&1?ft===0&&(ft=3):bc())),s.updateQueue!==null&&(s.flags|=4),Et(s),null);case 4:return Nn(),ud(t,s),t===null&&jl(s.stateNode.containerInfo),Et(s),null;case 10:return sc(s.type._context),Et(s),null;case 17:return Ut(s.type)&&Ur(),Et(s),null;case 19:if(Ze(tt),r=s.memoizedState,r===null)return Et(s),null;if(n=(s.flags&128)!==0,o=r.rendering,o===null)if(n)Hn(r,!1);else{if(ft!==0||t!==null&&t.flags&128)for(t=s.child;t!==null;){if(o=Yr(t),o!==null){for(s.flags|=128,Hn(r,!1),n=o.updateQueue,n!==null&&(s.updateQueue=n,s.flags|=4),s.subtreeFlags=0,n=a,a=s.child;a!==null;)r=a,t=n,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,t=o.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),a=a.sibling;return Ke(tt,tt.current&1|2),s.child}t=t.sibling}r.tail!==null&&dt()>wn&&(s.flags|=128,n=!0,Hn(r,!1),s.lanes=4194304)}else{if(!n)if(t=Yr(o),t!==null){if(s.flags|=128,n=!0,a=t.updateQueue,a!==null&&(s.updateQueue=a,s.flags|=4),Hn(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!et)return Et(s),null}else 2*dt()-r.renderingStartTime>wn&&a!==1073741824&&(s.flags|=128,n=!0,Hn(r,!1),s.lanes=4194304);r.isBackwards?(o.sibling=s.child,s.child=o):(a=r.last,a!==null?a.sibling=o:s.child=o,r.last=o)}return r.tail!==null?(s=r.tail,r.rendering=s,r.tail=s.sibling,r.renderingStartTime=dt(),s.sibling=null,a=tt.current,Ke(tt,n?a&1|2:a&1),s):(Et(s),null);case 22:case 23:return vc(),n=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(s.flags|=8192),n&&s.mode&1?Wt&1073741824&&(Et(s),s.subtreeFlags&6&&(s.flags|=8192)):Et(s),null;case 24:return null;case 25:return null}throw Error(oe(156,s.tag))}function tg(t,s){switch(Xd(s),s.tag){case 1:return Ut(s.type)&&Ur(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return Nn(),Ze(Ft),Ze(Lt),ic(),t=s.flags,t&65536&&!(t&128)?(s.flags=t&-65537|128,s):null;case 5:return rc(s),null;case 13:if(Ze(tt),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(oe(340));bn()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return Ze(tt),null;case 4:return Nn(),null;case 10:return sc(s.type._context),null;case 22:case 23:return vc(),null;case 24:return null;default:return null}}var tr=!1,Ct=!1,sg=typeof WeakSet=="function"?WeakSet:Set,ke=null;function on(t,s){var a=t.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(n){ot(t,s,n)}else a.current=null}function xd(t,s,a){try{a()}catch(n){ot(t,s,n)}}var Hm=!1;function ag(t,s){if(Jo=Or,t=n0(),Jd(t)){if("selectionStart"in t)var a={start:t.selectionStart,end:t.selectionEnd};else e:{a=(a=t.ownerDocument)&&a.defaultView||window;var n=a.getSelection&&a.getSelection();if(n&&n.rangeCount!==0){a=n.anchorNode;var l=n.anchorOffset,r=n.focusNode;n=n.focusOffset;try{a.nodeType,r.nodeType}catch{a=null;break e}var o=0,d=-1,c=-1,m=0,g=0,x=t,j=null;t:for(;;){for(var h;x!==a||l!==0&&x.nodeType!==3||(d=o+l),x!==r||n!==0&&x.nodeType!==3||(c=o+n),x.nodeType===3&&(o+=x.nodeValue.length),(h=x.firstChild)!==null;)j=x,x=h;for(;;){if(x===t)break t;if(j===a&&++m===l&&(d=o),j===r&&++g===n&&(c=o),(h=x.nextSibling)!==null)break;x=j,j=x.parentNode}x=h}a=d===-1||c===-1?null:{start:d,end:c}}else a=null}a=a||{start:0,end:0}}else a=null;for(Ko={focusedElem:t,selectionRange:a},Or=!1,ke=s;ke!==null;)if(s=ke,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,ke=t;else for(;ke!==null;){s=ke;try{var f=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var u=f.memoizedProps,b=f.memoizedState,p=s.stateNode,y=p.getSnapshotBeforeUpdate(s.elementType===s.type?u:is(s.type,u),b);p.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=s.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(S){ot(s,s.return,S)}if(t=s.sibling,t!==null){t.return=s.return,ke=t;break}ke=s.return}return f=Hm,Hm=!1,f}function ol(t,s,a){var n=s.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var l=n=n.next;do{if((l.tag&t)===t){var r=l.destroy;l.destroy=void 0,r!==void 0&&xd(s,a,r)}l=l.next}while(l!==n)}}function pi(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&t)===t){var n=a.create;a.destroy=n()}a=a.next}while(a!==s)}}function hd(t){var s=t.ref;if(s!==null){var a=t.stateNode;switch(t.tag){case 5:t=a;break;default:t=a}typeof s=="function"?s(t):s.current=t}}function eh(t){var s=t.alternate;s!==null&&(t.alternate=null,eh(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[js],delete s[yl],delete s[ed],delete s[Ff],delete s[Uf])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function th(t){return t.tag===5||t.tag===3||t.tag===4}function qm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||th(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function pd(t,s,a){var n=t.tag;if(n===5||n===6)t=t.stateNode,s?a.nodeType===8?a.parentNode.insertBefore(t,s):a.insertBefore(t,s):(a.nodeType===8?(s=a.parentNode,s.insertBefore(t,a)):(s=a,s.appendChild(t)),a=a._reactRootContainer,a!=null||s.onclick!==null||(s.onclick=Fr));else if(n!==4&&(t=t.child,t!==null))for(pd(t,s,a),t=t.sibling;t!==null;)pd(t,s,a),t=t.sibling}function fd(t,s,a){var n=t.tag;if(n===5||n===6)t=t.stateNode,s?a.insertBefore(t,s):a.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(fd(t,s,a),t=t.sibling;t!==null;)fd(t,s,a),t=t.sibling}var Nt=null,os=!1;function zs(t,s,a){for(a=a.child;a!==null;)sh(t,s,a),a=a.sibling}function sh(t,s,a){if(ys&&typeof ys.onCommitFiberUnmount=="function")try{ys.onCommitFiberUnmount(ii,a)}catch{}switch(a.tag){case 5:Ct||on(a,s);case 6:var n=Nt,l=os;Nt=null,zs(t,s,a),Nt=n,os=l,Nt!==null&&(os?(t=Nt,a=a.stateNode,t.nodeType===8?t.parentNode.removeChild(a):t.removeChild(a)):Nt.removeChild(a.stateNode));break;case 18:Nt!==null&&(os?(t=Nt,a=a.stateNode,t.nodeType===8?Hi(t.parentNode,a):t.nodeType===1&&Hi(t,a),gl(t)):Hi(Nt,a.stateNode));break;case 4:n=Nt,l=os,Nt=a.stateNode.containerInfo,os=!0,zs(t,s,a),Nt=n,os=l;break;case 0:case 11:case 14:case 15:if(!Ct&&(n=a.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){l=n=n.next;do{var r=l,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&xd(a,s,o),l=l.next}while(l!==n)}zs(t,s,a);break;case 1:if(!Ct&&(on(a,s),n=a.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=a.memoizedProps,n.state=a.memoizedState,n.componentWillUnmount()}catch(d){ot(a,s,d)}zs(t,s,a);break;case 21:zs(t,s,a);break;case 22:a.mode&1?(Ct=(n=Ct)||a.memoizedState!==null,zs(t,s,a),Ct=n):zs(t,s,a);break;default:zs(t,s,a)}}function Ym(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var a=t.stateNode;a===null&&(a=t.stateNode=new sg),s.forEach(function(n){var l=ug.bind(null,t,n);a.has(n)||(a.add(n),n.then(l,l))})}}function ls(t,s){var a=s.deletions;if(a!==null)for(var n=0;n<a.length;n++){var l=a[n];try{var r=t,o=s,d=o;e:for(;d!==null;){switch(d.tag){case 5:Nt=d.stateNode,os=!1;break e;case 3:Nt=d.stateNode.containerInfo,os=!0;break e;case 4:Nt=d.stateNode.containerInfo,os=!0;break e}d=d.return}if(Nt===null)throw Error(oe(160));sh(r,o,l),Nt=null,os=!1;var c=l.alternate;c!==null&&(c.return=null),l.return=null}catch(m){ot(l,s,m)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)ah(s,t),s=s.sibling}function ah(t,s){var a=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ls(s,t),gs(t),n&4){try{ol(3,t,t.return),pi(3,t)}catch(u){ot(t,t.return,u)}try{ol(5,t,t.return)}catch(u){ot(t,t.return,u)}}break;case 1:ls(s,t),gs(t),n&512&&a!==null&&on(a,a.return);break;case 5:if(ls(s,t),gs(t),n&512&&a!==null&&on(a,a.return),t.flags&32){var l=t.stateNode;try{xl(l,"")}catch(u){ot(t,t.return,u)}}if(n&4&&(l=t.stateNode,l!=null)){var r=t.memoizedProps,o=a!==null?a.memoizedProps:r,d=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{d==="input"&&r.type==="radio"&&r.name!=null&&kx(l,r),Uo(d,o);var m=Uo(d,r);for(o=0;o<c.length;o+=2){var g=c[o],x=c[o+1];g==="style"?Dx(l,x):g==="dangerouslySetInnerHTML"?Ax(l,x):g==="children"?xl(l,x):_d(l,g,x,m)}switch(d){case"input":Io(l,r);break;case"textarea":Ex(l,r);break;case"select":var j=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!r.multiple;var h=r.value;h!=null?mn(l,!!r.multiple,h,!1):j!==!!r.multiple&&(r.defaultValue!=null?mn(l,!!r.multiple,r.defaultValue,!0):mn(l,!!r.multiple,r.multiple?[]:"",!1))}l[yl]=r}catch(u){ot(t,t.return,u)}}break;case 6:if(ls(s,t),gs(t),n&4){if(t.stateNode===null)throw Error(oe(162));l=t.stateNode,r=t.memoizedProps;try{l.nodeValue=r}catch(u){ot(t,t.return,u)}}break;case 3:if(ls(s,t),gs(t),n&4&&a!==null&&a.memoizedState.isDehydrated)try{gl(s.containerInfo)}catch(u){ot(t,t.return,u)}break;case 4:ls(s,t),gs(t);break;case 13:ls(s,t),gs(t),l=t.child,l.flags&8192&&(r=l.memoizedState!==null,l.stateNode.isHidden=r,!r||l.alternate!==null&&l.alternate.memoizedState!==null||(fc=dt())),n&4&&Ym(t);break;case 22:if(g=a!==null&&a.memoizedState!==null,t.mode&1?(Ct=(m=Ct)||g,ls(s,t),Ct=m):ls(s,t),gs(t),n&8192){if(m=t.memoizedState!==null,(t.stateNode.isHidden=m)&&!g&&t.mode&1)for(ke=t,g=t.child;g!==null;){for(x=ke=g;ke!==null;){switch(j=ke,h=j.child,j.tag){case 0:case 11:case 14:case 15:ol(4,j,j.return);break;case 1:on(j,j.return);var f=j.stateNode;if(typeof f.componentWillUnmount=="function"){n=j,a=j.return;try{s=n,f.props=s.memoizedProps,f.state=s.memoizedState,f.componentWillUnmount()}catch(u){ot(n,a,u)}}break;case 5:on(j,j.return);break;case 22:if(j.memoizedState!==null){Qm(x);continue}}h!==null?(h.return=j,ke=h):Qm(x)}g=g.sibling}e:for(g=null,x=t;;){if(x.tag===5){if(g===null){g=x;try{l=x.stateNode,m?(r=l.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(d=x.stateNode,c=x.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,d.style.display=Lx("display",o))}catch(u){ot(t,t.return,u)}}}else if(x.tag===6){if(g===null)try{x.stateNode.nodeValue=m?"":x.memoizedProps}catch(u){ot(t,t.return,u)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===t)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===t)break e;for(;x.sibling===null;){if(x.return===null||x.return===t)break e;g===x&&(g=null),x=x.return}g===x&&(g=null),x.sibling.return=x.return,x=x.sibling}}break;case 19:ls(s,t),gs(t),n&4&&Ym(t);break;case 21:break;default:ls(s,t),gs(t)}}function gs(t){var s=t.flags;if(s&2){try{e:{for(var a=t.return;a!==null;){if(th(a)){var n=a;break e}a=a.return}throw Error(oe(160))}switch(n.tag){case 5:var l=n.stateNode;n.flags&32&&(xl(l,""),n.flags&=-33);var r=qm(t);fd(t,r,l);break;case 3:case 4:var o=n.stateNode.containerInfo,d=qm(t);pd(t,d,o);break;default:throw Error(oe(161))}}catch(c){ot(t,t.return,c)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function ng(t,s,a){ke=t,nh(t)}function nh(t,s,a){for(var n=(t.mode&1)!==0;ke!==null;){var l=ke,r=l.child;if(l.tag===22&&n){var o=l.memoizedState!==null||tr;if(!o){var d=l.alternate,c=d!==null&&d.memoizedState!==null||Ct;d=tr;var m=Ct;if(tr=o,(Ct=c)&&!m)for(ke=l;ke!==null;)o=ke,c=o.child,o.tag===22&&o.memoizedState!==null?Jm(l):c!==null?(c.return=o,ke=c):Jm(l);for(;r!==null;)ke=r,nh(r),r=r.sibling;ke=l,tr=d,Ct=m}Gm(t)}else l.subtreeFlags&8772&&r!==null?(r.return=l,ke=r):Gm(t)}}function Gm(t){for(;ke!==null;){var s=ke;if(s.flags&8772){var a=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:Ct||pi(5,s);break;case 1:var n=s.stateNode;if(s.flags&4&&!Ct)if(a===null)n.componentDidMount();else{var l=s.elementType===s.type?a.memoizedProps:is(s.type,a.memoizedProps);n.componentDidUpdate(l,a.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var r=s.updateQueue;r!==null&&Rm(s,r,n);break;case 3:var o=s.updateQueue;if(o!==null){if(a=null,s.child!==null)switch(s.child.tag){case 5:a=s.child.stateNode;break;case 1:a=s.child.stateNode}Rm(s,o,a)}break;case 5:var d=s.stateNode;if(a===null&&s.flags&4){a=d;var c=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&a.focus();break;case"img":c.src&&(a.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var m=s.alternate;if(m!==null){var g=m.memoizedState;if(g!==null){var x=g.dehydrated;x!==null&&gl(x)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}Ct||s.flags&512&&hd(s)}catch(j){ot(s,s.return,j)}}if(s===t){ke=null;break}if(a=s.sibling,a!==null){a.return=s.return,ke=a;break}ke=s.return}}function Qm(t){for(;ke!==null;){var s=ke;if(s===t){ke=null;break}var a=s.sibling;if(a!==null){a.return=s.return,ke=a;break}ke=s.return}}function Jm(t){for(;ke!==null;){var s=ke;try{switch(s.tag){case 0:case 11:case 15:var a=s.return;try{pi(4,s)}catch(c){ot(s,a,c)}break;case 1:var n=s.stateNode;if(typeof n.componentDidMount=="function"){var l=s.return;try{n.componentDidMount()}catch(c){ot(s,l,c)}}var r=s.return;try{hd(s)}catch(c){ot(s,r,c)}break;case 5:var o=s.return;try{hd(s)}catch(c){ot(s,o,c)}}}catch(c){ot(s,s.return,c)}if(s===t){ke=null;break}var d=s.sibling;if(d!==null){d.return=s.return,ke=d;break}ke=s.return}}var lg=Math.ceil,Jr=Bs.ReactCurrentDispatcher,hc=Bs.ReactCurrentOwner,ss=Bs.ReactCurrentBatchConfig,He=0,bt=null,ut=null,yt=0,Wt=0,dn=ua(0),ft=0,Al=null,Ma=0,fi=0,pc=0,dl=null,_t=null,fc=0,wn=1/0,Ls=null,Kr=!1,gd=null,na=null,sr=!1,Ks=null,Xr=0,cl=0,vd=null,Cr=-1,Ar=0;function Tt(){return He&6?dt():Cr!==-1?Cr:Cr=dt()}function la(t){return t.mode&1?He&2&&yt!==0?yt&-yt:Vf.transition!==null?(Ar===0&&(Ar=Vx()),Ar):(t=Ge,t!==0||(t=window.event,t=t===void 0?16:Qx(t.type)),t):1}function ms(t,s,a,n){if(50<cl)throw cl=0,vd=null,Error(oe(185));Tl(t,a,n),(!(He&2)||t!==bt)&&(t===bt&&(!(He&2)&&(fi|=a),ft===4&&Qs(t,yt)),$t(t,n),a===1&&He===0&&!(s.mode&1)&&(wn=dt()+500,ui&&xa()))}function $t(t,s){var a=t.callbackNode;$p(t,s);var n=Ir(t,t===bt?yt:0);if(n===0)a!==null&&lm(a),t.callbackNode=null,t.callbackPriority=0;else if(s=n&-n,t.callbackPriority!==s){if(a!=null&&lm(a),s===1)t.tag===0?$f(Km.bind(null,t)):h0(Km.bind(null,t)),_f(function(){!(He&6)&&xa()}),a=null;else{switch(zx(n)){case 1:a=Vd;break;case 4:a=Ux;break;case 16:a=Pr;break;case 536870912:a=$x;break;default:a=Pr}a=uh(a,lh.bind(null,t))}t.callbackPriority=s,t.callbackNode=a}}function lh(t,s){if(Cr=-1,Ar=0,He&6)throw Error(oe(327));var a=t.callbackNode;if(fn()&&t.callbackNode!==a)return null;var n=Ir(t,t===bt?yt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||s)s=Zr(t,n);else{s=n;var l=He;He|=2;var r=ih();(bt!==t||yt!==s)&&(Ls=null,wn=dt()+500,ka(t,s));do try{og();break}catch(d){rh(t,d)}while(!0);tc(),Jr.current=r,He=l,ut!==null?s=0:(bt=null,yt=0,s=ft)}if(s!==0){if(s===2&&(l=Ho(t),l!==0&&(n=l,s=bd(t,l))),s===1)throw a=Al,ka(t,0),Qs(t,n),$t(t,dt()),a;if(s===6)Qs(t,n);else{if(l=t.current.alternate,!(n&30)&&!rg(l)&&(s=Zr(t,n),s===2&&(r=Ho(t),r!==0&&(n=r,s=bd(t,r))),s===1))throw a=Al,ka(t,0),Qs(t,n),$t(t,dt()),a;switch(t.finishedWork=l,t.finishedLanes=n,s){case 0:case 1:throw Error(oe(345));case 2:Na(t,_t,Ls);break;case 3:if(Qs(t,n),(n&130023424)===n&&(s=fc+500-dt(),10<s)){if(Ir(t,0)!==0)break;if(l=t.suspendedLanes,(l&n)!==n){Tt(),t.pingedLanes|=t.suspendedLanes&l;break}t.timeoutHandle=Zo(Na.bind(null,t,_t,Ls),s);break}Na(t,_t,Ls);break;case 4:if(Qs(t,n),(n&4194240)===n)break;for(s=t.eventTimes,l=-1;0<n;){var o=31-cs(n);r=1<<o,o=s[o],o>l&&(l=o),n&=~r}if(n=l,n=dt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*lg(n/1960))-n,10<n){t.timeoutHandle=Zo(Na.bind(null,t,_t,Ls),n);break}Na(t,_t,Ls);break;case 5:Na(t,_t,Ls);break;default:throw Error(oe(329))}}}return $t(t,dt()),t.callbackNode===a?lh.bind(null,t):null}function bd(t,s){var a=dl;return t.current.memoizedState.isDehydrated&&(ka(t,s).flags|=256),t=Zr(t,s),t!==2&&(s=_t,_t=a,s!==null&&jd(s)),t}function jd(t){_t===null?_t=t:_t.push.apply(_t,t)}function rg(t){for(var s=t;;){if(s.flags&16384){var a=s.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var n=0;n<a.length;n++){var l=a[n],r=l.getSnapshot;l=l.value;try{if(!us(r(),l))return!1}catch{return!1}}}if(a=s.child,s.subtreeFlags&16384&&a!==null)a.return=s,s=a;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Qs(t,s){for(s&=~pc,s&=~fi,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var a=31-cs(s),n=1<<a;t[a]=-1,s&=~n}}function Km(t){if(He&6)throw Error(oe(327));fn();var s=Ir(t,0);if(!(s&1))return $t(t,dt()),null;var a=Zr(t,s);if(t.tag!==0&&a===2){var n=Ho(t);n!==0&&(s=n,a=bd(t,n))}if(a===1)throw a=Al,ka(t,0),Qs(t,s),$t(t,dt()),a;if(a===6)throw Error(oe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,Na(t,_t,Ls),$t(t,dt()),null}function gc(t,s){var a=He;He|=1;try{return t(s)}finally{He=a,He===0&&(wn=dt()+500,ui&&xa())}}function Ra(t){Ks!==null&&Ks.tag===0&&!(He&6)&&fn();var s=He;He|=1;var a=ss.transition,n=Ge;try{if(ss.transition=null,Ge=1,t)return t()}finally{Ge=n,ss.transition=a,He=s,!(He&6)&&xa()}}function vc(){Wt=dn.current,Ze(dn)}function ka(t,s){t.finishedWork=null,t.finishedLanes=0;var a=t.timeoutHandle;if(a!==-1&&(t.timeoutHandle=-1,Of(a)),ut!==null)for(a=ut.return;a!==null;){var n=a;switch(Xd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ur();break;case 3:Nn(),Ze(Ft),Ze(Lt),ic();break;case 5:rc(n);break;case 4:Nn();break;case 13:Ze(tt);break;case 19:Ze(tt);break;case 10:sc(n.type._context);break;case 22:case 23:vc()}a=a.return}if(bt=t,ut=t=ra(t.current,null),yt=Wt=s,ft=0,Al=null,pc=fi=Ma=0,_t=dl=null,wa!==null){for(s=0;s<wa.length;s++)if(a=wa[s],n=a.interleaved,n!==null){a.interleaved=null;var l=n.next,r=a.pending;if(r!==null){var o=r.next;r.next=l,n.next=o}a.pending=n}wa=null}return t}function rh(t,s){do{var a=ut;try{if(tc(),Sr.current=Qr,Gr){for(var n=at.memoizedState;n!==null;){var l=n.queue;l!==null&&(l.pending=null),n=n.next}Gr=!1}if(Da=0,gt=pt=at=null,il=!1,kl=0,hc.current=null,a===null||a.return===null){ft=1,Al=s,ut=null;break}e:{var r=t,o=a.return,d=a,c=s;if(s=yt,d.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var m=c,g=d,x=g.tag;if(!(g.mode&1)&&(x===0||x===11||x===15)){var j=g.alternate;j?(g.updateQueue=j.updateQueue,g.memoizedState=j.memoizedState,g.lanes=j.lanes):(g.updateQueue=null,g.memoizedState=null)}var h=Bm(o);if(h!==null){h.flags&=-257,Fm(h,o,d,r,s),h.mode&1&&_m(r,m,s),s=h,c=m;var f=s.updateQueue;if(f===null){var u=new Set;u.add(c),s.updateQueue=u}else f.add(c);break e}else{if(!(s&1)){_m(r,m,s),bc();break e}c=Error(oe(426))}}else if(et&&d.mode&1){var b=Bm(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Fm(b,o,d,r,s),Zd(yn(c,d));break e}}r=c=yn(c,d),ft!==4&&(ft=2),dl===null?dl=[r]:dl.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,s&=-s,r.lanes|=s;var p=z0(r,c,s);Mm(r,p);break e;case 1:d=c;var y=r.type,w=r.stateNode;if(!(r.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(na===null||!na.has(w)))){r.flags|=65536,s&=-s,r.lanes|=s;var S=W0(r,d,s);Mm(r,S);break e}}r=r.return}while(r!==null)}dh(a)}catch(N){s=N,ut===a&&a!==null&&(ut=a=a.return);continue}break}while(!0)}function ih(){var t=Jr.current;return Jr.current=Qr,t===null?Qr:t}function bc(){(ft===0||ft===3||ft===2)&&(ft=4),bt===null||!(Ma&268435455)&&!(fi&268435455)||Qs(bt,yt)}function Zr(t,s){var a=He;He|=2;var n=ih();(bt!==t||yt!==s)&&(Ls=null,ka(t,s));do try{ig();break}catch(l){rh(t,l)}while(!0);if(tc(),He=a,Jr.current=n,ut!==null)throw Error(oe(261));return bt=null,yt=0,ft}function ig(){for(;ut!==null;)oh(ut)}function og(){for(;ut!==null&&!Rp();)oh(ut)}function oh(t){var s=mh(t.alternate,t,Wt);t.memoizedProps=t.pendingProps,s===null?dh(t):ut=s,hc.current=null}function dh(t){var s=t;do{var a=s.alternate;if(t=s.return,s.flags&32768){if(a=tg(a,s),a!==null){a.flags&=32767,ut=a;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ft=6,ut=null;return}}else if(a=eg(a,s,Wt),a!==null){ut=a;return}if(s=s.sibling,s!==null){ut=s;return}ut=s=t}while(s!==null);ft===0&&(ft=5)}function Na(t,s,a){var n=Ge,l=ss.transition;try{ss.transition=null,Ge=1,dg(t,s,a,n)}finally{ss.transition=l,Ge=n}return null}function dg(t,s,a,n){do fn();while(Ks!==null);if(He&6)throw Error(oe(327));a=t.finishedWork;var l=t.finishedLanes;if(a===null)return null;if(t.finishedWork=null,t.finishedLanes=0,a===t.current)throw Error(oe(177));t.callbackNode=null,t.callbackPriority=0;var r=a.lanes|a.childLanes;if(Vp(t,r),t===bt&&(ut=bt=null,yt=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||sr||(sr=!0,uh(Pr,function(){return fn(),null})),r=(a.flags&15990)!==0,a.subtreeFlags&15990||r){r=ss.transition,ss.transition=null;var o=Ge;Ge=1;var d=He;He|=4,hc.current=null,ag(t,a),ah(a,t),Lf(Ko),Or=!!Jo,Ko=Jo=null,t.current=a,ng(a),Tp(),He=d,Ge=o,ss.transition=r}else t.current=a;if(sr&&(sr=!1,Ks=t,Xr=l),r=t.pendingLanes,r===0&&(na=null),Op(a.stateNode),$t(t,dt()),s!==null)for(n=t.onRecoverableError,a=0;a<s.length;a++)l=s[a],n(l.value,{componentStack:l.stack,digest:l.digest});if(Kr)throw Kr=!1,t=gd,gd=null,t;return Xr&1&&t.tag!==0&&fn(),r=t.pendingLanes,r&1?t===vd?cl++:(cl=0,vd=t):cl=0,xa(),null}function fn(){if(Ks!==null){var t=zx(Xr),s=ss.transition,a=Ge;try{if(ss.transition=null,Ge=16>t?16:t,Ks===null)var n=!1;else{if(t=Ks,Ks=null,Xr=0,He&6)throw Error(oe(331));var l=He;for(He|=4,ke=t.current;ke!==null;){var r=ke,o=r.child;if(ke.flags&16){var d=r.deletions;if(d!==null){for(var c=0;c<d.length;c++){var m=d[c];for(ke=m;ke!==null;){var g=ke;switch(g.tag){case 0:case 11:case 15:ol(8,g,r)}var x=g.child;if(x!==null)x.return=g,ke=x;else for(;ke!==null;){g=ke;var j=g.sibling,h=g.return;if(eh(g),g===m){ke=null;break}if(j!==null){j.return=h,ke=j;break}ke=h}}}var f=r.alternate;if(f!==null){var u=f.child;if(u!==null){f.child=null;do{var b=u.sibling;u.sibling=null,u=b}while(u!==null)}}ke=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,ke=o;else e:for(;ke!==null;){if(r=ke,r.flags&2048)switch(r.tag){case 0:case 11:case 15:ol(9,r,r.return)}var p=r.sibling;if(p!==null){p.return=r.return,ke=p;break e}ke=r.return}}var y=t.current;for(ke=y;ke!==null;){o=ke;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ke=w;else e:for(o=y;ke!==null;){if(d=ke,d.flags&2048)try{switch(d.tag){case 0:case 11:case 15:pi(9,d)}}catch(N){ot(d,d.return,N)}if(d===o){ke=null;break e}var S=d.sibling;if(S!==null){S.return=d.return,ke=S;break e}ke=d.return}}if(He=l,xa(),ys&&typeof ys.onPostCommitFiberRoot=="function")try{ys.onPostCommitFiberRoot(ii,t)}catch{}n=!0}return n}finally{Ge=a,ss.transition=s}}return!1}function Xm(t,s,a){s=yn(a,s),s=z0(t,s,1),t=aa(t,s,1),s=Tt(),t!==null&&(Tl(t,1,s),$t(t,s))}function ot(t,s,a){if(t.tag===3)Xm(t,t,a);else for(;s!==null;){if(s.tag===3){Xm(s,t,a);break}else if(s.tag===1){var n=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(na===null||!na.has(n))){t=yn(a,t),t=W0(s,t,1),s=aa(s,t,1),t=Tt(),s!==null&&(Tl(s,1,t),$t(s,t));break}}s=s.return}}function cg(t,s,a){var n=t.pingCache;n!==null&&n.delete(s),s=Tt(),t.pingedLanes|=t.suspendedLanes&a,bt===t&&(yt&a)===a&&(ft===4||ft===3&&(yt&130023424)===yt&&500>dt()-fc?ka(t,0):pc|=a),$t(t,s)}function ch(t,s){s===0&&(t.mode&1?(s=ql,ql<<=1,!(ql&130023424)&&(ql=4194304)):s=1);var a=Tt();t=Os(t,s),t!==null&&(Tl(t,s,a),$t(t,a))}function mg(t){var s=t.memoizedState,a=0;s!==null&&(a=s.retryLane),ch(t,a)}function ug(t,s){var a=0;switch(t.tag){case 13:var n=t.stateNode,l=t.memoizedState;l!==null&&(a=l.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(oe(314))}n!==null&&n.delete(s),ch(t,a)}var mh;mh=function(t,s,a){if(t!==null)if(t.memoizedProps!==s.pendingProps||Ft.current)Bt=!0;else{if(!(t.lanes&a)&&!(s.flags&128))return Bt=!1,Zf(t,s,a);Bt=!!(t.flags&131072)}else Bt=!1,et&&s.flags&1048576&&p0(s,zr,s.index);switch(s.lanes=0,s.tag){case 2:var n=s.type;Er(t,s),t=s.pendingProps;var l=vn(s,Lt.current);pn(s,a),l=dc(null,s,n,t,l,a);var r=cc();return s.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Ut(n)?(r=!0,$r(s)):r=!1,s.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,nc(s),l.updater=hi,s.stateNode=l,l._reactInternals=s,rd(s,n,t,a),s=dd(null,s,n,!0,r,a)):(s.tag=0,et&&r&&Kd(s),Rt(null,s,l,a),s=s.child),s;case 16:n=s.elementType;e:{switch(Er(t,s),t=s.pendingProps,l=n._init,n=l(n._payload),s.type=n,l=s.tag=hg(n),t=is(n,t),l){case 0:s=od(null,s,n,t,a);break e;case 1:s=Vm(null,s,n,t,a);break e;case 11:s=Um(null,s,n,t,a);break e;case 14:s=$m(null,s,n,is(n.type,t),a);break e}throw Error(oe(306,n,""))}return s;case 0:return n=s.type,l=s.pendingProps,l=s.elementType===n?l:is(n,l),od(t,s,n,l,a);case 1:return n=s.type,l=s.pendingProps,l=s.elementType===n?l:is(n,l),Vm(t,s,n,l,a);case 3:e:{if(G0(s),t===null)throw Error(oe(387));n=s.pendingProps,r=s.memoizedState,l=r.element,N0(t,s),qr(s,n,null,a);var o=s.memoizedState;if(n=o.element,r.isDehydrated)if(r={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},s.updateQueue.baseState=r,s.memoizedState=r,s.flags&256){l=yn(Error(oe(423)),s),s=zm(t,s,n,a,l);break e}else if(n!==l){l=yn(Error(oe(424)),s),s=zm(t,s,n,a,l);break e}else for(Ht=sa(s.stateNode.containerInfo.firstChild),qt=s,et=!0,ds=null,a=b0(s,null,n,a),s.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(bn(),n===l){s=_s(t,s,a);break e}Rt(t,s,n,a)}s=s.child}return s;case 5:return y0(s),t===null&&ad(s),n=s.type,l=s.pendingProps,r=t!==null?t.memoizedProps:null,o=l.children,Xo(n,l)?o=null:r!==null&&Xo(n,r)&&(s.flags|=32),Y0(t,s),Rt(t,s,o,a),s.child;case 6:return t===null&&ad(s),null;case 13:return Q0(t,s,a);case 4:return lc(s,s.stateNode.containerInfo),n=s.pendingProps,t===null?s.child=jn(s,null,n,a):Rt(t,s,n,a),s.child;case 11:return n=s.type,l=s.pendingProps,l=s.elementType===n?l:is(n,l),Um(t,s,n,l,a);case 7:return Rt(t,s,s.pendingProps,a),s.child;case 8:return Rt(t,s,s.pendingProps.children,a),s.child;case 12:return Rt(t,s,s.pendingProps.children,a),s.child;case 10:e:{if(n=s.type._context,l=s.pendingProps,r=s.memoizedProps,o=l.value,Ke(Wr,n._currentValue),n._currentValue=o,r!==null)if(us(r.value,o)){if(r.children===l.children&&!Ft.current){s=_s(t,s,a);break e}}else for(r=s.child,r!==null&&(r.return=s);r!==null;){var d=r.dependencies;if(d!==null){o=r.child;for(var c=d.firstContext;c!==null;){if(c.context===n){if(r.tag===1){c=Ts(-1,a&-a),c.tag=2;var m=r.updateQueue;if(m!==null){m=m.shared;var g=m.pending;g===null?c.next=c:(c.next=g.next,g.next=c),m.pending=c}}r.lanes|=a,c=r.alternate,c!==null&&(c.lanes|=a),nd(r.return,a,s),d.lanes|=a;break}c=c.next}}else if(r.tag===10)o=r.type===s.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(oe(341));o.lanes|=a,d=o.alternate,d!==null&&(d.lanes|=a),nd(o,a,s),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===s){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}Rt(t,s,l.children,a),s=s.child}return s;case 9:return l=s.type,n=s.pendingProps.children,pn(s,a),l=as(l),n=n(l),s.flags|=1,Rt(t,s,n,a),s.child;case 14:return n=s.type,l=is(n,s.pendingProps),l=is(n.type,l),$m(t,s,n,l,a);case 15:return H0(t,s,s.type,s.pendingProps,a);case 17:return n=s.type,l=s.pendingProps,l=s.elementType===n?l:is(n,l),Er(t,s),s.tag=1,Ut(n)?(t=!0,$r(s)):t=!1,pn(s,a),V0(s,n,l),rd(s,n,l,a),dd(null,s,n,!0,t,a);case 19:return J0(t,s,a);case 22:return q0(t,s,a)}throw Error(oe(156,s.tag))};function uh(t,s){return Fx(t,s)}function xg(t,s,a,n){this.tag=t,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zt(t,s,a,n){return new xg(t,s,a,n)}function jc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function hg(t){if(typeof t=="function")return jc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Fd)return 11;if(t===Ud)return 14}return 2}function ra(t,s){var a=t.alternate;return a===null?(a=Zt(t.tag,s,t.key,t.mode),a.elementType=t.elementType,a.type=t.type,a.stateNode=t.stateNode,a.alternate=t,t.alternate=a):(a.pendingProps=s,a.type=t.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=t.flags&14680064,a.childLanes=t.childLanes,a.lanes=t.lanes,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,s=t.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},a.sibling=t.sibling,a.index=t.index,a.ref=t.ref,a}function Lr(t,s,a,n,l,r){var o=2;if(n=t,typeof t=="function")jc(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Xa:return Ea(a.children,l,r,s);case Bd:o=8,l|=8;break;case Do:return t=Zt(12,a,s,l|2),t.elementType=Do,t.lanes=r,t;case Mo:return t=Zt(13,a,s,l),t.elementType=Mo,t.lanes=r,t;case Ro:return t=Zt(19,a,s,l),t.elementType=Ro,t.lanes=r,t;case yx:return gi(a,l,r,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case jx:o=10;break e;case Nx:o=9;break e;case Fd:o=11;break e;case Ud:o=14;break e;case qs:o=16,n=null;break e}throw Error(oe(130,t==null?t:typeof t,""))}return s=Zt(o,a,s,l),s.elementType=t,s.type=n,s.lanes=r,s}function Ea(t,s,a,n){return t=Zt(7,t,n,s),t.lanes=a,t}function gi(t,s,a,n){return t=Zt(22,t,n,s),t.elementType=yx,t.lanes=a,t.stateNode={isHidden:!1},t}function Zi(t,s,a){return t=Zt(6,t,null,s),t.lanes=a,t}function eo(t,s,a){return s=Zt(4,t.children!==null?t.children:[],t.key,s),s.lanes=a,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function pg(t,s,a,n,l){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pi(0),this.expirationTimes=Pi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pi(0),this.identifierPrefix=n,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Nc(t,s,a,n,l,r,o,d,c){return t=new pg(t,s,a,d,c),s===1?(s=1,r===!0&&(s|=8)):s=0,r=Zt(3,null,null,s),t.current=r,r.stateNode=t,r.memoizedState={element:n,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},nc(r),t}function fg(t,s,a){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ka,key:n==null?null:""+n,children:t,containerInfo:s,implementation:a}}function xh(t){if(!t)return ca;t=t._reactInternals;e:{if(Pa(t)!==t||t.tag!==1)throw Error(oe(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Ut(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(oe(171))}if(t.tag===1){var a=t.type;if(Ut(a))return x0(t,a,s)}return s}function hh(t,s,a,n,l,r,o,d,c){return t=Nc(a,n,!0,t,l,r,o,d,c),t.context=xh(null),a=t.current,n=Tt(),l=la(a),r=Ts(n,l),r.callback=s??null,aa(a,r,l),t.current.lanes=l,Tl(t,l,n),$t(t,n),t}function vi(t,s,a,n){var l=s.current,r=Tt(),o=la(l);return a=xh(a),s.context===null?s.context=a:s.pendingContext=a,s=Ts(r,o),s.payload={element:t},n=n===void 0?null:n,n!==null&&(s.callback=n),t=aa(l,s,o),t!==null&&(ms(t,l,o,r),wr(t,l,o)),o}function ei(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Zm(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var a=t.retryLane;t.retryLane=a!==0&&a<s?a:s}}function yc(t,s){Zm(t,s),(t=t.alternate)&&Zm(t,s)}function gg(){return null}var ph=typeof reportError=="function"?reportError:function(t){console.error(t)};function wc(t){this._internalRoot=t}bi.prototype.render=wc.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(oe(409));vi(t,s,null,null)};bi.prototype.unmount=wc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;Ra(function(){vi(null,t,null,null)}),s[Is]=null}};function bi(t){this._internalRoot=t}bi.prototype.unstable_scheduleHydration=function(t){if(t){var s=qx();t={blockedOn:null,target:t,priority:s};for(var a=0;a<Gs.length&&s!==0&&s<Gs[a].priority;a++);Gs.splice(a,0,t),a===0&&Gx(t)}};function Sc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ji(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function eu(){}function vg(t,s,a,n,l){if(l){if(typeof n=="function"){var r=n;n=function(){var m=ei(o);r.call(m)}}var o=hh(s,n,t,0,null,!1,!1,"",eu);return t._reactRootContainer=o,t[Is]=o.current,jl(t.nodeType===8?t.parentNode:t),Ra(),o}for(;l=t.lastChild;)t.removeChild(l);if(typeof n=="function"){var d=n;n=function(){var m=ei(c);d.call(m)}}var c=Nc(t,0,!1,null,null,!1,!1,"",eu);return t._reactRootContainer=c,t[Is]=c.current,jl(t.nodeType===8?t.parentNode:t),Ra(function(){vi(s,c,a,n)}),c}function Ni(t,s,a,n,l){var r=a._reactRootContainer;if(r){var o=r;if(typeof l=="function"){var d=l;l=function(){var c=ei(o);d.call(c)}}vi(s,o,t,l)}else o=vg(a,s,t,l,n);return ei(o)}Wx=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var a=Zn(s.pendingLanes);a!==0&&(zd(s,a|1),$t(s,dt()),!(He&6)&&(wn=dt()+500,xa()))}break;case 13:Ra(function(){var n=Os(t,1);if(n!==null){var l=Tt();ms(n,t,1,l)}}),yc(t,1)}};Wd=function(t){if(t.tag===13){var s=Os(t,134217728);if(s!==null){var a=Tt();ms(s,t,134217728,a)}yc(t,134217728)}};Hx=function(t){if(t.tag===13){var s=la(t),a=Os(t,s);if(a!==null){var n=Tt();ms(a,t,s,n)}yc(t,s)}};qx=function(){return Ge};Yx=function(t,s){var a=Ge;try{return Ge=t,s()}finally{Ge=a}};Vo=function(t,s,a){switch(s){case"input":if(Io(t,a),s=a.name,a.type==="radio"&&s!=null){for(a=t;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<a.length;s++){var n=a[s];if(n!==t&&n.form===t.form){var l=mi(n);if(!l)throw Error(oe(90));Sx(n),Io(n,l)}}}break;case"textarea":Ex(t,a);break;case"select":s=a.value,s!=null&&mn(t,!!a.multiple,s,!1)}};Tx=gc;Px=Ra;var bg={usingClientEntryPoint:!1,Events:[Il,sn,mi,Mx,Rx,gc]},qn={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jg={bundleType:qn.bundleType,version:qn.version,rendererPackageName:qn.rendererPackageName,rendererConfig:qn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=_x(t),t===null?null:t.stateNode},findFiberByHostInstance:qn.findFiberByHostInstance||gg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ar=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ar.isDisabled&&ar.supportsFiber)try{ii=ar.inject(jg),ys=ar}catch{}}Gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bg;Gt.createPortal=function(t,s){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sc(s))throw Error(oe(200));return fg(t,s,null,a)};Gt.createRoot=function(t,s){if(!Sc(t))throw Error(oe(299));var a=!1,n="",l=ph;return s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(n=s.identifierPrefix),s.onRecoverableError!==void 0&&(l=s.onRecoverableError)),s=Nc(t,1,!1,null,null,a,!1,n,l),t[Is]=s.current,jl(t.nodeType===8?t.parentNode:t),new wc(s)};Gt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(oe(188)):(t=Object.keys(t).join(","),Error(oe(268,t)));return t=_x(s),t=t===null?null:t.stateNode,t};Gt.flushSync=function(t){return Ra(t)};Gt.hydrate=function(t,s,a){if(!ji(s))throw Error(oe(200));return Ni(null,t,s,!0,a)};Gt.hydrateRoot=function(t,s,a){if(!Sc(t))throw Error(oe(405));var n=a!=null&&a.hydratedSources||null,l=!1,r="",o=ph;if(a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(r=a.identifierPrefix),a.onRecoverableError!==void 0&&(o=a.onRecoverableError)),s=hh(s,null,t,1,a??null,l,!1,r,o),t[Is]=s.current,jl(t),n)for(t=0;t<n.length;t++)a=n[t],l=a._getVersion,l=l(a._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[a,l]:s.mutableSourceEagerHydrationData.push(a,l);return new bi(s)};Gt.render=function(t,s,a){if(!ji(s))throw Error(oe(200));return Ni(null,t,s,!1,a)};Gt.unmountComponentAtNode=function(t){if(!ji(t))throw Error(oe(40));return t._reactRootContainer?(Ra(function(){Ni(null,null,t,!1,function(){t._reactRootContainer=null,t[Is]=null})}),!0):!1};Gt.unstable_batchedUpdates=gc;Gt.unstable_renderSubtreeIntoContainer=function(t,s,a,n){if(!ji(a))throw Error(oe(200));if(t==null||t._reactInternals===void 0)throw Error(oe(38));return Ni(t,s,a,!1,n)};Gt.version="18.3.1-next-f1338f8080-20240426";function fh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fh)}catch(t){console.error(t)}}fh(),fx.exports=Gt;var Ng=fx.exports,tu=Ng;Ao.createRoot=tu.createRoot,Ao.hydrateRoot=tu.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ll(){return Ll=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},Ll.apply(this,arguments)}var Xs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Xs||(Xs={}));const su="popstate";function yg(t){t===void 0&&(t={});function s(n,l){let{pathname:r,search:o,hash:d}=n.location;return Nd("",{pathname:r,search:o,hash:d},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function a(n,l){return typeof l=="string"?l:ti(l)}return Sg(s,a,null,t)}function nt(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function kc(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function wg(){return Math.random().toString(36).substr(2,8)}function au(t,s){return{usr:t.state,key:t.key,idx:s}}function Nd(t,s,a,n){return a===void 0&&(a=null),Ll({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof s=="string"?Ln(s):s,{state:a,key:s&&s.key||n||wg()})}function ti(t){let{pathname:s="/",search:a="",hash:n=""}=t;return a&&a!=="?"&&(s+=a.charAt(0)==="?"?a:"?"+a),n&&n!=="#"&&(s+=n.charAt(0)==="#"?n:"#"+n),s}function Ln(t){let s={};if(t){let a=t.indexOf("#");a>=0&&(s.hash=t.substr(a),t=t.substr(0,a));let n=t.indexOf("?");n>=0&&(s.search=t.substr(n),t=t.substr(0,n)),t&&(s.pathname=t)}return s}function Sg(t,s,a,n){n===void 0&&(n={});let{window:l=document.defaultView,v5Compat:r=!1}=n,o=l.history,d=Xs.Pop,c=null,m=g();m==null&&(m=0,o.replaceState(Ll({},o.state,{idx:m}),""));function g(){return(o.state||{idx:null}).idx}function x(){d=Xs.Pop;let b=g(),p=b==null?null:b-m;m=b,c&&c({action:d,location:u.location,delta:p})}function j(b,p){d=Xs.Push;let y=Nd(u.location,b,p);m=g()+1;let w=au(y,m),S=u.createHref(y);try{o.pushState(w,"",S)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;l.location.assign(S)}r&&c&&c({action:d,location:u.location,delta:1})}function h(b,p){d=Xs.Replace;let y=Nd(u.location,b,p);m=g();let w=au(y,m),S=u.createHref(y);o.replaceState(w,"",S),r&&c&&c({action:d,location:u.location,delta:0})}function f(b){let p=l.location.origin!=="null"?l.location.origin:l.location.href,y=typeof b=="string"?b:ti(b);return y=y.replace(/ $/,"%20"),nt(p,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,p)}let u={get action(){return d},get location(){return t(l,o)},listen(b){if(c)throw new Error("A history only accepts one active listener");return l.addEventListener(su,x),c=b,()=>{l.removeEventListener(su,x),c=null}},createHref(b){return s(l,b)},createURL:f,encodeLocation(b){let p=f(b);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:j,replace:h,go(b){return o.go(b)}};return u}var nu;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(nu||(nu={}));function kg(t,s,a){return a===void 0&&(a="/"),Eg(t,s,a)}function Eg(t,s,a,n){let l=typeof s=="string"?Ln(s):s,r=Sn(l.pathname||"/",a);if(r==null)return null;let o=gh(t);Cg(o);let d=null;for(let c=0;d==null&&c<o.length;++c){let m=Bg(r);d=Og(o[c],m)}return d}function gh(t,s,a,n){s===void 0&&(s=[]),a===void 0&&(a=[]),n===void 0&&(n="");let l=(r,o,d)=>{let c={relativePath:d===void 0?r.path||"":d,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};c.relativePath.startsWith("/")&&(nt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let m=ia([n,c.relativePath]),g=a.concat(c);r.children&&r.children.length>0&&(nt(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),gh(r.children,s,g,m)),!(r.path==null&&!r.index)&&s.push({path:m,score:Pg(m,r.index),routesMeta:g})};return t.forEach((r,o)=>{var d;if(r.path===""||!((d=r.path)!=null&&d.includes("?")))l(r,o);else for(let c of vh(r.path))l(r,o,c)}),s}function vh(t){let s=t.split("/");if(s.length===0)return[];let[a,...n]=s,l=a.endsWith("?"),r=a.replace(/\?$/,"");if(n.length===0)return l?[r,""]:[r];let o=vh(n.join("/")),d=[];return d.push(...o.map(c=>c===""?r:[r,c].join("/"))),l&&d.push(...o),d.map(c=>t.startsWith("/")&&c===""?"/":c)}function Cg(t){t.sort((s,a)=>s.score!==a.score?a.score-s.score:Ig(s.routesMeta.map(n=>n.childrenIndex),a.routesMeta.map(n=>n.childrenIndex)))}const Ag=/^:[\w-]+$/,Lg=3,Dg=2,Mg=1,Rg=10,Tg=-2,lu=t=>t==="*";function Pg(t,s){let a=t.split("/"),n=a.length;return a.some(lu)&&(n+=Tg),s&&(n+=Dg),a.filter(l=>!lu(l)).reduce((l,r)=>l+(Ag.test(r)?Lg:r===""?Mg:Rg),n)}function Ig(t,s){return t.length===s.length&&t.slice(0,-1).every((n,l)=>n===s[l])?t[t.length-1]-s[s.length-1]:0}function Og(t,s,a){let{routesMeta:n}=t,l={},r="/",o=[];for(let d=0;d<n.length;++d){let c=n[d],m=d===n.length-1,g=r==="/"?s:s.slice(r.length)||"/",x=yd({path:c.relativePath,caseSensitive:c.caseSensitive,end:m},g),j=c.route;if(!x)return null;Object.assign(l,x.params),o.push({params:l,pathname:ia([r,x.pathname]),pathnameBase:zg(ia([r,x.pathnameBase])),route:j}),x.pathnameBase!=="/"&&(r=ia([r,x.pathnameBase]))}return o}function yd(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,n]=_g(t.path,t.caseSensitive,t.end),l=s.match(a);if(!l)return null;let r=l[0],o=r.replace(/(.)\/+$/,"$1"),d=l.slice(1);return{params:n.reduce((m,g,x)=>{let{paramName:j,isOptional:h}=g;if(j==="*"){let u=d[x]||"";o=r.slice(0,r.length-u.length).replace(/(.)\/+$/,"$1")}const f=d[x];return h&&!f?m[j]=void 0:m[j]=(f||"").replace(/%2F/g,"/"),m},{}),pathname:r,pathnameBase:o,pattern:t}}function _g(t,s,a){s===void 0&&(s=!1),a===void 0&&(a=!0),kc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],l="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,d,c)=>(n.push({paramName:d,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),l+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?l+="\\/*$":t!==""&&t!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,s?void 0:"i"),n]}function Bg(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return kc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),t}}function Sn(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let a=s.endsWith("/")?s.length-1:s.length,n=t.charAt(a);return n&&n!=="/"?null:t.slice(a)||"/"}const Fg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ug=t=>Fg.test(t);function $g(t,s){s===void 0&&(s="/");let{pathname:a,search:n="",hash:l=""}=typeof t=="string"?Ln(t):t,r;if(a)if(Ug(a))r=a;else{if(a.includes("//")){let o=a;a=a.replace(/\/\/+/g,"/"),kc(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+a))}a.startsWith("/")?r=ru(a.substring(1),"/"):r=ru(a,s)}else r=s;return{pathname:r,search:Wg(n),hash:Hg(l)}}function ru(t,s){let a=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(l=>{l===".."?a.length>1&&a.pop():l!=="."&&a.push(l)}),a.length>1?a.join("/"):"/"}function to(t,s,a,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Vg(t){return t.filter((s,a)=>a===0||s.route.path&&s.route.path.length>0)}function Ec(t,s){let a=Vg(t);return s?a.map((n,l)=>l===a.length-1?n.pathname:n.pathnameBase):a.map(n=>n.pathnameBase)}function Cc(t,s,a,n){n===void 0&&(n=!1);let l;typeof t=="string"?l=Ln(t):(l=Ll({},t),nt(!l.pathname||!l.pathname.includes("?"),to("?","pathname","search",l)),nt(!l.pathname||!l.pathname.includes("#"),to("#","pathname","hash",l)),nt(!l.search||!l.search.includes("#"),to("#","search","hash",l)));let r=t===""||l.pathname==="",o=r?"/":l.pathname,d;if(o==null)d=a;else{let x=s.length-1;if(!n&&o.startsWith("..")){let j=o.split("/");for(;j[0]==="..";)j.shift(),x-=1;l.pathname=j.join("/")}d=x>=0?s[x]:"/"}let c=$g(l,d),m=o&&o!=="/"&&o.endsWith("/"),g=(r||o===".")&&a.endsWith("/");return!c.pathname.endsWith("/")&&(m||g)&&(c.pathname+="/"),c}const ia=t=>t.join("/").replace(/\/\/+/g,"/"),zg=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Wg=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Hg=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function qg(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const bh=["post","put","patch","delete"];new Set(bh);const Yg=["get",...bh];new Set(Yg);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dl(){return Dl=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},Dl.apply(this,arguments)}const yi=i.createContext(null),jh=i.createContext(null),Fs=i.createContext(null),wi=i.createContext(null),ks=i.createContext({outlet:null,matches:[],isDataRoute:!1}),Nh=i.createContext(null);function Gg(t,s){let{relative:a}=s===void 0?{}:s;Dn()||nt(!1);let{basename:n,navigator:l}=i.useContext(Fs),{hash:r,pathname:o,search:d}=Si(t,{relative:a}),c=o;return n!=="/"&&(c=o==="/"?n:ia([n,o])),l.createHref({pathname:c,search:d,hash:r})}function Dn(){return i.useContext(wi)!=null}function ct(){return Dn()||nt(!1),i.useContext(wi).location}function yh(t){i.useContext(Fs).static||i.useLayoutEffect(t)}function Ue(){let{isDataRoute:t}=i.useContext(ks);return t?dv():Qg()}function Qg(){Dn()||nt(!1);let t=i.useContext(yi),{basename:s,future:a,navigator:n}=i.useContext(Fs),{matches:l}=i.useContext(ks),{pathname:r}=ct(),o=JSON.stringify(Ec(l,a.v7_relativeSplatPath)),d=i.useRef(!1);return yh(()=>{d.current=!0}),i.useCallback(function(m,g){if(g===void 0&&(g={}),!d.current)return;if(typeof m=="number"){n.go(m);return}let x=Cc(m,JSON.parse(o),r,g.relative==="path");t==null&&s!=="/"&&(x.pathname=x.pathname==="/"?s:ia([s,x.pathname])),(g.replace?n.replace:n.push)(x,g.state,g)},[s,n,o,r,t])}const Jg=i.createContext(null);function Kg(t){let s=i.useContext(ks).outlet;return s&&i.createElement(Jg.Provider,{value:t},s)}function Dt(){let{matches:t}=i.useContext(ks),s=t[t.length-1];return s?s.params:{}}function Si(t,s){let{relative:a}=s===void 0?{}:s,{future:n}=i.useContext(Fs),{matches:l}=i.useContext(ks),{pathname:r}=ct(),o=JSON.stringify(Ec(l,n.v7_relativeSplatPath));return i.useMemo(()=>Cc(t,JSON.parse(o),r,a==="path"),[t,o,r,a])}function Xg(t,s){return Zg(t,s)}function Zg(t,s,a,n){Dn()||nt(!1);let{navigator:l}=i.useContext(Fs),{matches:r}=i.useContext(ks),o=r[r.length-1],d=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let m=ct(),g;if(s){var x;let b=typeof s=="string"?Ln(s):s;c==="/"||(x=b.pathname)!=null&&x.startsWith(c)||nt(!1),g=b}else g=m;let j=g.pathname||"/",h=j;if(c!=="/"){let b=c.replace(/^\//,"").split("/");h="/"+j.replace(/^\//,"").split("/").slice(b.length).join("/")}let f=kg(t,{pathname:h}),u=nv(f&&f.map(b=>Object.assign({},b,{params:Object.assign({},d,b.params),pathname:ia([c,l.encodeLocation?l.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?c:ia([c,l.encodeLocation?l.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),r,a,n);return s&&u?i.createElement(wi.Provider,{value:{location:Dl({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Xs.Pop}},u):u}function ev(){let t=ov(),s=qg(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,l={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},s),a?i.createElement("pre",{style:l},a):null,null)}const tv=i.createElement(ev,null);class sv extends i.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,a){return a.location!==s.location||a.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:a.error,location:a.location,revalidation:s.revalidation||a.revalidation}}componentDidCatch(s,a){console.error("React Router caught the following error during render",s,a)}render(){return this.state.error!==void 0?i.createElement(ks.Provider,{value:this.props.routeContext},i.createElement(Nh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function av(t){let{routeContext:s,match:a,children:n}=t,l=i.useContext(yi);return l&&l.static&&l.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=a.route.id),i.createElement(ks.Provider,{value:s},n)}function nv(t,s,a,n){var l;if(s===void 0&&(s=[]),a===void 0&&(a=null),n===void 0&&(n=null),t==null){var r;if(!a)return null;if(a.errors)t=a.matches;else if((r=n)!=null&&r.v7_partialHydration&&s.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let o=t,d=(l=a)==null?void 0:l.errors;if(d!=null){let g=o.findIndex(x=>x.route.id&&(d==null?void 0:d[x.route.id])!==void 0);g>=0||nt(!1),o=o.slice(0,Math.min(o.length,g+1))}let c=!1,m=-1;if(a&&n&&n.v7_partialHydration)for(let g=0;g<o.length;g++){let x=o[g];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(m=g),x.route.id){let{loaderData:j,errors:h}=a,f=x.route.loader&&j[x.route.id]===void 0&&(!h||h[x.route.id]===void 0);if(x.route.lazy||f){c=!0,m>=0?o=o.slice(0,m+1):o=[o[0]];break}}}return o.reduceRight((g,x,j)=>{let h,f=!1,u=null,b=null;a&&(h=d&&x.route.id?d[x.route.id]:void 0,u=x.route.errorElement||tv,c&&(m<0&&j===0?(cv("route-fallback"),f=!0,b=null):m===j&&(f=!0,b=x.route.hydrateFallbackElement||null)));let p=s.concat(o.slice(0,j+1)),y=()=>{let w;return h?w=u:f?w=b:x.route.Component?w=i.createElement(x.route.Component,null):x.route.element?w=x.route.element:w=g,i.createElement(av,{match:x,routeContext:{outlet:g,matches:p,isDataRoute:a!=null},children:w})};return a&&(x.route.ErrorBoundary||x.route.errorElement||j===0)?i.createElement(sv,{location:a.location,revalidation:a.revalidation,component:u,error:h,children:y(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):y()},null)}var wh=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(wh||{}),Sh=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Sh||{});function lv(t){let s=i.useContext(yi);return s||nt(!1),s}function rv(t){let s=i.useContext(jh);return s||nt(!1),s}function iv(t){let s=i.useContext(ks);return s||nt(!1),s}function kh(t){let s=iv(),a=s.matches[s.matches.length-1];return a.route.id||nt(!1),a.route.id}function ov(){var t;let s=i.useContext(Nh),a=rv(),n=kh();return s!==void 0?s:(t=a.errors)==null?void 0:t[n]}function dv(){let{router:t}=lv(wh.UseNavigateStable),s=kh(Sh.UseNavigateStable),a=i.useRef(!1);return yh(()=>{a.current=!0}),i.useCallback(function(l,r){r===void 0&&(r={}),a.current&&(typeof l=="number"?t.navigate(l):t.navigate(l,Dl({fromRouteId:s},r)))},[t,s])}const iu={};function cv(t,s,a){iu[t]||(iu[t]=!0)}function mv(t,s){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function zt(t){let{to:s,replace:a,state:n,relative:l}=t;Dn()||nt(!1);let{future:r,static:o}=i.useContext(Fs),{matches:d}=i.useContext(ks),{pathname:c}=ct(),m=Ue(),g=Cc(s,Ec(d,r.v7_relativeSplatPath),c,l==="path"),x=JSON.stringify(g);return i.useEffect(()=>m(JSON.parse(x),{replace:a,state:n,relative:l}),[m,x,l,a,n]),null}function _l(t){return Kg(t.context)}function ee(t){nt(!1)}function uv(t){let{basename:s="/",children:a=null,location:n,navigationType:l=Xs.Pop,navigator:r,static:o=!1,future:d}=t;Dn()&&nt(!1);let c=s.replace(/^\/*/,"/"),m=i.useMemo(()=>({basename:c,navigator:r,static:o,future:Dl({v7_relativeSplatPath:!1},d)}),[c,d,r,o]);typeof n=="string"&&(n=Ln(n));let{pathname:g="/",search:x="",hash:j="",state:h=null,key:f="default"}=n,u=i.useMemo(()=>{let b=Sn(g,c);return b==null?null:{location:{pathname:b,search:x,hash:j,state:h,key:f},navigationType:l}},[c,g,x,j,h,f,l]);return u==null?null:i.createElement(Fs.Provider,{value:m},i.createElement(wi.Provider,{children:a,value:u}))}function xv(t){let{children:s,location:a}=t;return Xg(wd(s),a)}new Promise(()=>{});function wd(t,s){s===void 0&&(s=[]);let a=[];return i.Children.forEach(t,(n,l)=>{if(!i.isValidElement(n))return;let r=[...s,l];if(n.type===i.Fragment){a.push.apply(a,wd(n.props.children,r));return}n.type!==ee&&nt(!1),!n.props.index||!n.props.children||nt(!1);let o={id:n.props.id||r.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=wd(n.props.children,r)),a.push(o)}),a}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function si(){return si=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},si.apply(this,arguments)}function Eh(t,s){if(t==null)return{};var a={},n=Object.keys(t),l,r;for(r=0;r<n.length;r++)l=n[r],!(s.indexOf(l)>=0)&&(a[l]=t[l]);return a}function hv(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function pv(t,s){return t.button===0&&(!s||s==="_self")&&!hv(t)}function Sd(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((s,a)=>{let n=t[a];return s.concat(Array.isArray(n)?n.map(l=>[a,l]):[[a,n]])},[]))}function fv(t,s){let a=Sd(t);return s&&s.forEach((n,l)=>{a.has(l)||s.getAll(l).forEach(r=>{a.append(l,r)})}),a}const gv=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],vv=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],bv="6";try{window.__reactRouterVersion=bv}catch{}const jv=i.createContext({isTransitioning:!1}),Nv="startTransition",ou=dp[Nv];function yv(t){let{basename:s,children:a,future:n,window:l}=t,r=i.useRef();r.current==null&&(r.current=yg({window:l,v5Compat:!0}));let o=r.current,[d,c]=i.useState({action:o.action,location:o.location}),{v7_startTransition:m}=n||{},g=i.useCallback(x=>{m&&ou?ou(()=>c(x)):c(x)},[c,m]);return i.useLayoutEffect(()=>o.listen(g),[o,g]),i.useEffect(()=>mv(n),[n]),i.createElement(uv,{basename:s,children:a,location:d.location,navigationType:d.action,navigator:o,future:n})}const wv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Sv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$e=i.forwardRef(function(s,a){let{onClick:n,relative:l,reloadDocument:r,replace:o,state:d,target:c,to:m,preventScrollReset:g,viewTransition:x}=s,j=Eh(s,gv),{basename:h}=i.useContext(Fs),f,u=!1;if(typeof m=="string"&&Sv.test(m)&&(f=m,wv))try{let w=new URL(window.location.href),S=m.startsWith("//")?new URL(w.protocol+m):new URL(m),N=Sn(S.pathname,h);S.origin===w.origin&&N!=null?m=N+S.search+S.hash:u=!0}catch{}let b=Gg(m,{relative:l}),p=Ev(m,{replace:o,state:d,target:c,preventScrollReset:g,relative:l,viewTransition:x});function y(w){n&&n(w),w.defaultPrevented||p(w)}return i.createElement("a",si({},j,{href:f||b,onClick:u||r?n:y,ref:a,target:c}))}),es=i.forwardRef(function(s,a){let{"aria-current":n="page",caseSensitive:l=!1,className:r="",end:o=!1,style:d,to:c,viewTransition:m,children:g}=s,x=Eh(s,vv),j=Si(c,{relative:x.relative}),h=ct(),f=i.useContext(jh),{navigator:u,basename:b}=i.useContext(Fs),p=f!=null&&Av(j)&&m===!0,y=u.encodeLocation?u.encodeLocation(j).pathname:j.pathname,w=h.pathname,S=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;l||(w=w.toLowerCase(),S=S?S.toLowerCase():null,y=y.toLowerCase()),S&&b&&(S=Sn(S,b)||S);const N=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let E=w===y||!o&&w.startsWith(y)&&w.charAt(N)==="/",v=S!=null&&(S===y||!o&&S.startsWith(y)&&S.charAt(y.length)==="/"),A={isActive:E,isPending:v,isTransitioning:p},T=E?n:void 0,C;typeof r=="function"?C=r(A):C=[r,E?"active":null,v?"pending":null,p?"transitioning":null].filter(Boolean).join(" ");let k=typeof d=="function"?d(A):d;return i.createElement($e,si({},x,{"aria-current":T,className:C,ref:a,style:k,to:c,viewTransition:m}),typeof g=="function"?g(A):g)});var kd;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(kd||(kd={}));var du;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(du||(du={}));function kv(t){let s=i.useContext(yi);return s||nt(!1),s}function Ev(t,s){let{target:a,replace:n,state:l,preventScrollReset:r,relative:o,viewTransition:d}=s===void 0?{}:s,c=Ue(),m=ct(),g=Si(t,{relative:o});return i.useCallback(x=>{if(pv(x,a)){x.preventDefault();let j=n!==void 0?n:ti(m)===ti(g);c(t,{replace:j,state:l,preventScrollReset:r,relative:o,viewTransition:d})}},[m,c,g,n,l,a,t,r,o,d])}function Cv(t){let s=i.useRef(Sd(t)),a=i.useRef(!1),n=ct(),l=i.useMemo(()=>fv(n.search,a.current?null:s.current),[n.search]),r=Ue(),o=i.useCallback((d,c)=>{const m=Sd(typeof d=="function"?d(l):d);a.current=!0,r("?"+m,c)},[r,l]);return[l,o]}function Av(t,s){s===void 0&&(s={});let a=i.useContext(jv);a==null&&nt(!1);let{basename:n}=kv(kd.useViewTransitionState),l=Si(t,{relative:s.relative});if(!a.isTransitioning)return!1;let r=Sn(a.currentLocation.pathname,n)||a.currentLocation.pathname,o=Sn(a.nextLocation.pathname,n)||a.nextLocation.pathname;return yd(l.pathname,o)!=null||yd(l.pathname,r)!=null}const Ch="http://localhost:4000";function Us(){return Ch}function xs(){return localStorage.getItem("jasiq_token")}function Ed(t){if(!t){localStorage.removeItem("jasiq_token");return}localStorage.setItem("jasiq_token",t)}async function cu(t){const s=await t.text();try{return JSON.parse(s)}catch{return{error:{code:"HTTP_ERROR",message:s||t.statusText}}}}async function z(t,{method:s,body:a,headers:n}={}){var g,x;const l=xs(),r=await fetch(`${Ch}${t}`,{method:s||"GET",headers:{"content-type":"application/json",...l?{authorization:`Bearer ${l}`}:{},...n||{}},body:a?JSON.stringify(a):void 0});if(r.status===204)return null;const d=(r.headers.get("content-type")||"").includes("application/json");if(r.ok)return d?await r.json():null;if(r.status===401){const j=String(t||"");if(j.includes("/api/v1/auth/admin/login")||j.includes("/api/v1/auth/employee/login")){const f=d?await r.json().catch(()=>null):await cu(r),u=new Error(((g=f==null?void 0:f.error)==null?void 0:g.message)||`Request failed (${r.status})`);throw u.status=r.status,u.payload=f,u}return Ed(null),localStorage.removeItem("jasiq_bootstrap"),window.location.hash="#/",window.location.reload(),null}const c=d?await r.json().catch(()=>null):await cu(r),m=new Error(((x=c==null?void 0:c.error)==null?void 0:x.message)||`Request failed (${r.status})`);throw m.status=r.status,m.payload=c,m}const Ah=i.createContext(null);function Lv(t){var w,S,N,E,v;const s=((w=t==null?void 0:t.navigation)==null?void 0:w.items)||[],a=((S=t==null?void 0:t.rbac)==null?void 0:S.permissions)||[],l=(((N=t==null?void 0:t.rbac)==null?void 0:N.roles)||[])[0],r=(t==null?void 0:t.systemConfig)||{},o=((E=r==null?void 0:r.TIMESHEET_ENABLED)==null?void 0:E.value)??(r==null?void 0:r.TIMESHEET_ENABLED),d=String(o??"").trim().toLowerCase(),c=d==="true"||d==="1"||d==="yes"||d==="enabled"||d==="on",m=((v=r==null?void 0:r.LEAVE_ENABLED)==null?void 0:v.value)??(r==null?void 0:r.LEAVE_ENABLED),g=String(m??"").trim().toLowerCase(),x=g==="true"||g==="1"||g==="yes"||g==="enabled"||g==="on",j=a.includes("SYSTEM_FULL_ACCESS")||a.includes("TIMESHEET_READ"),h=a.includes("SYSTEM_FULL_ACCESS")||a.includes("TIMESHEET_APPROVAL_QUEUE_READ");a.includes("SYSTEM_FULL_ACCESS")||a.includes("LEAVE_REQUEST_READ"),a.includes("SYSTEM_FULL_ACCESS")||a.includes("LEAVE_APPROVE_L1"),a.includes("SYSTEM_FULL_ACCESS")||a.includes("LEAVE_APPROVE_L2"),a.includes("SYSTEM_FULL_ACCESS")||a.includes("LEAVE_TYPE_READ"),a.includes("SYSTEM_FULL_ACCESS")||a.includes("LEAVE_BALANCE_READ");const f=a.includes("SYSTEM_FULL_ACCESS")||a.includes("AUTH_ADMIN_MANAGE"),u=[...s],b=new Set(u.map(A=>A.path)),p={SUPER_ADMIN:[{label:"Overview",path:"/leave/overview"}],FOUNDER:[{label:"Overview",path:"/leave/overview"}],HR_ADMIN:[{label:"Overview",path:"/leave/overview"}],FINANCE_ADMIN:[{label:"Overview",path:"/leave/overview"}],MANAGER:[{label:"Team",path:"/leave/team"}],EMPLOYEE:[{label:"My Leave",path:"/leave/my"}]};x&&l&&p[l]&&p[l].forEach((A,T)=>{const C=`leave${l}${T}`;b.has(A.path)||(u.push({id:C,label:A.label,path:A.path,requiredPermission:"LEAVE_REQUEST_READ"}),b.add(A.path))}),c&&j&&!b.has("/timesheet/my")&&u.push({id:"timesheetMy",label:"My Timesheet",path:"/timesheet/my",requiredPermission:"TIMESHEET_READ"}),c&&j&&h&&!b.has("/timesheet/approvals")&&u.push({id:"timesheetApprovals",label:"Timesheet Approvals",path:"/timesheet/approvals",requiredPermission:"TIMESHEET_APPROVAL_QUEUE_READ"}),f&&!b.has("/super-admin/system-config")&&u.push({id:"adminManagement",label:"Admin Management",path:"/super-admin/system-config",requiredPermission:"AUTH_ADMIN_MANAGE"});const y={};for(const A of u)y[A.path]=A;return{...t,navigation:{items:u,byPath:y}}}function Dv({children:t}){const[s,a]=i.useState("idle"),[n,l]=i.useState(null),[r,o]=i.useState(null),[d,c]=i.useState(xs()),m=i.useCallback(async(j=null)=>{if(!(j!==null?j:d)){l(null),a("idle");return}a("loading"),o(null);try{const f=await z("/api/v1/app/bootstrap");l(Lv(f)),a("ready")}catch(f){if(f.status===401){Ed(null),c(null),l(null),a("idle");return}o(f),a("error")}},[d]);i.useEffect(()=>{m()},[m]);const g=i.useCallback(j=>{Ed(j),c(j||null),j||(l(null),a("idle"))},[]),x=i.useMemo(()=>({status:s,bootstrap:n,error:r,refresh:m,setToken:g,token:d}),[s,n,r,m,g,d]);return e.jsx(Ah.Provider,{value:x,children:t})}function he(){const t=i.useContext(Ah);if(!t)throw new Error("BootstrapProvider missing");return t}function so(){const t=Ue(),{setToken:s,refresh:a,bootstrap:n}=he(),[l,r]=i.useState(""),[o,d]=i.useState(""),[c,m]=i.useState(null),[g,x]=i.useState(!1),j=i.useMemo(()=>l.trim().length>0&&o.trim().length>0,[l,o]);async function h(b){var S,N;if(localStorage.setItem("accessToken",b.accessToken),s(b.accessToken),await a(),b.forcePasswordChange){t("/change-password");return}const p=(N=(S=n==null?void 0:n.rbac)==null?void 0:S.roles)==null?void 0:N[0],w={SUPER_ADMIN:"/super-admin/dashboard",HR_ADMIN:"/hr/dashboard",FINANCE_ADMIN:"/finance/dashboard",MANAGER:"/manager/dashboard",EMPLOYEE:"/employee/dashboard"}[p]||"/";t(w)}const f={post:async(b,p)=>({data:await z(b,{method:"POST",body:p})})};async function u(b){b.preventDefault(),m(null),x(!0);const p={email:l,password:o};try{const y=await f.post("/api/v1/auth/admin/login",p);await h(y.data);return}catch{try{const w=await f.post("/api/v1/auth/employee/login",p);await h(w.data);return}catch{m("Invalid email or password")}}finally{x(!1)}}return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse"}),e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-indigo-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse animation-delay-2000"}),e.jsx("div",{className:"absolute bottom-0 left-1/2 w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse animation-delay-4000"})]}),e.jsxs("div",{className:"relative z-10 w-full max-w-md",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-3xl shadow-2xl p-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-3xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl mb-4 shadow-lg transform rotate-3 hover:rotate-6 transition-transform duration-300",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"JASIQ CoreOps"}),e.jsx("p",{className:"text-blue-100 text-sm",children:"Welcome back! Sign in to access your dashboard"})]}),e.jsxs("form",{className:"space-y-6",onSubmit:u,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-blue-100",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-blue-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})}),e.jsx("input",{type:"email",className:"block w-full pl-10 pr-3 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-200",placeholder:"you@example.com",value:l,onChange:b=>r(b.target.value),disabled:g,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-blue-100",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-blue-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("input",{type:"password",className:"block w-full pl-10 pr-3 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-200",placeholder:"Enter your password",value:o,onChange:b=>d(b.target.value),disabled:g,required:!0})]})]}),c&&e.jsxs("div",{className:"rounded-xl bg-red-500/20 border border-red-400/30 px-4 py-3 flex items-center space-x-2",children:[e.jsx("svg",{className:"h-5 w-5 text-red-200 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-red-100 text-sm",children:c})]}),e.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold py-3 px-4 rounded-xl shadow-lg transform transition-all duration-200 hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center space-x-2",disabled:!j||g,children:g?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:"Signing in"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Sign In"}),e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("p",{className:"text-blue-100 text-xs",children:"Secure access to your CoreOps dashboard"})})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-white/60 text-sm",children:["Powered by ",e.jsx("span",{className:"font-semibold",children:"JASIQ"})]})})]}),e.jsx("style",{jsx:!0,children:`
        @keyframes pulse {
          0%, 100% { opacity: 0.2; }
          50% { opacity: 0.3; }
        }
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        .animation-delay-4000 {
          animation-delay: 4s;
        }
      `})]})}function Mv(){const{setToken:t,refresh:s}=he(),[a,n]=i.useState("loading"),[l,r]=i.useState(!1),[o,d]=i.useState(""),[c,m]=i.useState(""),[g,x]=i.useState(""),[j,h]=i.useState(""),[f,u]=i.useState(!1);Ca.useEffect(()=>{let y=!0;return(async()=>{try{const w=await z("/api/v1/auth/bootstrap-status");if(!y)return;r(!!w.bootstrapSignupEnabled),n("ready")}catch(w){if(!y)return;d(w.message||"Failed to load bootstrap status"),n("error")}})(),()=>{y=!1}},[]);const b=i.useMemo(()=>c.trim().length>1&&g.trim().length>0&&j.trim().length>0,[c,g,j]),p=async()=>{var y,w,S;d(""),u(!0);try{const N={name:c.trim(),email:g.trim(),password:j},E=await z("/api/v1/auth/bootstrap-signup",{method:"POST",body:N}),{accessToken:v}=E;t(v),await s(),window.location.hash="#/"}catch(N){const E=((S=(w=(y=N.payload)==null?void 0:y.error)==null?void 0:w.issues)==null?void 0:S.map(v=>v.message).join(", "))||N.message||"Signup failed";d(E)}finally{u(!1)}};return a==="loading"?e.jsx("div",{className:"min-h-screen flex items-center justify-center text-slate-600",children:"Loading"}):a==="error"?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white border border-slate-200 rounded-lg p-6",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Bootstrap status failed"}),e.jsx("div",{className:"mt-2 text-sm text-slate-600",children:o||"Please check backend connectivity."})]})}):l?e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white border border-slate-200 rounded-lg p-6",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Initial Setup"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Create the first super admin account."}),e.jsxs("div",{className:"mt-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Name"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:c,onChange:y=>m(y.target.value),disabled:f})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Email"}),e.jsx("input",{type:"email",className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:g,onChange:y=>x(y.target.value),disabled:f})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Password"}),e.jsx("input",{type:"password",className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:j,onChange:y=>h(y.target.value),disabled:f}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Min 8 chars, must include upper, lower, number."})]}),o?e.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 p-3 text-sm text-rose-800",children:o}):null,e.jsx("button",{type:"button",className:`w-full rounded-md px-4 py-2 text-sm font-medium text-white ${b&&!f?"bg-slate-900 hover:bg-slate-800":"bg-slate-400"}`,disabled:!b||f,onClick:p,children:f?"Creating":"Create Super Admin"})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white border border-slate-200 rounded-lg p-6",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Signup disabled"}),e.jsx("div",{className:"mt-2 text-sm text-slate-600",children:"System is already bootstrapped."}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"button",className:"rounded-md bg-slate-900 px-4 py-2 text-sm font-medium text-white",onClick:()=>{window.location.hash="#/"},children:"Go to Login"})})]})})}function mu(){const[t]=Cv(),s=Ue(),a=t.get("token"),[n,l]=i.useState({password:"",confirmPassword:""}),[r,o]=i.useState({}),[d,c]=i.useState(!1),[m,g]=i.useState("idle"),[x,j]=i.useState("");i.useEffect(()=>{a||(g("error"),j("Invalid or expired password setup link."))},[a]);const h=p=>{const{name:y,value:w}=p.target;l(S=>({...S,[y]:w})),r[y]&&o(S=>({...S,[y]:""}))},f=()=>{const p={};return n.password?n.password.length<8&&(p.password="Password must be at least 8 characters long"):p.password="Password is required",n.confirmPassword?n.password!==n.confirmPassword&&(p.confirmPassword="Passwords do not match"):p.confirmPassword="Please confirm your password",o(p),Object.keys(p).length===0},u=async p=>{if(p.preventDefault(),!!f()){c(!0);try{const y=await z("/api/v1/auth/set-password",{method:"POST",body:{token:a,password:n.password}});g("success"),setTimeout(()=>{s("/login")},3e3)}catch(y){g("error"),j((y==null?void 0:y.message)||"This password setup link is invalid or has expired. Please contact HR for assistance.")}finally{c(!1)}}};if(!a)return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Invalid Link"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Invalid or expired password setup link."}),e.jsx("p",{className:"text-sm text-slate-500",children:"Please contact HR for assistance with your account setup."})]})})})});if(m==="success")return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h1",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Password Set Successfully"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Your password has been set successfully. You will be redirected to the login page."}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-slate-500",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-slate-300 border-t-slate-600 rounded-full animate-spin"}),"Redirecting to login..."]})]})})})});const b=n.password&&n.confirmPassword&&n.password===n.confirmPassword&&n.password.length>=8;return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Set Your Password"}),e.jsx("p",{className:"text-slate-600",children:"Please set a password to activate your employee account."})]}),m==="error"&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Setup Failed"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:x})]})]})}),e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-2",children:"New Password"}),e.jsx("input",{type:"password",id:"password",name:"password",value:n.password,onChange:h,disabled:d,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500 disabled:bg-slate-50 disabled:text-slate-500",placeholder:"Enter your password",autoComplete:"new-password"}),r.password&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:r.password}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Must be at least 8 characters long"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-slate-700 mb-2",children:"Confirm Password"}),e.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:n.confirmPassword,onChange:h,disabled:d,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500 disabled:bg-slate-50 disabled:text-slate-500",placeholder:"Confirm your password",autoComplete:"new-password"}),r.confirmPassword&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:r.confirmPassword})]}),e.jsx("button",{type:"submit",disabled:!b||d,className:"w-full flex items-center justify-center px-4 py-2 bg-slate-900 text-white font-medium rounded-lg hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Setting Password..."]}):"Set Password"})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("p",{className:"text-xs text-slate-500",children:"If you need assistance, please contact your HR department."})})]})})})}function uu(){const t=Ue(),[s,a]=i.useState(""),[n,l]=i.useState(""),[r,o]=i.useState(""),[d,c]=i.useState(""),[m,g]=i.useState(!1),x=i.useMemo(()=>!(!s||!n||!r||n.length<8||n!==r),[s,n,r]),j=async h=>{h.preventDefault(),c(""),g(!0);try{await z("/api/v1/auth/change-password",{method:"POST",body:{currentPassword:s,newPassword:n}}),t("/")}catch(f){c(f.message||"Failed to update password")}finally{g(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsx("div",{className:"text-2xl font-semibold text-slate-900",children:"Change Password"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"You must change your password to continue."}),e.jsxs("form",{onSubmit:j,className:"mt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Current Password"}),e.jsx("input",{type:"password",className:"mt-1 w-full rounded-md border border-slate-300 px-3 py-2 text-sm focus:border-slate-500 focus:ring-slate-500",value:s,onChange:h=>a(h.target.value),disabled:m,autoComplete:"current-password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"New Password"}),e.jsx("input",{type:"password",className:"mt-1 w-full rounded-md border border-slate-300 px-3 py-2 text-sm focus:border-slate-500 focus:ring-slate-500",value:n,onChange:h=>l(h.target.value),disabled:m,autoComplete:"new-password"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Minimum 8 characters."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Confirm Password"}),e.jsx("input",{type:"password",className:"mt-1 w-full rounded-md border border-slate-300 px-3 py-2 text-sm focus:border-slate-500 focus:ring-slate-500",value:r,onChange:h=>o(h.target.value),disabled:m,autoComplete:"new-password"})]}),d&&e.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-700",children:d}),e.jsx("button",{type:"submit",className:"w-full inline-flex justify-center items-center rounded-md bg-slate-900 px-4 py-2 text-sm font-medium text-white hover:bg-slate-800 disabled:bg-slate-300",disabled:!x||m,children:m?"Updating":"Update Password"})]})]})})}function Ss(t){const[s,a]=i.useState(!1);return i.useEffect(()=>{const n=window.matchMedia(t);n.matches!==s&&a(n.matches);const l=()=>a(n.matches);return n.addEventListener("change",l),()=>n.removeEventListener("change",l)},[s,t]),s}const xu={dashboard:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),employees:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),attendance:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"leave-balances":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"leave-overview":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"leave-approvals":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"timesheet-approvals":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"month-close":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})};function hu({open:t,setOpen:s}){var h,f;const{token:a,setToken:n}=he(),{bootstrap:l}=he(),r=ct();(h=l==null?void 0:l.user)!=null&&h.email;const o=((f=l==null?void 0:l.rbac)==null?void 0:f.permissions)||[],d=t!==void 0,c=()=>{d&&s&&s(!1)};function m(...u){return u.filter(Boolean).join(" ")}const g=async()=>{try{n(null),window.location.href="/"}catch{}},j=[{id:"dashboard",label:"Dashboard",path:"/hr/dashboard"},{id:"month-close",label:"Operations",header:!0},{id:"month-close",label:"  Inbox",path:"/hr/ops/inbox"},{id:"month-close",label:"  Alerts",path:"/hr/ops/alerts"},{id:"month-close",label:"  Data Quality",path:"/hr/ops/data-quality"},{id:"employees",label:"Employees",path:"/hr/employees",requiredPermission:"EMPLOYEE_READ"},{id:"attendance",label:"Attendance",path:"/hr/attendance",requiredPermission:"ATTENDANCE_CORRECT"},{id:"timesheet-approvals",label:"Timesheet Approvals",path:"/hr/timesheets/approvals",requiredPermission:"TIMESHEET_APPROVAL_QUEUE_READ"},{id:"leave-balances",label:"Leave Balances",path:"/hr/leave/balances",requiredPermissions:["LEAVE_TYPE_READ","LEAVE_BALANCE_GRANT"]},{id:"leave-approvals",label:"Leave Approvals",path:"/hr/leave/approvals",requiredPermissions:["LEAVE_APPROVE_L1","LEAVE_APPROVE_L2"]},{id:"leave-overview",label:"Leave Overview",path:"/hr/leave/overview",requiredPermission:"LEAVE_REQUEST_READ"},{id:"month-close",label:"Month Close",path:"/hr/month-close",requiredPermissions:["GOV_MONTH_CLOSE_READ","MONTH_CLOSE_MANAGE"]}].filter(u=>!u.requiredPermission&&!u.requiredPermissions?!0:u.requiredPermission?o.includes(u.requiredPermission):u.requiredPermissions?u.requiredPermissions.some(b=>o.includes(b)):!1);return e.jsxs(e.Fragment,{children:[d&&t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:c}),d&&e.jsx("div",{className:`fixed top-0 left-0 h-full w-64 bg-gradient-to-b from-slate-50 to-white border-r border-slate-200/60 shadow-lg transform transition-transform z-50 lg:hidden ${t?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200/60 bg-white/80 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-lg flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white font-bold text-xs",children:"HR"})}),e.jsx("span",{className:"font-semibold text-slate-800 text-sm",children:"HR Admin"})]}),e.jsx("button",{onClick:c,className:"p-2 rounded-lg hover:bg-slate-100 transition-colors duration-200","aria-label":"Close sidebar",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:j.map(u=>{if(u.header)return e.jsx("div",{className:"px-3 pt-4 pb-2 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:u.label},`${u.id}-${u.label}`);const b=r.pathname===u.path||u.path!=="/hr/dashboard"&&r.pathname.startsWith(u.path);return e.jsxs(es,{to:u.path,onClick:c,className:({isActive:p})=>m("group relative flex items-center gap-3 px-3 py-2.5 rounded-xl font-medium text-sm transition-all duration-200","hover:bg-slate-100/80",p?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 shadow-sm border border-blue-200/50":"text-slate-700 hover:text-slate-900"),children:[e.jsx("span",{className:m("flex-shrink-0 transition-transform duration-200",b?"scale-110 text-blue-600":"text-slate-500 group-hover:text-slate-700"),children:xu[u.id]}),e.jsx("span",{className:"truncate",children:u.label}),b&&e.jsx("span",{className:"absolute inset-y-0 left-0 w-1 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-r-full"})]},u.id)})}),e.jsx("div",{className:"p-4 border-t border-slate-200/60",children:e.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-xl transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]})}),e.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:left-0 lg:w-64 lg:z-10 lg:block",children:e.jsxs("div",{className:"h-full bg-gradient-to-b from-slate-50 to-white border-r border-slate-200/60 shadow-sm flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-200/60",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold",children:"HR"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-800",children:"HR Admin"}),e.jsx("div",{className:"text-xs text-slate-500",children:"JASIQ CoreOps"})]})]})}),e.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:j.map(u=>{if(u.header)return e.jsx("div",{className:"px-3 pt-4 pb-2 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:u.label},`${u.id}-${u.label}`);const b=r.pathname===u.path||u.path!=="/hr/dashboard"&&r.pathname.startsWith(u.path);return e.jsxs(es,{to:u.path,className:({isActive:p})=>m("group relative flex items-center gap-3 px-3 py-2.5 rounded-xl font-medium text-sm transition-all duration-200","hover:bg-slate-100/80",p?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 shadow-sm border border-blue-200/50":"text-slate-700 hover:text-slate-900"),children:[e.jsx("span",{className:m("flex-shrink-0 transition-transform duration-200",b?"scale-110 text-blue-600":"text-slate-500 group-hover:text-slate-700"),children:xu[u.id]}),e.jsx("span",{className:"truncate",children:u.label}),b&&e.jsx("span",{className:"absolute inset-y-0 left-0 w-1 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-r-full"})]},u.id)})}),e.jsx("div",{className:"p-4 border-t border-slate-200/60",children:e.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-xl transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]})})]})}const Rv=t=>{const s={"/hr/dashboard":"Dashboard","/hr/employees":"Employees","/hr/employees/create":"Create Employee","/hr/attendance":"Attendance","/hr/timesheets/approvals":"Timesheet Approvals","/hr/leave/balances":"Leave Balances","/hr/leave/approvals":"Leave Approvals","/hr/leave/overview":"Leave Overview","/hr/month-close":"Month Close"};return s[t]?s[t]:t.startsWith("/hr/employees/")?"Employee Profile":"HR"},Tv=t=>t.startsWith("/hr/dashboard")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}):t.startsWith("/hr/employees")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}):t.startsWith("/hr/attendance")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}):t.startsWith("/hr/leave")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});function Pv(){const[t,s]=i.useState(!1),a=ct(),n=Ss("(max-width: 1023px)"),l=Ss("(min-width: 768px) and (max-width: 1023px)"),r=Rv(a.pathname),o=Tv(a.pathname);return e.jsxs("div",{className:"h-screen flex overflow-hidden",children:[e.jsx("aside",{className:"w-64 bg-white border-r hidden lg:flex flex-col",children:e.jsx(hu,{})}),e.jsx(hu,{open:t,setOpen:s}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 text-white shadow-lg border-b border-slate-700/50 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 lg:px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:()=>s(!0),className:"lg:hidden p-2.5 rounded-xl hover:bg-white/10 transition-all duration-200 active:scale-95","aria-label":"Open menu",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white/10 backdrop-blur-sm",children:o}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold tracking-tight text-white",children:r}),!n&&e.jsx("p",{className:"text-xs text-slate-300 mt-0.5",children:"JASIQ CoreOps Platform"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[l&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"JC"})}),e.jsx("span",{className:"text-sm font-semibold text-white",children:"CoreOps"})]}),!n&&!l&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold",children:"JC"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-white",children:"JASIQ CoreOps"}),e.jsx("div",{className:"text-xs text-slate-300",children:"HR Panel"})]})]})]})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gradient-to-br from-slate-50 via-white to-slate-50",children:e.jsx("div",{className:"px-4 py-6 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:e.jsx(_l,{})})})]})]})}const pu={dashboard:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),payroll:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),finance:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),ledger:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),reports:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4V7m-9 10V7a2 2 0 012-2h6a2 2 0 012 2v10m-10 0h10"})}),expenses:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"month-close":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})};function fu({open:t,setOpen:s}){var x;const{setToken:a}=he(),{bootstrap:n}=he(),l=ct(),r=t!==void 0,o=()=>{r&&s&&s(!1)},d=((x=n==null?void 0:n.user)==null?void 0:x.email)||"Finance";function c(...j){return j.filter(Boolean).join(" ")}const m=async()=>{try{a(null),window.location.href="/"}catch{}},g=[{id:"dashboard",label:"Dashboard",path:"/finance/dashboard"},{id:"reports",label:"Operations",path:"/finance/ops/dashboard"},{id:"reports",label:"  Inbox",path:"/finance/ops/inbox"},{id:"reports",label:"  Alerts",path:"/finance/ops/alerts"},{id:"reports",label:"  Overrides",path:"/finance/ops/overrides"},{id:"reports",label:"  Data Quality",path:"/finance/ops/data-quality"},{id:"payroll",label:"Payroll",path:"/finance/payroll"},{id:"ledger",label:"Ledger",path:"/finance/ledger"},{id:"expenses",label:"Reimbursements",path:"/finance/reimbursements"},{id:"expenses",label:"Expenses",path:"/finance/expenses"},{id:"expenses",label:"Expense Categories",path:"/finance/expenses/categories"},{id:"expenses",label:"Expense Payments",path:"/finance/expenses/payments"},{id:"expenses",label:"Adjustments",path:"/finance/expenses/adjustments"},{id:"reports",label:"Revenue",path:"/finance/revenue"},{id:"reports",label:"Revenue Approvals",path:"/finance/revenue/approvals"},{id:"reports",label:"Revenue Reports",path:"/finance/revenue/reports"},{id:"reports",label:"Revenue Categories",path:"/finance/revenue/categories"},{id:"reports",label:"Revenue Clients",path:"/finance/revenue/clients"},{id:"reports",label:"Reports",path:"/finance/reports/dashboard"},{id:"reports",label:"  Revenue",path:"/finance/reports/revenue"},{id:"reports",label:"  Expense",path:"/finance/reports/expense"},{id:"reports",label:"  Profit & Loss",path:"/finance/reports/pnl"},{id:"reports",label:"  Receivables",path:"/finance/reports/receivables"},{id:"reports",label:"  Payables",path:"/finance/reports/payables"},{id:"reports",label:"  Cashflow",path:"/finance/reports/cashflow"},{id:"month-close",label:"Month Close",path:"/finance/month-close"}];return e.jsxs(e.Fragment,{children:[r&&t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:o}),r&&e.jsx("div",{className:`fixed top-0 left-0 h-full w-64 bg-gradient-to-b from-slate-50 to-white border-r border-slate-200/60 shadow-lg transform transition-transform z-50 lg:hidden ${t?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200/60 bg-white/80 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-lg flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white font-bold text-xs",children:"FA"})}),e.jsx("span",{className:"font-semibold text-slate-800 text-sm",children:"Finance"})]}),e.jsx("button",{onClick:o,className:"p-2 rounded-lg hover:bg-slate-100 transition-colors duration-200","aria-label":"Close sidebar",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:g.map(j=>{const h=l.pathname===j.path||j.path!=="/finance/dashboard"&&l.pathname.startsWith(j.path);return e.jsxs(es,{to:j.path,onClick:o,className:({isActive:f})=>c("group relative flex items-center gap-3 px-3 py-2.5 rounded-xl font-medium text-sm transition-all duration-200","hover:bg-slate-100/80",f?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 shadow-sm border border-blue-200/50":"text-slate-700 hover:text-slate-900"),children:[e.jsx("span",{className:c("flex-shrink-0 transition-transform duration-200",h?"scale-110 text-blue-600":"text-slate-500 group-hover:text-slate-700"),children:pu[j.id]}),e.jsx("span",{className:"truncate",children:j.label}),h&&e.jsx("span",{className:"absolute inset-y-0 left-0 w-1 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-r-full"})]},j.id)})}),e.jsx("div",{className:"p-4 border-t border-slate-200/60",children:e.jsxs("button",{onClick:m,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-xl transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]})}),e.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:left-0 lg:w-64 lg:z-10 lg:block",children:e.jsxs("div",{className:"h-full bg-gradient-to-b from-slate-50 to-white border-r border-slate-200/60 shadow-sm flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-200/60",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold",children:"FA"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-800",children:"Finance"}),e.jsx("div",{className:"text-xs text-slate-500",children:"JASIQ CoreOps"})]})]})}),e.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:g.map(j=>{const h=l.pathname===j.path||j.path!=="/finance/dashboard"&&l.pathname.startsWith(j.path);return e.jsxs(es,{to:j.path,className:({isActive:f})=>c("group relative flex items-center gap-3 px-3 py-2.5 rounded-xl font-medium text-sm transition-all duration-200","hover:bg-slate-100/80",f?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 shadow-sm border border-blue-200/50":"text-slate-700 hover:text-slate-900"),children:[e.jsx("span",{className:c("flex-shrink-0 transition-transform duration-200",h?"scale-110 text-blue-600":"text-slate-500 group-hover:text-slate-700"),children:pu[j.id]}),e.jsx("span",{className:"truncate",children:j.label}),h&&e.jsx("span",{className:"absolute inset-y-0 left-0 w-1 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-r-full"})]},j.id)})}),e.jsx("div",{className:"p-3 border-t border-slate-200/60 bg-gradient-to-t from-slate-50 to-transparent",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-white/60 backdrop-blur-sm border border-slate-200/50 shadow-sm",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-slate-600 to-slate-800 rounded-full flex items-center justify-center text-white font-semibold text-sm shadow-inner",children:(d==null?void 0:d.charAt(0).toUpperCase())||"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-slate-800 text-sm truncate",children:d}),e.jsx("div",{className:"text-xs text-slate-500 truncate",children:"Finance"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse shadow-sm"}),e.jsx("span",{className:"text-xs text-slate-500 font-medium",children:"Online"})]})]})}),e.jsx("div",{className:"p-4 border-t border-slate-200/60",children:e.jsxs("button",{onClick:m,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-xl transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]})})]})}const Iv=t=>{const s={"/finance/dashboard":"Dashboard","/finance/payroll":"Payroll","/finance/ledger":"Ledger","/finance/expenses":"Expenses","/finance/expenses/create":"Create Expense","/finance/expenses/categories":"Expense Categories","/finance/expenses/payments":"Expense Payments","/finance/expenses/adjustments":"Adjustments","/finance/revenue":"Revenue","/finance/revenue/create":"Create Income","/finance/revenue/approvals":"Revenue Approvals","/finance/revenue/reports":"Revenue Reports","/finance/revenue/categories":"Revenue Categories","/finance/revenue/clients":"Revenue Clients","/finance/reports":"Reports","/finance/reports/dashboard":"Reports Dashboard","/finance/reports/revenue":"Revenue Report","/finance/reports/expense":"Expense Report","/finance/reports/pnl":"Profit & Loss","/finance/reports/receivables":"Receivables","/finance/reports/payables":"Payables","/finance/reports/cashflow":"Cashflow","/finance/month-close":"Month Close"};return s[t]?s[t]:t.startsWith("/finance/payroll/")?"Payroll Run":t.startsWith("/finance/expenses/")?"Expense Detail":t.startsWith("/finance/revenue/")?"Income Detail":"Finance"},Ov=t=>t.startsWith("/finance/dashboard")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}):t.startsWith("/finance/payroll")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}):t.startsWith("/finance/reports")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4V7m-9 10V7a2 2 0 012-2h6a2 2 0 012 2v10m-10 0h10"})}):t.startsWith("/finance/month-close")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});function _v(){const[t,s]=i.useState(!1),a=ct(),n=Ss("(max-width: 1023px)"),l=Ss("(min-width: 768px) and (max-width: 1023px)"),r=Iv(a.pathname),o=Ov(a.pathname);return e.jsxs("div",{className:"h-screen flex overflow-hidden",children:[e.jsx("aside",{className:"w-64 bg-white border-r hidden lg:flex flex-col",children:e.jsx(fu,{})}),e.jsx(fu,{open:t,setOpen:s}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 text-white shadow-lg border-b border-slate-700/50 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 lg:px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:()=>s(!0),className:"lg:hidden p-2.5 rounded-xl hover:bg-white/10 transition-all duration-200 active:scale-95","aria-label":"Open menu",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white/10 backdrop-blur-sm",children:o}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold tracking-tight text-white",children:r}),!n&&e.jsx("p",{className:"text-xs text-slate-300 mt-0.5",children:"JASIQ CoreOps Platform"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[l&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"JC"})}),e.jsx("span",{className:"text-sm font-semibold text-white",children:"CoreOps"})]}),!n&&!l&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold",children:"JC"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-white",children:"JASIQ CoreOps"}),e.jsx("div",{className:"text-xs text-slate-300",children:"Finance Panel"})]})]})]})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gradient-to-br from-slate-50 via-white to-slate-50",children:e.jsx("div",{className:"px-4 py-6 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:e.jsx(_l,{})})})]})]})}const gu={dashboard:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"my-attendance":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"my-leave":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"my-payslip":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"my-timesheets":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),"my-profile":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"team-attendance":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"team-leave":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"team-timesheets":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),expenses:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},Bv=[{label:"Dashboard",path:"/manager/dashboard",section:"MY AREA",permission:null,icon:"dashboard"},{label:"My Attendance",path:"/manager/my-attendance",section:"MY AREA",permission:"ATTENDANCE_VIEW_SELF",icon:"my-attendance"},{label:"My Leave",path:"/manager/my-leave",section:"MY AREA",permission:"LEAVE_VIEW_SELF",icon:"my-leave"},{label:"My Timesheets",path:"/manager/my-timesheets",section:"MY AREA",permission:"TIMESHEET_VIEW_SELF",icon:"my-timesheets"},{label:"My Profile",path:"/manager/my-profile",section:"MY AREA",permission:"PROFILE_VIEW_SELF",icon:"my-profile"},{label:"Team Attendance",path:"/manager/team-attendance",section:"TEAM AREA",permission:"ATTENDANCE_VIEW_SELF",icon:"team-attendance"},{label:"Team Leave",path:"/manager/team-leave",section:"TEAM AREA",permission:"LEAVE_APPROVE_TEAM",icon:"team-leave"},{label:"Team Timesheets",path:"/manager/team-timesheets",section:"TEAM AREA",permission:"TIMESHEET_APPROVE_TEAM",icon:"team-timesheets"},{label:"Team Expenses",path:"/manager/expenses",section:"TEAM AREA",permission:"EXPENSE_APPROVE",icon:"expenses"},{label:"Reimbursement Approvals",path:"/manager/reimbursements",section:"TEAM AREA",permission:"REIMBURSEMENT_VIEW_DIVISION",icon:"team-leave"},{label:"Revenue",path:"/manager/revenue",section:"TEAM AREA",permission:null,icon:"expenses"},{label:"Operations Inbox",path:"/manager/ops/inbox",section:"OPERATIONS",permission:null,icon:"dashboard"}];function Fv(t){return t.reduce((s,a)=>{const n=a.section;return s[n]||(s[n]=[]),s[n].push(a),s},{})}function vu({open:t,setOpen:s,role:a}){var f;const{bootstrap:n,token:l,setToken:r}=he(),o=((f=n==null?void 0:n.rbac)==null?void 0:f.permissions)||[],d=ct(),c=()=>{try{r(null),window.location.href="/"}catch{}},m=Bv.filter(u=>{var p;if(((p=n==null?void 0:n.rbac)==null?void 0:p.role)==="MANAGER"||a==="Manager")return console.log("Manager role detected, showing all Manager pages:",u.label),!0;const b=!u.permission||o.includes(u.permission);return console.log("Page:",u.label,"Permission:",u.permission,"Has Permission:",b,"User Permissions:",o),b}),g=Fv(m);function x(...u){return u.filter(Boolean).join(" ")}const j=t!==void 0,h=()=>{j&&s&&s(!1)};return e.jsxs(e.Fragment,{children:[j&&t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:h}),j&&e.jsx("div",{className:`fixed top-0 left-0 h-full w-64 bg-gradient-to-b from-slate-50 to-white border-r border-slate-200/60 shadow-lg transform transition-transform z-50 lg:hidden ${t?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200/60 bg-white/80 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-lg flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white font-bold text-xs",children:"MG"})}),e.jsx("span",{className:"font-semibold text-slate-800 text-sm",children:"Manager"})]}),e.jsx("button",{onClick:h,className:"p-2 rounded-lg hover:bg-slate-100 transition-colors duration-200","aria-label":"Close sidebar",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:Object.entries(g).map(([u,b])=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"px-3 text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2",children:u}),e.jsx("div",{className:"space-y-1",children:b.map(p=>{const y=d.pathname===p.path||p.path!=="/manager/dashboard"&&d.pathname.startsWith(p.path);return e.jsxs(es,{to:p.path,onClick:h,className:({isActive:w})=>x("group relative flex items-center gap-3 px-3 py-2.5 rounded-xl font-medium text-sm transition-all duration-200","hover:bg-slate-100/80",w?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 shadow-sm border border-blue-200/50":"text-slate-700 hover:text-slate-900"),children:[e.jsx("span",{className:x("flex-shrink-0 transition-transform duration-200",y?"scale-110":"group-hover:scale-105"),children:gu[p.icon]}),e.jsx("span",{className:"truncate",children:p.label})]},p.path)})})]},u))}),e.jsx("div",{className:"p-4 border-t border-slate-200/60",children:e.jsxs("button",{onClick:c,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-xl transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]})}),e.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:left-0 lg:w-64 lg:z-10 lg:block",children:e.jsxs("div",{className:"h-full bg-gradient-to-b from-slate-50 to-white border-r border-slate-200/60 shadow-sm flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-200/60",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold",children:"MG"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-800",children:"Manager"}),e.jsx("div",{className:"text-xs text-slate-500",children:"JASIQ CoreOps"})]})]})}),e.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:Object.entries(g).map(([u,b])=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"px-3 text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2",children:u}),e.jsx("div",{className:"space-y-1",children:b.map(p=>{const y=d.pathname===p.path||p.path!=="/manager/dashboard"&&d.pathname.startsWith(p.path);return e.jsxs(es,{to:p.path,className:({isActive:w})=>x("group relative flex items-center gap-3 px-3 py-2.5 rounded-xl font-medium text-sm transition-all duration-200","hover:bg-slate-100/80",w?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 shadow-sm border border-blue-200/50":"text-slate-700 hover:text-slate-900"),children:[e.jsx("span",{className:x("flex-shrink-0 transition-transform duration-200",y?"scale-110":"group-hover:scale-105"),children:gu[p.icon]}),e.jsx("span",{className:"truncate",children:p.label})]},p.path)})})]},u))}),e.jsx("div",{className:"p-4 border-t border-slate-200/60",children:e.jsxs("button",{onClick:c,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-xl transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]})})]})}const Uv=t=>{const s={"/manager/dashboard":"Dashboard","/manager/my-attendance":"My Attendance","/manager/my-leave":"My Leave","/manager/my-timesheets":"My Timesheets","/manager/my-profile":"My Profile","/manager/team-attendance":"Team Attendance","/manager/team-leave":"Team Leave","/manager/team-timesheets":"Team Timesheets","/manager/expenses":"Team Expenses","/manager/revenue":"Revenue","/manager/revenue/create":"Create Income","/manager/reports/pnl":"Profit & Loss"};return s[t]?s[t]:t.startsWith("/manager/expenses/")?"Expense Review":t.startsWith("/manager/revenue/")?"Income Detail":"Manager"},$v=t=>t.startsWith("/manager/dashboard")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}):t.startsWith("/manager/my-attendance")||t.startsWith("/manager/team-attendance")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}):t.startsWith("/manager/my-leave")||t.startsWith("/manager/team-leave")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}):t.startsWith("/manager/my-timesheets")||t.startsWith("/manager/team-timesheets")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});function Vv(){const[t,s]=i.useState(!1),a=ct(),n=Ss("(max-width: 1023px)"),l=Ss("(min-width: 768px) and (max-width: 1023px)"),r=Uv(a.pathname),o=$v(a.pathname);return e.jsxs("div",{className:"h-screen flex overflow-hidden",children:[e.jsx("aside",{className:"w-64 bg-white border-r hidden lg:flex flex-col",children:e.jsx(vu,{role:"Manager"})}),e.jsx(vu,{open:t,setOpen:s,role:"Manager"}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 text-white shadow-lg border-b border-slate-700/50 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 lg:px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:()=>s(!0),className:"lg:hidden p-2.5 rounded-xl hover:bg-white/10 transition-all duration-200 active:scale-95","aria-label":"Open menu",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white/10 backdrop-blur-sm",children:o}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold tracking-tight text-white",children:r}),!n&&e.jsx("p",{className:"text-xs text-slate-300 mt-0.5",children:"JASIQ CoreOps Platform"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[l&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"MG"})}),e.jsx("span",{className:"text-sm font-semibold text-white",children:"Manager"})]}),!n&&!l&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold",children:"MG"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-white",children:"Manager Panel"}),e.jsx("div",{className:"text-xs text-slate-300",children:"JASIQ CoreOps"})]})]})]})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gradient-to-br from-slate-50 via-white to-slate-50",children:e.jsx("div",{className:"px-4 py-6 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:e.jsx(_l,{})})})]})]})}function bu({mobile:t,onClose:s}){const{setToken:a}=he(),n=ct(),l=()=>{s&&s()},r=async()=>{try{a(null),window.location.href="/"}catch{}},o=[{id:"dashboard",label:"Dashboard",path:"/employee/dashboard",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{id:"profile",label:"My Profile",path:"/employee/profile",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})},{id:"attendance",label:"My Attendance",path:"/employee/attendance",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})},{id:"timesheets",label:"My Timesheets",path:"/employee/timesheets",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{id:"leave",label:"My Leave",path:"/employee/leave",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})})},{id:"documents",label:"Documents",path:"/employee/documents",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{id:"payslips",label:"My Payslips",path:"/employee/payslips",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},{id:"expenses",label:"Expenses",path:"/employee/expenses",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},{id:"reimbursements",label:"Reimbursements",path:"/employee/reimbursements",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:flex lg:flex-shrink-0",children:e.jsxs("div",{className:"w-64 bg-gradient-to-b from-slate-50 to-white border-r border-slate-200/60 flex flex-col shadow-sm",children:[e.jsx("div",{className:"p-6 border-b border-slate-200/60 bg-gradient-to-r from-slate-50 to-blue-50/30"}),e.jsxs("nav",{className:"flex-1 p-4 space-y-2",children:[o.map(d=>e.jsxs(es,{to:d.path,className:({isActive:c})=>`group relative flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-xl transition-all duration-300 ${c?"bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg transform scale-105":"text-slate-700 hover:bg-gradient-to-r hover:from-slate-100 hover:to-blue-50/50 hover:text-slate-900 hover:shadow-md"}`,children:[e.jsx("span",{className:`transition-transform duration-300 ${n.pathname.startsWith(d.path)?"scale-110 text-white":"text-slate-500 group-hover:text-blue-600"}`,children:d.icon}),e.jsx("span",{className:"relative",children:d.label}),n.pathname.startsWith(d.path)&&e.jsx("span",{className:"absolute inset-y-0 left-0 w-1 bg-white rounded-r-full animate-pulse"})]},d.id)),e.jsxs("div",{className:"border-t border-slate-200/60 mt-6 pt-4 space-y-2",children:[e.jsxs(es,{to:"/help",className:({isActive:d})=>`group flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-xl transition-all duration-300 ${d?"bg-gradient-to-r from-slate-100 to-slate-200 text-slate-900 shadow-sm":"text-slate-600 hover:bg-gradient-to-r hover:from-slate-100 hover:to-slate-50 hover:text-slate-900"}`,children:[e.jsx("svg",{className:"w-5 h-5 text-slate-500 group-hover:text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Help & Policies"]}),e.jsxs("button",{onClick:r,className:"w-full flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-xl text-red-600 hover:bg-gradient-to-r hover:from-red-50 hover:to-pink-50 hover:text-red-700 transition-all duration-300 group",children:[e.jsx("svg",{className:"w-5 h-5 text-red-500 group-hover:text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})]})]})}),t&&e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-200/60 bg-gradient-to-r from-slate-50 to-blue-50/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:l,className:"p-2 rounded-xl hover:bg-white/60 transition-all duration-200 shadow-sm",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("nav",{className:"flex-1 p-4 space-y-2",children:[o.map(d=>e.jsxs(es,{to:d.path,onClick:l,className:({isActive:c})=>`group relative flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-xl transition-all duration-300 ${c?"bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg transform scale-105":"text-slate-700 hover:bg-gradient-to-r hover:from-slate-100 hover:to-blue-50/50 hover:text-slate-900 hover:shadow-md"}`,children:[e.jsx("span",{className:`transition-transform duration-300 ${n.pathname.startsWith(d.path)?"scale-110 text-white":"text-slate-500 group-hover:text-blue-600"}`,children:d.icon}),e.jsx("span",{className:"relative",children:d.label}),n.pathname.startsWith(d.path)&&e.jsx("span",{className:"absolute inset-y-0 left-0 w-1 bg-white rounded-r-full animate-pulse"})]},d.id)),e.jsxs("div",{className:"border-t border-slate-200/60 mt-6 pt-4 space-y-2",children:[e.jsxs(es,{to:"/help",onClick:l,className:({isActive:d})=>`group flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-xl transition-all duration-300 ${d?"bg-gradient-to-r from-slate-100 to-slate-200 text-slate-900 shadow-sm":"text-slate-600 hover:bg-gradient-to-r hover:from-slate-100 hover:to-slate-50 hover:text-slate-900"}`,children:[e.jsx("svg",{className:"w-5 h-5 text-slate-500 group-hover:text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Help & Policies"]}),e.jsxs("button",{onClick:r,className:"w-full flex items-center gap-3 px-4 py-3 text-sm font-medium rounded-xl text-red-600 hover:bg-gradient-to-r hover:from-red-50 hover:to-pink-50 hover:text-red-700 transition-all duration-300 group",children:[e.jsx("svg",{className:"w-5 h-5 text-red-500 group-hover:text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})]})]})]})}const zv=t=>{const s={"/employee/dashboard":"Dashboard","/employee/timesheets":"My Timesheets","/employee/attendance":"My Attendance","/employee/leave":"Leave Management","/employee/profile":"My Profile","/employee/payroll":"My Payroll","/employee/notifications":"Notifications","/employee/payslips":"My Payslips","/employee/expenses":"My Expenses","/employee/expenses/create":"Create Expense"};return s[t]?s[t]:t.startsWith("/employee/timesheets/")?"Timesheet Details":t.startsWith("/employee/leave/")?"Leave Details":t.startsWith("/employee/expenses/")?"Expense Detail":"Employee Portal"},Wv=t=>t.startsWith("/employee/dashboard")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}):t.startsWith("/employee/timesheets")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}):t.startsWith("/employee/attendance")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}):t.startsWith("/employee/leave")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}):t.startsWith("/employee/profile")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}):t.startsWith("/employee/payroll")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});function Hv(){const[t,s]=i.useState(!1),a=ct(),n=Ss("(max-width: 1023px)"),l=Ss("(min-width: 768px) and (max-width: 1023px)"),r=zv(a.pathname),o=Wv(a.pathname);i.useEffect(()=>{n&&s(!1)},[a.pathname,n]);const d=()=>{s(!1)},c=()=>{s(!t)};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx("aside",{className:"hidden lg:flex lg:flex-col lg:fixed lg:inset-y-0 lg:left-0 lg:z-40 lg:w-64 lg:bg-white lg:border-r lg:border-slate-200",children:e.jsx(bu,{})}),t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/40 z-40 lg:hidden",onClick:d}),e.jsx("div",{className:"fixed left-0 top-0 h-full w-64 bg-white transform transition-transform duration-300 ease-in-out z-50 lg:hidden",children:e.jsx(bu,{mobile:!0,onClose:d})})]}),e.jsxs("div",{className:"flex flex-col flex-1 lg:ml-64 min-w-0",children:[e.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-blue-600 via-blue-700 to-blue-800 text-white shadow-xl border-b border-blue-700/50 backdrop-blur-md lg:left-64",children:e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("button",{onClick:c,className:"lg:hidden p-2.5 rounded-xl hover:bg-white/10 transition-all duration-200 active:scale-95 shadow-md hover:shadow-lg","aria-label":"Open menu",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white/10 backdrop-blur-sm flex-shrink-0 shadow-inner",children:o}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-lg font-bold tracking-tight text-white truncate",children:r}),!n&&e.jsx("p",{className:"text-xs text-blue-100 mt-0.5 font-medium",children:"Employee Portal"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 flex-shrink-0",children:[l&&e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 px-3 py-2 rounded-xl backdrop-blur-sm",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-white to-blue-100 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-blue-700 font-bold text-sm",children:"JC"})}),e.jsx("span",{className:"text-sm font-semibold text-white",children:"CoreOps"})]}),!n&&!l&&e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 px-4 py-2 rounded-xl backdrop-blur-sm",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-white to-blue-100 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-blue-700 font-bold",children:"JC"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-white",children:"JASIQ CoreOps"}),e.jsx("div",{className:"text-xs text-blue-100 font-medium",children:"Employee Portal"})]})]}),n&&!l&&e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-white to-blue-100 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-blue-700 font-bold text-sm",children:"JC"})})]})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gradient-to-br from-blue-50 via-white to-blue-50 pt-16",children:e.jsx("div",{className:"w-full px-4 py-6 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:e.jsx(_l,{})})})]})]})}const ju={dashboard:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),divisions:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),projects:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),roles:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),employees:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),attendance:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),timesheets:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),"leave-overview":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),payroll:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),finance:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),reports:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v1a1 1 0 001 1h4a1 1 0 001-1v-1m3-2V8a2 2 0 00-2-2H8a2 2 0 00-2 2v8m5-4h.01M9 13h.01M15 13h.01M12 13h.01M12 17h.01M9 9h.01M15 9h.01"})}),"system-config":e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"month-close":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"audit-logs":e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})};function Nu({open:t,setOpen:s}){var j;const{token:a,setToken:n}=he(),{bootstrap:l}=he(),r=ct(),o=t!==void 0,d=()=>{o&&s&&s(!1)},c=((j=l==null?void 0:l.user)==null?void 0:j.email)||"Admin";function m(...h){return h.filter(Boolean).join(" ")}const g=async()=>{try{n(null),window.location.href="/"}catch{}},x=[{id:"dashboard",label:"Dashboard",path:"/super-admin/dashboard"},{id:"reports",label:"Operations",path:"/super-admin/ops/dashboard"},{id:"reports",label:"  Inbox",path:"/super-admin/ops/inbox"},{id:"reports",label:"  Alerts",path:"/super-admin/ops/alerts"},{id:"reports",label:"  Overrides",path:"/super-admin/ops/overrides"},{id:"reports",label:"  Data Quality",path:"/super-admin/ops/data-quality"},{id:"reports",label:"Reimbursements",path:"/super-admin/reimbursements"},{id:"reports",label:"Revenue",path:"/super-admin/revenue"},{id:"reports",label:"Revenue Categories",path:"/super-admin/revenue/categories"},{id:"reports",label:"Revenue Clients",path:"/super-admin/revenue/clients"},{id:"divisions",label:"Divisions",path:"/super-admin/divisions"},{id:"projects",label:"Projects",path:"/super-admin/projects"},{id:"employees",label:"Employees",path:"/super-admin/employees"},{id:"attendance",label:"Attendance",path:"/super-admin/attendance"},{id:"timesheets",label:"Timesheets",path:"/timesheet/approvals"},{id:"leave-overview",label:"Leave Overview",path:"/super-admin/leave/overview"},{id:"system-config",label:"System Config",path:"/super-admin/system-config"},{id:"month-close",label:"Month Close",path:"/super-admin/month-close"},{id:"audit-logs",label:"Audit Logs",path:"/super-admin/audit-logs"}];return e.jsxs(e.Fragment,{children:[o&&t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:d}),o&&e.jsx("div",{className:`fixed top-0 left-0 h-full w-64 bg-gradient-to-b from-slate-50 to-white border-r border-slate-200/60 shadow-lg transform transition-transform z-50 lg:hidden ${t?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200/60 bg-white/80 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-lg flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white font-bold text-xs",children:"SA"})}),e.jsx("span",{className:"font-semibold text-slate-800 text-sm",children:"Super Admin"})]}),e.jsx("button",{onClick:d,className:"p-2 rounded-lg hover:bg-slate-100 transition-colors duration-200","aria-label":"Close sidebar",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:x.map(h=>{const f=r.pathname===h.path||h.path!=="/super-admin/dashboard"&&r.pathname.startsWith(h.path);return e.jsxs(es,{to:h.path,onClick:d,className:({isActive:u})=>m("group relative flex items-center gap-3 px-3 py-2.5 rounded-xl font-medium text-sm transition-all duration-200","hover:bg-slate-100/80",u?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 shadow-sm border border-blue-200/50":"text-slate-700 hover:text-slate-900"),children:[e.jsx("span",{className:m("flex-shrink-0 transition-transform duration-200",f?"scale-110 text-blue-600":"text-slate-500 group-hover:text-slate-700"),children:ju[h.id]}),e.jsx("span",{className:"truncate",children:h.label}),f&&e.jsx("span",{className:"absolute inset-y-0 left-0 w-1 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-r-full"})]},h.id)})}),e.jsx("div",{className:"p-4 border-t border-slate-200/60",children:e.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-xl transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]})}),e.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:left-0 lg:w-64 lg:z-10 lg:block",children:e.jsxs("div",{className:"h-full bg-gradient-to-b from-slate-50 to-white border-r border-slate-200/60 shadow-sm flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-slate-200/60",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold",children:"SA"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-800",children:"Super Admin"}),e.jsx("div",{className:"text-xs text-slate-500",children:"JASIQ CoreOps"})]})]})}),e.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:x.map(h=>{const f=r.pathname===h.path||h.path!=="/super-admin/dashboard"&&r.pathname.startsWith(h.path);return e.jsxs(es,{to:h.path,className:({isActive:u})=>m("group relative flex items-center gap-3 px-3 py-2.5 rounded-xl font-medium text-sm transition-all duration-200","hover:bg-slate-100/80",u?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 shadow-sm border border-blue-200/50":"text-slate-700 hover:text-slate-900"),children:[e.jsx("span",{className:m("flex-shrink-0 transition-transform duration-200",f?"scale-110 text-blue-600":"text-slate-500 group-hover:text-slate-700"),children:ju[h.id]}),e.jsx("span",{className:"truncate",children:h.label}),f&&e.jsx("span",{className:"absolute inset-y-0 left-0 w-1 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-r-full"})]},h.id)})}),e.jsx("div",{className:"p-3 border-t border-slate-200/60 bg-gradient-to-t from-slate-50 to-transparent",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-white/60 backdrop-blur-sm border border-slate-200/50 shadow-sm",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-slate-600 to-slate-800 rounded-full flex items-center justify-center text-white font-semibold text-sm shadow-inner",children:(c==null?void 0:c.charAt(0).toUpperCase())||"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-slate-800 text-sm truncate",children:c}),e.jsx("div",{className:"text-xs text-slate-500 truncate",children:"Super Admin"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse shadow-sm"}),e.jsx("span",{className:"text-xs text-slate-500 font-medium",children:"Online"})]})]})}),e.jsx("div",{className:"p-4 border-t border-slate-200/60",children:e.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-xl transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})})]})})]})}const qv=t=>{const s={"/super-admin/dashboard":"Dashboard","/super-admin/revenue":"Revenue","/super-admin/revenue/categories":"Revenue Categories","/super-admin/revenue/clients":"Revenue Clients","/super-admin/divisions":"Divisions","/super-admin/divisions/create":"Create Division","/super-admin/projects":"Projects","/super-admin/employees":"Employees","/super-admin/attendance":"Attendance","/timesheet/approvals":"Timesheet Approvals","/timesheet/my":"My Timesheet","/super-admin/leave/overview":"Leave Overview","/super-admin/system-config":"System Configuration","/super-admin/month-close":"Month Close","/super-admin/audit-logs":"Audit Logs"};return s[t]?s[t]:t.startsWith("/super-admin/employees/")?"Employee Profile":t.startsWith("/super-admin/divisions/")?"Division Details":t.startsWith("/timesheet/")?"Timesheet Details":"Super Admin"},Yv=t=>t.startsWith("/super-admin/dashboard")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}):t.startsWith("/super-admin/divisions")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}):t.startsWith("/super-admin/employees")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}):t.startsWith("/timesheet")?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});function yu(){const[t,s]=i.useState(!1),a=ct(),n=Ss("(max-width: 1023px)"),l=Ss("(min-width: 768px) and (max-width: 1023px)"),r=qv(a.pathname),o=Yv(a.pathname);return e.jsxs("div",{className:"h-screen flex overflow-hidden",children:[e.jsx("aside",{className:"w-64 bg-white border-r hidden lg:flex flex-col",children:e.jsx(Nu,{})}),e.jsx(Nu,{open:t,setOpen:s}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 text-white shadow-lg border-b border-slate-700/50 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 lg:px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:()=>s(!0),className:"lg:hidden p-2.5 rounded-xl hover:bg-white/10 transition-all duration-200 active:scale-95","aria-label":"Open menu",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white/10 backdrop-blur-sm",children:o}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold tracking-tight text-white",children:r}),!n&&e.jsx("p",{className:"text-xs text-slate-300 mt-0.5",children:"JASIQ CoreOps Platform"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[l&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"JC"})}),e.jsx("span",{className:"text-sm font-semibold text-white",children:"CoreOps"})]}),!n&&!l&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold",children:"JC"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-white",children:"JASIQ CoreOps"}),e.jsx("div",{className:"text-xs text-slate-300",children:"Super Admin Panel"})]})]})]})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-gradient-to-br from-slate-50 via-white to-slate-50",children:e.jsx("div",{className:"px-4 py-6 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:e.jsx(_l,{})})})]})]})}function Gv(){return e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Not found"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"The requested page does not exist."})]})}function de({message:t="Loading"}){return e.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-slate-200 rounded-full"}),e.jsx("div",{className:"absolute top-0 left-0 w-12 h-12 border-4 border-blue-500 rounded-full border-t-transparent animate-spin"})]}),e.jsx("p",{className:"text-slate-600 font-medium",children:t})]})}function ye({title:t,description:s,action:a}){return e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-slate-100 to-slate-200 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:e.jsx("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:t}),e.jsx("p",{className:"text-slate-600 mb-4",children:s}),a&&e.jsx("div",{className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-medium rounded-xl transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98]",children:a})]})}function ge({error:t}){var o;const{bootstrap:s}=he();if((((o=s==null?void 0:s.rbac)==null?void 0:o.roles)||[]).includes("SUPER_ADMIN"))return e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:e.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Access Granted"}),e.jsx("p",{className:"text-slate-600",children:"As SUPER_ADMIN, you have access to all resources."})]});const l=t==null?void 0:t.requiredPermission,r=t==null?void 0:t.message;return e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-rose-100 to-pink-100 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:e.jsx("svg",{className:"w-8 h-8 text-rose-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-600",children:r==="Forbidden"&&l?`Required permission: ${l}`:r||"You don't have permission to access this resource."})]})}function le({error:t,onRetry:s}){return(t==null?void 0:t.status)===403?e.jsx(ge,{error:t}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-rose-100 to-pink-100 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:e.jsx("svg",{className:"w-8 h-8 text-rose-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:(t==null?void 0:t.title)||"Something went wrong"}),e.jsx("p",{className:"text-slate-600 mb-4",children:(t==null?void 0:t.message)||"An unexpected error occurred."}),s&&e.jsxs("button",{onClick:s,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-medium rounded-xl transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98]",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Try Again"]})]})}function Qv(t){const s=String(t||""),a="=".repeat((4-s.length%4)%4);return s.replace(/-/g,"+").replace(/_/g,"/")+a}function va({allowedRoles:t,children:s}){var c,m,g;const{status:a,bootstrap:n,token:l}=he();if(a==="idle")return e.jsx(zt,{to:"/login",replace:!0});if(a==="loading"||!n||!(n!=null&&n.rbac))return e.jsx(de,{message:"Loading"});const r=((c=n==null?void 0:n.rbac)==null?void 0:c.roles)||[];if(r.includes("SUPER_ADMIN"))return s;let o=r;if(r.length===0&&l)try{const x=JSON.parse(atob(Qv(l.split(".")[1]))),j=x.role||((m=x==null?void 0:x.claims)==null?void 0:m.role)||((g=x==null?void 0:x.roles)==null?void 0:g[0]);if(j&&(o=[j],j==="SUPER_ADMIN"))return s}catch{}return Array.isArray(t)&&t.some(x=>o.includes(x))?s:e.jsx(ge,{})}function Pe({path:t,page:s,pageSize:a,enabled:n=!0}){const[l,r]=i.useState("idle"),[o,d]=i.useState(null),[c,m]=i.useState(null),[g,x]=i.useState(0),j=i.useCallback(()=>{x(f=>f+1)},[]),h=i.useMemo(()=>{const f=new URL(t,"http://local");return f.searchParams.set("page",String(s)),f.searchParams.set("pageSize",String(a)),f.pathname+f.search},[t,s,a]);return i.useEffect(()=>{if(!n)return;let f=!0;async function u(){r("loading"),m(null);try{const b=await z(h);if(!f)return;d(b),r("ready")}catch(b){if(!f)return;m(b),r("error")}}return u(),()=>{f=!1}},[h,n,g]),{status:l,data:o,error:c,url:h,refresh:j}}function Jv(t){switch(t){case"SUPER_ADMIN":return"/super-admin";case"HR_ADMIN":return"/hr";case"FINANCE_HEAD":return"/finance";case"MANAGER":return"/manager";case"EMPLOYEE":return"/employee";default:return""}}function Ac(t){const s=t==null?void 0:t[0];return Jv(s)}function Lh(t){return`${Ac(t)}/employees`}function Kv(t){return`${Ac(t)}/employees/add`}function wu(t,s){return`${Ac(t)}/employees/${s}`}function Xv(){var E;const t=Ue(),{bootstrap:s}=he(),a=((E=s==null?void 0:s.rbac)==null?void 0:E.permissions)||[],n=a.includes("EMPLOYEE_READ"),l=a.includes("LEAVE_REQUEST_READ"),r=a.includes("ATTENDANCE_CORRECT"),o=a.includes("LEAVE_OVERRIDE"),[d,c]=i.useState(0),[m,g]=i.useState(0),[x,j]=i.useState(0),[h,f]=i.useState(0),[u,b]=i.useState({status:"open",message:"Month is open for corrections"}),[p,y]=i.useState([]),[w,S]=i.useState(!0);i.useEffect(()=>{(async()=>{try{S(!0);const A=new Date().toISOString().slice(0,7);if(l)try{const C=await z("/api/v1/leave/requests?status=PENDING&limit=1");c((C==null?void 0:C.total)||0)}catch(C){console.warn("Failed to fetch leave approvals:",C)}if(n)try{const C=await z("/api/v1/employees?limit=1");g((C==null?void 0:C.total)||0)}catch(C){console.warn("Failed to fetch employees:",C)}if(r)try{const C=new Date().toISOString().slice(0,7),k=await z(`/api/v1/attendance/hr-month?month=${C}`);console.log("[HR Dashboard] Raw attendance data:",k);let D=[];if(k!=null&&k.records&&Array.isArray(k.records))D=k.records;else if(k!=null&&k.items&&Array.isArray(k.items))D=k.items;else if(k!=null&&k.attendances&&Array.isArray(k.attendances))D=k.attendances;else if(Array.isArray(k))D=k;else{console.warn("[HR Dashboard] No attendance records array found in response"),j(0);return}const R=D.filter(L=>{const _=JSON.stringify(L).toLowerCase();return(L==null?void 0:L.status)==="ABSENT"||(L==null?void 0:L.source)==="MANUAL"||_.includes("override")||_.includes("manual")}).length;j(R),console.log("[HR Dashboard] Attendance corrections calculated:",{totalRecords:D.length,correctionsNeeded:R,month:C,sampleRecords:D.slice(0,3)})}catch(C){console.warn("Failed to fetch attendance corrections:",C),j(0)}if(o)try{const C=new Date().toISOString().slice(0,7),k=await z(`/api/v1/leave/requests?month=${C}&override=true&limit=1`);f((k==null?void 0:k.total)||0)}catch(C){console.warn("Failed to fetch leave overrides:",C),f(0)}try{const C=await z(`/api/v1/governance/month-close?month=${A}`);if(C!=null&&C.isClosed)b({status:"locked",message:"Month is locked - corrections disabled"});else{const k=new Date(new Date().getFullYear(),new Date().getMonth()+1,0),R=Math.ceil((k-new Date)/(1e3*60*60*24));R<=3?b({status:"closing",message:`Month closes in ${R} days`}):b({status:"open",message:"Month is open for corrections"})}}catch(C){console.warn("Failed to fetch month close status:",C),b({status:"open",message:"Month is open for corrections"})}const T=[];l&&d>0&&T.push(`${d} pending L2 leave approval${d===1?"":"s"} require attention`),u.status==="closing"&&T.push("Month close approaching - submit corrections soon"),u.status==="locked"&&r&&T.push("Month locked - attendance corrections disabled"),y(T)}catch(A){console.error("Dashboard data fetch error:",A)}finally{S(!1)}})()},[n,l,r,o,d]),i.useEffect(()=>{const v=A=>{console.log("[HR Dashboard] Received attendance update event:",A.detail),r&&(async()=>{try{const C=new Date().toISOString().slice(0,7),k=await z(`/api/v1/attendance/hr-month?month=${C}`);console.log("[HR Dashboard] Event refresh - Raw attendance data:",k);let D=[];if(k!=null&&k.records&&Array.isArray(k.records))D=k.records;else if(k!=null&&k.items&&Array.isArray(k.items))D=k.items;else if(k!=null&&k.attendances&&Array.isArray(k.attendances))D=k.attendances;else if(Array.isArray(k))D=k;else{console.warn("[HR Dashboard] Event refresh - No attendance records array found");return}const R=D.filter(L=>{const _=JSON.stringify(L).toLowerCase();return(L==null?void 0:L.status)==="ABSENT"||(L==null?void 0:L.source)==="MANUAL"||_.includes("override")||_.includes("manual")}).length;console.log("[HR Dashboard] Event refresh - Updated attendance corrections:",R),j(R)}catch(C){console.warn("Failed to refresh attendance corrections:",C)}})(),fetchDashboardData()};return window.addEventListener("attendanceDataUpdated",v),()=>{window.removeEventListener("attendanceDataUpdated",v)}},[n,l,r,o]);const N=v=>{try{console.log("Navigating to:",v),t(v)}catch(A){console.error("Navigation failed:",A),window.location.href=v}};return w?e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n&&e.jsxs("div",{onClick:()=>{var v;return N(Lh((v=s==null?void 0:s.rbac)==null?void 0:v.roles))},className:"group cursor-pointer rounded-xl border border-slate-200 p-4 text-center transition-all duration-200 hover:shadow-lg hover:border-blue-300 hover:bg-blue-50",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-blue-200 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-blue-700 transition-colors",children:"Employees"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Manage employees"}),m>0&&e.jsx("p",{className:"text-2xl font-bold text-slate-900 mt-2",children:m})]}),l&&e.jsxs("div",{onClick:()=>N("/hr/governance/leave-balances"),className:"group cursor-pointer rounded-xl border border-slate-200 p-4 text-center transition-all duration-200 hover:shadow-lg hover:border-emerald-300 hover:bg-emerald-50",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-emerald-200 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-emerald-700 transition-colors",children:"Leave Balances"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Manage leave balances"}),d>0&&e.jsx("p",{className:"text-2xl font-bold text-emerald-600 mt-2",children:d})]}),r&&e.jsxs("div",{onClick:()=>N("/hr/attendance"),className:"group cursor-pointer rounded-xl border border-slate-200 p-4 text-center transition-all duration-200 hover:shadow-lg hover:border-purple-300 hover:bg-purple-50",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-purple-200 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-purple-700 transition-colors",children:"Attendance"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Correct attendance"}),x>0&&e.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-2",children:x})]}),a.includes("LEAVE_MONTH_CLOSE_OVERRIDE")&&e.jsxs("div",{onClick:()=>N("/hr/governance/month-close"),className:"group cursor-pointer rounded-xl border border-slate-200 p-4 text-center transition-all duration-200 hover:shadow-lg hover:border-amber-300 hover:bg-amber-50",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-amber-200 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-amber-700 transition-colors",children:"Month Close"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Close month"}),e.jsx("div",{className:`mt-2 px-2 py-1 rounded-full text-xs font-medium ${u.status==="locked"?"bg-red-100 text-red-700":u.status==="warning"?"bg-amber-100 text-amber-700":"bg-green-100 text-green-700"}`,children:u.status})]})]}),p.length>0&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:[e.jsx("h3",{className:"font-semibold text-amber-900 mb-2",children:"Critical Alerts"}),e.jsx("ul",{className:"space-y-1",children:p.map((v,A)=>e.jsxs("li",{className:"text-sm text-amber-800",children:[" ",v]},A))})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-slate-900 mb-4",children:"Month Status"}),e.jsx("div",{className:`p-4 rounded-lg ${u.status==="locked"?"bg-red-50 border border-red-200":u.status==="warning"?"bg-amber-50 border border-amber-200":"bg-green-50 border border-green-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${u.status==="locked"?"bg-red-500":u.status==="warning"?"bg-amber-500":"bg-green-500"}`}),e.jsx("p",{className:"text-slate-900 font-medium",children:u.message})]})})]})]})}function Be(t){const[s,a]=i.useState("idle"),[n,l]=i.useState(null),r=i.useCallback(async(...o)=>{a("loading"),l(null);try{const d=await t(...o);return a("success"),d}catch(d){throw l(d),a("error"),d}},[t]);return{status:s,error:n,run:r}}function cn(...t){return t.filter(Boolean).join(" ")}function Zv({divisionId:t,scope:s,status:a}){const n=new URL("/api/v1/employees","http://local");return t&&n.searchParams.set("divisionId",t),s&&n.searchParams.set("scope",s),a&&n.searchParams.set("status",a),n.pathname+n.search}function ao(t){const s=String((t==null?void 0:t.firstName)||"").trim(),a=String((t==null?void 0:t.lastName)||"").trim(),n=s?s[0]:"",l=a?a[0]:"";return(n+l).toUpperCase()||""}function no({name:t,className:s}){const a={className:cn("h-4 w-4",s),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};return t==="filter"?e.jsx("svg",{...a,children:e.jsx("path",{d:"M3 5h18M6 12h12M10 19h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):t==="search"?e.jsx("svg",{...a,children:e.jsx("path",{d:"M21 21l-4.35-4.35m1.35-5.65a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):t==="chevron"?e.jsx("svg",{...a,children:e.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):t==="x"?e.jsx("svg",{...a,children:e.jsx("path",{d:"M18 6 6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):t==="edit"?e.jsxs("svg",{...a,children:[e.jsx("path",{d:"M12 20h9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}):t==="download"?e.jsxs("svg",{...a,children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M7 10l5 5 5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 15V3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}):null}function lo(t){const s=String(t||"").toUpperCase(),a=s==="ACTIVE"?"Active":s==="ON_HOLD"?"Locked":s==="EXITED"?"Closed":s||"",n=s==="ACTIVE"?"bg-emerald-50 text-emerald-700 ring-emerald-200":s==="ON_HOLD"?"bg-amber-50 text-amber-800 ring-amber-200":s==="EXITED"?"bg-rose-50 text-rose-700 ring-rose-200":"bg-slate-50 text-slate-700 ring-slate-200";return e.jsx("span",{className:cn("inline-flex items-center rounded-full px-2 py-1 text-xs font-semibold ring-1 ring-inset",n),children:a})}function ro(t,s=null){const a=String(t||"").toUpperCase();if(a==="COMPANY")return e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-slate-100 text-slate-700",children:"Shared"});if(a==="DIVISION"){const n=s||"#3B82F6";return e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full border",style:{borderColor:n,color:n},children:"DIVISION"})}return e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-slate-100 text-slate-800",children:""})}function nr(t){const s=(t==null?void 0:t.firstName)||"",a=(t==null?void 0:t.lastName)||"";return`${s} ${a}`.trim()||""}function eb(t,s){if(!s)return"";const a=t[s];return a?`${a.code}  ${a.name}`:s.slice(0,8)+""}function Dh(){var Ie,ze,rt,qe,it,mt,Mt,Vs,As,St;const{bootstrap:t}=he();(rt=(ze=(Ie=t==null?void 0:t.ui)==null?void 0:Ie.screens)==null?void 0:ze.employees)!=null&&rt.title;const s=Ue(),a=((qe=t==null?void 0:t.rbac)==null?void 0:qe.permissions)||[],n=a.includes("SYSTEM_FULL_ACCESS"),l=n||a.includes("EMPLOYEE_WRITE");n||a.includes("EMPLOYEE_COMPENSATION_WRITE"),n||a.includes("EMPLOYEE_DOCUMENT_WRITE");const[r,o]=i.useState(1),[d]=i.useState(20),[c,m]=i.useState(""),[g,x]=i.useState(""),[j,h]=i.useState(""),[f,u]=i.useState(""),[b,p]=i.useState("grid"),[y,w]=i.useState(!1),S=Pe({path:"/api/v1/governance/divisions",page:1,pageSize:200,enabled:!0}),N=i.useMemo(()=>{var Ve;const fe=((Ve=S.data)==null?void 0:Ve.items)||[],Oe={};for(const Ye of fe)Oe[Ye.id]=Ye;return Oe},[S.data]),E=Pe({path:Zv({divisionId:c||null,scope:g||null,status:j||null}),page:r,pageSize:d,enabled:!0}),v=((it=E.data)==null?void 0:it.items)||[],A=((mt=E.data)==null?void 0:mt.total)||0,T=i.useMemo(()=>{const fe=String(f||"").trim().toLowerCase();return fe?v.filter(Oe=>{const Ve=String(Oe.employeeCode||"").toLowerCase(),Ye=nr(Oe).toLowerCase();return Ve.includes(fe)||Ye.includes(fe)}):v},[v,f]);i.useMemo(()=>{const fe={ACTIVE:0,ON_HOLD:0,EXITED:0},Oe={COMPANY:0,DIVISION:0},Ve={};for(const Ye of v){Ye.status&&fe[Ye.status]!==void 0&&(fe[Ye.status]+=1),Ye.scope&&Oe[Ye.scope]!==void 0&&(Oe[Ye.scope]+=1);const Jt=Ye.primaryDivisionId||"";Jt&&(Ve[Jt]=(Ve[Jt]||0)+1)}return{statusCounts:fe,scopeCounts:Oe,divisionCounts:Ve}},[v]);const[C,k]=i.useState(null),[D,R]=i.useState("profile"),[L,_]=i.useState({status:"idle",data:null,error:null,refreshIndex:0});i.useEffect(()=>{let fe=!0;async function Oe(){if(!C){_(Ve=>({...Ve,status:"idle",data:null,error:null}));return}_(Ve=>({...Ve,status:"loading",error:null}));try{const Ve=await z(`/api/v1/employees/${C}`);if(!fe)return;_(Ye=>({...Ye,status:"ready",data:Ve,error:null}))}catch(Ve){if(!fe)return;_(Ye=>({...Ye,status:"error",error:Ve}))}}return Oe(),()=>{fe=!1}},[C,L.refreshIndex]);const I=((Mt=L.data)==null?void 0:Mt.item)||null;I==null||I.status;const[G,O]=i.useState({status:"idle",data:null,error:null,refreshIndex:0});i.useEffect(()=>{let fe=!0;async function Oe(){if(!(!C||D!=="compensation")){O(Ve=>({...Ve,status:"loading",error:null}));try{const Ve=await z(`/api/v1/employees/${C}/compensation`);if(!fe)return;O(Ye=>({...Ye,status:"ready",data:Ve,error:null}))}catch(Ve){if(!fe)return;O(Ye=>({...Ye,status:"error",error:Ve}))}}}return Oe(),()=>{fe=!1}},[C,D,G.refreshIndex]);const[F,W]=i.useState({status:"idle",data:null,error:null,refreshIndex:0});i.useEffect(()=>{let fe=!0;async function Oe(){if(!(!C||D!=="documents")){W(Ve=>({...Ve,status:"loading",error:null}));try{const Ve=await z(`/api/v1/employees/${C}/documents`);if(!fe)return;W(Ye=>({...Ye,status:"ready",data:Ve,error:null}))}catch(Ve){if(!fe)return;W(Ye=>({...Ye,status:"error",error:Ve}))}}}return Oe(),()=>{fe=!1}},[C,D,F.refreshIndex]),Be(async fe=>z("/api/v1/employees",{method:"POST",body:fe,headers:fe!=null&&fe.idempotencyKey?{"x-idempotency-key":fe.idempotencyKey}:void 0})),Be(async({id:fe,payload:Oe})=>z(`/api/v1/employees/${fe}`,{method:"PATCH",body:Oe})),Be(async({id:fe,payload:Oe})=>z(`/api/v1/employees/${fe}/change-scope`,{method:"POST",body:Oe})),Be(async({id:fe,payload:Oe})=>z(`/api/v1/employees/${fe}/change-status`,{method:"POST",body:Oe})),Be(async({id:fe,payload:Oe})=>z(`/api/v1/employees/${fe}/compensation`,{method:"POST",body:Oe})),Be(async({id:fe,payload:Oe})=>z(`/api/v1/employees/${fe}/documents`,{method:"POST",body:Oe})),Be(async({id:fe,docId:Oe})=>z(`/api/v1/employees/${fe}/documents/${Oe}/download`));const[$,M]=i.useState(!1),[P,V]=i.useState("create"),[U,B]=i.useState(""),[Q,ae]=i.useState(""),[ie,we]=i.useState(""),[De,Z]=i.useState(""),[ve,ue]=i.useState(""),[re,Re]=i.useState("ACTIVE"),[ne,H]=i.useState("COMPANY"),[te,q]=i.useState(""),[Y,xe]=i.useState(""),[J,me]=i.useState("");i.useRef(!1);const[K,be]=i.useState(!1),[je,pe]=i.useState("COMPANY"),[Ae,Se]=i.useState(""),[Me,ce]=i.useState(""),[Ce,xt]=i.useState(!1),[hs,Es]=i.useState("ACTIVE"),[ht,Ot]=i.useState(""),[ps,Vt]=i.useState(!1),[fs,Pn]=i.useState(""),[Ia,In]=i.useState("USD"),[pa,On]=i.useState("MONTHLY"),[Ul,_n]=i.useState(""),[Cs,Oa]=i.useState(""),[_a,fa]=i.useState(!1),[Ba,Fa]=i.useState(""),[Ua,ga]=i.useState(""),[$a,Va]=i.useState(""),[za,$s]=i.useState(""),[Wa,se]=i.useState(""),[Ne,Ee]=i.useState("");if(E.status==="loading"&&!E.data)return e.jsx(de,{});if(E.status==="error")return((Vs=E.error)==null?void 0:Vs.status)===403?e.jsx(ge,{}):e.jsx(le,{error:E.error});const Le=e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-900 text-white flex items-center justify-center text-sm font-semibold",children:I?ao(I):""}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:I?nr(I):"Employee detail"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:I?`${I.employeeCode}  ${I.email||""}`:"Select an employee to view details."})]})]})}),I?e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[lo(I.status),ro(I.scope,(I==null?void 0:I.scope)==="DIVISION"?(As=N[I==null?void 0:I.primaryDivisionId])==null?void 0:As.color:null)]}):null]}),e.jsx("div",{className:"p-4",children:C?L.status==="loading"?e.jsx(de,{message:"Loading employee"}):L.status==="error"?((St=L.error)==null?void 0:St.status)===403?e.jsx(ge,{}):e.jsx(le,{error:L.error}):I?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Employment scope impact"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:I.scope==="DIVISION"?"This employee is a DIVISION resource. Costs impact division P&L.":"This employee is a COMPANY resource. Costs roll up to company overhead."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Payroll / P&L impact"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Compensation history must remain append-only for payroll accuracy."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Month-close locking"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"When the month is closed, employee changes are locked to protect financial reporting."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Audit notes"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Sensitive actions require a reason and are recorded in Audit Logs."})]})]}):null:e.jsx(ye,{title:"No employee selected",description:"Pick someone from the directory to view employment details."})})]});return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-5",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Employees"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Employment records and financial scope"})]}),e.jsx("div",{className:"flex justify-center mb-6",children:l?e.jsxs("button",{type:"button",className:"group relative inline-flex items-center gap-3 rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-3 text-sm font-semibold text-white shadow-lg hover:shadow-xl hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 transform hover:scale-105",onClick:()=>{var fe;return s(Kv((fe=t==null?void 0:t.rbac)==null?void 0:fe.roles))},children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-white opacity-0 group-hover:opacity-20 transition-opacity"}),e.jsx("svg",{className:"w-5 h-5 relative",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"relative",children:"Add Employee"})]}):null}),e.jsx("div",{className:"bg-white border-b border-slate-200/60 shadow-sm",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[e.jsxs("div",{className:"min-w-[240px] flex-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-700 uppercase tracking-wide mb-2",children:"Search Employees"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(no,{name:"search",className:"text-slate-400"})}),e.jsx("input",{className:"w-full pl-11 pr-4 py-3 rounded-xl border border-slate-300 bg-white text-sm placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md",value:f,onChange:fe=>u(fe.target.value),placeholder:"Search by name, email, or code..."})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>p("grid"),className:`p-3 rounded-xl transition-all duration-200 ${b==="grid"?"bg-blue-100 text-blue-700 shadow-sm":"text-slate-500 hover:bg-slate-100 hover:text-slate-700"}`,children:e.jsx(no,{name:"grid",className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:()=>p("table"),className:`p-3 rounded-xl transition-all duration-200 ${b==="table"?"bg-blue-100 text-blue-700 shadow-sm":"text-slate-500 hover:bg-slate-100 hover:text-slate-700"}`,children:e.jsx(no,{name:"table",className:"w-5 h-5"})})]})]})})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),"Employees"]}),e.jsxs("div",{className:"mt-1 text-sm text-slate-600",children:["Showing ",T.length," on this page  ",e.jsx("span",{className:"font-medium text-blue-600",children:A})," total"]})]}),e.jsx("div",{className:"bg-white px-3 py-1 rounded-full border border-slate-200 shadow-sm",children:e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:["Page ",r]})})]})}),T.length===0?e.jsx("div",{className:"p-6",children:e.jsx(ye,{title:"No employees",description:"Try changing filters or search."})}):e.jsxs("div",{children:[e.jsx("div",{className:"sm:hidden p-3 space-y-2",children:T.map(fe=>{const Oe=C===fe.id,Ve=N[fe.primaryDivisionId],Ye=(Ve==null?void 0:Ve.color)||"#3B82F6";return e.jsx("div",{className:cn("w-full text-left rounded-2xl border p-5 transition-all duration-200 hover:shadow-lg",Oe?"border-blue-500 bg-gradient-to-r from-blue-50 to-indigo-50 shadow-md":"border-slate-200 bg-white hover:border-slate-300 hover:bg-slate-50"),role:"button",tabIndex:0,onClick:()=>{k(fe.id),R("profile"),w(!0)},onKeyDown:Jt=>{(Jt.key==="Enter"||Jt.key===" ")&&(Jt.preventDefault(),k(fe.id),R("profile"),w(!0))},children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:cn("h-12 w-12 rounded-full flex items-center justify-center text-sm font-bold shadow-inner",Oe?"bg-blue-600 text-white":"bg-gradient-to-br from-slate-700 to-slate-900 text-white"),children:ao(fe)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:cn("text-base font-semibold truncate",Oe?"text-blue-900":"text-slate-900"),children:nr(fe)}),e.jsx("div",{className:"mt-1 font-mono text-xs text-slate-500",children:fe.employeeCode}),e.jsx("div",{className:"mt-1 text-xs text-slate-500 truncate",children:fe.email||""}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[ro(fe.scope,Ye),lo(fe.status)]})]})]}),e.jsxs("button",{type:"button",className:cn("inline-flex items-center gap-2 rounded-xl px-4 py-2 text-sm font-medium transition-all duration-200 shadow-sm hover:shadow-md",Oe?"bg-blue-600 text-white hover:bg-blue-700":"bg-white border border-slate-300 text-slate-700 hover:bg-slate-50"),onClick:Jt=>{var Bn;Jt.stopPropagation(),s(wu((Bn=t==null?void 0:t.rbac)==null?void 0:Bn.roles,fe.id))},children:["View",e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})},fe.id)})}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Employee ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Scope"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Division"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Designation"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Joined On"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:T.map(fe=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-sm text-slate-700",children:fe.employeeCode})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-slate-900 text-white flex items-center justify-center text-xs font-semibold",children:ao(fe)}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:nr(fe)}),e.jsx("div",{className:"text-xs text-slate-500",children:fe.email||""})]})]})}),e.jsx("td",{className:"px-4 py-3",children:ro(fe.scope)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-sm text-slate-700",children:fe.scope==="COMPANY"?"":eb(N,fe.primaryDivisionId)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-sm text-slate-700",children:fe.designation||""})}),e.jsx("td",{className:"px-4 py-3",children:lo(fe.status)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-sm text-slate-700",children:fe.createdAt?new Date(fe.createdAt).toLocaleDateString():""})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{type:"button",className:"inline-flex items-center gap-2 rounded-lg border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:()=>{var Oe;return s(wu((Oe=t==null?void 0:t.rbac)==null?void 0:Oe.roles,fe.id))},children:"View"})})]},fe.id))})]})})})]})]}),A>d&&e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",e.jsx("span",{className:"font-medium text-slate-900",children:(r-1)*d+1})," to"," ",e.jsx("span",{className:"font-medium text-slate-900",children:Math.min(r*d,A)})," of"," ",e.jsx("span",{className:"font-medium text-blue-600",children:A})," results"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-xl hover:bg-slate-50 hover:border-slate-400 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm",disabled:r<=1,onClick:()=>o(r-1),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"px-3 py-2 text-sm font-semibold text-slate-900 bg-blue-50 border border-blue-200 rounded-xl",children:r}),e.jsx("span",{className:"text-sm text-slate-500 mx-1",children:"of"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:Math.ceil(A/d)})]}),e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-xl hover:bg-slate-50 hover:border-slate-400 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm",disabled:r>=Math.ceil(A/d),onClick:()=>o(r+1),children:["Next",e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})}),C&&y?e.jsxs("div",{className:"fixed inset-0 z-50 bg-slate-50 xl:hidden",children:[e.jsx("div",{className:"sticky top-0 z-10 border-b border-slate-200 bg-white px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",onClick:()=>w(!1),children:"Back"}),e.jsx("div",{className:"min-w-0 text-sm font-semibold text-slate-900 truncate",children:"Employee"}),e.jsx("div",{className:"w-[68px]"})]})}),e.jsx("div",{className:"p-4",children:Le})]}):null]})}function tb(){var a;const{bootstrap:t}=he();return(((a=t==null?void 0:t.rbac)==null?void 0:a.permissions)||[]).includes("EMPLOYEE_READ")?e.jsx(Dh,{}):e.jsx(ge,{})}function Mh(){var $;const{bootstrap:t}=he(),s=Ue(),a=ct(),[n,l]=i.useState(1),[r,o]=i.useState(!1),d=()=>a.pathname.startsWith("/hr")?"/hr/employees":"/super-admin/employees",[c,m]=i.useState([]),[g,x]=i.useState(!1),[j,h]=i.useState([]),[f,u]=i.useState(!1),[b,p]=i.useState({employeeCode:"",firstName:"",lastName:"",email:"",phone:"",joiningDate:"",employmentType:"",scope:"",primaryDivisionId:"",scopeConfirmation:!1,salaryType:"",amount:"",currency:"",effectiveFrom:"",effectiveTo:"",compensationNotes:"",reportingManager:"",designation:"",roleId:"",password:""}),[y,w]=i.useState({}),S=(($=t==null?void 0:t.rbac)==null?void 0:$.roles)||[],N=S[0],E=["COREOPS_ADMIN","HR_ADMIN","FINANCE_ADMIN","FOUNDER"].includes(N),v=S.includes("SUPER_ADMIN")||S.includes("HR_ADMIN"),A=S.includes("HR_ADMIN"),T=()=>A?[{id:"EMPLOYEE",name:"Employee",description:"Basic employee access"}]:S.includes("SUPER_ADMIN")?[{id:"EMPLOYEE",name:"Employee",description:"Basic employee access"},{id:"MANAGER",name:"Manager",description:"Can manage team members"},{id:"HR_ADMIN",name:"HR Admin",description:"Full HR management access"},{id:"FINANCE_ADMIN",name:"Finance Admin",description:"Financial and payroll access"},{id:"FOUNDER",name:"Founder",description:"Founder-level access"}]:[],C=async M=>{var P,V;x(!0);try{const U=M?`?divisionId=${M}`:"",B=await z(`/api/v1/employees/eligible-managers${U}`);m(B.items||[])}catch(U){console.error("Failed to fetch reporting managers:",U),((V=(P=U==null?void 0:U.response)==null?void 0:P.data)==null?void 0:V.code)==="DIVISION_NOT_FOUND"?D(`Division not found: ${M}`,"error"):D("Failed to load reporting managers","error"),m([])}finally{x(!1)}},k=async()=>{u(!0);try{const M=await z("/api/v1/governance/divisions?page=1&pageSize=200");h(M.items||[])}catch(M){console.error("Failed to fetch divisions:",M),h([])}finally{u(!1)}};function D(M,P="info"){const V=document.createElement("div");V.className=`fixed top-4 right-4 px-4 py-3 rounded-lg shadow-lg z-50 ${P==="success"?"bg-green-500 text-white":P==="error"?"bg-red-500 text-white":"bg-blue-500 text-white"}`,V.textContent=M,document.body.appendChild(V),setTimeout(()=>{V.parentNode&&V.parentNode.removeChild(V)},3e3)}i.useEffect(()=>{A&&!b.roleId&&p(M=>({...M,roleId:"EMPLOYEE"}))},[A,b.roleId]),i.useEffect(()=>{k()},[]),i.useEffect(()=>{b.scope==="DIVISION"&&b.primaryDivisionId?C(b.primaryDivisionId):b.scope==="COMPANY"?C(null):m([])},[b.scope,b.primaryDivisionId]);const R=M=>({EMPLOYEE:"Employee",MANAGER:"Manager",HR_ADMIN:"HR Admin",FINANCE_ADMIN:"Finance Admin",FOUNDER:"Founder"})[M]||"Employee",L=(M,P,V)=>{p(U=>({...U,[P]:V})),y[P]&&w(U=>({...U,[P]:""}))},_=M=>{const P={};return M===1&&(b.employeeCode||(P.employeeCode="Employee Code is required"),b.firstName||(P.firstName="First Name is required"),b.lastName||(P.lastName="Last Name is required"),b.email||(P.email="Email is required"),b.joiningDate||(P.joiningDate="Joining Date is required"),b.employmentType||(P.employmentType="Employment Type is required")),M===2&&(b.scope||(P.scope="Employment Scope is required"),b.scope==="DIVISION"&&!b.primaryDivisionId&&(P.primaryDivisionId="Division selection is required for Division scope"),b.scopeConfirmation||(P.scopeConfirmation="Please confirm you understand the financial impact")),M===3&&E&&(b.salaryType||(P.salaryType="Salary Type is required"),b.amount||(P.amount="Amount is required"),b.currency||(P.currency="Currency is required"),b.effectiveFrom||(P.effectiveFrom="Effective From is required")),M===4&&(b.designation||(P.designation="Designation is required"),b.roleId||(P.roleId="System Role is required"),v&&(!b.password||b.password.length<8)&&(P.password="Password must be at least 8 characters long")),w(P),Object.keys(P).length===0},I=()=>{_(n)&&l(M=>Math.min(M+1,4))},G=()=>{l(M=>Math.max(M-1,1))},O=async()=>{var M,P;if(_(4)){o(!0);try{const V={employeeCode:b.employeeCode,firstName:b.firstName,lastName:b.lastName,email:b.email,phone:b.phone,password:b.password,joiningDate:b.joiningDate,employmentType:b.employmentType,status:"ACTIVE",scope:b.scope,primaryDivisionId:b.scope==="DIVISION"?b.primaryDivisionId:null,reportingManagerId:b.reportingManager||null,designation:b.designation,roleId:b.roleId};E&&b.salaryType&&(V.compensation={salaryType:b.salaryType,amount:b.amount,currency:b.currency,effectiveFrom:b.effectiveFrom,effectiveTo:b.effectiveTo||null,notes:b.compensationNotes});const U=await z("/api/v1/employees",{method:"POST",body:V}),Q=`${R(b.roleId)} created successfully`;D(Q,"success"),setTimeout(()=>{s(d())},1e3)}catch(V){console.error("Failed to create employee:",V);const U=((P=(M=V==null?void 0:V.response)==null?void 0:M.data)==null?void 0:P.message)||(V==null?void 0:V.message)||"Failed to create employee. Please try again.";D(U,"error")}finally{o(!1)}}},F=M=>({1:"Identity",2:"Scope",3:"Compensation",4:"Access"})[M],W=M=>M<n;return e.jsxs("div",{className:"flex-1 bg-white",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white border-b border-slate-200 px-6 py-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("div",{className:"lg:hidden flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-slate-600",children:["Step ",n," of 4"]}),e.jsxs("span",{className:"text-sm font-medium text-slate-900",children:["- ",F(n)]})]}),e.jsx("div",{className:"hidden lg:flex items-center gap-4 overflow-x-auto pb-2",children:[1,2,3,4].map(M=>e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("div",{className:`h-8 w-8 rounded-full flex items-center justify-center text-sm font-medium ${W(M)?"bg-green-600 text-white":M===n?"bg-slate-900 text-white":"bg-slate-200 text-slate-500"}`,children:W(M)?"":M}),e.jsx("span",{className:"text-sm whitespace-nowrap font-medium",children:F(M)})]},M))})]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-8",children:[n===1&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-900 mb-6",children:"Employee Identity"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Employee Code *"}),e.jsx("input",{type:"text",value:b.employeeCode,onChange:M=>L(1,"employeeCode",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",placeholder:"e.g., EMP001"}),y.employeeCode&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.employeeCode})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",value:b.firstName,onChange:M=>L(1,"firstName",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",placeholder:"John"}),y.firstName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:b.lastName,onChange:M=>L(1,"lastName",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",placeholder:"Doe"}),y.lastName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.lastName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:b.email,onChange:M=>L(1,"email",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",placeholder:"john.doe@company.com"}),y.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",value:b.phone,onChange:M=>L(1,"phone",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",placeholder:"+1 234 567 8900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Joining Date *"}),e.jsx("input",{type:"date",value:b.joiningDate,onChange:M=>L(1,"joiningDate",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500"}),y.joiningDate&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.joiningDate})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Employment Type *"}),e.jsxs("select",{value:b.employmentType,onChange:M=>L(1,"employmentType",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",children:[e.jsx("option",{value:"",children:"Select employment type"}),e.jsx("option",{value:"INTERN",children:"Intern"}),e.jsx("option",{value:"TRAINEE",children:"Trainee"}),e.jsx("option",{value:"CONTRACT",children:"Contract"}),e.jsx("option",{value:"FULL_TIME",children:"Full-time"})]}),y.employmentType&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.employmentType})]})]}),e.jsxs("div",{className:"mt-8 flex justify-between",children:[e.jsx("button",{onClick:()=>s(d()),className:"px-4 py-2 text-slate-600 hover:text-slate-900",children:"Cancel"}),e.jsx("button",{onClick:I,className:"px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800",children:"Continue to Scope"})]})]}),n===2&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-900 mb-2",children:"Employment Scope"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Choose how this employee's costs and contributions are tracked"}),e.jsx("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-amber-800",children:"Financial Impact Notice"}),e.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"This decision affects financial reports."})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:`border-2 rounded-lg p-6 cursor-pointer transition-colors ${b.scope==="COMPANY"?"border-slate-900 bg-slate-50":"border-slate-200 hover:border-slate-400"}`,onClick:()=>L(2,"scope","COMPANY"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"COMPANY"}),e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:"Shared Cost"})]}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-600",children:[e.jsx("li",{children:" Works across company"}),e.jsx("li",{children:" Salary treated as company overhead"}),e.jsx("li",{children:" Not counted in division P&L"}),e.jsx("li",{children:" Timesheet mandatory"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${b.scope==="COMPANY"?"border-slate-900 bg-slate-900":"border-slate-300"}`,children:b.scope==="COMPANY"&&e.jsx("div",{className:"w-full h-full rounded-full bg-white scale-50"})})})]}),e.jsxs("div",{className:`border-2 rounded-lg p-6 cursor-pointer transition-colors ${b.scope==="DIVISION"?"border-slate-900 bg-slate-50":"border-slate-200 hover:border-slate-400"}`,onClick:()=>L(2,"scope","DIVISION"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"DIVISION"}),e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"Dedicated Resource"})]}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-600",children:[e.jsx("li",{children:" Salary belongs to one division"}),e.jsx("li",{children:" Appears in division P&L"}),e.jsx("li",{children:" Division selection mandatory"}),e.jsx("li",{children:" Cost tracking by division"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${b.scope==="DIVISION"?"border-slate-900 bg-slate-900":"border-slate-300"}`,children:b.scope==="DIVISION"&&e.jsx("div",{className:"w-full h-full rounded-full bg-white scale-50"})})})]})]}),b.scope==="DIVISION"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Select Division *"}),e.jsxs("select",{value:b.primaryDivisionId,onChange:M=>L(2,"primaryDivisionId",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",disabled:f,children:[e.jsx("option",{value:"",children:f?"Loading divisions...":"Select a division"}),j.map(M=>e.jsx("option",{value:M.id,children:M.name},M.id))]}),y.primaryDivisionId&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.primaryDivisionId})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",checked:b.scopeConfirmation,onChange:M=>L(2,"scopeConfirmation",M.target.checked),className:"mt-1 w-4 h-4 text-slate-900 border-slate-300 rounded focus:ring-slate-500"}),e.jsx("span",{className:"text-sm text-slate-700",children:"I understand this decision affects financial reporting."})]}),y.scopeConfirmation&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.scopeConfirmation})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:G,className:"px-4 py-2 text-slate-600 hover:text-slate-900",children:" Back"}),e.jsx("button",{onClick:I,className:"px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800",children:"Continue to Compensation"})]})]}),n===3&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-900 mb-6",children:"Compensation"}),E?e.jsxs("div",{children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Audit Notice"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Compensation history is preserved for audit accuracy. This is append-only."})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Salary Type *"}),e.jsxs("select",{value:b.salaryType,onChange:M=>L(3,"salaryType",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",children:[e.jsx("option",{value:"",children:"Select salary type"}),e.jsx("option",{value:"MONTHLY_FIXED",children:"Monthly Fixed"}),e.jsx("option",{value:"STIPEND",children:"Stipend"})]}),y.salaryType&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.salaryType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Amount *"}),e.jsx("input",{type:"number",value:b.amount,onChange:M=>L(3,"amount",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",placeholder:"5000"}),y.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Currency *"}),e.jsxs("select",{value:b.currency,onChange:M=>L(3,"currency",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",children:[e.jsx("option",{value:"",children:"Select currency"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"GBP",children:"GBP"}),e.jsx("option",{value:"INR",children:"INR"})]}),y.currency&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.currency})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Effective From *"}),e.jsx("input",{type:"date",value:b.effectiveFrom,onChange:M=>L(3,"effectiveFrom",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500"}),y.effectiveFrom&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.effectiveFrom})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"End Date (Optional)"}),e.jsx("input",{type:"date",value:b.effectiveTo,onChange:M=>L(3,"effectiveTo",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Notes"}),e.jsx("textarea",{value:b.compensationNotes,onChange:M=>L(3,"compensationNotes",M.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",placeholder:"Any additional notes about compensation..."})]})]})]}):e.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-6 text-center",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Access Restricted"}),e.jsx("p",{className:"text-slate-600 mb-4",children:"Only HR Admin, Finance Admin, and Founder can set compensation details."}),e.jsx("p",{className:"text-sm text-slate-500",children:"You can skip this step and proceed to access configuration."})]}),e.jsxs("div",{className:"mt-8 flex justify-between",children:[e.jsx("button",{onClick:G,className:"px-4 py-2 text-slate-600 hover:text-slate-900",children:" Back"}),e.jsx("button",{onClick:I,className:"px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800",children:"Continue to Access"})]})]}),n===4&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-slate-900 mb-6",children:"Access & Reporting"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Reporting Manager"}),e.jsxs("select",{value:b.reportingManager,onChange:M=>L(4,"reportingManager",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",disabled:g,children:[e.jsx("option",{value:"",children:"Select manager (optional)"}),c.map(M=>e.jsxs("option",{value:M.id,children:[M.name,M.designation?` - ${M.designation}`:""]},M.id))]}),g&&e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Loading managers..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Designation *"}),e.jsx("input",{type:"text",value:b.designation,onChange:M=>L(4,"designation",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",placeholder:"Software Engineer"}),y.designation&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.designation})]}),v&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Password *"}),e.jsx("input",{type:"password",value:b.password,onChange:M=>L(4,"password",M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500",placeholder:"Minimum 8 characters",minLength:8,required:!0}),y.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.password})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"System Role *"}),A&&e.jsx("div",{className:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"}),' As HR Admin, you can only create employees with the "Employee" role.']})}),e.jsxs("div",{className:"space-y-3",children:[T().map(M=>e.jsxs("label",{className:"flex items-center p-3 border border-slate-200 rounded-lg cursor-pointer hover:bg-slate-50",children:[e.jsx("input",{type:"radio",name:"systemRole",value:M.id,checked:b.roleId===M.id,onChange:P=>L(4,"roleId",P.target.value),className:"mr-3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-medium text-slate-900",children:M.name})}),e.jsx("p",{className:"text-sm text-slate-600",children:M.description})]})]},M.id)),T().length===0&&e.jsx("div",{className:"text-center py-4 text-slate-600",children:"No roles available for assignment."})]}),y.roleId&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.roleId})]})]}),e.jsxs("div",{className:"mt-8 flex justify-between",children:[e.jsx("button",{onClick:G,className:"px-4 py-2 text-slate-600 hover:text-slate-900",children:" Back"}),e.jsx("button",{onClick:O,disabled:r,className:"px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 disabled:bg-slate-300",children:r?"Creating Employee...":"Create Employee"})]})]})]})]})}function sb(){var a;const{bootstrap:t}=he();return(((a=t==null?void 0:t.rbac)==null?void 0:a.permissions)||[]).includes("EMPLOYEE_WRITE")?e.jsx(Mh,{}):e.jsx(ge,{})}function Rh(...t){return t.filter(Boolean).join(" ")}function ab(t){const s=t instanceof Date?t:new Date(t);return new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth()+1,0)).toISOString().slice(0,10)}function Su(t){const s=String((t==null?void 0:t.firstName)||"").trim(),a=String((t==null?void 0:t.lastName)||"").trim();return[s,a].filter(Boolean).join(" ").trim()||""}function nb(t){const s=String((t==null?void 0:t.firstName)||"").trim(),a=String((t==null?void 0:t.lastName)||"").trim(),n=s?s[0]:"",l=a?a[0]:"";return(n+l).toUpperCase()||""}function lb(t,s){if(!s)return"";const a=t[s];return a?`${a.code}  ${a.name}`:String(s).slice(0,8)+""}function ku(t){const s=String(t||"").toUpperCase(),a=s==="ACTIVE"?"Active":s==="ON_HOLD"?"Locked":s==="EXITED"?"Closed":s||"",n=s==="ACTIVE"?"bg-emerald-50 text-emerald-700 ring-emerald-200":s==="ON_HOLD"?"bg-amber-50 text-amber-800 ring-amber-200":s==="EXITED"?"bg-rose-50 text-rose-700 ring-rose-200":"bg-slate-50 text-slate-700 ring-slate-200";return e.jsx("span",{className:Rh("inline-flex items-center rounded-full px-2 py-1 text-xs font-semibold ring-1 ring-inset",n),children:a})}function Eu(t,s){const a=String(t||"").toUpperCase();if(a==="COMPANY")return e.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-700",children:"Shared"});if(a==="DIVISION"){const n=s;return e.jsx("span",{className:"inline-flex items-center rounded-full border px-2 py-1 text-xs font-semibold",style:{borderColor:n,color:n},children:"DIVISION"})}return e.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-700",children:""})}function lr({name:t,className:s}){const a={className:Rh("h-4 w-4",s),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};return t==="x"?e.jsx("svg",{...a,children:e.jsx("path",{d:"M18 6 6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):null}function Th(){var Ve,Ye,Jt,Bn,Oc,_c,Bc,Fc,Uc,$c,Vc,zc,Wc,Hc,qc;const{bootstrap:t}=he(),{id:s}=Dt(),a=Ue(),n=s;i.useEffect(()=>{var X;s||a(Lh((X=t==null?void 0:t.rbac)==null?void 0:X.roles),{replace:!0})},[s,a,t]);const l=((Ve=t==null?void 0:t.rbac)==null?void 0:Ve.permissions)||[],r=((Ye=t==null?void 0:t.rbac)==null?void 0:Ye.roles)||[],o=((Jt=t==null?void 0:t.features)==null?void 0:Jt.flags)||{},d=(t==null?void 0:t.systemConfig)||{},c=l.includes("SYSTEM_FULL_ACCESS"),m=!!(o!=null&&o.MONTH_CLOSE_ENABLED),g=c||l.includes("GOV_MONTH_CLOSE_READ"),x=c||l.includes("GOV_AUDIT_READ"),j=c||l.includes("EMPLOYEE_WRITE");c||l.includes("EMPLOYEE_COMPENSATION_WRITE");const h=c||l.includes("EMPLOYEE_DOCUMENT_WRITE");r.includes("HR_ADMIN"),r.includes("HR_ADMIN")||r.includes("FINANCE_ADMIN")||r.includes("FOUNDER");const f=c||l.includes("ATTENDANCE_READ"),u=c||l.includes("TIMESHEET_READ"),b=((Bn=d==null?void 0:d.TIMESHEET_ENABLED)==null?void 0:Bn.value)??(d==null?void 0:d.TIMESHEET_ENABLED),p=["true","1","yes","enabled","on"].includes(String(b??"").trim().toLowerCase()),y=Pe({path:"/api/v1/governance/divisions",page:1,pageSize:200,enabled:!0}),w=i.useMemo(()=>{var _e;const X=((_e=y.data)==null?void 0:_e.items)||[],Qe={};for(const jt of X)Qe[jt.id]=jt;return Qe},[y.data]),[S,N]=i.useState({status:"idle",data:null,error:null,refreshIndex:0}),E=()=>N(X=>({...X,refreshIndex:X.refreshIndex+1}));i.useEffect(()=>{let X=!0;async function Qe(){if(s){N(_e=>({..._e,status:"loading",error:null}));try{const _e=await z(`/api/v1/employees/${s}`);if(!X)return;N(jt=>({...jt,status:"ready",data:_e,error:null}))}catch(_e){if(!X)return;N(jt=>({...jt,status:"error",error:_e}))}}}return Qe(),()=>{X=!1}},[s,S.refreshIndex]);const v=((Oc=S.data)==null?void 0:Oc.item)||null,A=v!=null&&v.primaryDivisionId?w[v.primaryDivisionId]:null,T=(A==null?void 0:A.color)||"#3B82F6",C=["SUPER_ADMIN","ADMIN","COREOPS_ADMIN"],k=["EMPLOYEE","MANAGER","HR_ADMIN","FINANCE_ADMIN","FOUNDER"],D=(r||[]).filter(X=>C.includes(X));D.includes("SUPER_ADMIN")||D.includes("ADMIN"),((v==null?void 0:v.systemRoles)||[]).filter(X=>C.includes(X));const R=((v==null?void 0:v.functionalRoles)||[]).filter(X=>k.includes(X)),[L,_]=i.useState(!1),[I,G]=i.useState(["EMPLOYEE"]),[O,F]=i.useState("");i.useEffect(()=>{const X=Array.isArray(R)?R:[],Qe=Array.from(new Set([...X,"EMPLOYEE"])).filter(_e=>k.includes(_e));G(Qe),_(!1),F("")},[s,S.refreshIndex,v==null?void 0:v.id]);const W=i.useMemo(()=>ab(new Date),[]),$=Pe({path:"/api/v1/governance/month-close",page:1,pageSize:200,enabled:m&&g}),M=i.useMemo(()=>{var Qe;const X=new Set;for(const _e of((Qe=$.data)==null?void 0:Qe.items)||[]){const jt=(_e==null?void 0:_e.monthEnd)||(_e==null?void 0:_e.monthStart)||(_e==null?void 0:_e.month);jt&&String((_e==null?void 0:_e.status)||"").toUpperCase()==="CLOSED"&&X.add(String(jt).slice(0,10))}return X},[$.data]),V=!!(W&&m&&g&&M.has(W));Be(async({id:X,payload:Qe})=>z(`/api/v1/employees/${X}`,{method:"PATCH",body:Qe}));const[U,B]=i.useState({status:"idle",data:null,error:null,refreshIndex:0}),Q=()=>B(X=>({...X,refreshIndex:X.refreshIndex+1}));i.useEffect(()=>{let X=!0;async function Qe(){if(s){B(_e=>({..._e,status:"loading",error:null}));try{const _e=await z(`/api/v1/employees/${s}/compensation`);if(!X)return;B(jt=>({...jt,status:"ready",data:_e,error:null}))}catch(_e){if(!X)return;B(jt=>({...jt,status:"error",error:_e}))}}}return Qe(),()=>{X=!1}},[s,U.refreshIndex]);const ae=((_c=U.data)==null?void 0:_c.items)||((Bc=U.data)==null?void 0:Bc.item)||((Fc=U.data)==null?void 0:Fc.data)||((Uc=U.data)==null?void 0:Uc.versions)||(($c=U.data)==null?void 0:$c.history)||[],ie=Array.isArray(ae)?ae:[],[we,De]=i.useState({status:"idle",data:null,error:null,refreshIndex:0}),Z=()=>De(X=>({...X,refreshIndex:X.refreshIndex+1}));i.useEffect(()=>{let X=!0;async function Qe(){if(s){De(_e=>({..._e,status:"loading",error:null}));try{const _e=await z(`/api/v1/employees/${s}/documents`);if(!X)return;De(jt=>({...jt,status:"ready",data:_e,error:null}))}catch(_e){if(!X)return;De(jt=>({...jt,status:"error",error:_e}))}}}return Qe(),()=>{X=!1}},[s,we.refreshIndex]);const ve=((Vc=we.data)==null?void 0:Vc.items)||((zc=we.data)==null?void 0:zc.documents)||[],ue=i.useMemo(()=>{if(!s)return"";const X=new URL("/api/v1/governance/audit","http://local");return X.searchParams.set("entityType","EMPLOYEE"),X.searchParams.set("entityId",s),X.pathname+X.search},[s]),Re=((Wc=Pe({path:ue||"/api/v1/governance/audit",page:1,pageSize:50,enabled:!!ue&&x}).data)==null?void 0:Wc.items)||[],ne=i.useMemo(()=>{var Qe;const X=((Qe=S.data)==null?void 0:Qe.scopeHistory)||[];return Array.isArray(X)&&X.length>0?X:Re.filter(_e=>String(_e.action||"").toUpperCase().includes("SCOPE"))},[Re,S.data]),H=Be(async({id:X,payload:Qe})=>z(`/api/v1/employees/${X}`,{method:"PATCH",body:Qe})),te=Be(async({id:X,payload:Qe})=>z(`/api/v1/employees/${X}/change-scope`,{method:"POST",body:Qe})),q=Be(async({id:X,payload:Qe})=>z(`/api/v1/employees/${X}/compensation`,{method:"POST",body:Qe})),Y=Be(async({id:X,payload:Qe})=>z(`/api/v1/employees/${X}/documents`,{method:"POST",body:Qe})),[xe,J]=i.useState(!1),[me,K]=i.useState(""),[be,je]=i.useState(""),[pe,Ae]=i.useState(""),[Se,Me]=i.useState(""),[ce,Ce]=i.useState(""),[xt,hs]=i.useState(""),[Es,ht]=i.useState(""),Ot=()=>{v&&(K(v.firstName||""),je(v.lastName||""),Ae(v.phone||""),Me(v.designation||""),Ce(v.reportingManagerId||""),hs(""),ht(""),J(!0))},[ps,Vt]=i.useState(!1),[fs,Pn]=i.useState("COMPANY"),[Ia,In]=i.useState(""),[pa,On]=i.useState(""),Ul=()=>{v&&(Pn(v.scope||"COMPANY"),In(v.primaryDivisionId||""),On(""),Vt(!0))},[_n,Cs]=i.useState(!1),[Oa,_a]=i.useState("MONTHLY"),[fa,Ba]=i.useState(""),[Fa,Ua]=i.useState("USD"),[ga,$a]=i.useState(""),[Va,za]=i.useState(""),[$s,Wa]=i.useState(""),se=()=>{_a("MONTHLY"),Ba(""),Ua("USD"),$a(""),za(""),Wa(""),Cs(!0)},[Ne,Ee]=i.useState(!1),[Le,Ie]=i.useState(""),[ze,rt]=i.useState(""),[qe,it]=i.useState(""),[mt,Mt]=i.useState(""),[Vs,As]=i.useState(""),[St,fe]=i.useState(""),Oe=()=>{Ie(""),rt(""),it(""),Mt(""),As(""),fe(""),Ee(!0)};return S.status==="loading"&&!S.data?e.jsx(de,{message:"Loading employee"}):S.status==="error"?((Hc=S.error)==null?void 0:Hc.status)===403?e.jsx(ge,{}):e.jsx(le,{error:S.error}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Employee Profile"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Employment record and financial scope"})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("button",{type:"button",onClick:()=>a("/hr/employees"),className:`inline-flex items-center gap-2 px-4 py-2 \r
                     bg-white border border-gray-200 \r
                     rounded-md shadow-sm\r
                     text-sm font-medium text-gray-700\r
                     hover:bg-gray-50 hover:shadow\r
                     transition-all duration-200`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Employees"]})}),V?e.jsxs("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-amber-900",children:"Month is closed. Employee changes are read-only."}),e.jsx("div",{className:"mt-1 text-sm text-amber-800",children:"All changes require the month to be open."})]}):null,e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pt-6 pb-10",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Overview"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Identity fields are audited. Employee ID is immutable."})]}),e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:bg-slate-50",disabled:!j||V,onClick:Ot,children:"Edit Identity"})]}),e.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Employee ID"}),e.jsx("div",{className:"mt-1 font-mono text-sm text-slate-500",children:(v==null?void 0:v.employeeCode)||""}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Employee ID is immutable"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Status"}),e.jsx("div",{className:"mt-1",children:ku(v==null?void 0:v.status)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Joining Date"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:v!=null&&v.createdAt?new Date(v.createdAt).toLocaleDateString():""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Full Name"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:Su(v)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Email"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:(v==null?void 0:v.email)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Phone"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:(v==null?void 0:v.phone)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Designation"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:(v==null?void 0:v.designation)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Reporting Manager"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:(v==null?void 0:v.reportingManagerName)||(v==null?void 0:v.reportingManager)||(v==null?void 0:v.reportingManagerId)||""})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Employment Scope"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Scope changes are append-only and require a reason."})]}),e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:bg-slate-50",disabled:!j||V,onClick:Ul,children:"Change Scope"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Eu(v==null?void 0:v.scope,T),(v==null?void 0:v.scope)==="DIVISION"?e.jsx("span",{className:"text-sm text-slate-700",children:lb(w,v==null?void 0:v.primaryDivisionId)}):null]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Effective From"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:v!=null&&v.scopeEffectiveFrom||v!=null&&v.scopeEffectiveAt||v!=null&&v.updatedAt||v!=null&&v.createdAt?new Date((v==null?void 0:v.scopeEffectiveFrom)||(v==null?void 0:v.scopeEffectiveAt)||(v==null?void 0:v.updatedAt)||(v==null?void 0:v.createdAt)).toLocaleDateString():""})]}),e.jsx("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-3",children:e.jsx("div",{className:"text-sm font-medium text-amber-900",children:"This scope affects financial reporting and payroll allocation."})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-slate-200 flex items-start justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Scope History"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"History is never overwritten."})]})}),e.jsx("div",{className:"p-4",children:ne.length===0?e.jsx(ye,{title:"No scope history",description:"Scope changes will appear here."}):e.jsx("div",{className:"space-y-3",children:ne.map(X=>e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:String(X.scope||X.action||"UPDATE")}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:X.changedAt||X.createdAt?new Date(X.changedAt||X.createdAt).toLocaleString():""})]}),e.jsxs("div",{className:"text-xs text-slate-600",children:["Actor: ",X.changedBy||X.actorId||""]})]})},X.id))})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Compensation History"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"New versions only. Never overwrite existing entries."})]}),e.jsx("button",{type:"button",className:"rounded-lg bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-slate-800 disabled:bg-slate-200",disabled:V,title:V?"Compensation changes are locked due to month close":void 0,onClick:se,children:"Add New Compensation Version"})]}),e.jsx("div",{className:"p-4",children:U.status==="loading"&&!U.data?e.jsx(de,{message:"Loading compensation"}):U.status==="error"?e.jsx(le,{error:U.error}):ie.length===0?e.jsx(ye,{title:"No compensation history",description:"Compensation versions will appear here."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Salary Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Currency"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Effective From"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Effective To"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:ie.map(X=>e.jsxs("tr",{className:"text-sm text-slate-700",children:[e.jsx("td",{className:"px-4 py-3",children:X.frequency||X.salaryType||""}),e.jsx("td",{className:"px-4 py-3 font-mono",children:X.amount!=null?String(X.amount):""}),e.jsx("td",{className:"px-4 py-3",children:X.currency||""}),e.jsx("td",{className:"px-4 py-3",children:X.effectiveFrom?String(X.effectiveFrom).slice(0,10):""}),e.jsx("td",{className:"px-4 py-3",children:X.effectiveTo?String(X.effectiveTo).slice(0,10):""})]},X.id||`${X.effectiveFrom}-${X.amount}`))})]})})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Documents"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Uploads are audited. Reason required."})]}),e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:bg-slate-50",disabled:!h||V,onClick:Oe,children:"Upload Metadata"})]}),e.jsx("div",{className:"p-4",children:we.status==="loading"&&!we.data?e.jsx(de,{message:"Loading documents"}):we.status==="error"?e.jsx(le,{error:we.error}):(ve||[]).length===0?e.jsx(ye,{title:"No documents",description:"Uploaded documents will appear here."}):e.jsx("div",{className:"space-y-2",children:(ve||[]).map(X=>e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:X.documentType||X.type||X.docType||"Document"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:X.fileName||X.filename||X.storageKey||""})]}),e.jsx("div",{className:"text-xs text-slate-500",children:X.createdAt||X.markedAt?new Date(X.createdAt||X.markedAt).toLocaleDateString():""})]})},X.id||X.storageKey))})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Attendance & Timesheets"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Read-only summaries and safe links to modules."})]}),e.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Attendance"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:f?"Available":"Not accessible"}),f?e.jsx("div",{className:"mt-2",children:e.jsx($e,{className:"text-sm font-medium text-slate-900 underline",to:"/hr/attendance",children:"Open Attendance"})}):null]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Timesheets"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:p&&u?"Available":"Not accessible"}),p&&u?e.jsx("div",{className:"mt-2",children:e.jsx($e,{className:"text-sm font-medium text-slate-900 underline",to:"/timesheet/approvals",children:"Open Timesheets"})}):null]})]})]})]}),e.jsx("div",{className:"lg:col-span-4",children:e.jsx("div",{className:"lg:sticky lg:top-6 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-900 text-white flex items-center justify-center text-sm font-semibold",children:v?nb(v):""}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:v?Su(v):""}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:(v==null?void 0:v.employeeCode)||""})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[ku(v==null?void 0:v.status),Eu(v==null?void 0:v.scope,T)]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Employment scope impact"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:(v==null?void 0:v.scope)==="DIVISION"?"This employee is a DIVISION resource. Costs impact division P&L.":"This employee is a COMPANY resource. Costs roll up to company overhead."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Payroll & P&L implications"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Compensation versions must be append-only for audit and payroll accuracy."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Month Close locking behavior"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"When the month is closed, employee changes are read-only to protect financial reporting."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Audit notes"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Sensitive actions require reason and are recorded in Audit Logs."})]})]})]})})})]})}),xe?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>J(!1)}),e.jsxs("div",{className:"relative w-full max-w-2xl rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:"Edit Identity"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Changes require confirmation and a reason. Employee ID cannot be changed."})]}),e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white p-2 text-slate-700",onClick:()=>J(!1),children:e.jsx(lr,{name:"x"})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"First Name"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:me,onChange:X=>K(X.target.value),disabled:V})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Last Name"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:be,onChange:X=>je(X.target.value),disabled:V})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Phone"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:pe,onChange:X=>Ae(X.target.value),disabled:V})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Designation"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:Se,onChange:X=>Me(X.target.value),disabled:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reporting Manager"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:ce,onChange:X=>Ce(X.target.value),disabled:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason (required)"}),e.jsx("textarea",{className:"mt-1 w-full h-24 rounded-md border-slate-300 text-sm",value:xt,onChange:X=>hs(X.target.value),disabled:V}),xt.trim().length===0?e.jsx("div",{className:"mt-1 text-xs text-rose-700",children:"Reason is required."}):null]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Type CONFIRM to apply"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono",value:Es,onChange:X=>ht(X.target.value),disabled:V})]})]}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",onClick:()=>J(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"rounded-lg bg-slate-900 px-4 py-2 text-sm font-medium text-white hover:bg-slate-800 disabled:bg-slate-200",disabled:V||H.status==="loading"||xt.trim().length===0||Es.trim()!=="CONFIRM"||!n,onClick:async()=>{const X={firstName:me.trim()||null,lastName:be.trim()||null,phone:pe.trim()||null,reason:xt.trim()};await H.run({id:n,payload:X}),J(!1),E()},children:"Save Changes"})]})]})]}):null,ps?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>Vt(!1)}),e.jsxs("div",{className:"relative w-full max-w-xl rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:"Change Scope"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Scope changes are append-only and require a reason."})]}),e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white p-2 text-slate-700",onClick:()=>Vt(!1),children:e.jsx(lr,{name:"x"})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Scope"}),e.jsxs("select",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:fs,onChange:X=>Pn(X.target.value),disabled:V,children:[e.jsx("option",{value:"COMPANY",children:"COMPANY (Shared)"}),e.jsx("option",{value:"DIVISION",children:"DIVISION"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Division"}),e.jsxs("select",{className:"mt-1 w-full rounded-md border-slate-300 text-sm disabled:bg-slate-50",value:Ia,onChange:X=>In(X.target.value),disabled:V||fs!=="DIVISION",children:[e.jsx("option",{value:"",children:fs==="DIVISION"?"Select":""}),(((qc=y.data)==null?void 0:qc.items)||[]).map(X=>e.jsxs("option",{value:X.id,children:[X.code,"  ",X.name]},X.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason (required)"}),e.jsx("textarea",{className:"mt-1 w-full h-24 rounded-md border-slate-300 text-sm",value:pa,onChange:X=>On(X.target.value),disabled:V}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Reason is required and will be recorded in Audit Logs"}),pa.trim().length===0?e.jsx("div",{className:"mt-1 text-xs text-rose-700",children:"Reason is required."}):null]})]}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",onClick:()=>Vt(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"rounded-lg bg-slate-900 px-4 py-2 text-sm font-medium text-white hover:bg-slate-800 disabled:bg-slate-200",disabled:V||te.status==="loading"||!n||pa.trim().length===0||fs==="DIVISION"&&!Ia,onClick:async()=>{await te.run({id:n,payload:{scope:fs,primaryDivisionId:fs==="DIVISION"?Ia:null,reason:pa.trim()}}),Vt(!1),E()},children:"Apply"})]})]})]}):null,_n?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>Cs(!1)}),e.jsxs("div",{className:"relative w-full max-w-xl rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:"Add Compensation Version"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Reason is required. Existing entries cannot be edited."})]}),e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white p-2 text-slate-700",onClick:()=>Cs(!1),children:e.jsx(lr,{name:"x"})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Salary Type"}),e.jsxs("select",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:Oa,onChange:X=>_a(X.target.value),disabled:V,children:[e.jsx("option",{value:"MONTHLY",children:"MONTHLY"}),e.jsx("option",{value:"HOURLY",children:"HOURLY"}),e.jsx("option",{value:"ANNUAL",children:"ANNUAL"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Currency"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:Fa,onChange:X=>Ua(X.target.value),disabled:V})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Amount"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono",value:fa,onChange:X=>Ba(X.target.value),disabled:V})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Effective From"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",type:"date",value:ga,onChange:X=>$a(X.target.value),disabled:V})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Effective To (optional)"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",type:"date",value:Va,onChange:X=>za(X.target.value),disabled:V})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason (required)"}),e.jsx("textarea",{className:"mt-1 w-full h-24 rounded-md border-slate-300 text-sm",value:$s,onChange:X=>Wa(X.target.value),disabled:V}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Reason is required and will be recorded in Audit Logs"}),$s.trim().length===0?e.jsx("div",{className:"mt-1 text-xs text-rose-700",children:"Reason is required."}):null]})]}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",onClick:()=>Cs(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"rounded-lg bg-slate-900 px-4 py-2 text-sm font-medium text-white hover:bg-slate-800 disabled:bg-slate-200",disabled:V||q.status==="loading"||!n||$s.trim().length===0||ga.trim().length===0||fa.trim().length===0,onClick:async()=>{await q.run({id:n,payload:{amount:Number(fa),currency:Fa.trim().toUpperCase(),frequency:Oa,effectiveFrom:ga,effectiveTo:Va.trim()||null,reason:$s.trim()}}),Cs(!1),Q()},children:"Add Version"})]})]})]}):null,Ne?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>Ee(!1)}),e.jsxs("div",{className:"relative w-full max-w-xl rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:"Upload Document Metadata"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"This registers a document reference for audit. A reason is required."})]}),e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white p-2 text-slate-700",onClick:()=>Ee(!1),children:e.jsx(lr,{name:"x"})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Type"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:Le,onChange:X=>Ie(X.target.value),disabled:V})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"File Name"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:ze,onChange:X=>rt(X.target.value),disabled:V})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Storage Key"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono",value:qe,onChange:X=>it(X.target.value),disabled:V})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"MIME Type"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:mt,onChange:X=>Mt(X.target.value),disabled:V})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Size (bytes)"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono",value:Vs,onChange:X=>As(X.target.value),disabled:V})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason (required)"}),e.jsx("textarea",{className:"mt-1 w-full h-24 rounded-md border-slate-300 text-sm",value:St,onChange:X=>fe(X.target.value),disabled:V}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Reason is required and will be recorded in Audit Logs"}),St.trim().length===0?e.jsx("div",{className:"mt-1 text-xs text-rose-700",children:"Reason is required."}):null]})]}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",onClick:()=>Ee(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"rounded-lg bg-slate-900 px-4 py-2 text-sm font-medium text-white hover:bg-slate-800 disabled:bg-slate-200",disabled:V||Y.status==="loading"||!n||!h||St.trim().length===0||Le.trim().length===0||ze.trim().length===0||qe.trim().length===0,onClick:async()=>{await Y.run({id:n,payload:{documentType:Le.trim(),fileName:ze.trim(),storageKey:qe.trim(),mimeType:mt.trim()||null,sizeBytes:Vs.trim()?Number(Vs):null,reason:St.trim()}}),Ee(!1),Z()},children:"Register"})]})]})]}):null]})}function rb(){var a;const{bootstrap:t}=he();return(((a=t==null?void 0:t.rbac)==null?void 0:a.permissions)||[]).includes("EMPLOYEE_READ")?e.jsx(Th,{}):e.jsx(ge,{})}function We({title:t,subtitle:s,actions:a,breadcrumbs:n,variant:l}){const r=l==="divisions";return e.jsxs("div",{className:r?"bg-white border-b border-slate-200 p-6 mb-6":"bg-white/95 backdrop-blur-sm border border-white/20 rounded-2xl shadow-lg p-6 mb-6 relative overflow-hidden",children:[r?null:e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-blue-500/5 to-purple-500/5"}),e.jsxs("div",{className:r?"":"relative z-10",children:[n&&e.jsx("nav",{className:"flex mb-4","aria-label":"Breadcrumb",children:e.jsx("ol",{className:"inline-flex items-center space-x-1 text-sm",children:n.map((o,d)=>e.jsxs("li",{className:"flex items-center",children:[d>0&&e.jsx("svg",{className:"w-4 h-4 mx-1 text-slate-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),o.href?e.jsx("a",{href:o.href,className:"text-slate-500 hover:text-slate-700 transition-colors",children:o.label}):e.jsx("span",{className:"text-slate-900 font-medium",children:o.label})]},d))})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:t}),s&&e.jsx("p",{className:"mt-1 text-slate-600",children:s})]}),a&&e.jsx("div",{className:"flex items-center space-x-3",children:a})]})]})]})}function rr(t){return t&&typeof t=="string"?t.slice(0,10):null}function Dr(){const t=new Date,s=5.5*60*60*1e3;return new Date(t.getTime()+s+t.getTimezoneOffset()*60*1e3).toISOString().split("T")[0]}function ib(){return Dr().slice(0,7)}function Cu(t){return String(t).padStart(2,"0")}function ob(t){return t%4===0&&t%100!==0||t%400===0}function db(t,s){return s===2?ob(t)?29:28:s===4||s===6||s===9||s===11?30:31}function cb(t,s){const a=[],n=s+1,l=db(t,n);for(let r=1;r<=l;r++)a.push(`${t}-${Cu(n)}-${Cu(r)}`);return a}function Ws(...t){return t.filter(Boolean).join(" ")}function mb(t){return t.slice(0,7)}function ub(t){const s=String((t==null?void 0:t.firstName)||"").trim(),a=String((t==null?void 0:t.lastName)||"").trim(),n=s?s[0]:"",l=a?a[0]:"";return(n+l).toUpperCase()||""}function Au(t){const s=String(t||"").toUpperCase();return s==="PRESENT"?"bg-emerald-50 text-emerald-700 border-emerald-200":s==="ABSENT"?"bg-rose-50 text-rose-700 border-rose-200":s==="LEAVE"?"bg-amber-50 text-amber-800 border-amber-200":"bg-white text-slate-500 border-slate-200"}function xb(){var _n,Cs,Oa,_a,fa,Ba,Fa,Ua,ga,$a,Va,za,$s,Wa;const{bootstrap:t}=he(),s=((Oa=(Cs=(_n=t==null?void 0:t.ui)==null?void 0:_n.screens)==null?void 0:Cs.attendance)==null?void 0:Oa.title)||"Attendance",a=((_a=t==null?void 0:t.rbac)==null?void 0:_a.permissions)||[],n=a.includes("ATTENDANCE_READ")||a.includes("ATTENDANCE_VIEW_TEAM")||a.includes("ATTENDANCE_VIEW_ALL")||a.includes("ATTENDANCE_CORRECT"),l=a.includes("ATTENDANCE_WRITE")||a.includes("SYSTEM_FULL_ACCESS"),r=a.includes("ATTENDANCE_CORRECT")||a.includes("SYSTEM_FULL_ACCESS"),o=l||r,d=r&&!l,c=a.includes("ATTENDANCE_OVERRIDE")||a.includes("ATTENDANCE_WRITE")||a.includes("ATTENDANCE_CORRECT")||a.includes("LEAVE_MONTH_CLOSE_OVERRIDE")||a.includes("SYSTEM_FULL_ACCESS"),m=a.includes("ATTENDANCE_BULK_WRITE")||a.includes("ATTENDANCE_WRITE")||a.includes("SYSTEM_FULL_ACCESS"),g=a.includes("SYSTEM_FULL_ACCESS"),x=a.includes("ATTENDANCE_WRITE")||a.includes("ATTENDANCE_CORRECT")||a.includes("ATTENDANCE_VIEW_TEAM")||a.includes("ATTENDANCE_VIEW_ALL"),j=g?"admin":x?"hr":"readonly",[h,f]=i.useState(""),[u,b]=i.useState(""),[p,y]=i.useState("monthly"),[w,S]=i.useState(!1),[N,E]=i.useState(!1),[v,A]=i.useState(""),[T,C]=i.useState("P"),[k,D]=i.useState("ALL"),[R,L]=i.useState(!1),[_,I]=i.useState("");function G(se){return se==="P"?"PRESENT":se==="A"?"ABSENT":se==="L"?"LEAVE":se}function O(se){if(!se)return null;const Ne=se.toUpperCase();return Ne==="PRESENT"?"P":Ne==="ABSENT"?"A":Ne==="LEAVE"?"L":Ne}function F(se,Ne="info"){const Ee=document.createElement("div");Ee.className=`fixed top-4 right-4 px-4 py-3 rounded-lg shadow-lg z-50 ${Ne==="success"?"bg-green-500 text-white":Ne==="error"?"bg-red-500 text-white":"bg-blue-500 text-white"}`,Ee.textContent=se,document.body.appendChild(Ee),setTimeout(()=>{Ee.parentNode&&Ee.parentNode.removeChild(Ee)},3e3)}i.useEffect(()=>{y("monthly")},[j]);const[W,$]=i.useState(""),[M,P]=i.useState("");i.useEffect(()=>{const se=setTimeout(()=>{P(W)},300);return()=>clearTimeout(se)},[W]);const V=Pe({path:"/api/v1/governance/divisions",page:1,pageSize:200,enabled:!0}),U=i.useMemo(()=>{var Ne;const se={};for(const Ee of((Ne=V.data)==null?void 0:Ne.items)||[])se[Ee.id]=Ee;return se},[V.data]),[B,Q]=i.useState({status:"idle",data:null,error:null,refreshIndex:0}),ae=()=>Q(se=>({...se,refreshIndex:se.refreshIndex+1}));i.useEffect(()=>{if(!n||!h)return;let se=!0;async function Ne(){Q(Ee=>({...Ee,status:"loading",error:null}));try{const Ee=a.includes("ATTENDANCE_CORRECT")?"/api/v1/attendance/hr-month":"/api/v1/attendance/month",Le=new URL(Ee,"http://local");Le.searchParams.set("month",h),u&&Le.searchParams.set("divisionId",u);const Ie=await z(Le.pathname+Le.search);if(!se)return;Q(ze=>({...ze,status:"ready",data:Ie,error:null}))}catch(Ee){if(!se)return;Q(Le=>({...Le,status:"error",error:Ee}))}}return Ne(),()=>{se=!1}},[n,h,u,B.refreshIndex]),i.useEffect(()=>{if(!n||h)return;let se=!0;async function Ne(){try{const Ee=a.includes("ATTENDANCE_CORRECT")?"/api/v1/attendance/hr-month":"/api/v1/attendance/month",Le=new URL(Ee,"http://local"),Ie=a.includes("ATTENDANCE_CORRECT")?"/api/v1/attendance/hr-today":"/api/v1/attendance/today",ze=await z(Ie),rt=(ze==null?void 0:ze.todayDate)||null;if(!se)return;rt&&/^\d{4}-\d{2}-\d{2}$/.test(rt)&&f(mb(rt))}catch{}}return Ne(),()=>{se=!1}},[n,h]);const[ie,we]=i.useState({status:"idle",data:null,error:null,refreshIndex:0}),De=()=>we(se=>({...se,refreshIndex:se.refreshIndex+1}));i.useEffect(()=>{if(!n||p!=="summary")return;let se=!0;async function Ne(){we(Ee=>({...Ee,status:"loading",error:null}));try{const Ee=new URL("/api/v1/attendance/summary","http://local");Ee.searchParams.set("month",h),u&&Ee.searchParams.set("divisionId",u);const Le=await z(Ee.pathname+Ee.search);if(!se)return;we(Ie=>({...Ie,status:"ready",data:Le,error:null}))}catch(Ee){if(!se)return;we(Le=>({...Le,status:"error",error:Ee}))}}return Ne(),()=>{se=!1}},[n,p,h,u,ie.refreshIndex]);const Z=!!((fa=B.data)!=null&&fa.isMonthClosed),ve=o&&(!Z||c);(Ba=B.data)!=null&&Ba.todayDate;const ue=Dr(),re=ue,Re=parseInt(ue.split("-")[2],10),ne=i.useMemo(()=>{if(!h)return[];const[se,Ne]=h.split("-").map(Number);return cb(se,Ne-1)},[h]),H=((Fa=B.data)==null?void 0:Fa.employees)||[],te=((Ua=B.data)==null?void 0:Ua.records)||[],q=i.useMemo(()=>{const se=String(M||"").trim().toLowerCase();return se?(H||[]).filter(Ne=>{const Ee=String((Ne==null?void 0:Ne.employeeCode)||"").toLowerCase(),Le=`${String((Ne==null?void 0:Ne.firstName)||"").trim()} ${String((Ne==null?void 0:Ne.lastName)||"").trim()}`.trim().toLowerCase();return Ee.includes(se)||Le.includes(se)}):H},[H,M]),Y=i.useMemo(()=>{var Ee;const se=((Ee=ie.data)==null?void 0:Ee.items)||[],Ne=String(M||"").trim().toLowerCase();return Ne?se.filter(Le=>{const Ie=String((Le==null?void 0:Le.employeeCode)||"").toLowerCase(),ze=`${String((Le==null?void 0:Le.firstName)||"").trim()} ${String((Le==null?void 0:Le.lastName)||"").trim()}`.trim().toLowerCase();return Ie.includes(Ne)||ze.includes(Ne)}):se},[ie.data,M]),[xe,J]=i.useState({});i.useEffect(()=>{if(!n)return;let se=!0;async function Ne(){const Ee=(H||[]).map(ze=>ze.id).filter(ze=>ze&&!xe[ze]);if(Ee.length===0)return;const Le=Ee.slice(0,50),Ie=await Promise.all(Le.map(async ze=>{try{const rt=await z(`/api/v1/employees/${ze}`),qe=(rt==null?void 0:rt.item)||null,it=rr(qe==null?void 0:qe.joiningDate)||(typeof(qe==null?void 0:qe.createdAt)=="string"?rr(qe.createdAt):null),mt=rr(qe==null?void 0:qe.exitDate);return[ze,{joiningDate:it,exitDate:mt,status:(qe==null?void 0:qe.status)||null}]}catch{return[ze,{joiningDate:null,exitDate:null,status:null}]}}));se&&J(ze=>{const rt={...ze};for(const[qe,it]of Ie)rt[qe]=it;return rt})}return Ne(),()=>{se=!1}},[n,H,xe]);const me=i.useMemo(()=>{const se=new Map;for(const Ne of te){const Ee=rr(Ne.attendanceDate);Ee&&se.set(`${Ne.employeeId}:${Ee}`,Ne)}return se},[te]),K=se=>{var Ee,Le;const Ne=((Le=(Ee=se==null?void 0:se.response)==null?void 0:Ee.data)==null?void 0:Le.message)||(se==null?void 0:se.message)||"";return Ne.includes("Invalid attendance source")?"Unable to update attendance. Please try again.":Ne.includes("newStatus")||Ne.includes("status")?"Please select a valid attendance status.":Ne.includes("Cannot mark attendance for future date")?"You cannot mark attendance for a future date.":Ne.includes("Month is closed")||Ne.includes("Attendance cannot be dealt")?"This month is closed. Attendance cannot be modified.":Ne.includes("Employee not found")?"Employee not found. Please select a valid employee.":Ne.includes("Past dates")||Ne.includes("Future dates")?"Selected date cannot be modified. Please check date restrictions.":"Attendance update failed"},be=Be(async se=>z("/api/v1/attendance/mark",{method:"POST",body:se})),je=Be(async se=>z("/api/v1/attendance/override",{method:"POST",body:se})),[pe,Ae]=i.useState(!1),[Se,Me]=i.useState(null),[ce,Ce]=i.useState(""),[xt,hs]=i.useState(""),[Es,ht]=i.useState(""),[Ot,ps]=i.useState("PRESENT"),[Vt,fs]=i.useState(""),Pn=(se,Ne)=>{const Ee=new Date(Ne),Le=new Date;if(Le.setHours(0,0,0,0),Ee.setHours(0,0,0,0),Ee>Le){console.log("[Attendance Debug] Blocked attempt to open future date:",Ne);return}const Ie=me.get(`${se.id}:${Ne}`);Me(se),Ce(Ne),hs(Ne),ht((Ie==null?void 0:Ie.status)||""),ps((Ie==null?void 0:Ie.status)||"PRESENT"),fs(""),Ae(!0)},Ia=async se=>{var Ee,Le,Ie,ze,rt,qe;if(se&&se.preventDefault(),!v)return F("Select date","error");if(R)return;const Ne=Dr();if(!w&&v<Ne){F("Past dates are not allowed","error");return}if(w&&!_.trim()){F("Reason is required for override","error");return}L(!0);try{const it=((Ee=B.data)==null?void 0:Ee.employees)||[],mt=await z("/api/v1/attendance/bulk-mark",{method:"POST",body:{attendanceDate:v,source:"HR",items:it.map(St=>({employeeId:St.id,status:G(T),reason:w?_.trim():void 0}))}});if(mt.status!==200)throw new Error(((Le=mt.data)==null?void 0:Le.message)||"Bulk attendance failed");const Mt=Array.isArray((Ie=mt.data)==null?void 0:Ie.items)?mt.data.items:Array.isArray(mt.data)?mt.data:[],Vs=Mt.filter(St=>St.outcome==="UPDATED"||St.outcome==="CREATED"),As=Mt.filter(St=>St.outcome==="FAILED");if(As.length===0)F("Attendance updated successfully","success");else{const St=`${Vs.length} updated, ${As.length} failed`;F(St,"error"),console.log("Failed bulk updates:",As)}E(!1),await In()}catch(it){const mt=((rt=(ze=it==null?void 0:it.response)==null?void 0:ze.data)==null?void 0:rt.message)||((qe=it==null?void 0:it.data)==null?void 0:qe.message)||(it==null?void 0:it.message)||"Attendance update failed";F(mt,"error")}finally{L(!1)}},In=async()=>{try{const se=h||ib();Q(Le=>({...Le,data:null}));const Ne=a.includes("ATTENDANCE_CORRECT")?`/api/v1/attendance/hr-month?month=${se}&t=${Date.now()}`:`/api/v1/attendance/month?month=${se}&t=${Date.now()}`,Ee=await z(Ne);Q(Le=>({...Le,status:"ready",data:Ee,error:null})),De()}catch(se){console.error("Failed to refetch month data:",se)}},pa=(se,Ne,Ee,Le)=>{if(!Ee||Ee==="")return"Please select a status.";const Ie=Dr();if(Ne>Ie)return"Future dates cannot be modified.";if(!se||!se.id)return"Please select a valid employee.";if(Ne<Ie){if(!w)return"Past dates require override mode";if((!Le||Le.trim()==="")&&!a.includes("SYSTEM_FULL_ACCESS"))return"Reason is required for override."}return Ne===Ie&&a.includes("SYSTEM_FULL_ACCESS"),null},On=async()=>{const se=pa(Se,xt,Ot,Vt);if(se){F(se,"error");return}const Ne={employeeId:Se.id,attendanceDate:xt,status:Ot,source:"HR",reason:Vt.trim()||void 0},Ee={employeeId:Se.id,attendanceDate:xt,newStatus:Ot,reason:Vt.trim()||void 0};console.assert(Ne.attendanceDate===xt,"Payload date mismatch (must submit clicked cell date)");try{d?await je.run(Ee):await be.run(Ne),Ae(!1),ae(),F("Attendance updated successfully","success"),setTimeout(()=>{var Ie;console.log("[Attendance Page] Emitting attendance update event"),(Ie=V.refresh)==null||Ie.call(V);const Le=new CustomEvent("attendanceDataUpdated",{detail:{employeeId:Se.id,attendanceDate:xt,newStatus:Ot,oldStatus:Es,isOverride:w&&c}});window.dispatchEvent(Le)},100)}catch(Le){console.error("[Attendance Page] Override failed:",Le);const Ie=K(Le);F(Ie,"error")}};if(B.status==="loading"&&!B.data)return e.jsxs("div",{children:[e.jsx(We,{title:s}),((ga=B.error)==null?void 0:ga.status)===403?e.jsx(ge,{}):e.jsx(le,{error:B.error})]});const Ul=(($a=B.data)==null?void 0:$a.monthStatus)||"OPEN";return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:s,subtitle:"Monthly",actions:o?e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("button",{type:"button",className:Ws("rounded-lg px-3 py-2 text-sm font-medium",p==="monthly"?"bg-slate-900 text-white":"border border-slate-300 bg-white text-slate-700 hover:bg-slate-50"),onClick:()=>y("monthly"),children:"Monthly"}),e.jsx("button",{type:"button",className:Ws("rounded-lg px-3 py-2 text-sm font-medium",p==="summary"?"bg-slate-900 text-white":"border border-slate-300 bg-white text-slate-700 hover:bg-slate-50"),onClick:()=>{y("summary"),De()},children:"Overview"})]}):null}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-8",children:e.jsxs("div",{className:"mt-4 grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"lg:col-span-4 xl:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Controls"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Month close status: ",Ul]})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Month"}),e.jsx("input",{type:"month",className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:h,onChange:se=>{f(se.target.value),ae()}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Employee"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:W,onChange:se=>$(se.target.value),placeholder:"Search by name or code"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Division"}),e.jsxs("select",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:u,onChange:se=>{b(se.target.value),ae(),De()},disabled:V.status==="error"||(((Va=V.data)==null?void 0:Va.items)||[]).length===0,children:[e.jsx("option",{value:"",children:"All"}),(((za=V.data)==null?void 0:za.items)||[]).map(se=>e.jsxs("option",{value:se.id,children:[se.code,"  ",se.name]},se.id))]}),V.status==="error"?e.jsx("div",{className:"mt-1 text-xs text-rose-700",children:"Divisions unavailable."}):null]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-xs font-medium text-slate-600",children:"Editability"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:ve?"Month is OPEN. Attendance is editable.":"Read-only."})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-900",children:"Attendance"}),e.jsxs("div",{className:"mt-2 space-y-2 text-xs text-slate-600",children:[e.jsx("div",{children:"Attendance is recorded as factual daily status."}),e.jsx("div",{children:"Leave days are auto-synced and read-only."}),e.jsx("div",{children:"Locked months cannot be edited."})]})]})]})]})}),e.jsx("div",{className:"lg:col-span-8 xl:col-span-9",children:p==="monthly"?e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:o?"Attendance Overview":"Attendance"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[q.length," employees  ",ne.length," days"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Z?e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-amber-200 bg-amber-50 px-2 py-1 text-xs font-semibold text-amber-900",children:[e.jsx("span",{"aria-hidden":!0,children:""}),"Month locked"]}):null,c&&e.jsx("button",{onClick:()=>S(se=>!se),className:Ws("rounded-lg border px-3 py-1 text-xs font-medium",w?"border-blue-300 bg-blue-50 text-blue-700":"border-slate-300 bg-white text-slate-700 hover:bg-slate-50"),children:w?"Override ON":"Override Mode"}),m&&e.jsx("button",{onClick:()=>E(!0),className:"rounded-lg bg-blue-600 px-3 py-1 text-xs font-medium text-white hover:bg-blue-700",children:"Bulk Attendance"}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-xs text-slate-600",children:[e.jsx("span",{className:"inline-flex h-3 w-3 rounded bg-emerald-200"})," Present",e.jsx("span",{className:"inline-flex h-3 w-3 rounded bg-rose-200"})," Absent",e.jsx("span",{className:"inline-flex h-3 w-3 rounded bg-amber-200"})," Leave"]})]})]}),q.length===0?e.jsx("div",{className:"p-6",children:e.jsx(ye,{title:"No active employees",description:"Attendance applies to ACTIVE employees only."})}):e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"min-w-full border-separate",style:{borderSpacing:0},children:[e.jsx("thead",{className:"sticky top-0 bg-white z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white border-b border-slate-200 px-3 py-2 text-left text-xs font-semibold text-slate-600",children:"Employee"}),ne.map(se=>{const Ee=parseInt(se.slice(8))===Re;return e.jsx("th",{className:Ws("border-b px-2 py-2 text-center text-xs font-semibold whitespace-nowrap",Ee?"bg-blue-50 border-b-2 border-b-blue-400 text-blue-900":"border-slate-200 text-slate-600"),children:se.slice(8)},se)})]})}),e.jsx("tbody",{children:q.map(se=>{var Ee;const Ne=se.primaryDivisionId&&((Ee=U[se.primaryDivisionId])==null?void 0:Ee.code)||"";return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white border-b border-slate-100 px-3 py-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-9 w-9 rounded-full bg-slate-900 text-white flex items-center justify-center text-sm font-semibold",children:ub(se)}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900 truncate",children:[se.employeeCode,"  ",se.firstName," ",se.lastName]}),e.jsx("div",{className:"text-xs text-slate-500 truncate",children:Ne?`Division: ${Ne}`:se.scope})]})]})}),ne.map(Le=>{const Ie=me.get(`${se.id}:${Le}`),ze=(Ie==null?void 0:Ie.status)||"",rt=O(ze);parseInt(Le.slice(8));const qe=Le===re,mt=new Date(Le)>ue;let Mt=!1;return d?Mt=!!(w&&c&&!Z&&!mt):(w&&c&&!Z&&!mt&&(Mt=!0),!w&&!c&&qe&&o&&!Z&&(Mt=!0),qe&&o&&!Z&&(Mt=!0),mt&&(Mt=!1)),e.jsx("td",{className:Ws("border-b border-slate-100 px-2 py-2 text-center",qe?"bg-blue-50/30":""),children:Mt?e.jsx("button",{type:"button",className:Ws("w-12 h-9 rounded-lg border text-xs font-semibold",Au(ze),"hover:shadow-sm",qe?"ring-2 ring-blue-400":""),onClick:()=>Pn(se,Le),title:ze?`${ze}`:"",children:rt||""}):e.jsx("div",{className:Ws("w-12 h-9 inline-flex items-center justify-center rounded-lg border text-xs font-semibold opacity-40 cursor-not-allowed pointer-events-none",Au(ze),qe?"ring-2 ring-blue-300":""),title:"Editing restricted",children:rt||""})},Le)})]},se.id)})})]})})]}):e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Monthly attendance totals"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Read-only aggregation for the selected month."})]}),ie.status==="loading"?e.jsx("div",{className:"p-6",children:e.jsx(de,{label:"Loading summary"})}):ie.status==="error"?e.jsx("div",{className:"p-6",children:(($s=ie.error)==null?void 0:$s.status)===403?e.jsx(ge,{}):e.jsx(le,{error:ie.error})}):(((Wa=ie.data)==null?void 0:Wa.items)||[]).length===0?e.jsx("div",{className:"p-6",children:e.jsx(ye,{title:"No data"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Present"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Absent"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Leave"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Days"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:Y.map(se=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[se.employeeCode,"  ",se.firstName," ",se.lastName]})}),e.jsx("td",{className:"px-4 py-3 text-right text-sm text-slate-700",children:se.presentDays}),e.jsx("td",{className:"px-4 py-3 text-right text-sm text-slate-700",children:se.absentDays}),e.jsx("td",{className:"px-4 py-3 text-right text-sm text-slate-700",children:se.leaveDays}),e.jsx("td",{className:"px-4 py-3 text-right text-sm text-slate-700",children:se.totalWorkingDays})]},se.employeeId))})]})})]})})]})}),pe?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>{be.status==="loading"||je.status==="loading"||Ae(!1)}}),e.jsxs("div",{className:"relative w-full max-w-lg rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:"Edit Attendance"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-600",children:"Employee"}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-900",children:Se?`${Se.employeeCode}  ${Se.firstName} ${Se.lastName}`:""})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-600",children:"Date"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:ce||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-600",children:"Old status"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:Es||""})]})]})]}),Z&&!c?e.jsx("div",{className:"mt-3 rounded-xl border border-amber-200 bg-amber-50 p-3 text-sm text-amber-900",children:"Month is LOCKED. Read-only."}):null,e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"New status"}),e.jsxs("select",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:Ot,onChange:se=>ps(se.target.value),disabled:Z&&!c,children:[e.jsx("option",{value:"PRESENT",children:"PRESENT"}),e.jsx("option",{value:"ABSENT",children:"ABSENT"}),e.jsx("option",{value:"LEAVE",children:"LEAVE"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:Vt,onChange:se=>fs(se.target.value),disabled:Z&&!c,placeholder:a.includes("SYSTEM_FULL_ACCESS")?"Optional for SUPER_ADMIN":"Required"}),(!Z||c)&&!Vt.trim()&&!a.includes("SYSTEM_FULL_ACCESS")?e.jsx("div",{className:"mt-1 text-xs text-rose-700",children:"Reason is required."}):null]})]}),be.status==="error"||je.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:be.error||je.error})}):null,e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:be.status==="loading"||je.status==="loading",onClick:()=>{Ae(!1)},children:"Cancel"}),e.jsx("button",{type:"button",className:"rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white disabled:bg-slate-400",disabled:be.status==="loading"||je.status==="loading"||Z&&!c||!Se||!ce||!Vt.trim()&&!a.includes("SYSTEM_FULL_ACCESS"),onClick:On,children:be.status==="loading"||je.status==="loading"?"Saving":"Confirm"})]})]})]}):null,N&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-[420px] shadow-xl",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Bulk Attendance"}),e.jsx("label",{className:"block text-sm mb-2",children:"Date"}),e.jsx("input",{type:"date",value:v,onChange:se=>A(se.target.value),className:"w-full border rounded-lg px-3 py-2 mb-4"}),e.jsx("label",{className:"block text-sm mb-2",children:"Status"}),e.jsxs("select",{value:T,onChange:se=>C(se.target.value),className:"w-full border rounded-lg px-3 py-2 mb-4",children:[e.jsx("option",{value:"P",children:"Present"}),e.jsx("option",{value:"A",children:"Absent"}),e.jsx("option",{value:"L",children:"Leave"})]}),w&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-2",children:"Reason *"}),e.jsx("input",{type:"text",value:_,onChange:se=>I(se.target.value),className:"w-full border rounded-lg px-3 py-2 mb-4",placeholder:"Required for override"}),!_.trim()&&e.jsx("div",{className:"text-xs text-red-600 mb-4",children:"Reason is required for override"})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 border rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:Ia,disabled:R,className:Ws("px-4 py-2 bg-blue-600 text-white rounded-lg",R&&"opacity-50 cursor-not-allowed"),children:R?"Applying...":"Apply"})]})]})})]})}function Lu(){var l,r;const{bootstrap:t}=he(),s=((l=t==null?void 0:t.rbac)==null?void 0:l.permissions)||[];return!(((r=t==null?void 0:t.rbac)==null?void 0:r.roles)||[]).includes("SUPER_ADMIN")&&!s.includes("ATTENDANCE_VIEW_TEAM")&&!s.includes("ATTENDANCE_CORRECT")?e.jsx(ge,{}):e.jsx(xb,{})}function hb(){var l,r;const{bootstrap:t}=he(),s=((l=t==null?void 0:t.rbac)==null?void 0:l.permissions)||[];return!(((r=t==null?void 0:t.rbac)==null?void 0:r.roles)||[]).includes("SUPER_ADMIN")&&!s.includes("TIMESHEET_VIEW_TEAM")?e.jsx(ge,{}):e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-6",children:"HR Timesheets"}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-4",children:e.jsx("p",{className:"text-slate-600",children:"Timesheet management functionality will be implemented here."})})]})}function oa({title:t,defaultOpen:s=!1,children:a}){const[n,l]=i.useState(s);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("button",{type:"button",onClick:()=>l(!n),className:"w-full px-6 py-4 flex items-center justify-between text-left hover:bg-gray-50 transition-colors",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:t}),e.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform duration-200 ${n?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx("div",{className:`transition-all duration-200 ease-in-out ${n?"max-h-96 opacity-100":"max-h-0 opacity-0"} overflow-hidden`,children:e.jsx("div",{className:"px-6 pb-6",children:a})})]})}function io(t){return t?new Date(t).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}):""}function Lc({data:t,role:s,monthLocked:a,onView:n}){const l=m=>{const g=String((m==null?void 0:m.status)||"").toUpperCase(),x=!!(m!=null&&m.approvedL1At||m!=null&&m.approvedL1By||m!=null&&m.approvedL1ById),j=!!(m!=null&&m.approvedL2At||m!=null&&m.approvedL2By||m!=null&&m.approvedL2ById);return g==="SUBMITTED"||g==="PENDING_L1"?x?{key:"PENDING_L2",label:"Pending for L2",approvedBy:"L1"}:{key:"PENDING_L1",label:"Pending for L1",approvedBy:"-"}:g==="PENDING_L2"?{key:"PENDING_L2",label:"Pending for L2",approvedBy:x?"L1":"-"}:g==="APPROVED"?j?{key:"APPROVED",label:"Approved by L2",approvedBy:"L2"}:x?{key:"APPROVED",label:"Approved by L1",approvedBy:"L1"}:{key:"APPROVED",label:"Approved",approvedBy:"-"}:g==="REJECTED"?{key:"REJECTED",label:"Rejected",approvedBy:"-"}:{key:g||"UNKNOWN",label:g||"-",approvedBy:"-"}},r=m=>{switch(m==null?void 0:m.toUpperCase()){case"PENDING_L1":return"bg-yellow-100 text-yellow-700";case"PENDING_L2":return"bg-orange-100 text-orange-700";case"APPROVED":return"bg-green-100 text-green-700";case"REJECTED":return"bg-red-100 text-red-700";case"LOCKED":return"bg-gray-200 text-gray-500";default:return"bg-gray-100 text-gray-700"}},o=m=>{n&&n(m)},d=m=>{console.log("Approve leave:",m)},c=m=>{console.log("Reject leave:",m)};return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[900px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700 whitespace-nowrap",children:"Employee"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700 whitespace-nowrap",children:"Division"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700 whitespace-nowrap",children:"Date Range"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700 whitespace-nowrap",children:"Type"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700 whitespace-nowrap",children:"Days"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700 whitespace-nowrap",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700 whitespace-nowrap",children:"Approved By"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700 whitespace-nowrap",children:"Approved At"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700 whitespace-nowrap",children:"Action"})]})}),e.jsx("tbody",{children:t==null?void 0:t.map((m,g)=>{var x,j;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-gray-800 whitespace-nowrap",children:(()=>{var u,b;const h=String(((u=m==null?void 0:m.employee)==null?void 0:u.name)||"").trim()||String((m==null?void 0:m.employeeName)||"").trim()||`${(m==null?void 0:m.firstName)||""} ${(m==null?void 0:m.lastName)||""}`.trim(),f=String(((b=m==null?void 0:m.employee)==null?void 0:b.code)||(m==null?void 0:m.employeeCode)||"").trim();return h&&f?`${h} (${f})`:h||f||"-"})()}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-800 whitespace-nowrap",children:(()=>{var u;const h=(m==null?void 0:m.divisionName)||((u=m==null?void 0:m.division)==null?void 0:u.name)||(typeof(m==null?void 0:m.division)=="string"?m.division:"")||"",f=(m==null?void 0:m.primaryDivisionId)||(m==null?void 0:m.primaryDivisionID)||(m==null?void 0:m.primary_division_id);return h||(f?String(f).slice(0,8)+"":"-")})()}),e.jsxs("td",{className:"py-3 px-4 text-sm text-gray-800 whitespace-nowrap",children:[io(m.startDate||m.start_date)," - ",io(m.endDate||m.end_date)]}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-800 whitespace-nowrap",children:m.leaveTypeName||m.leaveTypeCode||((x=m==null?void 0:m.leaveType)==null?void 0:x.name)||((j=m==null?void 0:m.leaveType)==null?void 0:j.code)||(m==null?void 0:m.leaveType)||"-"}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-800 whitespace-nowrap",children:(()=>{const h=m.units??m.days;return Number.isFinite(Number(h))?`${Number(h)} days`:"-"})()}),e.jsx("td",{className:"py-3 px-4 whitespace-nowrap",children:(()=>{const h=l(m);return e.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${r(h.key)}`,children:h.label})})()}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-800 whitespace-nowrap",children:l(m).approvedBy||"-"}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-800 whitespace-nowrap",children:io((m==null?void 0:m.approvedL2At)||(m==null?void 0:m.approvedL1At))||"-"}),e.jsx("td",{className:"py-3 px-4 whitespace-nowrap",children:s==="SUPER_ADMIN"?e.jsx("button",{onClick:()=>o(m),disabled:a,className:`text-sm font-medium px-3 py-1 rounded-md border transition-colors ${a?"border-gray-200 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"View"}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>o(m),disabled:a,className:`text-sm font-medium px-3 py-1 rounded-md border transition-colors ${a?"border-gray-200 text-gray-400 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"View"}),!a&&e.jsxs(e.Fragment,{children:[m.status==="PENDING_L1"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>d(m),className:"text-sm font-medium px-3 py-1 rounded-md border border-green-300 text-green-700 hover:bg-green-50",children:"Approve (L1)"}),e.jsx("button",{onClick:()=>c(m),className:"text-sm font-medium px-3 py-1 rounded-md border border-red-300 text-red-700 hover:bg-red-50",children:"Reject"})]}),m.status==="PENDING_L2"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>d(m),className:"text-sm font-medium px-3 py-1 rounded-md border border-green-300 text-green-700 hover:bg-green-50",children:"Approve (Final)"}),e.jsx("button",{onClick:()=>c(m),className:"text-sm font-medium px-3 py-1 rounded-md border border-red-300 text-red-700 hover:bg-red-50",children:"Reject"})]})]})]})})]},m.id||g)})})]})})}function oo(t){return!t||t==="-"?"-":new Date(t).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})}function Dc({isOpen:t,onClose:s,leaveId:a,leaveData:n}){const[l,r]=i.useState(null),[o,d]=i.useState(!1),[c,m]=i.useState(null);i.useEffect(()=>{if(n){r(n);return}a&&(d(!0),m(null),z(`/api/v1/leave/requests/${a}`).then(u=>{console.log("API Response:",u);const b=u.data||u;console.log("Response Data:",b);const p=(b==null?void 0:b.item)||b;if(console.log("Leave Data:",p),console.log("Leave Data ID:",p==null?void 0:p.id),!p||!p.id)throw console.log("Validation failed - leaveData:",p),new Error("Leave details not found");console.log("Setting leave data:",p),r(p)}).catch(u=>{console.error("Error loading leave details:",u),m(u)}).finally(()=>d(!1)))},[a,n]);const g=()=>{m(null),d(!0),z(`/api/v1/leave/requests/${a}`).then(u=>{const b=u.data||u,p=(b==null?void 0:b.item)||b;if(!p||!p.id)throw new Error("Leave details not found");r(p)}).catch(u=>{console.error("Error loading leave details:",u),m(u)}).finally(()=>d(!1))},x=u=>u?u.status===404?{title:"Leave Request Not Found",description:"This leave request may have been removed or is no longer accessible."}:{title:"Unable to load leave details",description:"Unable to load leave details. The request may not exist or you may not have permission."}:null,j=u=>{if(!u)return[];const b=[];return u!=null&&u.createdAt&&b.push({type:"created",timestamp:u.createdAt,label:"Applied",color:"bg-blue-500"}),u!=null&&u.approvedL1At&&b.push({type:"approved_l1",timestamp:u.approvedL1At,label:"Approved L1",color:"bg-green-500"}),u!=null&&u.approvedL2At&&b.push({type:"approved_final",timestamp:u.approvedL2At,label:"Approved Final",color:"bg-green-500"}),u!=null&&u.rejectedAt&&b.push({type:"rejected",timestamp:u.rejectedAt,label:"Rejected",color:"bg-red-500"}),u!=null&&u.cancelledAt&&b.push({type:"cancelled",timestamp:u.cancelledAt,label:"Cancelled",color:"bg-orange-500"}),b.sort((p,y)=>new Date(p.timestamp)-new Date(y.timestamp))};if(!t)return null;const h=x(c),f=j(l);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity",onClick:s}),e.jsx("div",{className:`fixed right-0 top-0 h-full w-96 bg-white shadow-xl z-50 transform transition-transform duration-300 ease-in-out ${t?"translate-x-0":"translate-x-full"}`,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Leave Details"}),e.jsx("button",{onClick:s,className:"p-2 rounded-md hover:bg-gray-100 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:o?e.jsx(de,{}):h?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:h.title}),e.jsx("p",{className:"text-sm text-gray-600 max-w-md mx-auto mb-6",children:h.description}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:"Retry"}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium text-sm",children:"Close"})]})]}):l?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Employee"}),e.jsxs("p",{className:"text-gray-800 font-medium",children:[l==null?void 0:l.firstName," ",l==null?void 0:l.lastName," (",(l==null?void 0:l.employeeCode)||"-",")"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Leave Type"}),e.jsx("p",{className:"text-gray-800",children:(l==null?void 0:l.leaveTypeName)||"-"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Date Range"}),e.jsxs("p",{className:"text-gray-800",children:[oo((l==null?void 0:l.startDate)||"-")," - ",oo((l==null?void 0:l.endDate)||"-")]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Number of Days"}),e.jsxs("p",{className:"text-gray-800",children:[(l==null?void 0:l.units)||"-"," days"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Reason"}),e.jsx("p",{className:"text-gray-800",children:(l==null?void 0:l.reason)||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Status"}),e.jsx("span",{className:`inline-flex rounded-full px-3 py-1 text-sm font-semibold ${(l==null?void 0:l.status)==="APPROVED"?"bg-green-100 text-green-700":(l==null?void 0:l.status)==="REJECTED"?"bg-red-100 text-red-700":(l==null?void 0:l.status)==="PENDING_L1"?"bg-yellow-100 text-yellow-700":(l==null?void 0:l.status)==="PENDING_L2"?"bg-orange-100 text-orange-700":"bg-gray-200 text-gray-500"}`,children:(l==null?void 0:l.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-3",children:"Timeline"}),e.jsx("div",{className:"space-y-3",children:f.length>0?f.map((u,b)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${u.color}`}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-800",children:[e.jsx("span",{className:"font-medium",children:u.label}),e.jsxs("span",{className:"text-gray-600",children:["  ",oo(u.timestamp)]})]})})]},u.timestamp||b)):e.jsx("div",{className:"text-sm text-gray-500",children:"No timeline information available"})})]})]}):null})]})})]})}function Mc(){var G,O,F,W,$,M;const{bootstrap:t}=he(),[s,a]=i.useState(null),[n,l]=i.useState(!1),[r,o]=i.useState(""),[d,c]=i.useState(""),[m,g]=i.useState(""),[x,j]=i.useState(""),h=(P,V)=>{if(!V)return!0;const U=String(V).slice(0,7),B=String((P==null?void 0:P.startDate)||"").slice(0,7),Q=String((P==null?void 0:P.endDate)||"").slice(0,7);return B===U||Q===U},f=P=>String((P==null?void 0:P.status)||"").toUpperCase()!=="SUBMITTED"?!1:!(P!=null&&P.approvedL1At),u=P=>String((P==null?void 0:P.status)||"").toUpperCase()!=="SUBMITTED"?!1:!!(P!=null&&P.approvedL1At)&&!(P!=null&&P.approvedL2At),{data:b,status:p,error:y,refresh:w}=Pe({path:"/api/v1/leave/requests",page:1,pageSize:200,enabled:!0}),{data:S,status:N}=Pe({path:"/api/v1/employees",page:1,pageSize:200,enabled:!0}),{data:E,status:v}=Pe({path:"/api/v1/leave/types",page:1,pageSize:50,enabled:!0}),A=((G=t==null?void 0:t.rbac)==null?void 0:G.roles)||[],T=A.includes("SUPER_ADMIN"),C=A[0];if(!T&&!["SUPER_ADMIN","FOUNDER","HR_ADMIN","FINANCE_ADMIN"].includes(C))return e.jsx(ge,{});i.useEffect(()=>{w()},[r,d,m,x,w]);const D=i.useMemo(()=>(Array.isArray(b==null?void 0:b.items)?b.items:[]).filter(V=>{if(x&&String((V==null?void 0:V.leaveTypeCode)||"")!==String(x)||!h(V,r))return!1;const U=String(d||"");return U?U==="PENDING_L1"?f(V):U==="PENDING_L2"?u(V):String((V==null?void 0:V.status)||"").toUpperCase()===U:!0}),[b==null?void 0:b.items,x,r,d]),R=i.useMemo(()=>{const P=D;return{total:P.length,pendingL1:P.filter(V=>f(V)).length,pendingL2:P.filter(V=>u(V)).length,approved:P.filter(V=>String((V==null?void 0:V.status)||"").toUpperCase()==="APPROVED").length,rejected:P.filter(V=>String((V==null?void 0:V.status)||"").toUpperCase()==="REJECTED").length}},[D]),L=P=>{a(P.id),l(!0)},_=()=>{l(!1),a(null)},I=()=>{g(""),j(""),c(""),o("")};return p==="loading"?e.jsx(de,{}):p==="error"?e.jsx(le,{onRetry:w}):D.length?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-3xl shadow-xl mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-900 to-slate-700 bg-clip-text text-transparent",children:"Leave Overview"}),e.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Comprehensive leave management and tracking system"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Total Requests"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:R.total})]}),e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Pending L1"}),e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:R.pendingL1})]}),e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Pending L2"}),e.jsx("p",{className:"text-xl font-bold text-orange-600",children:R.pendingL2})]}),e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Approved"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:R.approved})]}),e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Rejected"}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:R.rejected})]}),e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})})]}),(b==null?void 0:b.monthLocked)&&e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50/50 border border-amber-200 text-amber-800 px-6 py-4 rounded-2xl shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Leave Records Locked"}),e.jsx("div",{className:"text-sm opacity-90",children:"Leave records for this month are locked and cannot be modified."})]})]})}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),e.jsx("button",{onClick:I,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Reset Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee"}),e.jsxs("select",{value:m,onChange:P=>g(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Employees"}),(W=S==null?void 0:S.items)==null?void 0:W.map(P=>e.jsxs("option",{value:P.id,children:[P.firstName," ",P.lastName," (",P.employeeCode,")"]},P.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Leave Type"}),e.jsxs("select",{value:x,onChange:P=>j(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Types"}),($=E==null?void 0:E.items)==null?void 0:$.map(P=>e.jsx("option",{value:P.code,children:P.name},P.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:d,onChange:P=>c(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"PENDING_L1",children:"Pending L1"}),e.jsx("option",{value:"PENDING_L2",children:"Pending L2"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Month"}),e.jsxs("select",{value:r,onChange:P=>o(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Month"}),e.jsx("option",{value:"2026-02",children:"February 2026"}),e.jsx("option",{value:"2026-01",children:"January 2026"}),e.jsx("option",{value:"2025-12",children:"December 2025"}),e.jsx("option",{value:"2025-11",children:"November 2025"})]})]})]})]}),e.jsx(oa,{title:"Leave Records",defaultOpen:!0,children:e.jsx(Lc,{data:D,role:C,monthLocked:b.monthLocked,onView:L})}),e.jsx(oa,{title:"Policy Info",defaultOpen:!1,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Supported Leave Types:"}),e.jsx("ul",{className:"space-y-1 text-sm text-gray-600",children:(M=E==null?void 0:E.items)==null?void 0:M.map(P=>e.jsxs("li",{children:[" ",e.jsx("strong",{children:P.name})," - ",P.code]},P.id))})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Important:"})," Leave affects attendance, not salary directly."]})})]})}),e.jsx(Dc,{isOpen:n,onClose:_,leaveId:s})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-3xl shadow-xl mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-900 to-slate-700 bg-clip-text text-transparent",children:"Leave Overview"}),e.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Comprehensive leave management and tracking system"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Requests"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:R.total})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:R.pendingL1+R.pendingL2})]}),e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Approved"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:R.approved})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rejected"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:R.rejected})]}),e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})})]}),(b==null?void 0:b.monthLocked)&&e.jsx("div",{className:"bg-gray-100 border border-gray-200 text-gray-600 px-4 py-3 rounded-xl",children:" Leave records for this month are locked."}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),e.jsx("button",{onClick:I,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Reset Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee"}),e.jsxs("select",{value:m,onChange:P=>g(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Employees"}),(O=S==null?void 0:S.items)==null?void 0:O.map(P=>e.jsxs("option",{value:P.id,children:[P.firstName," ",P.lastName," (",P.employeeCode,")"]},P.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Leave Type"}),e.jsxs("select",{value:x,onChange:P=>j(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Types"}),(F=E==null?void 0:E.items)==null?void 0:F.map(P=>e.jsx("option",{value:P.code,children:P.name},P.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:d,onChange:P=>c(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"PENDING_L1",children:"Pending L1"}),e.jsx("option",{value:"PENDING_L2",children:"Pending L2"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Month"}),e.jsxs("select",{value:r,onChange:P=>o(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Month"}),e.jsx("option",{value:"2026-02",children:"February 2026"}),e.jsx("option",{value:"2026-01",children:"January 2026"}),e.jsx("option",{value:"2025-12",children:"December 2025"}),e.jsx("option",{value:"2025-11",children:"November 2025"})]})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Leave Requests Found"}),e.jsx("p",{className:"text-sm text-gray-600 max-w-md mx-auto",children:"Try adjusting filters or selecting another month."})]})]})}function pb(){var a;const{bootstrap:t}=he();return(((a=t==null?void 0:t.rbac)==null?void 0:a.permissions)||[]).includes("LEAVE_REQUEST_READ")?e.jsx(Mc,{}):e.jsx(ge,{})}function fb(){var T,C,k,D,R,L,_,I,G,O,F,W;const{bootstrap:t}=he(),s=((T=t==null?void 0:t.rbac)==null?void 0:T.permissions)||[];if(!s.includes("LEAVE_REQUEST_READ"))return e.jsx(ge,{});const[a,n]=i.useState(new Date().toISOString().slice(0,7)),[l,r]=i.useState(""),[o,d]=i.useState(""),[c,m]=i.useState(""),[g,x]=i.useState(""),[j,h]=i.useState(null),[f,u]=i.useState(!1),[b,p]=i.useState(null),y=Pe({path:"/api/v1/leave/requests",page:1,pageSize:100,enabled:!0}),w=Pe({path:"/api/v1/employees",page:1,pageSize:200,enabled:!0}),S=Pe({path:"/api/v1/leave/types",page:1,pageSize:50,enabled:!0});i.useEffect(()=>{(async()=>{try{const M=await z(`/api/v1/governance/month-close?month=${a}`);M.items&&M.items.length>0?h(M.items[0].status==="CLOSED"):h(!1)}catch{h(!1)}})()},[a]);const N=Ca.useMemo(()=>{var $;return($=y.data)!=null&&$.items?y.data.items.filter(M=>{var P;return!(l&&M.employeeId!==l||o&&M.leaveTypeId!==o||c&&M.status!==c||g&&((P=M.employee)==null?void 0:P.divisionId)!==g||a&&!M.startDate.startsWith(a))}):[]},[(C=y.data)==null?void 0:C.items,l,o,c,g,a]),E=Ca.useMemo(()=>{const $=N.length,M=N.filter(B=>B.status==="PENDING").length,P=N.filter(B=>B.status==="APPROVED").length,V=N.filter(B=>B.status==="REJECTED").length,U=N.filter(B=>B.status==="CANCELLED").length;return{total:$,pending:M,approved:P,rejected:V,cancelled:U}},[N]),v=()=>{r(""),d(""),m(""),x("")},A=$=>({PENDING:"bg-amber-100 text-amber-800 border-amber-200",APPROVED:"bg-green-100 text-green-800 border-green-200",REJECTED:"bg-red-100 text-red-800 border-red-200",CANCELLED:"bg-gray-100 text-gray-800 border-gray-200"})[$]||"bg-gray-100 text-gray-800 border-gray-200";return y.status==="loading"||w.status==="loading"||S.status==="loading"?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Leave Overview"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Monitor and review employee leave records"})]}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-6",children:e.jsx(de,{message:"Loading leave requests..."})})]}):y.status==="error"||w.status==="error"||S.status==="error"?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Leave Overview"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Monitor and review employee leave records"})]}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-6",children:e.jsx(le,{error:y.error||w.error||S.error})})]}):e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Leave Overview"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Monitor and review employee leave records"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Month:"}),e.jsx("input",{type:"month",value:a,onChange:$=>n($.target.value),className:"px-3 py-1.5 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("select",{value:l,onChange:$=>r($.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 min-w-0 flex-1",children:[e.jsx("option",{value:"",children:"All Employees"}),(D=(k=w.data)==null?void 0:k.items)==null?void 0:D.map($=>e.jsxs("option",{value:$.id,children:[$.firstName," ",$.lastName," (",$.employeeCode,")"]},$.id))]}),e.jsxs("select",{value:o,onChange:$=>d($.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 min-w-0 flex-1",children:[e.jsx("option",{value:"",children:"All Leave Types"}),(L=(R=S.data)==null?void 0:R.items)==null?void 0:L.map($=>e.jsx("option",{value:$.id,children:$.name},$.id))]}),e.jsxs("select",{value:c,onChange:$=>m($.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 min-w-0 flex-1",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]}),e.jsxs("select",{value:g,onChange:$=>x($.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 min-w-0 flex-1",children:[e.jsx("option",{value:"",children:"All Divisions"}),[...new Set((I=(_=w.data)==null?void 0:_.items)==null?void 0:I.map($=>$.division).filter(Boolean))].map($=>e.jsx("option",{value:$.id,children:$.name},$.id))]}),e.jsx("button",{onClick:v,className:"px-3 py-2 border border-slate-300 rounded-lg text-sm text-slate-700 hover:bg-slate-50 transition-colors",children:"Reset"})]})}),e.jsx("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:"Total:"}),e.jsx("span",{className:"font-medium text-slate-900",children:E.total})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:"Pending:"}),e.jsx("span",{className:"font-medium text-amber-700",children:E.pending})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:"Approved:"}),e.jsx("span",{className:"font-medium text-green-700",children:E.approved})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:"Rejected:"}),e.jsx("span",{className:"font-medium text-red-700",children:E.rejected})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-600",children:"Cancelled:"}),e.jsx("span",{className:"font-medium text-gray-700",children:E.cancelled})]})]})}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Employee"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Division"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Leave Type"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Date Range"}),e.jsx("th",{className:"text-center py-3 px-4 font-medium text-slate-700",children:"Days"}),e.jsx("th",{className:"text-center py-3 px-4 font-medium text-slate-700",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Applied On"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Approved By"}),e.jsx("th",{className:"text-center py-3 px-4 font-medium text-slate-700",children:"Actions"})]})}),e.jsx("tbody",{children:N.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"9",className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No leave requests found"}),e.jsx("p",{className:"text-sm text-slate-600",children:"No leave requests match the current filters."})]})}):N.map($=>{var M,P,V,U,B,Q,ae;return e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsxs("td",{className:"py-3 px-4",children:[e.jsxs("div",{className:"font-medium text-slate-900",children:[(M=$.employee)==null?void 0:M.firstName," ",(P=$.employee)==null?void 0:P.lastName]}),e.jsx("div",{className:"text-xs text-slate-600",children:(V=$.employee)==null?void 0:V.employeeCode})]}),e.jsx("td",{className:"py-3 px-4 text-slate-600",children:((B=(U=$.employee)==null?void 0:U.division)==null?void 0:B.name)||"-"}),e.jsx("td",{className:"py-3 px-4 text-slate-600",children:((Q=$.leaveType)==null?void 0:Q.name)||"-"}),e.jsxs("td",{className:"py-3 px-4 text-slate-600",children:[new Date($.startDate).toLocaleDateString()," - ",new Date($.endDate).toLocaleDateString()]}),e.jsx("td",{className:"text-center py-3 px-4 text-slate-600",children:$.totalDays||"-"}),e.jsx("td",{className:"text-center py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${A($.status)}`,children:$.status})}),e.jsx("td",{className:"py-3 px-4 text-slate-600",children:new Date($.createdAt).toLocaleDateString()}),e.jsx("td",{className:"py-3 px-4 text-slate-600",children:((ae=$.approvedBy)==null?void 0:ae.name)||"-"}),e.jsx("td",{className:"text-center py-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>{p($),u(!0)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"View details",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),s.includes("LEAVE_OVERRIDE")&&!j&&e.jsx("button",{className:"p-1.5 text-amber-600 hover:bg-amber-50 rounded-lg transition-colors",title:"Override request",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})})]},$.id)})})]})})})]}),f&&b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Leave Request Details"}),e.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-slate-100 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Employee"}),e.jsxs("p",{className:"text-slate-900",children:[(G=b.employee)==null?void 0:G.firstName," ",(O=b.employee)==null?void 0:O.lastName]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Employee Code"}),e.jsx("p",{className:"text-slate-900",children:(F=b.employee)==null?void 0:F.employeeCode})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Leave Type"}),e.jsx("p",{className:"text-slate-900",children:(W=b.leaveType)==null?void 0:W.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Status"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${A(b.status)}`,children:b.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Start Date"}),e.jsx("p",{className:"text-slate-900",children:new Date(b.startDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"End Date"}),e.jsx("p",{className:"text-slate-900",children:new Date(b.endDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Total Days"}),e.jsx("p",{className:"text-slate-900",children:b.totalDays})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Applied On"}),e.jsx("p",{className:"text-slate-900",children:new Date(b.createdAt).toLocaleDateString()})]})]}),b.reason&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Reason"}),e.jsx("p",{className:"text-slate-900 mt-1",children:b.reason})]}),b.approvedBy&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Approved By"}),e.jsx("p",{className:"text-slate-900 mt-1",children:b.approvedBy.name})]})]})]})})]})}function ha({columns:t,data:s,loading:a,empty:n,onRowClick:l}){return a?e.jsx("div",{className:"bg-white/95 backdrop-blur-sm border border-white/20 rounded-2xl shadow-lg overflow-hidden",children:e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-slate-200 rounded-full"}),e.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-4 border-blue-500 rounded-full border-t-transparent animate-spin"})]}),e.jsx("span",{className:"ml-3 text-slate-600 font-medium",children:"Loading..."})]})})}):!s||s.length===0?e.jsx("div",{className:"bg-white/95 backdrop-blur-sm border border-white/20 rounded-2xl shadow-lg overflow-hidden",children:e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-slate-100 to-slate-200 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:e.jsx("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No data"}),e.jsx("p",{className:"text-slate-600",children:n||"No items to display"})]})})}):e.jsx("div",{className:"bg-white/95 backdrop-blur-sm border border-white/20 rounded-2xl shadow-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-50 to-slate-100",children:e.jsx("tr",{children:t.map(r=>e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider",children:r.title},r.key))})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:s.map((r,o)=>e.jsx("tr",{onClick:()=>l&&l(r),className:`transition-all duration-200 ${l?"hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 cursor-pointer":""}`,children:t.map(d=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:d.render?d.render(r[d.key],r):r[d.key]},d.key))},o))})]})})}function tl(...t){return t.filter(Boolean).join(" ")}function gb(t){const s=String(t??"").trim().toLowerCase();return s==="true"||s==="1"||s==="yes"||s==="enabled"||s==="on"}function vb(t){const s=String(t||"").toUpperCase();return s==="SUBMITTED"?"bg-blue-50 text-blue-800":s==="APPROVED"?"bg-emerald-50 text-emerald-800":s==="REJECTED"?"bg-rose-50 text-rose-800":"bg-slate-100 text-slate-800"}function Du({status:t}){const s=String(t||"").toUpperCase();return s?e.jsx("span",{className:tl("inline-flex rounded-full px-2 py-1 text-xs font-semibold",vb(s)),children:s}):null}function ir(t){const s=new Date(`${t}T00:00:00.000Z`);return new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth()+1,0)).toISOString().slice(0,10)}function Ph(){var $,M,P,V;const{bootstrap:t}=he(),s=(($=t==null?void 0:t.rbac)==null?void 0:$.permissions)||[],a=s.includes("LEAVE_REQUEST_READ"),n=s.includes("LEAVE_APPROVE_L1"),l=s.includes("LEAVE_APPROVE_L2"),r=s.includes("GOV_MONTH_CLOSE_READ"),o=(t==null?void 0:t.systemConfig)||{},d=((M=t==null?void 0:t.features)==null?void 0:M.flags)||{},c=gb(((P=o==null?void 0:o.LEAVE_ENABLED)==null?void 0:P.value)??(o==null?void 0:o.LEAVE_ENABLED)),m=!!(d!=null&&d.MONTH_CLOSE_ENABLED),g=!!(n||l),x=i.useMemo(()=>l&&!n?"PENDING_L2":"SUBMITTED",[n,l]),[j,h]=i.useState(""),[f,u]=i.useState(""),[b,p]=i.useState(""),[y,w]=i.useState(""),[S,N]=i.useState(1),[E]=i.useState(20),v=i.useMemo(()=>{const U=new URL("/api/v1/leave/requests","http://local");return U.searchParams.set("page",String(S)),U.searchParams.set("pageSize",String(E)),U.searchParams.set("status",x),j.trim()&&U.searchParams.set("divisionId",j.trim()),U.pathname+U.search},[j,S,E,x]),A=Pe({path:v,page:S,pageSize:E,enabled:c&&a&&g}),T=i.useMemo(()=>{var ae;const U=[...((ae=A.data)==null?void 0:ae.items)||[]],B=!x||x==="PENDING_L2"?U:U.filter(ie=>String(ie.status||"").toUpperCase()===x),Q=String(y||"").trim().toLowerCase();return Q?B.filter(ie=>`${ie.employeeCode||""} ${ie.firstName||""} ${ie.lastName||""} ${ie.leaveTypeName||""} ${ie.leaveTypeCode||""} ${ie.startDate||""} ${ie.endDate||""}`.trim().toLowerCase().includes(Q)):B},[A.data,x,y]),C=((V=A.data)==null?void 0:V.total)||0;i.useEffect(()=>{var U,B,Q,ae,ie;try{console.log("[LeaveApprovalPage] queueStatus:",x),console.log("[LeaveApprovalPage] apiItems:",(((U=A.data)==null?void 0:U.items)||[]).length),console.log("[LeaveApprovalPage] filteredItems:",T.length),(((B=A.data)==null?void 0:B.items)||[]).length>0&&console.log("[LeaveApprovalPage] firstItem.status:",(ie=(ae=(Q=A.data)==null?void 0:Q.items)==null?void 0:ae[0])==null?void 0:ie.status)}catch{}},[x,A.data,T.length]);const k=Pe({path:"/api/v1/governance/month-close",page:1,pageSize:200,enabled:m&&r}),D=i.useMemo(()=>{var B;const U=new Set;for(const Q of((B=k.data)==null?void 0:B.items)||[]){const ae=(Q==null?void 0:Q.monthEnd)||(Q==null?void 0:Q.monthStart)||(Q==null?void 0:Q.month);ae&&String((Q==null?void 0:Q.status)||"").toUpperCase()==="CLOSED"&&U.add(String(ae).slice(0,10))}return U},[k.data]),R=Be(async({id:U,reason:B})=>z(`/api/v1/leave/requests/${U}/approve`,{method:"POST",body:{reason:B||null}})),L=Be(async({id:U,reason:B})=>z(`/api/v1/leave/requests/${U}/reject`,{method:"POST",body:{reason:B}})),[_,I]=i.useState(null),[G,O]=i.useState(""),F=x==="PENDING_L2"?"L2 (Final)":"L1",W=i.useMemo(()=>{var U,B;return a?c?g?A.status==="loading"&&!A.data?e.jsx(de,{}):A.status==="error"?((U=A.error)==null?void 0:U.status)===403?e.jsx(ge,{}):e.jsx(le,{error:A.error}):e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Leave Approvals"}),e.jsxs("span",{className:tl("inline-flex items-center rounded-full px-2 py-1 text-xs font-semibold",x==="PENDING_L2"?"bg-purple-50 text-purple-800":"bg-blue-50 text-blue-800"),children:["Queue: ",F]})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Showing: ",T.length," / Total: ",C]})]}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:A.refresh,disabled:A.status==="loading"||R.status==="loading"||L.status==="loading",children:"Refresh"})]}),e.jsxs("div",{className:"p-4 grid grid-cols-1 gap-3 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Search"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm min-h-[44px]",value:y,onChange:Q=>{w(Q.target.value),N(1)},placeholder:"Employee / type / date"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Filters the current page results."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Division Id (optional)"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono min-h-[44px]",value:f,onChange:Q=>{const ae=Q.target.value;u(ae),ae.trim()===""?(h(""),p(""),N(1)):/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(ae.trim())?(h(ae.trim()),p(""),N(1)):p("Please enter a valid UUID (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)")},placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Filter the approval queue to a specific division."}),b?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:b}):null]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Month Close"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:m?r?"Closed months are marked if readable.":"You do not have GOV_MONTH_CLOSE_READ permission.":"Month-close feature is disabled."})]})]}),e.jsx("div",{className:"p-4",children:T.length===0?e.jsx(ye,{title:"No pending requests",description:`No ${x} leave requests found for your scope.`}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(ha,{columns:[{key:"employee",title:"Employee",render:(Q,ae)=>e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:ae.employeeCode||String(ae.employeeId).slice(0,8)+""}),e.jsxs("div",{className:"mt-0.5 text-xs text-slate-500",children:[ae.firstName||""," ",ae.lastName||""]})]})},{key:"type",title:"Leave Type",render:(Q,ae)=>e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:ae.leaveTypeName||ae.leaveTypeCode||""}),e.jsx("div",{className:"mt-0.5 text-xs text-slate-500",children:ae.leaveTypeIsPaid?"Paid":"Unpaid"})]})},{key:"dates",title:"Dates",render:(Q,ae)=>{const ie=String(ae.startDate||"").slice(0,10),we=String(ae.endDate||"").slice(0,10),De=ie?ir(ie):null,Z=we?ir(we):null,ve=!!(De&&D.has(De))||!!(Z&&D.has(Z));return e.jsxs("div",{children:[e.jsxs("div",{className:"font-mono text-sm text-slate-900",children:[ie,"  ",we]}),m&&r?e.jsx("div",{className:tl("mt-0.5 text-xs",ve?"text-amber-700":"text-slate-500"),children:ve?"Month CLOSED":"Month open"}):null]})}},{key:"status",title:"Status",render:(Q,ae)=>e.jsx(Du,{status:ae.status})},{key:"action",title:"Action",render:(Q,ae)=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx($e,{to:`/leave/requests/${ae.id}`,state:{item:ae,employeeId:ae.employeeId},className:"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"View"}),e.jsx("button",{type:"button",className:"rounded-md bg-emerald-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-emerald-700 disabled:bg-emerald-300",disabled:R.status==="loading"||L.status==="loading",onClick:()=>{O(""),I({mode:"approve",item:ae})},children:"Approve"}),e.jsx("button",{type:"button",className:"rounded-md bg-rose-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-rose-700 disabled:bg-rose-300",disabled:R.status==="loading"||L.status==="loading",onClick:()=>{O(""),I({mode:"reject",item:ae})},children:"Reject"})]})}],data:T},`${T.length}:${((B=T[0])==null?void 0:B.id)||"none"}`)}),e.jsx("div",{className:"grid grid-cols-1 gap-3 md:hidden",children:T.map(Q=>{const ae=String(Q.startDate||"").slice(0,10),ie=String(Q.endDate||"").slice(0,10),we=ae?ir(ae):null,De=ie?ir(ie):null,Z=!!(we&&D.has(we))||!!(De&&D.has(De));return e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-900",children:[Q.firstName||""," ",Q.lastName||""]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:Q.employeeCode||String(Q.employeeId).slice(0,8)+""})]}),e.jsx(Du,{status:Q.status})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Leave"}),e.jsx("div",{className:"mt-0.5 text-sm text-slate-900",children:Q.leaveTypeName||Q.leaveTypeCode}),e.jsxs("div",{className:"mt-2 font-mono text-sm text-slate-700",children:[ae,"  ",ie]}),m&&r?e.jsx("div",{className:tl("mt-1 text-xs",Z?"text-amber-700":"text-slate-500"),children:Z?"Month CLOSED":"Month open"}):null]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2",children:[e.jsx($e,{to:`/leave/requests/${Q.id}`,state:{item:Q,employeeId:Q.employeeId},className:"inline-flex w-full items-center justify-center rounded-md border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"View"}),e.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-md bg-emerald-600 px-3 py-2 text-sm font-medium text-white hover:bg-emerald-700 disabled:bg-emerald-300",disabled:R.status==="loading"||L.status==="loading",onClick:()=>{O(""),I({mode:"approve",item:Q})},children:"Approve"}),e.jsx("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-md bg-rose-600 px-3 py-2 text-sm font-medium text-white hover:bg-rose-700 disabled:bg-rose-300",disabled:R.status==="loading"||L.status==="loading",onClick:()=>{O(""),I({mode:"reject",item:Q})},children:"Reject"})]})]},Q.id)})})]})}),e.jsx("div",{className:"p-4 pt-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:S<=1,onClick:()=>N(Q=>Math.max(1,Q-1)),children:"Previous"}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",S]}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:S*E>=C,onClick:()=>N(Q=>Q+1),children:"Next"})]})})]})}):e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Approvals not accessible"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"You need LEAVE_APPROVE_L1 or LEAVE_APPROVE_L2 permission."})]}):e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Leave is disabled"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"LEAVE_ENABLED must be enabled in system config."})]}):e.jsx(ge,{})},[R.status,g,a,r,D,j,T,c,A,m,S,E,L.status,C]);return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Leave Approvals"}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-8",children:e.jsx("div",{className:"mt-4",children:W})}),_?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>{R.status==="loading"||L.status==="loading"||I(null)}}),e.jsxs("div",{className:"relative w-full max-w-xl rounded-xl bg-white border border-slate-200 shadow-sm p-5 max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:_.mode==="approve"?"Approve Leave Request":"Reject Leave Request"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:_.mode==="approve"?"Reason is optional; it may be required if a month-close override is needed.":"Reason is required."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason"}),e.jsx("textarea",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",rows:4,value:G,onChange:U=>O(U.target.value),placeholder:_.mode==="approve"?"Optional":"Required"})]}),R.status==="error"||L.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:R.error||L.error})}):null,e.jsxs("div",{className:"mt-4 flex flex-col gap-2 sm:flex-row sm:justify-end",children:[e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 bg-white px-4 py-3 text-sm font-medium text-slate-700 hover:bg-slate-50 min-h-[44px]",onClick:()=>{R.status==="loading"||L.status==="loading"||(I(null),O(""))},disabled:R.status==="loading"||L.status==="loading",children:"Cancel"}),e.jsx("button",{type:"button",className:tl("w-full sm:w-auto rounded-md px-4 py-3 text-sm font-medium text-white min-h-[44px]",_.mode==="approve"?"bg-emerald-600 hover:bg-emerald-700 disabled:bg-emerald-300":"bg-rose-600 hover:bg-rose-700 disabled:bg-rose-300"),disabled:R.status==="loading"||L.status==="loading"||_.mode==="reject"&&G.trim().length===0,onClick:async()=>{const U=G.trim();try{_.mode==="approve"?await R.run({id:_.item.id,reason:U||null}):await L.run({id:_.item.id,reason:U}),I(null),O(""),A.refresh()}catch{}},children:_.mode==="approve"?"Approve":"Reject"})]})]})]})}):null]})}function bb(){return e.jsx(Ph,{})}function rs(...t){return t.filter(Boolean).join(" ")}function jb(t){const s=String(t??"").trim().toLowerCase();return s==="true"||s==="1"||s==="yes"||s==="enabled"||s==="on"}function co(t){const s=String((t==null?void 0:t.firstName)||"").trim(),a=String((t==null?void 0:t.lastName)||"").trim();return`${s} ${a}`.trim()||""}function Nb(t){const s=String(t||"").toUpperCase();return s==="SUBMITTED"?"bg-blue-50 text-blue-800":s==="APPROVED"?"bg-emerald-50 text-emerald-800":s==="REJECTED"?"bg-rose-50 text-rose-800":s==="REVISION_REQUIRED"?"bg-amber-50 text-amber-800":"bg-slate-100 text-slate-800"}function Mu({status:t}){const s=String(t||"").toUpperCase();return s?e.jsx("span",{className:rs("inline-flex rounded-full px-2 py-1 text-xs font-semibold",Nb(s)),children:s}):null}function or(t){const s=String((t==null?void 0:t.status)||"").toUpperCase();return!!(s==="SUBMITTED"||s==="APPROVED"&&(t!=null&&t.approvedL1At)&&!(t!=null&&t.approvedL2At))}function yb(){const t=new Date,s=t.getDay(),a=t.getDate()-s+(s===0?-6:1),n=new Date(t.setDate(a)),l=new Date(t.setDate(a+6));return{start:n.toISOString().slice(0,10),end:l.toISOString().slice(0,10),display:`${n.toLocaleDateString()} - ${l.toLocaleDateString()}`}}function Ih(){var Q,ae,ie,we,De,Z;const{bootstrap:t}=he(),s=((Q=t==null?void 0:t.rbac)==null?void 0:Q.permissions)||[],a=((ae=t==null?void 0:t.rbac)==null?void 0:ae.roles)||[],n=s.includes("TIMESHEET_APPROVAL_QUEUE_READ"),l=a.includes("SUPER_ADMIN"),r=s.includes("TIMESHEET_APPROVE_L1")||l,o=s.includes("TIMESHEET_APPROVE_L2")||l,d=!!(r||o),c=(t==null?void 0:t.systemConfig)||{},m=jb(((ie=c==null?void 0:c.TIMESHEET_ENABLED)==null?void 0:ie.value)??(c==null?void 0:c.TIMESHEET_ENABLED)),g=parseInt((we=c==null?void 0:c.TIMESHEET_APPROVAL_LEVELS)==null?void 0:we.value)||1,[x,j]=i.useState(1),[h,f]=i.useState(20),[u,b]=i.useState(""),[p,y]=i.useState("ALL"),[w,S]=i.useState(""),[N,E]=i.useState(""),[v,A]=i.useState("pending"),[T,C]=i.useState("submittedOn"),[k,D]=i.useState("desc"),R=Be(async({id:ve})=>z(`/api/v1/timesheets/${ve}/approve`,{method:"POST",body:{}})),L=Be(async({id:ve,reason:ue})=>z(`/api/v1/timesheets/${ve}/reject`,{method:"POST",body:{reason:ue}})),[_,I]=i.useState(null),[G,O]=i.useState("");yb();const F=i.useMemo(()=>g===1?"L1":o&&!r?"L2 (Final)":"L1",[g,r,o]),W=Pe({path:"/api/v1/timesheets/approvals",page:x,pageSize:h,enabled:n&&m}),$=((De=W.data)==null?void 0:De.items)||[],M=((Z=W.data)==null?void 0:Z.total)||0,P=i.useMemo(()=>{const ve=$.filter(Re=>or(Re)).length,ue=$.filter(Re=>String(Re.status||"").toUpperCase()==="APPROVED").length,re=$.filter(Re=>String(Re.status||"").toUpperCase()==="REJECTED").length;return{pending:ve,approved:ue,rejected:re}},[$]),V=i.useMemo(()=>{let ve=$;v==="approved"?ve=ve.filter(re=>String(re.status||"").toUpperCase()==="APPROVED"):v==="rejected"?ve=ve.filter(re=>String(re.status||"").toUpperCase()==="REJECTED"):ve=ve.filter(re=>or(re));const ue=String(u||"").trim().toLowerCase();return ue&&(ve=ve.filter(re=>`${re.employeeCode||""} ${co(re)} ${re.periodStart||""} ${re.periodEnd||""}`.toLowerCase().includes(ue))),p!=="ALL"&&(ve=ve.filter(re=>String(re.status||"").toUpperCase()===p)),w&&N&&(ve=ve.filter(re=>re.periodStart>=w&&re.periodEnd<=N)),ve},[$,u,p,w,N,v]),U=i.useMemo(()=>{const ve=[{key:"employee",header:e.jsxs("button",{onClick:()=>{T==="employee"?D(k==="asc"?"desc":"asc"):(C("employee"),D("asc"))},"aria-sort":T==="employee"?k==="asc"?"ascending":"descending":"none",className:rs("flex items-center gap-1 text-left font-medium px-2 py-1 rounded transition-colors",T==="employee"?"text-slate-900 font-semibold bg-slate-100":"text-slate-700 hover:text-slate-900 hover:bg-slate-50"),children:["Employee Name",e.jsx("span",{className:rs("text-xs",T==="employee"?"text-slate-900":"text-slate-400"),children:T==="employee"?k==="asc"?"":"":""})]}),render:ue=>e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:co(ue)}),e.jsx("div",{className:"mt-1 font-mono text-xs text-slate-600",children:ue.employeeCode||""})]})},{key:"employeeCode",header:"Employee Code",render:ue=>e.jsx("span",{className:"font-mono text-sm text-slate-900",children:ue.employeeCode||""})},{key:"week",header:"Week Range",render:ue=>e.jsxs("span",{className:"font-mono text-sm text-slate-900",children:[ue.periodStart,"  ",ue.periodEnd]})},{key:"totalHours",header:e.jsxs("button",{onClick:()=>{T==="totalHours"?D(k==="asc"?"desc":"asc"):(C("totalHours"),D("desc"))},"aria-sort":T==="totalHours"?k==="asc"?"ascending":"descending":"none",className:rs("flex items-center justify-end gap-1 text-right font-medium px-2 py-1 rounded transition-colors",T==="totalHours"?"text-slate-900 font-semibold bg-slate-100":"text-slate-700 hover:text-slate-900 hover:bg-slate-50"),children:["Total Hours",e.jsx("span",{className:rs("text-xs",T==="totalHours"?"text-slate-900":"text-slate-400"),children:T==="totalHours"?k==="asc"?"":"":""})]}),render:ue=>e.jsx("span",{className:"text-sm font-medium text-slate-900 text-right block",children:ue.totalHours||"0"})},{key:"submittedOn",header:e.jsxs("button",{onClick:()=>{T==="submittedOn"?D(k==="asc"?"desc":"asc"):(C("submittedOn"),D("desc"))},"aria-sort":T==="submittedOn"?k==="asc"?"ascending":"descending":"none",className:rs("flex items-center gap-1 text-left font-medium px-2 py-1 rounded transition-colors",T==="submittedOn"?"text-slate-900 font-semibold bg-slate-100":"text-slate-700 hover:text-slate-900 hover:bg-slate-50"),children:["Submitted On",e.jsx("span",{className:rs("text-xs",T==="submittedOn"?"text-slate-900":"text-slate-400"),children:T==="submittedOn"?k==="asc"?"":"":""})]}),render:ue=>e.jsx("span",{className:"text-sm text-slate-900",children:ue.submittedAt?new Date(ue.submittedAt).toLocaleDateString():""})},{key:"status",header:"Status",render:ue=>e.jsx("div",{className:"flex justify-center",children:e.jsx(Mu,{status:ue.status})})},{key:"approvalLevel",header:"Approval Level",render:ue=>{const Re=Number((ue==null?void 0:ue.pendingApprovalLevel)||1)===2?"L2":"L1",ne=g===1||g===2&&Re==="L2";return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:rs("inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold shadow-sm",Re==="L1"?"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800":"bg-gradient-to-r from-purple-100 to-purple-200 text-purple-800"),children:Re}),ne&&e.jsx("span",{className:"inline-flex items-center rounded-full bg-gradient-to-r from-emerald-100 to-emerald-200 px-2 py-1 text-xs font-semibold text-emerald-800 shadow-sm",children:"Final"})]})}}];return ve.push({key:"action",header:"Actions",render:ue=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[!l&&e.jsx($e,{to:`/timesheet/${ue.id}`,className:"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50 focus:ring-2 focus:ring-blue-500 focus:ring-offset-1",children:"View"}),d&&or(ue)?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"rounded-md bg-emerald-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-emerald-700 disabled:bg-emerald-300",disabled:R.status==="loading"||L.status==="loading",onClick:async()=>{await R.run({id:ue.id}),await W.refresh()},children:"Approve"}),e.jsx("button",{type:"button",className:"rounded-md bg-rose-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-rose-700 disabled:bg-rose-300",disabled:R.status==="loading"||L.status==="loading",onClick:()=>{O(""),I({mode:"reject",item:ue})},children:"Reject"})]}):null]})}),ve},[l,V,T,k,g]),B=i.useMemo(()=>{var ve,ue;return n?m?W.status==="loading"&&!W.data?e.jsx(de,{}):W.status==="error"?((ve=W.error)==null?void 0:ve.status)===403?e.jsx(ge,{}):e.jsx(le,{error:W.error}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-white to-blue-50 rounded-2xl border border-blue-200 shadow-lg p-6 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center rounded-full bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-2 text-xs font-medium text-white shadow-md",children:"Acting as Approver"}),e.jsxs("span",{className:rs("inline-flex items-center rounded-full px-3 py-2 text-xs font-semibold shadow-sm",String(F).startsWith("L2")?"bg-purple-50 text-purple-800 border border-purple-200":"bg-blue-50 text-blue-800 border border-blue-200"),children:["Queue: ",F]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-600",children:[e.jsxs("span",{className:"inline-flex items-center rounded-md bg-white/80 backdrop-blur-sm px-3 py-1.5 border border-slate-200 shadow-sm",children:["Pending: ",P.pending]}),e.jsxs("span",{className:"inline-flex items-center rounded-md bg-white/80 backdrop-blur-sm px-3 py-1.5 border border-slate-200 shadow-sm",children:["Approved: ",P.approved]}),e.jsxs("span",{className:"inline-flex items-center rounded-md bg-white/80 backdrop-blur-sm px-3 py-1.5 border border-slate-200 shadow-sm",children:["Rejected: ",P.rejected]}),e.jsxs("span",{className:"inline-flex items-center rounded-md bg-white/80 backdrop-blur-sm px-3 py-1.5 border border-slate-200 shadow-sm",children:["Levels: ",g]}),e.jsxs("span",{className:"inline-flex items-center rounded-md bg-white/80 backdrop-blur-sm px-3 py-1.5 border border-slate-200 shadow-sm",children:["Max Hours/Day: ",((ue=c==null?void 0:c.TIMESHEET_MAX_HOURS_PER_DAY)==null?void 0:ue.value)||8]})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-white to-slate-50 rounded-2xl border border-slate-200 shadow-lg p-6 backdrop-blur-sm",children:e.jsx("div",{className:"flex space-x-8",children:[{key:"pending",label:"Pending",count:P.pending},{key:"approved",label:"Approved",count:P.approved},{key:"rejected",label:"Rejected",count:P.rejected}].map(re=>e.jsxs("button",{onClick:()=>A(re.key),className:rs("py-3 px-2 border-b-3 font-medium text-sm flex items-center gap-2 transition-all rounded-t-lg",v===re.key?"border-blue-500 text-blue-600 font-bold bg-gradient-to-b from-blue-50 to-white shadow-sm -mb-px":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 hover:bg-slate-50"),children:[re.label,e.jsx("span",{className:rs("inline-flex items-center rounded-full px-3 py-1 text-xs font-bold shadow-sm",v===re.key?"bg-gradient-to-r from-blue-500 to-blue-600 text-white":"bg-slate-100 text-slate-600"),children:re.count})]},re.key))})}),e.jsxs("div",{className:"bg-gradient-to-r from-white to-slate-50 rounded-2xl border border-slate-200 shadow-lg p-6 backdrop-blur-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-700 mb-2",children:"Search"}),e.jsx("input",{className:"w-full rounded-lg border-slate-300 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm",value:u,onChange:re=>{b(re.target.value),j(1)},placeholder:"Employee code or name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-700 mb-2",children:"Status"}),e.jsxs("select",{className:"w-full rounded-lg border-slate-300 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm bg-white",value:p,onChange:re=>{y(re.target.value),j(1)},children:[e.jsx("option",{value:"ALL",children:"All"}),e.jsx("option",{value:"SUBMITTED",children:"Submitted"}),e.jsx("option",{value:"APPROVED",children:"L1 Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-700 mb-2",children:"Week Start"}),e.jsx("input",{type:"date",className:"w-full rounded-lg border-slate-300 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm",value:w,onChange:re=>{S(re.target.value),j(1)}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-700 mb-2",children:"Week End"}),e.jsx("input",{type:"date",className:"w-full rounded-lg border-slate-300 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm",value:N,onChange:re=>{E(re.target.value),j(1)}})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-sm transition-all",onClick:()=>{y("ALL"),S(""),E(""),b(""),j(1)},children:"Reset Filters"}),e.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-sm transition-all",onClick:W.refresh,disabled:W.status==="loading",children:W.status==="loading"?"Refreshing":"Refresh"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-white to-slate-50 rounded-2xl border border-slate-200 shadow-xl overflow-hidden backdrop-blur-sm",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 bg-gradient-to-r from-slate-50 to-blue-50 flex items-center justify-between",children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Approval Queue"}),e.jsxs("span",{className:"inline-flex items-center rounded-full bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-2 text-sm font-bold text-white shadow-md",children:["Total: ",M]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 border-separate border-spacing-0",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-50 to-blue-50 sticky top-0 z-10",children:e.jsx("tr",{children:U.map(re=>e.jsx("th",{className:"px-4 py-4 text-left text-xs font-bold text-slate-700 uppercase tracking-wider border-b-2 border-slate-200",children:re.header},re.key))})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-100 min-h-48",children:V.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:U.length,className:"text-center py-16",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-slate-100 to-slate-200 flex items-center justify-center shadow-inner",children:e.jsx("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"mt-4 text-lg font-semibold text-slate-900",children:"No timesheets pending approval"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Waiting for employees to submit their timesheets."})]})})}):V.map(re=>e.jsx("tr",{className:"hover:bg-gradient-to-r hover:from-blue-50 hover:to-slate-50 transition-all duration-200",children:U.map(Re=>e.jsx("td",{className:"px-4 py-4 text-sm text-slate-900 border-b border-slate-100 align-middle",children:Re.render(re)},Re.key))},re.id))})]})}),e.jsx("div",{className:"p-4 pt-0 border-t border-slate-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Rows per page:"}),e.jsxs("select",{value:h,onChange:re=>{f(Number(re.target.value)),j(1)},className:"rounded-md border-slate-300 text-sm bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]})]}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",x]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50 disabled:opacity-50 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:x<=1,onClick:()=>j(re=>Math.max(1,re-1)),children:"Previous"}),e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50 disabled:opacity-50 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:x*h>=M,onClick:()=>j(re=>re+1),children:"Next"})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3 md:hidden",children:V.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"mt-4 text-sm font-medium text-slate-900",children:"No timesheets pending approval"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Waiting for employees to submit their timesheets."})]}):V.map(re=>e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:co(re)}),e.jsx("div",{className:"mt-1 font-mono text-xs text-slate-600",children:re.employeeCode||""})]}),e.jsx(Mu,{status:re.status})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Week"}),e.jsxs("div",{className:"mt-1 font-mono text-sm text-slate-900",children:[re.periodStart,"  ",re.periodEnd]}),e.jsxs("div",{className:"mt-3",children:[!l&&e.jsx($e,{to:`/timesheet/${re.id}`,className:"inline-flex w-full items-center justify-center rounded-md border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"View"}),d&&or(re)?e.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",className:"rounded-md bg-emerald-600 px-3 py-2 text-sm font-medium text-white hover:bg-emerald-700 disabled:bg-emerald-300",disabled:R.status==="loading"||L.status==="loading",onClick:async()=>{await R.run({id:re.id}),await W.refresh()},children:"Approve"}),e.jsx("button",{type:"button",className:"rounded-md bg-rose-600 px-3 py-2 text-sm font-medium text-white hover:bg-rose-700 disabled:bg-rose-300",disabled:R.status==="loading"||L.status==="loading",onClick:()=>{O(""),I({mode:"reject",item:re})},children:"Reject"})]}):null]})]},re.id))})]}):e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Timesheet is disabled"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"TIMESHEET_ENABLED must be enabled in system config."})]}):e.jsx(ge,{})},[n,m,W.status,W.data,W.error,V,U,P,M,v,p,u,w,N,x,h,T,k,g,c,d,R.status,L.status]);return e.jsxs(e.Fragment,{children:[e.jsx(We,{title:"Timesheet Approvals"}),B,_?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>{R.status==="loading"||L.status==="loading"||I(null)}}),e.jsxs("div",{className:"relative w-full max-w-lg rounded-2xl bg-white shadow-xl border border-slate-200",children:[e.jsxs("div",{className:"p-5 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Reject Timesheet"}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Provide a reason for rejection."})]}),e.jsx("div",{className:"p-5 space-y-3",children:e.jsx("textarea",{className:"w-full min-h-[110px] rounded-md border border-slate-300 p-3 text-sm",value:G,onChange:ve=>O(ve.target.value),placeholder:"Reason..."})}),e.jsxs("div",{className:"p-5 border-t border-slate-200 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",disabled:R.status==="loading"||L.status==="loading",onClick:()=>I(null),children:"Cancel"}),e.jsx("button",{type:"button",className:"rounded-md bg-rose-600 px-4 py-2 text-sm font-medium text-white hover:bg-rose-700 disabled:bg-rose-300",disabled:R.status==="loading"||L.status==="loading"||!String(G||"").trim(),onClick:async()=>{await L.run({id:_.item.id,reason:G}),I(null),await W.refresh()},children:"Reject"})]})]})]}):null]})}function wb(){return e.jsx(Ih,{})}function Sb(){var n;const{bootstrap:t}=he(),s=((n=t==null?void 0:t.rbac)==null?void 0:n.permissions)||[];return s.includes("GOV_DIVISION_READ")||s.includes("LEAVE_TYPE_READ")?e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Governance"}),e.jsx("p",{className:"text-slate-600 mt-2",children:"You have access to governance modules."})]}):e.jsx(ge,{})}function kb(){var d,c,m,g,x;const{bootstrap:t}=he(),s=((d=t==null?void 0:t.rbac)==null?void 0:d.permissions)||[],n=(((c=t==null?void 0:t.rbac)==null?void 0:c.roles)||[]).includes("SUPER_ADMIN");if(console.log("[HrLeaveTypesPage] Component loaded",{permissions:s,isSuperAdmin:n}),!n&&!s.includes("LEAVE_TYPE_READ"))return console.log("[HrLeaveTypesPage] Access denied - missing LEAVE_TYPE_READ permission"),e.jsx(ge,{});console.log("[HrLeaveTypesPage] Permission check passed, fetching leave types");const l=Pe({path:"/api/v1/leave/types",page:1,pageSize:100,enabled:!0});console.log("[HrLeaveTypesPage] Query state:",{status:l.status,dataLength:(g=(m=l.data)==null?void 0:m.items)==null?void 0:g.length,error:l.error});const r=()=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Leave Types Management"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Manage leave types and their configurations"})]}),o=()=>e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Leave Types"}),e.jsx("p",{className:"text-sm text-slate-600",children:"System-wide leave type configurations"})]})});return l.status==="loading"?e.jsxs("div",{className:"p-6",children:[e.jsx(r,{}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-6",children:e.jsx(de,{message:"Loading leave types..."})})]}):l.status==="error"?e.jsxs("div",{className:"p-6",children:[e.jsx(r,{}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-6",children:e.jsx(le,{error:l.error})})]}):e.jsxs("div",{className:"p-6",children:[e.jsx(r,{}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsx(o,{})}),e.jsx("div",{className:"p-6",children:!((x=l.data)!=null&&x.items)||l.data.items.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No leave types found"}),e.jsx("p",{className:"text-sm text-slate-600",children:"No leave types have been configured configured in the system yet."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Name"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Code"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Description"}),e.jsx("th",{className:"text-center py-3 px-4 font-medium text-slate-700",children:"Days Per Year"}),e.jsx("th",{className:"text-center py-3 px-4 font-medium text-slate-700",children:"Requires Approval"})]})}),e.jsx("tbody",{children:l.data.items.map(j=>e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("td",{className:"py-3 px-4 font-medium text-slate-900",children:j.name}),e.jsx("td",{className:"py-3 px-4 text-slate-600",children:j.code}),e.jsx("td",{className:"py-3 px-4 text-slate-600",children:j.description||"-"}),e.jsx("td",{className:"text-center py-3 px-4 text-slate-600",children:j.defaultDaysPerYear||"-"}),e.jsx("td",{className:"text-center py-3 px-4",children:j.requiresApproval?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Yes"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"No"})})]},j.id))})]})})})]})]})}function Ru(){var N,E,v,A,T,C;const{bootstrap:t}=he(),s=((N=t==null?void 0:t.rbac)==null?void 0:N.permissions)||[],n=(((E=t==null?void 0:t.rbac)==null?void 0:E.roles)||[]).includes("SUPER_ADMIN");if(console.log("[HrLeaveBalancesPage] Component loaded",{permissions:s,isSuperAdmin:n}),!n&&!s.includes("LEAVE_BALANCE_GRANT"))return console.log("[HrLeaveBalancesPage] Access denied - missing LEAVE_BALANCE_GRANT permission"),e.jsx(ge,{});console.log("[HrLeaveBalancesPage] Permission check passed, loading page");const l=()=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Leave Balances Management"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Grant and manage employee leave balances"})]}),r=()=>e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Leave Balances"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Employee leave balance allocations"})]})}),[o,d]=i.useState({employeeId:"",leaveTypeId:"",year:new Date().getFullYear(),grantAmount:"",reason:""}),[c,m]=i.useState(!1),[g,x]=i.useState(""),j=Pe({path:"/api/v1/employees",page:1,pageSize:200,enabled:!0}),h=Pe({path:"/api/v1/leave/types",page:1,pageSize:100,enabled:!0}),[f,u]=i.useState([]),[b,p]=i.useState(!0);i.useEffect(()=>{y()},[]);const y=async()=>{try{p(!0);const k=await z("/api/v1/leave/balances");u(k.items||[])}catch(k){console.error("Failed to fetch balances:",k)}finally{p(!1)}},w=k=>{const{name:D,value:R}=k.target;d(L=>({...L,[D]:R}))},S=async k=>{k.preventDefault(),m(!0),x("");try{await z("/api/v1/leave/balances",{method:"POST",body:{employeeId:o.employeeId,leaveTypeId:o.leaveTypeId,year:parseInt(o.year),grantAmount:parseInt(o.grantAmount),reason:o.reason}}),x("Leave balance granted successfully!"),d({employeeId:"",leaveTypeId:"",year:new Date().getFullYear(),grantAmount:"",reason:""}),y()}catch(D){console.error("Failed to grant balance:",D),x(`Error: ${D.message||"Failed to grant balance"}`)}finally{m(!1)}};return j.status==="loading"||h.status==="loading"?e.jsxs("div",{className:"p-6",children:[e.jsx(l,{}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-6",children:e.jsx(de,{message:"Loading leave balance data..."})})]}):j.status==="error"||h.status==="error"?e.jsxs("div",{className:"p-6",children:[e.jsx(l,{}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-6",children:e.jsx(le,{error:j.error||h.error})})]}):e.jsxs("div",{className:"p-6",children:[e.jsx(l,{}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Grant Leave Balance"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Allocate leave balance to an employee"})]}),e.jsxs("div",{className:"p-6",children:[g&&e.jsx("div",{className:`mb-4 p-3 rounded-lg ${g.includes("Error")?"bg-red-50 text-red-800 border border-red-200":"bg-green-50 text-green-800 border border-green-200"}`,children:g}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Employee"}),e.jsxs("select",{name:"employeeId",value:o.employeeId,onChange:w,required:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Employee"}),(A=(v=j.data)==null?void 0:v.items)==null?void 0:A.map(k=>e.jsxs("option",{value:k.id,children:[k.firstName," ",k.lastName," (",k.employeeCode,")"]},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Leave Type"}),e.jsxs("select",{name:"leaveTypeId",value:o.leaveTypeId,onChange:w,required:!0,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Leave Type"}),(C=(T=h.data)==null?void 0:T.items)==null?void 0:C.map(k=>e.jsx("option",{value:k.id,children:k.name},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Year"}),e.jsx("input",{type:"number",name:"year",value:o.year,onChange:w,required:!0,min:"2020",max:"2030",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Grant Amount (Days)"}),e.jsx("input",{type:"number",name:"grantAmount",value:o.grantAmount,onChange:w,required:!0,min:"1",max:"365",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Reason"}),e.jsx("textarea",{name:"reason",value:o.reason,onChange:w,required:!0,rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Reason for granting leave balance..."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Granting...":"Grant Balance"})})]})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsx(r,{})}),e.jsx("div",{className:"p-6",children:b?e.jsx(de,{message:"Loading existing balances..."}):f.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No leave balances found"}),e.jsx("p",{className:"text-sm text-slate-600",children:"No leave balances have been granted yet yet."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Employee"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Leave Type"}),e.jsx("th",{className:"text-center py-3 px-4 font-medium text-slate-700",children:"Year"}),e.jsx("th",{className:"text-center py-3 px-4 font-medium text-slate-700",children:"Balance"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-slate-700",children:"Reason"})]})}),e.jsx("tbody",{children:f.map(k=>{var D,R,L;return e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsxs("td",{className:"py-3 px-4",children:[e.jsx("div",{className:"font-medium text-slate-900",children:(D=k.employee)==null?void 0:D.name}),e.jsx("div",{className:"text-sm text-slate-600",children:(R=k.employee)==null?void 0:R.code})]}),e.jsx("td",{className:"py-3 px-4 text-slate-600",children:(L=k.leaveType)==null?void 0:L.name}),e.jsx("td",{className:"text-center py-3 px-4 text-slate-600",children:k.year}),e.jsx("td",{className:"text-center py-3 px-4",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[k.availableBalance," days"]})}),e.jsx("td",{className:"py-3 px-4 text-slate-600",children:k.reason})]},k.id)})})]})})})]})]})]})}function Tu(){var w,S;const{bootstrap:t}=he(),s=((w=t==null?void 0:t.rbac)==null?void 0:w.permissions)||[],n=(((S=t==null?void 0:t.rbac)==null?void 0:S.roles)||[]).includes("SUPER_ADMIN");if(!n&&!s.includes("LEAVE_MONTH_CLOSE_OVERRIDE")&&!s.includes("GOV_MONTH_CLOSE_READ"))return e.jsx(ge,{});const l=()=>{const N=new Date;return`${N.getFullYear()}-${String(N.getMonth()+1).padStart(2,"0")}`},[r,o]=i.useState(l()),[d,c]=i.useState(null),[m,g]=i.useState(!0),[x,j]=i.useState(null);i.useEffect(()=>{r&&h()},[r]);const h=async()=>{try{g(!0),j(null);const N=await z(`/api/v1/governance/month-close?month=${r}`);c(N)}catch(N){console.error("[HrMonthClosePage] Error loading month status:",N),N.status===403?j("forbidden"):j("Unable to load month status")}finally{g(!1)}},f=async()=>{const N=prompt("Please provide a reason for closing the month:");if(N)try{await z("/api/v1/governance/month-close/status",{method:"POST",body:{month:r,status:"CLOSED",reason:N}}),h()}catch(E){console.error("Failed to close month:",E),alert(`Error: ${E.message||"Failed to close month"}`)}},u=async()=>{const N=prompt("Please provide a reason for reopening the month:");if(N)try{await z("/api/v1/governance/month-close/status",{method:"POST",body:{month:r,status:"OPEN",reason:N}}),h()}catch(E){console.error("Failed to reopen month:",E),alert(`Error: ${E.message||"Failed to reopen month"}`)}},b=n||s.includes("MONTH_CLOSE_MANAGE"),p=n||s.includes("LEAVE_MONTH_CLOSE_OVERRIDE");if(m)return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Month Close Management"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Manage monthly closing periods and attendance finalization"})]}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg p-6",children:e.jsx(de,{message:"Loading month status..."})})]});if(x==="forbidden")return e.jsx(ge,{});if(x)return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Month Close Management"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Manage monthly closing periods and attendance finalization"})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-6",children:[e.jsx(le,{error:{message:x}}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Retry"})})]})]});const y=N=>N==="OPEN"?"bg-green-100 text-green-800 border-green-200":N==="CLOSED"?"bg-red-100 text-red-800 border-red-200":"bg-gray-100 text-gray-800 border-gray-200";return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Month Close Management"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Manage monthly closing periods and attendance finalization"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Month:"}),e.jsx("input",{type:"month",value:r,onChange:N=>o(N.target.value),className:"px-3 py-1.5 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})}),e.jsxs("div",{className:"space-y-6",children:[(d==null?void 0:d.summary)&&e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Monthly Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:d.summary.totalEmployees}),e.jsx("div",{className:"text-sm text-slate-600",children:"Total Employees"})]}),e.jsxs("div",{className:"bg-amber-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-900",children:d.summary.pendingLeaveRequests}),e.jsx("div",{className:"text-sm text-amber-600",children:"Pending Leave Requests"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:d.summary.pendingAttendanceCorrections}),e.jsx("div",{className:"text-sm text-blue-600",children:"Pending Attendance Corrections"})]})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Month Status"}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${y(d==null?void 0:d.status)}`,children:d==null?void 0:d.status})]}),(d==null?void 0:d.reason)&&e.jsxs("div",{className:"mb-4 p-4 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700 mb-1",children:"Reason:"}),e.jsx("div",{className:"text-sm text-slate-900",children:d.reason})]}),(d==null?void 0:d.closedBy)&&e.jsxs("div",{className:"mb-4 p-4 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700 mb-1",children:"Closed By:"}),e.jsx("div",{className:"text-sm text-slate-900",children:d.closedBy.name}),d.closedAt&&e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:new Date(d.closedAt).toLocaleString()})]}),e.jsxs("div",{className:"flex gap-3",children:[(d==null?void 0:d.status)==="OPEN"&&b&&e.jsx("button",{onClick:f,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Close Month"}),(d==null?void 0:d.status)==="CLOSED"&&p&&e.jsx("button",{onClick:u,className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors",children:"Reopen Month"}),!b&&(d==null?void 0:d.status)==="OPEN"&&e.jsx("div",{className:"text-sm text-slate-600 py-2",children:"You don't have permission to close the month."}),!p&&(d==null?void 0:d.status)==="CLOSED"&&e.jsx("div",{className:"text-sm text-slate-600 py-2",children:"You don't have permission to reopen the month."})]})]})]})]})}const At={dashboard:{summary:async()=>z("/api/v1/ops/dashboard/summary")},inbox:{list:async({divisionId:t}={})=>{const s=new URLSearchParams;t&&s.set("divisionId",String(t));const a=s.toString();return z(`/api/v1/ops/inbox${a?`?${a}`:""}`)},action:async({itemType:t,entityId:s,action:a,reason:n})=>z("/api/v1/ops/inbox/action",{method:"POST",body:{itemType:t,entityId:s,action:a,reason:n||""}})},alerts:{list:async({divisionId:t,status:s,alertType:a,page:n,pageSize:l}={})=>{const r=new URLSearchParams;t&&r.set("divisionId",String(t)),s&&r.set("status",String(s)),a&&r.set("alertType",String(a)),n&&r.set("page",String(n)),l&&r.set("pageSize",String(l));const o=r.toString();return z(`/api/v1/ops/alerts${o?`?${o}`:""}`)},acknowledge:async t=>z(`/api/v1/ops/alerts/${t}/acknowledge`,{method:"POST"}),resolve:async t=>z(`/api/v1/ops/alerts/${t}/resolve`,{method:"POST"})},overrides:{list:async({divisionId:t,status:s,overrideType:a,page:n,pageSize:l}={})=>{const r=new URLSearchParams;t&&r.set("divisionId",String(t)),s&&r.set("status",String(s)),a&&r.set("overrideType",String(a)),n&&r.set("page",String(n)),l&&r.set("pageSize",String(l));const o=r.toString();return z(`/api/v1/ops/overrides${o?`?${o}`:""}`)},create:async({overrideType:t,divisionId:s,targetEntityType:a,targetEntityId:n,requestedAction:l,reason:r})=>z("/api/v1/ops/overrides",{method:"POST",body:{overrideType:t,divisionId:s||null,targetEntityType:a,targetEntityId:n,requestedAction:l,reason:r}}),approve:async(t,{approvalReason:s})=>z(`/api/v1/ops/overrides/${t}/approve`,{method:"POST",body:{approvalReason:s}}),reject:async(t,{approvalReason:s})=>z(`/api/v1/ops/overrides/${t}/reject`,{method:"POST",body:{approvalReason:s}}),execute:async(t,{reason:s}={})=>z(`/api/v1/ops/overrides/${t}/execute`,{method:"POST",body:{reason:s||""}})},dataQuality:{run:async({divisionId:t}={})=>z("/api/v1/ops/data-quality/run",{method:"POST",body:{divisionId:t||null}}),listFindings:async({divisionId:t,status:s,findingType:a,page:n,pageSize:l}={})=>{const r=new URLSearchParams;t&&r.set("divisionId",String(t)),s&&r.set("status",String(s)),a&&r.set("findingType",String(a)),n&&r.set("page",String(n)),l&&r.set("pageSize",String(l));const o=r.toString();return z(`/api/v1/ops/data-quality/findings${o?`?${o}`:""}`)},acknowledge:async t=>z(`/api/v1/ops/data-quality/findings/${t}/acknowledge`,{method:"POST"}),resolve:async t=>z(`/api/v1/ops/data-quality/findings/${t}/resolve`,{method:"POST"})}};function Oh(...t){return t.filter(Boolean).join(" ")}function Bl({title:t,subtitle:s,loading:a,error:n,empty:l,forbidden:r,children:o,onRetry:d}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:t}),s?e.jsx("div",{className:"text-sm text-slate-600 mt-1",children:s}):null]})})}),r?e.jsx(ge,{}):null,!r&&a?e.jsx(de,{}):null,!r&&!a&&n?e.jsx(le,{error:n,onRetry:d}):null,!r&&!a&&!n&&l?e.jsx(ye,{title:l.title,description:l.description,action:l.action}):null,!r&&!a&&!n&&!l?o:null]})}function Rc({tone:t="slate",children:s}){const a={slate:"bg-slate-100 text-slate-700 border-slate-200",blue:"bg-blue-50 text-blue-700 border-blue-200",green:"bg-emerald-50 text-emerald-700 border-emerald-200",amber:"bg-amber-50 text-amber-700 border-amber-200",red:"bg-rose-50 text-rose-700 border-rose-200",purple:"bg-purple-50 text-purple-700 border-purple-200"};return e.jsx("span",{className:Oh("inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold border",a[t]||a.slate),children:s})}function Cd({severity:t}){const s=String(t||"").toUpperCase(),a=s==="CRITICAL"?"red":s==="HIGH"?"amber":s==="MEDIUM"?"blue":"slate";return e.jsx(Rc,{tone:a,children:s||""})}function Ml({status:t}){const s=String(t||"").toUpperCase(),a=s==="OPEN"||s==="REQUESTED"?"amber":s==="ACKNOWLEDGED"||s==="APPROVED"?"blue":s==="RESOLVED"||s==="EXECUTED"?"green":"slate";return e.jsx(Rc,{tone:a,children:s||""})}function vt({children:t,variant:s="secondary",disabled:a,onClick:n,type:l="button"}){const r="inline-flex items-center justify-center px-3 py-2 rounded-lg text-sm font-medium border transition-colors",o={primary:"bg-blue-600 text-white border-blue-600 hover:bg-blue-700",secondary:"bg-white text-slate-700 border-slate-200 hover:bg-slate-50",danger:"bg-red-600 text-white border-red-600 hover:bg-red-700"};return e.jsx("button",{type:l,onClick:n,disabled:a,className:`${r} ${o[s]||o.secondary} ${a?"opacity-50 cursor-not-allowed hover:bg-inherit":""}`,children:t})}function qa({label:t,value:s,hint:a}){return e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm p-6",children:[e.jsx("div",{className:"text-xs uppercase tracking-wider text-slate-500 font-semibold",children:t}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 mt-2",children:s}),a?e.jsx("div",{className:"text-xs text-slate-600 mt-2",children:a}):null]})}function ki({columns:t,children:s}){return e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsx("tr",{children:t.map(a=>e.jsx("th",{className:Oh("px-4 py-3 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider border-b border-slate-200",a.align==="right"?"text-right":""),children:a.label},a.key))})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:s})]})})}function Eb({open:t,title:s,onClose:a,children:n}){return t?e.jsxs("div",{className:"fixed inset-0 z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:a}),e.jsxs("div",{className:"absolute inset-y-0 right-0 w-full max-w-md bg-white border-l border-slate-200 shadow-xl",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("button",{type:"button",onClick:a,className:"p-2 rounded-lg hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4 overflow-auto h-full pb-24",children:n})]})]}):null}function Ad({open:t,title:s,onClose:a,children:n}){return t?e.jsxs("div",{className:"fixed inset-0 z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:a}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-lg bg-white rounded-xl shadow-xl border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("button",{type:"button",onClick:a,className:"p-2 rounded-lg hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-5",children:n})]})})]}):null}function _h(t){return i.useMemo(()=>{const s=Date.now(),a=(l,r)=>{if(!l)return!1;const o=String(r||"").toUpperCase();if(o==="RESOLVED"||o==="EXECUTED")return!1;const d=new Date(l).getTime();return Number.isNaN(d)?!1:d<s},n=(t||[]).filter(l=>a(l.slaDueAt,l.status)).length;return{isOverdue:a,overdueCount:n}},[t])}function Cb(t){if(!t)return"";const s=new Date(t);return Number.isNaN(s.getTime())?String(t):new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(s)}function Ei({title:t="Inbox"}){const[s,a]=i.useState(!0),[n,l]=i.useState(null),[r,o]=i.useState([]),[d,c]=i.useState(!1),[m,g]=i.useState(""),[x,j]=i.useState(!1),[h,f]=i.useState(null),[u,b]=i.useState(null),{isOverdue:p}=_h(r),y=i.useCallback(async()=>{try{a(!0),l(null);const v=await At.inbox.list();o((v==null?void 0:v.items)||[])}catch(v){l(v)}finally{a(!1)}},[]);i.useEffect(()=>{y()},[y]);async function w(v,A,T){try{b(v.entityId),await At.inbox.action({itemType:v.itemType,entityId:v.entityId,action:A,reason:T}),await y()}catch(C){l(C)}finally{b(null)}}function S(v){f(v),g(""),c(!0)}async function N(){const v=String(m||"").trim();if(h&&v)try{j(!0),await w(h,"REJECT",v),c(!1),f(null),g("")}finally{j(!1)}}const E=i.useMemo(()=>[{key:"type",label:"Type"},{key:"title",label:"Title"},{key:"division",label:"Division"},{key:"sla",label:"SLA Due"},{key:"status",label:"Status"},{key:"actions",label:"Actions",align:"right"}],[]);return e.jsxs(e.Fragment,{children:[e.jsx(Bl,{title:t,subtitle:"Actionable items across modules",loading:s,error:n,empty:!s&&!n&&(r||[]).length===0?{title:"No items",description:"There are no actionable items in the inbox."}:null,onRetry:y,children:e.jsx(ki,{columns:E,children:(r||[]).map(v=>{const A=p(v.slaDueAt,v.status),T=(v.actions||[]).includes("APPROVE"),C=(v.actions||[]).includes("REJECT");return e.jsxs("tr",{className:A?"bg-rose-50":"",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700 font-medium",children:v.itemType}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-900",children:v.title}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:v.divisionId?String(v.divisionId).slice(0,8):""}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:Cb(v.slaDueAt)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx(Ml,{status:v.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[T?e.jsx(vt,{variant:"primary",disabled:u===v.entityId,onClick:()=>w(v,"APPROVE",""),children:"Approve"}):null,C?e.jsx(vt,{variant:"danger",disabled:u===v.entityId,onClick:()=>S(v),children:"Reject"}):null]})})]},`${v.itemType}-${v.entityId}`)})})}),e.jsx(Ad,{open:d,title:"Reject item",onClose:()=>c(!1),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-slate-700",children:"Reason is required to reject."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Reason"}),e.jsx("textarea",{value:m,onChange:v=>g(v.target.value),rows:4,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Required"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(vt,{disabled:x,onClick:()=>c(!1),children:"Cancel"}),e.jsx(vt,{variant:"danger",disabled:x||!String(m||"").trim(),onClick:N,children:x?"Submitting":"Reject"})]})]})})]})}function Ab(){return e.jsx(Ei,{title:"Inbox"})}function Tc({title:t="Alerts"}){const[s,a]=i.useState(!0),[n,l]=i.useState(null),[r,o]=i.useState([]),[d,c]=i.useState(""),[m,g]=i.useState(""),[x,j]=i.useState(!1),[h,f]=i.useState(null),[u,b]=i.useState(null),p=i.useCallback(async()=>{try{a(!0),l(null);const E=await At.alerts.list({status:d||void 0});let v=(E==null?void 0:E.items)||[];m&&(v=v.filter(A=>String(A.severity||"").toUpperCase()===String(m).toUpperCase())),o(v)}catch(E){l(E)}finally{a(!1)}},[m,d]);i.useEffect(()=>{p()},[p]);const y=i.useMemo(()=>[{key:"severity",label:"Severity"},{key:"title",label:"Title"},{key:"division",label:"Division"},{key:"status",label:"Status"},{key:"actions",label:"Actions",align:"right"}],[]);async function w(E){try{b(E.id),await At.alerts.acknowledge(E.id),await p()}catch(v){l(v)}finally{b(null)}}async function S(E){try{b(E.id),await At.alerts.resolve(E.id),await p()}catch(v){l(v)}finally{b(null)}}function N(E){f(E),j(!0)}return e.jsxs(e.Fragment,{children:[e.jsxs(Bl,{title:t,subtitle:"Operational alerts requiring attention",loading:s,error:n,empty:!s&&!n&&(r||[]).length===0?{title:"No alerts",description:"There are no alerts to show."}:null,onRetry:p,children:[e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 uppercase tracking-wider mb-1",children:"Status"}),e.jsxs("select",{value:d,onChange:E=>c(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"OPEN",children:"OPEN"}),e.jsx("option",{value:"ACKNOWLEDGED",children:"ACKNOWLEDGED"}),e.jsx("option",{value:"RESOLVED",children:"RESOLVED"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 uppercase tracking-wider mb-1",children:"Severity"}),e.jsxs("select",{value:m,onChange:E=>g(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"LOW",children:"LOW"}),e.jsx("option",{value:"MEDIUM",children:"MEDIUM"}),e.jsx("option",{value:"HIGH",children:"HIGH"}),e.jsx("option",{value:"CRITICAL",children:"CRITICAL"})]})]}),e.jsx("div",{className:"flex items-end justify-end",children:e.jsx(vt,{onClick:p,disabled:s,children:"Refresh"})})]})}),e.jsx(ki,{columns:y,children:(r||[]).map(E=>e.jsxs("tr",{className:"hover:bg-slate-50 cursor-pointer",onClick:()=>N(E),children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx(Cd,{severity:E.severity})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-900 font-medium",children:E.title}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:E.division_id?String(E.division_id).slice(0,8):""}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx(Ml,{status:E.status})}),e.jsx("td",{className:"px-4 py-3",onClick:v=>v.stopPropagation(),children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(vt,{disabled:u===E.id||String(E.status).toUpperCase()!=="OPEN",onClick:()=>w(E),children:"Acknowledge"}),e.jsx(vt,{variant:"primary",disabled:u===E.id||String(E.status).toUpperCase()==="RESOLVED",onClick:()=>S(E),children:"Resolve"})]})})]},E.id))})]}),e.jsx(Eb,{open:x,title:"Alert details",onClose:()=>j(!1),children:h?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs uppercase tracking-wider text-slate-500 font-semibold",children:"Severity"}),e.jsx(Cd,{severity:h.severity})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wider text-slate-500 font-semibold",children:"Title"}),e.jsx("div",{className:"text-sm text-slate-900 mt-1 font-medium",children:h.title})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wider text-slate-500 font-semibold",children:"Message"}),e.jsx("div",{className:"text-sm text-slate-700 mt-1 whitespace-pre-wrap",children:h.message||""})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rc,{children:h.alert_type||h.alertType||""}),e.jsx(Ml,{status:h.status})]})]}):null})]})}function Lb(){return e.jsx(Tc,{title:"Alerts"})}function Pu(t){const s=String(t||"").toUpperCase();return s==="CRITICAL"?0:s==="HIGH"?1:s==="MEDIUM"?2:3}function Pc({title:t="Data Quality"}){const[s,a]=i.useState(!0),[n,l]=i.useState(null),[r,o]=i.useState([]),[d,c]=i.useState(!1),[m,g]=i.useState(null),x=i.useCallback(async()=>{try{a(!0),l(null);const b=await At.dataQuality.listFindings({page:1,pageSize:200}),p=(b==null?void 0:b.items)||[];p.sort((y,w)=>{const S=Pu(y.severity),N=Pu(w.severity);if(S!==N)return S-N;const E=new Date(y.created_at||y.createdAt||0).getTime();return new Date(w.created_at||w.createdAt||0).getTime()-E}),o(p)}catch(b){l(b)}finally{a(!1)}},[]);i.useEffect(()=>{x()},[x]);async function j(){try{c(!0),await At.dataQuality.run(),await x()}catch(b){l(b)}finally{c(!1)}}async function h(b){try{g(b.id),await At.dataQuality.acknowledge(b.id),await x()}catch(p){l(p)}finally{g(null)}}async function f(b){try{g(b.id),await At.dataQuality.resolve(b.id),await x()}catch(p){l(p)}finally{g(null)}}const u=i.useMemo(()=>[{key:"severity",label:"Severity"},{key:"type",label:"Finding Type"},{key:"division",label:"Division"},{key:"entity",label:"Entity"},{key:"status",label:"Status"},{key:"actions",label:"Actions",align:"right"}],[]);return e.jsxs(Bl,{title:t,subtitle:"Automated integrity checks and findings",loading:s,error:n,empty:!s&&!n&&(r||[]).length===0?{title:"No findings",description:"No data quality findings were found."}:null,onRetry:x,children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Critical findings are pinned to the top."}),e.jsx(vt,{variant:"primary",disabled:d,onClick:j,children:d?"Running":"Run checks"})]}),e.jsx(ki,{columns:u,children:(r||[]).map(b=>{const p=String(b.status||"").toUpperCase();return e.jsxs("tr",{className:String(b.severity||"").toUpperCase()==="CRITICAL"?"bg-rose-50":"",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx(Cd,{severity:b.severity})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-900 font-medium",children:b.finding_type||b.findingType}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:b.division_id?String(b.division_id).slice(0,8):""}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-700",children:[b.entity_type||b.entityType,b.entity_id?`:${String(b.entity_id).slice(0,8)}`:""]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx(Ml,{status:b.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(vt,{disabled:m===b.id||p!=="OPEN",onClick:()=>h(b),children:"Acknowledge"}),e.jsx(vt,{variant:"primary",disabled:m===b.id||p==="RESOLVED",onClick:()=>f(b),children:"Resolve"})]})})]},b.id)})})]})}function Db(){return e.jsx(Pc,{title:"Data Quality"})}function Hs(t){const s=Number(t||0);return Number.isFinite(s)?s.toLocaleString(void 0,{maximumFractionDigits:2}):"0"}function Mb(t){const s=String(t||"").trim();if(!s)return"";if(/^\d{4}-\d{2}$/.test(s))return s;try{const a=new Date(s);if(!Number.isFinite(a.getTime()))return s;const n=String(a.getMonth()+1).padStart(2,"0");return`${a.getFullYear()}-${n}`}catch{return s}}function Rb(t){const s=Number(t);return Number.isFinite(s)?`${Math.round(s*100)}%`:"0%"}function Tb(t,s){const a=Number(t),n=Number(s);if(!Number.isFinite(a)||!Number.isFinite(n))return{text:"",tone:"neutral"};if(n===0)return a===0?{text:"0%",tone:"neutral"}:{text:"+%",tone:"up"};const l=(a-n)/Math.abs(n),r=l>0?"up":l<0?"down":"neutral";return{text:`${l>0?"+":""}${Math.round(l*100)}%`,tone:r}}function Iu({points:t}){const{d:s}=i.useMemo(()=>{const r=Array.isArray(t)?t:[],o=r.map(h=>Number((h==null?void 0:h.totalNet)||0)),d=o.length?Math.min(...o):0,m=(o.length?Math.max(...o):0)-d||1,g=r.length>1?(120-2*2)/(r.length-1):0;return{d:r.map((h,f)=>{const u=2+f*g,b=Number((h==null?void 0:h.totalNet)||0),p=2+(34-2*2)*(1-(b-d)/m);return{x:u,y:p}}).map((h,f)=>`${f===0?"M":"L"} ${h.x.toFixed(1)} ${h.y.toFixed(1)}`).join(" ")}},[t]);return e.jsx("svg",{viewBox:"0 0 120 34",className:"w-[120px] h-[34px]",children:e.jsx("path",{d:s,fill:"none",stroke:"#6366f1",strokeWidth:"2.5"})})}function Pb({points:t}){const{pathD:s,areaD:a,labels:n}=i.useMemo(()=>{var w,S;const c=Array.isArray(t)?t:[],m=c.map(N=>Number((N==null?void 0:N.totalNet)||0)),g=m.length?Math.min(...m):0,j=(m.length?Math.max(...m):0)-g||1,h=c.length>1?(600-12*2)/(c.length-1):0,f=c.map((N,E)=>{const v=12+E*h,A=Number((N==null?void 0:N.totalNet)||0),T=16+(140-16*2)*(1-(A-g)/j);return{x:v,y:T,v:A,month:String((N==null?void 0:N.month)||"")}}),u=f.map((N,E)=>`${E===0?"M":"L"} ${N.x.toFixed(1)} ${N.y.toFixed(1)}`).join(" "),b=f.length?`${u} L ${f[f.length-1].x.toFixed(1)} ${124 .toFixed(1)} L ${f[0].x.toFixed(1)} ${124 .toFixed(1)} Z`:"",p=(w=f[0])!=null&&w.month?String(f[0].month):"",y=(S=f[f.length-1])!=null&&S.month?String(f[f.length-1].month):"";return{pathD:u,areaD:b,labels:{left:p,right:y}}},[t]);return e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Monthly Expense Trend"}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Last 6 months (net payroll)"})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("svg",{viewBox:"0 0 600 140",className:"w-full h-36",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"trendStroke",x1:"0",x2:"1",y1:"0",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),e.jsx("stop",{offset:"100%",stopColor:"#6366f1"})]}),e.jsxs("linearGradient",{id:"trendFill",x1:"0",x2:"0",y1:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#6366f1",stopOpacity:"0.18"}),e.jsx("stop",{offset:"100%",stopColor:"#6366f1",stopOpacity:"0"})]})]}),e.jsx("rect",{x:"0",y:"0",width:"600",height:"140",fill:"#ffffff"}),a?e.jsx("path",{d:a,fill:"url(#trendFill)"}):null,e.jsx("path",{d:s,fill:"none",stroke:"url(#trendStroke)",strokeWidth:"3"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mt-2",children:[e.jsx("div",{children:n.left}),e.jsx("div",{children:n.right})]})]})]})}function Ib(){var p,y,w;const[t,s]=i.useState("loading"),[a,n]=i.useState(null),[l,r]=i.useState(null),[o,d]=i.useState({status:"idle",error:null,submitted:0,approved:0,paid:0});async function c(){try{s("loading"),n(null);const S=await z("/api/v1/finance/dashboard");r(S),s("ready")}catch(S){n(S),s("error")}}async function m(){try{d(v=>({...v,status:"loading",error:null}));const[S,N,E]=await Promise.all([z("/api/v1/expenses?page=1&size=1&status=SUBMITTED"),z("/api/v1/expenses?page=1&size=1&status=APPROVED"),z("/api/v1/expenses?page=1&size=1&status=PAID")]);d({status:"ready",error:null,submitted:Number((S==null?void 0:S.total)||0),approved:Number((N==null?void 0:N.total)||0),paid:Number((E==null?void 0:E.total)||0)})}catch(S){d(N=>({...N,status:"error",error:S}))}}if(i.useEffect(()=>{let S=!0;return(async()=>S&&(await c(),await m()))(),()=>{S=!1}},[]),i.useEffect(()=>{function S(){c(),m()}return window.addEventListener("finance:refresh",S),()=>window.removeEventListener("finance:refresh",S)},[]),t==="loading")return e.jsx(de,{message:"Loading dashboard"});if(t==="error")return(a==null?void 0:a.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"FINANCE_REPORT_READ"}}):e.jsx(le,{error:a,onRetry:c});const g=Mb(l==null?void 0:l.activePayrollMonth),x=Array.isArray(l==null?void 0:l.monthlyExpenseTrend)?l.monthlyExpenseTrend:[],j=((p=x[x.length-1])==null?void 0:p.totalNet)??0,h=x.length>=2?((y=x[x.length-2])==null?void 0:y.totalNet)??0:0,f=Tb(j,h),u=(()=>{const S=Number((l==null?void 0:l.totalNet)||0),N=Number((l==null?void 0:l.totalPaidThisMonth)||0);return!Number.isFinite(S)||S<=0?0:Math.min(1,Math.max(0,N/S))})(),b=(()=>{var C;const S=Array.isArray(x)?x:[],N=S.map(k=>Number((k==null?void 0:k.totalNet)||0)).filter(k=>Number.isFinite(k)),E=N.length?N.reduce((k,D)=>k+D,0)/N.length:0,v=N.length?Math.max(...N):0,A=N.length?N.indexOf(v):-1,T=A>=0?String(((C=S[A])==null?void 0:C.month)||""):"";return{avg:E,maxV:v,maxMonth:T}})();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Dashboard"}),e.jsxs("p",{className:"text-slate-600 mt-1",children:["Active payroll month: ",g]})]}),e.jsx("button",{onClick:()=>{c(),m()},className:"px-4 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm font-medium text-slate-700 shadow-sm",children:"Refresh"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white border border-slate-200 rounded-2xl shadow-sm p-5",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Total Gross (Active Month)"}),e.jsx("div",{className:"mt-2 text-2xl font-bold text-slate-900",children:Hs(l==null?void 0:l.totalGross)}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Month: ",g]})]}),e.jsx("div",{className:"pt-1",children:e.jsx(Iu,{points:x})})]})}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-2xl shadow-sm p-5",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Total Net (Active Month)"}),e.jsx("div",{className:"mt-2 text-2xl font-bold text-slate-900",children:Hs(l==null?void 0:l.totalNet)}),e.jsxs("div",{className:"mt-1 text-xs",children:[e.jsx("span",{className:f.tone==="up"?"text-emerald-600 font-semibold":f.tone==="down"?"text-rose-600 font-semibold":"text-slate-500 font-semibold",children:f.text}),e.jsx("span",{className:"text-slate-500",children:" MoM"})]})]}),e.jsx("div",{className:"pt-1",children:e.jsx(Iu,{points:x})})]})}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl shadow-sm p-5",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Employees Paid"}),e.jsx("div",{className:"mt-2 text-2xl font-bold text-slate-900",children:Number((l==null?void 0:l.totalEmployees)||0)}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Paid amount this month: ",Hs(l==null?void 0:l.totalPaidThisMonth)]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[e.jsx("span",{children:"Paid vs Net"}),e.jsx("span",{className:"font-semibold text-slate-800",children:Rb(u)})]}),e.jsx("div",{className:"h-2.5 rounded-full bg-slate-100 mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-blue-600 to-indigo-600",style:{width:`${Math.round(u*100)}%`}})})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl shadow-sm p-5",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Pending Payroll Runs"}),e.jsx("div",{className:"mt-2 text-2xl font-bold text-slate-900",children:Number((l==null?void 0:l.pendingPayrolls)||0)}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Last month expense: ",Hs(l==null?void 0:l.lastMonthExpense)]})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-200 flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Expenses"}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Live counts from expense module"})]}),e.jsx("a",{href:"/finance/expenses",className:"px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-semibold shadow-sm",children:"View Expenses"})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Submitted"}),e.jsx("div",{className:"mt-2 text-2xl font-bold text-slate-900",children:o.status==="ready"?o.submitted:""})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Approved"}),e.jsx("div",{className:"mt-2 text-2xl font-bold text-slate-900",children:o.status==="ready"?o.approved:""})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Paid"}),e.jsx("div",{className:"mt-2 text-2xl font-bold text-slate-900",children:o.status==="ready"?o.paid:""})]})]}),o.status==="error"?e.jsx("div",{className:"mt-3 text-xs text-rose-700",children:String(((w=o.error)==null?void 0:w.message)||o.error||"Failed to load expenses")}):null]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Pb,{points:x})}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Smart Insights"}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Derived from last 6 months + active month totals"})]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"6-Month Avg (Net)"}),e.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900",children:Hs(b.avg)})]})}),e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Highest Month (Net)"}),e.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900",children:Hs(b.maxV)}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:b.maxMonth||""})]})}),e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Current vs Prev Month"}),e.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900",children:Hs(j)}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Prev: ",Hs(h)]})]}),e.jsx("div",{className:f.tone==="up"?"px-3 py-2 rounded-xl bg-emerald-50 text-emerald-700 border border-emerald-200 text-sm font-semibold":f.tone==="down"?"px-3 py-2 rounded-xl bg-rose-50 text-rose-700 border border-rose-200 text-sm font-semibold":"px-3 py-2 rounded-xl bg-slate-50 text-slate-700 border border-slate-200 text-sm font-semibold",children:f.text})]})]})]})]})]})}function dr(t){if(!t)return"-";const s=String(t);if(s.includes("T")){const o=new Date(s);return Number.isNaN(o.getTime())?s:o.toLocaleDateString("en-US",{month:"long",year:"numeric"})}const a=s.slice(0,7);if(!/^[0-9]{4}-[0-9]{2}$/.test(a))return s;const[n,l]=a.split("-").map(o=>Number(o)),r=new Date(Date.UTC(n,l-1,1));return Number.isNaN(r.getTime())?s:new Intl.DateTimeFormat("en-US",{month:"long",year:"numeric",timeZone:"UTC"}).format(r)}function ml(t){const s=Number(typeof t=="string"?t:t??0),a=Number.isFinite(s)?s:0;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a)}function ai(t){const s=String(t||"").toUpperCase();return s==="DRAFT"||s==="REVIEWED"?"bg-slate-100 text-slate-800 border-slate-200":s==="LOCKED"?"bg-amber-100 text-amber-800 border-amber-200":s==="PAID"?"bg-green-100 text-green-800 border-green-200":s==="CLOSED"?"bg-slate-900 text-white border-slate-900":"bg-slate-100 text-slate-800 border-slate-200"}function Ld(t){return String(t||"").toUpperCase()==="CLOSED"}function Ob(t){const s=String(t||"").toUpperCase();return s==="LOCKED"||s==="PAID"||s==="CLOSED"}function Bh(t){return`${t.getUTCFullYear()}-${String(t.getUTCMonth()+1).padStart(2,"0")}`}function _b(t){const s=String(t||"").trim();return/^\d{4}-\d{2}$/.test(s)?`${s}-01`:null}function Bb(t,s){const a=new Date(t);return new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth()+s,1))}function Ou(){const t=new Date;return Bh(new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),1)))}function _u(t){const s=String(t||"").trim();if(!/^[0-9]{4}-[0-9]{2}$/.test(s))return s;const[a,n]=s.split("-").map(r=>Number(r));return new Date(Date.UTC(a,n-1,1)).toLocaleDateString("en-US",{month:"long",year:"numeric"})}function Yn(t){const s=String(t||"").trim();if(!s)return"";if(s.includes("T")){const a=new Date(s);if(Number.isNaN(a.getTime()))return s.slice(0,7);const n=a.getFullYear(),l=String(a.getMonth()+1).padStart(2,"0");return`${n}-${l}`}return s.slice(0,7)}function Bu(t){if(!t)return{label:"Generate",variant:"primary",kind:"generate"};const s=String(t.status||"").toUpperCase();return s?s==="DRAFT"||s==="REVIEWED"?{label:"Open",variant:"secondary",kind:"open"}:s==="LOCKED"||s==="PAID"||s==="CLOSED"?{label:"View",variant:"secondary",kind:"view"}:{label:"View",variant:"secondary",kind:"view"}:{label:"Generate",variant:"primary",kind:"generate"}}function mo({children:t,variant:s="secondary",disabled:a,onClick:n}){const l="inline-flex items-center justify-center px-3 py-2 rounded-lg text-sm font-medium border transition-colors",r={primary:"bg-blue-600 text-white border-blue-600 hover:bg-blue-700",secondary:"bg-white text-slate-700 border-slate-200 hover:bg-slate-50",danger:"bg-red-600 text-white border-red-600 hover:bg-red-700"};return e.jsx("button",{type:"button",onClick:n,disabled:a,className:`${l} ${r[s]||r.secondary} ${a?"opacity-50 cursor-not-allowed hover:bg-inherit":""}`,children:t})}function Fb(){var v,A,T;const{bootstrap:t}=he(),s=Ue(),[a,n]=i.useState(()=>Ou()),[l,r]=i.useState(!0),[o,d]=i.useState(null),[c,m]=i.useState([]),[g,x]=i.useState(!1),[j,h]=i.useState(!1),f=((v=t==null?void 0:t.rbac)==null?void 0:v.permissions)||[],u=f.includes("PAYROLL_RUN_READ"),b=f.includes("PAYROLL_GENERATE"),p=async()=>{try{r(!0),d(null),h(!1);const C=await z("/api/v1/payroll/runs?page=1&pageSize=200");m((C==null?void 0:C.items)||[])}catch(C){if((C==null?void 0:C.status)===403){m([]),h(!0);return}d(C)}finally{r(!1)}};i.useEffect(()=>{if(!u){r(!1),m([]),h(!0);return}p()},[]),i.useEffect(()=>{const C=Ou(),k=(c||[]).find(D=>String(D.month||"").slice(0,7)===C)||null;if(k&&Ld(k.status)){const D=Bh(Bb(new Date,1));n(D)}else n(C)},[c]);const y=i.useMemo(()=>(c||[]).find(C=>Yn(C.month)===String(a))||null,[c,a]),w=Ld(y==null?void 0:y.status),S=i.useMemo(()=>{const C=String(a||"");return(c||[]).filter(D=>{const R=Yn(D.month);return R&&R<C}).sort((D,R)=>String(Yn(R.month)||"").localeCompare(String(Yn(D.month)||"")))},[c,a]),N=async()=>{var k;if(!b)return;const C=_b(a);if(C)try{x(!0),d(null);const D=await z("/api/v1/payroll/runs",{method:"POST",body:{month:C}}),R=(D==null?void 0:D.runId)||((k=D==null?void 0:D.item)==null?void 0:k.id)||(D==null?void 0:D.id);R&&(await z(`/api/v1/payroll/runs/${R}/compute`,{method:"POST"}),s(`/finance/payroll/${R}`))}catch(D){d(D)}finally{x(!1)}},E=C=>{C!=null&&C.id&&s(`/finance/payroll/${C.id}`)};if(l)return e.jsx("div",{className:"p-6",children:e.jsx(de,{})});if(o){const C=((T=(A=o==null?void 0:o.payload)==null?void 0:A.error)==null?void 0:T.message)||(o==null?void 0:o.message)||"Failed to load payroll runs";return e.jsx("div",{className:"p-6",children:e.jsx(le,{error:{...o,message:C}})})}return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between gap-4 mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Payroll"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Finance Payroll module."})]})}),e.jsx("div",{className:"mb-4 text-sm font-semibold text-slate-900",children:"Active Payroll Month"}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Month"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Payroll Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Finance Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:(()=>{const C=y,k=Bu(C),D=C?String(C.status||"").toUpperCase():"",R=D?D==="DRAFT"?"Pending Draft":D==="REVIEWED"?"Under Review":D:"-",L=k.kind==="generate"&&!w;return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:_u(a)}),(C==null?void 0:C.id)&&e.jsxs("div",{className:"text-xs text-slate-500 mt-0.5",children:["Run: ",C.id]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C?e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${ai(C.status)}`,children:String(C.status||"-").toUpperCase()}):e.jsx("span",{className:"text-sm text-slate-600",children:"Not generated"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-slate-700",children:R})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:L?b?e.jsx(mo,{variant:"primary",disabled:g,onClick:N,children:g?"Generating":"Generate"}):e.jsx("span",{className:"text-sm text-slate-500",children:"No access"}):C!=null&&C.id?e.jsx(mo,{variant:"secondary",onClick:()=>E(C),children:k.label}):e.jsx("span",{className:"text-sm text-slate-500",children:"-"})})]},a)})()})]})})}),e.jsx("div",{className:"mt-8 mb-4 text-sm font-semibold text-slate-900",children:"Previous Payrolls"}),j?e.jsx(ye,{title:"Payroll runs are not accessible",description:"You do not have permission to view payroll runs."}):S.length===0?e.jsx(ye,{title:"No previous payrolls",description:"No previous payroll runs found."}):e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Month"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Payroll Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Finance Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:S.map(C=>{const k=Yn(C.month),D=Bu(C),R=C?String(C.status||"").toUpperCase():"",L=R?R==="DRAFT"?"Pending Draft":R==="REVIEWED"?"Under Review":R:"-";return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:_u(k)}),(C==null?void 0:C.id)&&e.jsxs("div",{className:"text-xs text-slate-500 mt-0.5",children:["Run: ",C.id]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${ai(C.status)}`,children:String(C.status||"-").toUpperCase()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-slate-700",children:L})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx(mo,{variant:"secondary",onClick:()=>E(C),children:D.label==="Generate"?"Open":D.label})})]},C.id)})})]})})})]})}function cr(...t){return t.filter(Boolean).join(" ")}function vs({children:t,variant:s="secondary",disabled:a,onClick:n,type:l="button"}){const r="inline-flex items-center justify-center px-3 py-2 rounded-lg text-sm font-medium border transition-colors",o={primary:"bg-blue-600 text-white border-blue-600 hover:bg-blue-700",secondary:"bg-white text-slate-700 border-slate-200 hover:bg-slate-50",danger:"bg-red-600 text-white border-red-600 hover:bg-red-700"};return e.jsx("button",{type:l,onClick:n,disabled:a,className:`${r} ${o[s]||o.secondary} ${a?"opacity-50 cursor-not-allowed hover:bg-inherit":""}`,children:t})}function Fu({title:t,children:s,onClose:a}){return e.jsxs("div",{className:"fixed inset-0 z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:a}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-lg bg-white rounded-xl shadow-xl border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),e.jsx("button",{type:"button",onClick:a,className:"p-2 rounded-lg hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-5",children:s})]})})]})}function Ub({open:t,employee:s,items:a,disabled:n,onClose:l,onAdd:r}){const[o,d]=i.useState("ADJUSTMENT"),[c,m]=i.useState(""),[g,x]=i.useState(""),[j,h]=i.useState(!1),[f,u]=i.useState(null),b=i.useMemo(()=>(a||[]).reduce((w,S)=>{if(!S.is_system_generated)return w;const N=String(S.item_type||"").toUpperCase();return N==="BASE_PAY"||N==="ALLOWANCE"||N==="BONUS"?w+Number(S.amount||0):w},0),[a]),p=i.useMemo(()=>(a||[]).filter(w=>!w.is_system_generated),[a]),y=async w=>{if(w.preventDefault(),!n)try{h(!0),u(null);const S=Number(c);if(!Number.isFinite(S)||S===0){u("Amount must be a number and cannot be 0");return}if(!String(g||"").trim()){u("Reason is required");return}await r({itemType:o,amount:S,reason:String(g).trim()}),m(""),x("")}catch(S){u((S==null?void 0:S.message)||"Failed to add adjustment")}finally{h(!1)}};return t?e.jsx("div",{className:"fixed inset-y-0 right-0 z-40 w-full max-w-md bg-white border-l border-slate-200 shadow-xl",children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Adjustments"}),e.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:(s==null?void 0:s.name)||"Employee"})]}),e.jsx("button",{type:"button",onClick:l,className:"p-2 rounded-lg hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-5 space-y-5 overflow-auto",children:[e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Gross Pay"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 mt-1",children:ml(b)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Existing adjustments"}),p.length===0?e.jsx("div",{className:"text-sm text-slate-600",children:"No manual adjustments."}):e.jsx("div",{className:"space-y-2",children:p.map(w=>e.jsxs("div",{className:"rounded-lg border border-slate-200 px-3 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900 truncate",children:w.description}),e.jsx("div",{className:"text-sm text-slate-800",children:ml(w.amount)})]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:String(w.item_type||"").toUpperCase()})]},w.id))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Add adjustment"}),n?e.jsx("div",{className:"text-sm text-slate-600",children:"Adjustments are disabled for this payroll status."}):e.jsxs("form",{onSubmit:y,className:"space-y-3",children:[f&&e.jsx("div",{className:"rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-700",children:f}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Type"}),e.jsxs("select",{value:o,onChange:w=>d(w.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"ALLOWANCE",children:"Allowance"}),e.jsx("option",{value:"BONUS",children:"Bonus"}),e.jsx("option",{value:"DEDUCTION",children:"Deduction"}),e.jsx("option",{value:"ADJUSTMENT",children:"Adjustment"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Amount"}),e.jsx("input",{value:c,onChange:w=>m(w.target.value),inputMode:"decimal",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Reason"}),e.jsx("textarea",{value:g,onChange:w=>x(w.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Required"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(vs,{variant:"primary",disabled:j,type:"submit",children:j?"Adding":"Add"})})]})]})]})]})}):null}function $b(){const{runId:t}=Dt(),s=Ue(),[a,n]=i.useState(!0),[l,r]=i.useState(!0),[o,d]=i.useState(null),[c,m]=i.useState(null),[g,x]=i.useState([]),[j,h]=i.useState({}),[f,u]=i.useState({}),[b,p]=i.useState(null),[y,w]=i.useState(!1),[S,N]=i.useState(null),[E,v]=i.useState(null),[A,T]=i.useState(!1),[C,k]=i.useState(""),[D,R]=i.useState(!1),[L,_]=i.useState(!1),[I,G]=i.useState(()=>new Date().toISOString().slice(0,10)),[O,F]=i.useState("BANK_TRANSFER"),[W,$]=i.useState(""),[M,P]=i.useState(!1),[V,U]=i.useState(null),B=async()=>{try{n(!0),r(!0),d(null);const[q,Y]=await Promise.all([z(`/api/v1/payroll/runs/${t}`),z(`/api/v1/payroll/runs/${t}/items`)]),xe=(q==null?void 0:q.item)||null,J=(Y==null?void 0:Y.items)||[],me={};for(const K of J){const be=K.employee_id;if(!be||me[be])continue;const je=K.employee_name||K.employeeName||`${K.first_name||""} ${K.last_name||""}`.trim()||K.employee_code||K.employeeCode||be;me[be]={id:be,name:je}}m(xe),x(J),h(me);try{const K=await z(`/api/v1/payroll/runs/${t}/payslips`),be=(K==null?void 0:K.items)||[],je={};for(const pe of be)pe!=null&&pe.employee_id&&(je[pe.employee_id]=pe);u(je)}catch{u({})}}catch(q){d((q==null?void 0:q.message)||"Failed to load payroll run")}finally{n(!1),r(!1)}},Q=async q=>{const Y=(f==null?void 0:f[q])||null;if(Y!=null&&Y.id)try{p(q);const xe=xs(),J=await fetch(`${Us()}/api/v1/payroll/payslips/${Y.id}/download`,{method:"GET",headers:{...xe?{authorization:`Bearer ${xe}`}:{}}});if(!J.ok){const je=await J.text();throw new Error(je||`Download failed (${J.status})`)}const me=await J.blob(),K=window.URL.createObjectURL(me),be=document.createElement("a");be.href=K,be.download=Y.file_name||`payslip-${q}.pdf`,document.body.appendChild(be),be.click(),window.URL.revokeObjectURL(K),document.body.removeChild(be)}finally{p(null)}},ae=async()=>{if(t)try{N(null),w(!0),await z(`/api/v1/payroll/runs/${t}/payslips/generate`,{method:"POST"}),await B()}catch(q){N((q==null?void 0:q.message)||"Failed to generate payslips")}finally{w(!1)}};i.useEffect(()=>{t&&B()},[t]);const ie=String((c==null?void 0:c.status)||"").toUpperCase(),we=Ld(ie),De=Ob(ie)||we,Z=i.useMemo(()=>{const q={};for(const xe of g||[]){const J=xe.employee_id;q[J]||(q[J]=[]),q[J].push(xe)}const Y=Object.entries(q).map(([xe,J])=>{var ce,Ce,xt,hs,Es;let me=0,K=0,be=0;for(const ht of J){const Ot=String(ht.item_type||"").toUpperCase(),ps=Number(ht.amount||0);if(ht.is_system_generated){Ot==="BASE_PAY"||Ot==="ALLOWANCE"||Ot==="BONUS"?me+=ps:Ot==="DEDUCTION"&&(K+=ps);continue}Ot==="DEDUCTION"?be-=ps:be+=ps}const je=me+be-K,pe=((ce=J.find(ht=>ht.division_id))==null?void 0:ce.division_id)||null,Ae=pe?"DIVISION":"COMPANY",Se=((Ce=J.find(ht=>ht.division_name))==null?void 0:Ce.division_name)||((xt=J.find(ht=>ht.divisionName))==null?void 0:xt.divisionName)||null,Me=((hs=J.find(ht=>ht.employee_name))==null?void 0:hs.employee_name)||((Es=J.find(ht=>ht.employeeName))==null?void 0:Es.employeeName)||null;return{employeeId:xe,employeeName:Me,scope:Ae,divisionId:pe,divisionName:Se,gross:me,deductions:K,adjustments:be,net:je,status:ie}});return Y.sort((xe,J)=>String(xe.employeeId).localeCompare(String(J.employeeId))),Y},[g,ie]),ve=E?j[E]:null,ue=i.useMemo(()=>E?(g||[]).filter(q=>q.employee_id===E):[],[g,E]),re=we||ie==="LOCKED"||ie==="PAID"||ie==="CLOSED"||Z.length===0;if(l)return e.jsx("div",{className:"p-6",children:e.jsx(de,{})});const Re=async()=>{try{R(!0),d(null),ie==="DRAFT"&&await z(`/api/v1/payroll/runs/${t}/review`,{method:"POST"}),await z(`/api/v1/payroll/runs/${t}/lock`,{method:"POST"}),T(!1),k(""),await B()}catch(q){d((q==null?void 0:q.message)||"Failed to lock payroll")}finally{R(!1)}},ne=async({itemType:q,amount:Y,reason:xe})=>{if(!E)return;const J=q==="ALLOWANCE"?"Manual Allowance":q==="BONUS"?"Manual Bonus":q==="DEDUCTION"?"Manual Deduction":"Manual Adjustment";await z(`/api/v1/payroll/runs/${t}/items`,{method:"POST",body:{employeeId:E,itemType:q,description:J,amount:Y,reason:xe}}),await B()},H=ie==="LOCKED"&&!we,te=async()=>{try{P(!0),U(null);const q=`${String(I).slice(0,10)}T00:00:00.000Z`;for(const Y of Z)await z(`/api/v1/payroll/runs/${t}/payments`,{method:"POST",body:{employeeId:Y.employeeId,paidAmount:Number(Y.net||0),paidAt:q,method:O,referenceId:W?String(W).trim():""}});window.dispatchEvent(new Event("finance:refresh")),_(!1),$(""),await B()}catch(q){U((q==null?void 0:q.message)||"Failed to mark payroll as paid"),(q==null?void 0:q.status)===403&&U("You do not have the required permission (PAYROLL_MARK_PAID) to mark payroll as paid.")}finally{P(!1)}};return a?e.jsx("div",{className:"p-6",children:e.jsx(de,{})}):o?e.jsx("div",{className:"p-6",children:e.jsx(le,{error:o})}):c?(g||[]).length===0?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900",children:["Payroll  ",dr(c.month)]}),e.jsx("span",{className:cr("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border",ai(c.status)),children:String(c.status||"-").toUpperCase()})]}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:["Run ID: ",c.id]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(vs,{onClick:()=>s("/finance/payroll"),children:"Back"})})]}),e.jsx(ye,{title:"No eligible employees found for this month.",description:"Ensure compensation profiles are configured."})]}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900",children:["Payroll  ",dr(c.month)]}),e.jsx("span",{className:cr("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border",ai(c.status)),children:String(c.status||"-").toUpperCase()})]}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:["Run ID: ",c.id]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vs,{onClick:()=>s("/finance/payroll"),children:"Back"}),e.jsx(vs,{variant:"secondary",disabled:y,onClick:ae,children:y?"Generating Payslips":"Generate Payslips"}),e.jsx(vs,{variant:"primary",disabled:re,onClick:()=>T(!0),children:"Lock Payroll"}),e.jsx(vs,{variant:"secondary",disabled:!H,onClick:()=>_(!0),children:"Mark as Paid"})]})]}),S&&e.jsx("div",{className:"mb-4 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-700",children:S}),e.jsx("div",{className:cr("bg-white border border-slate-200 rounded-lg overflow-hidden",E?"pr-0":""),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Scope"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Division"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Gross"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Adjustments"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Net"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Payslip"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:Z.map(q=>{var me;const Y=j[q.employeeId],xe=q.scope==="DIVISION"?q.divisionName||q.divisionId:"Company Overhead";q.scope;const J=q.employeeName||(Y==null?void 0:Y.name)||q.employeeId;return e.jsxs("tr",{className:cr("hover:bg-slate-50 cursor-pointer",E===q.employeeId?"bg-blue-50/40":""),onClick:()=>v(q.employeeId),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-slate-900",children:J})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-700",children:q.scope})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-700",children:xe||""})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("div",{className:"text-sm text-slate-900",children:ml(q.gross)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("div",{className:"text-sm text-slate-900",children:ml(q.adjustments)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("div",{className:"text-sm font-medium text-slate-900",children:ml(q.net)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-700",children:String(q.status||"-").toUpperCase()})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",onClick:K=>K.stopPropagation(),children:(me=f==null?void 0:f[q.employeeId])!=null&&me.id?e.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-900 text-sm font-medium",disabled:b===q.employeeId,onClick:()=>Q(q.employeeId),children:b===q.employeeId?"Downloading":"Download"}):e.jsx("span",{className:"text-slate-400 text-sm",children:""})})]},q.employeeId)})})]})})}),e.jsx(Ub,{open:!!E,employee:ve,items:ue,disabled:De,onClose:()=>v(null),onAdd:ne}),A&&e.jsx(Fu,{title:"Lock Payroll",onClose:()=>T(!1),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Type ",e.jsxs("span",{className:"font-semibold",children:["LOCK PAYROLL ",dr(c.month).toUpperCase()]})," to confirm."]}),e.jsx("input",{value:C,onChange:q=>k(q.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"LOCK PAYROLL ..."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(vs,{onClick:()=>T(!1),disabled:D,children:"Cancel"}),e.jsx(vs,{variant:"danger",disabled:D||C.trim().toUpperCase()!==`LOCK PAYROLL ${dr(c.month).toUpperCase()}`,onClick:Re,children:D?"Locking":"Lock"})]})]})}),L&&e.jsx(Fu,{title:"Mark as Paid",onClose:()=>_(!1),children:e.jsxs("div",{className:"space-y-4",children:[V&&e.jsx("div",{className:"rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-700",children:V}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Payment Date"}),e.jsx("input",{type:"date",value:I,onChange:q=>G(q.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Mode"}),e.jsxs("select",{value:O,onChange:q=>F(q.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"BANK_TRANSFER",children:"Bank Transfer"}),e.jsx("option",{value:"UPI",children:"UPI"}),e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Reference (optional)"}),e.jsx("input",{value:W,onChange:q=>$(q.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional"})]})]}),e.jsx("div",{className:"text-sm text-slate-600",children:"This will record payments for all employees in this run."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(vs,{onClick:()=>_(!1),disabled:M,children:"Cancel"}),e.jsx(vs,{variant:"primary",disabled:M,onClick:te,children:M?"Submitting":"Mark Paid"})]})]})})]}):e.jsx("div",{className:"p-6",children:e.jsx(ye,{title:"Payroll run not found",description:"This payroll run does not exist."})})}function Uu(){const{runId:t}=Dt();return t?e.jsx($b,{}):e.jsx(Fb,{})}function Vb(t){if(!t)return"";try{const s=new Date(t);if(!Number.isFinite(s.getTime()))return String(t);const a=String(s.getMonth()+1).padStart(2,"0");return`${s.getFullYear()}-${a}`}catch{return String(t)}}function zb(t){if(!t)return"";try{const s=new Date(t);return Number.isFinite(s.getTime())?s.toLocaleString():String(t)}catch{return String(t)}}function Wb(){const[t,s]=i.useState("loading"),[a,n]=i.useState(null),[l,r]=i.useState(null),[o,d]=i.useState(1),c=20,[m,g]=i.useState(!1),[x,j]=i.useState(null),[h,f]=i.useState(""),[u,b]=i.useState("idle"),[p,y]=i.useState(null),w=i.useMemo(()=>{const C=new URLSearchParams;return C.set("page",String(o)),C.set("pageSize",String(c)),C.toString()},[o]);async function S(){try{s("loading"),n(null);const C=await z(`/api/v1/finance/month-close?${w}`);r(C),s("ready")}catch(C){n(C),s("error")}}i.useEffect(()=>{S()},[w]);const N=i.useMemo(()=>Array.isArray(l==null?void 0:l.items)?l.items:[],[l]),E=i.useMemo(()=>Number((l==null?void 0:l.total)||0),[l]),v=i.useMemo(()=>Math.max(1,Math.ceil(E/c)),[E,c]),A=i.useMemo(()=>{let C=0,k=0;for(const D of N)String((D==null?void 0:D.status)||"OPEN")==="CLOSED"?k+=1:C+=1;return{open:C,closed:k}},[N]);if(t==="loading")return e.jsx(de,{message:"Loading month close"});if(t==="error")return(a==null?void 0:a.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"GOV_MONTH_CLOSE_READ"}}):e.jsx(le,{error:a,onRetry:S});async function T(){try{b("loading"),y(null);const C=String(x||"").trim();await z(`/api/v1/finance/month-close/${encodeURIComponent(C)}/close`,{method:"POST",body:{reason:h}}),b("idle"),g(!1),f(""),j(null),window.dispatchEvent(new Event("finance:refresh")),await S()}catch(C){y(C),b("idle")}}return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Month Close"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Close accounting months with an audit reason."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Shown (this page)"}),e.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900",children:N.length})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Open"}),e.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900",children:A.open})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Closed"}),e.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900",children:A.closed})]})]}),N.length===0?e.jsx(ye,{title:"No month close records",description:"No month close activity found."}):e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Month"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Scope"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Closed By"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Closed At"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:N.map((C,k)=>{var I;const D=Vb(C.month),R=C.id||`${D}-${k}`,L=String(C.status||"OPEN"),_=L==="OPEN";return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900",children:D}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:String(C.scope||"COMPANY")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:L==="CLOSED"?e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-emerald-50 text-emerald-700 border border-emerald-200",children:"CLOSED"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-amber-50 text-amber-700 border border-amber-200",children:"OPEN"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:(I=C==null?void 0:C.closedBy)!=null&&I.id?String(C.closedBy.id):""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:zb(C.closedAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:_?e.jsx("button",{onClick:()=>{j(D),f(""),y(null),g(!0)},className:"px-3 py-2 rounded-lg bg-gradient-to-r from-slate-900 to-slate-800 hover:from-slate-800 hover:to-slate-700 text-white text-sm font-medium",children:"Close Month"}):e.jsx("span",{className:"text-sm text-slate-400",children:""})})]},R)})})]})}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",o," of ",v," (Total: ",E,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{disabled:o<=1,onClick:()=>d(C=>Math.max(1,C-1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:o>=v,onClick:()=>d(C=>Math.min(v,C+1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Next"})]})]})]}),m&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>g(!1)}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Close Month"}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:["Month: ",String(x||"")]})]}),e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Reason (required)"}),e.jsx("textarea",{value:h,onChange:C=>f(C.target.value),className:"w-full min-h-[90px] px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:"Enter reason for closing this month"}),(p==null?void 0:p.status)===403&&e.jsxs("div",{className:"text-sm text-rose-700 bg-rose-50 border border-rose-200 rounded-lg px-3 py-2",children:["Required permission: ",e.jsx("span",{className:"font-semibold",children:"MONTH_CLOSE_EXECUTE"})]}),p&&(p==null?void 0:p.status)!==403&&e.jsx("div",{className:"text-sm text-rose-600",children:(p==null?void 0:p.message)||"Failed to close month"})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-slate-200 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>g(!1),disabled:u==="loading",className:"px-4 py-2 rounded-xl border border-slate-200 bg-white text-sm font-medium",children:"Cancel"}),e.jsx("button",{disabled:u==="loading"||!String(h||"").trim(),onClick:T,className:"px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium disabled:opacity-50",children:u==="loading"?"Closing":"Close Month"})]})]})]})]})}function Ya(t){const s=Number(t||0);return Number.isFinite(s)?s.toLocaleString(void 0,{maximumFractionDigits:2}):"0"}function Hb(t,s){const a=s.map(o=>o.map(d=>`"${String(d??"").replace(/"/g,'""')}"`).join(",")),n=new Blob([a.join(`
`)],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(n),r=document.createElement("a");r.href=l,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(l)}function qb(t){if(!t)return"";try{const s=new Date(t);return Number.isFinite(s.getTime())?s.toLocaleDateString():String(t)}catch{return String(t)}}function Yb(){const[t,s]=i.useState("loading"),[a,n]=i.useState(null),[l,r]=i.useState(null),[o,d]=i.useState(""),[c,m]=i.useState(""),[g,x]=i.useState(""),[j,h]=i.useState(1),f=20,u=i.useMemo(()=>{const N=new URLSearchParams;return N.set("page",String(j)),N.set("pageSize",String(f)),o&&N.set("month",o),c&&N.set("type",c),g&&N.set("search",g),N.toString()},[o,c,g,j]);async function b(){try{s("loading"),n(null);const N=await z(`/api/v1/finance/ledger?${u}`);r(N),s("ready")}catch(N){n(N),s("error")}}i.useEffect(()=>{b()},[u]),i.useEffect(()=>{function N(){b()}return window.addEventListener("finance:refresh",N),()=>window.removeEventListener("finance:refresh",N)},[]);const p=i.useMemo(()=>Array.isArray(l==null?void 0:l.items)?l.items:[],[l]),y=i.useMemo(()=>Number((l==null?void 0:l.total)||0),[l]),w=i.useMemo(()=>Math.max(1,Math.ceil(y/f)),[y,f]),S=i.useMemo(()=>{let N=0,E=0;for(const v of p)N+=Number((v==null?void 0:v.debit)||0)||0,E+=Number((v==null?void 0:v.credit)||0)||0;return{debit:N,credit:E,net:E-N}},[p]);return t==="loading"?e.jsx(de,{message:"Loading ledger"}):t==="error"?(a==null?void 0:a.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"FINANCE_LEDGER_READ"}}):e.jsx(le,{error:a,onRetry:b}):e.jsxs("div",{className:"space-y-5",children:[e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Ledger"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Payroll-derived entries with running balance."})]})}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 mb-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Filters"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{d(""),m(""),x(""),h(1)},className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Reset"}),e.jsx("button",{onClick:()=>{const N=[["date","type","reference","employeeName","divisionName","debit","credit","balance"],...p.map(E=>[E.date,E.type,E.reference,E.employeeName,E.divisionName,E.debit,E.credit,E.balance])];Hb(`finance-ledger-page-${j}.csv`,N)},className:"px-3 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium",children:"Export CSV"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Month"}),e.jsx("input",{value:o,onChange:N=>{d(N.target.value),h(1)},placeholder:"YYYY-MM",className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Type"}),e.jsxs("select",{value:c,onChange:N=>{m(N.target.value),h(1)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"PAYROLL",children:"PAYROLL"}),e.jsx("option",{value:"ADJUSTMENT",children:"ADJUSTMENT"}),e.jsx("option",{value:"BONUS",children:"BONUS"}),e.jsx("option",{value:"PAYMENT",children:"PAYMENT"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Employee Search"}),e.jsx("input",{value:g,onChange:N=>{x(N.target.value),h(1)},placeholder:"Search by employee name",className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Page Debit"}),e.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900",children:Ya(S.debit)})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Page Credit"}),e.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900",children:Ya(S.credit)})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Page Net"}),e.jsx("div",{className:"mt-1 text-lg font-bold text-slate-900",children:Ya(S.net)})]})]}),p.length===0?e.jsx(ye,{title:"No ledger entries",description:"No entries matched your filters."}):e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Reference"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Division"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Debit"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Credit"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Balance"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:p.map(N=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:qb(N.date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900",children:String(N.type||"")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:String(N.reference||"")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:String(N.employeeName||"")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:String(N.divisionName||"")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700 text-right",children:Ya(N.debit)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700 text-right",children:Ya(N.credit)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900 font-semibold text-right",children:Ya(N.balance)})]},N.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",j," of ",w," (Total: ",y,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{disabled:j<=1,onClick:()=>h(N=>Math.max(1,N-1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:j>=w,onClick:()=>h(N=>Math.min(w,N+1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Next"})]})]})]})]})}function Gb(t){if(!t)return"";try{const s=new Date(t);return Number.isFinite(s.getTime())?s.toLocaleDateString():String(t)}catch{return String(t)}}function Qb(t){const s=Number(t||0);return Number.isFinite(s)?s.toLocaleString(void 0,{maximumFractionDigits:2}):"0"}function $u({tone:t,children:s}){const a=t==="gray"?"bg-slate-100 text-slate-700 border-slate-200":t==="blue"?"bg-blue-50 text-blue-700 border-blue-200":t==="teal"?"bg-teal-50 text-teal-700 border-teal-200":t==="red"?"bg-red-50 text-red-700 border-red-200":t==="yellow"?"bg-amber-50 text-amber-700 border-amber-200":t==="green"?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full border text-xs font-semibold ${a}`,children:s})}function Vu(t){const s=String(t||"").toUpperCase();return s==="DRAFT"?"gray":s==="SUBMITTED"?"blue":s==="APPROVED"?"teal":s==="REJECTED"?"red":s==="PAID"?"green":s==="CLOSED"?"gray":s==="PARTIAL"?"yellow":"gray"}function Jb(){const t=Ue(),[s,a]=i.useState("loading"),[n,l]=i.useState(null),[r,o]=i.useState(null),[d,c]=i.useState(!0),[m,g]=i.useState(""),[x,j]=i.useState(""),[h,f]=i.useState(""),[u,b]=i.useState(""),[p,y]=i.useState(""),[w,S]=i.useState(""),[N,E]=i.useState(""),[v,A]=i.useState(""),[T,C]=i.useState(""),[k,D]=i.useState(""),[R,L]=i.useState(""),[_,I]=i.useState(1),G=20,[O,F]=i.useState([]),W=i.useMemo(()=>{const B=new URLSearchParams;return B.set("page",String(_)),B.set("size",String(G)),h&&B.set("status",h),p&&B.set("divisionId",p),w&&B.set("categoryId",w),N&&B.set("from",N),v&&B.set("to",v),T&&B.set("minAmount",T),k&&B.set("maxAmount",k),R&&B.set("search",R),B.toString()},[_,h,p,w,N,v,T,k,R]);async function $(){try{a("loading"),l(null);const[B,Q]=await Promise.all([z(`/api/v1/expenses?${W}`),z("/api/v1/expenses/categories")]);o(B),F(Array.isArray(Q==null?void 0:Q.items)?Q.items:Array.isArray(Q)?Q:[]),a("ready")}catch(B){l(B),a("error")}}i.useEffect(()=>{$()},[W]);const M=i.useMemo(()=>Array.isArray(r==null?void 0:r.items)?r.items:[],[r]),P=i.useMemo(()=>Number((r==null?void 0:r.total)||0),[r]),V=i.useMemo(()=>Math.max(1,Math.ceil(P/G)),[P,G]);if(s==="loading")return e.jsx(de,{message:"Loading expenses"});if(s==="error")return(n==null?void 0:n.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"EXPENSE_READ"}}):e.jsx(le,{error:n,onRetry:$});function U(){g(""),j(""),f(""),b(""),y(""),S(""),E(""),A(""),C(""),D(""),L(""),I(1)}return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Expenses"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Capture, approve and pay expenses with audit trail."})]}),e.jsx("button",{onClick:()=>t("/finance/expenses/create"),className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium",children:"Create Expense"})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 mb-4",children:[e.jsx("button",{onClick:()=>c(B=>!B),className:"text-sm font-semibold text-slate-800 hover:text-slate-900",children:"Filters"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:U,className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Reset"}),e.jsx("button",{onClick:$,className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Refresh"})]})]}),d?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Scope"}),e.jsxs("select",{value:m,onChange:B=>g(B.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"COMPANY",children:"COMPANY"}),e.jsx("option",{value:"DIVISION",children:"DIVISION"})]}),e.jsx("div",{className:"text-[11px] text-slate-500 mt-1",children:"Placeholder filter (backend-controlled)."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Source"}),e.jsxs("select",{value:x,onChange:B=>j(B.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"VENDOR",children:"VENDOR"}),e.jsx("option",{value:"REIMBURSEMENT",children:"REIMBURSEMENT"}),e.jsx("option",{value:"OTHER",children:"OTHER"})]}),e.jsx("div",{className:"text-[11px] text-slate-500 mt-1",children:"Placeholder filter (backend-controlled)."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Approval State"}),e.jsxs("select",{value:h,onChange:B=>{f(B.target.value),I(1)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"}),e.jsx("option",{value:"APPROVED",children:"APPROVED"}),e.jsx("option",{value:"REJECTED",children:"REJECTED"}),e.jsx("option",{value:"PAID",children:"PAID"}),e.jsx("option",{value:"CLOSED",children:"CLOSED"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Payment State"}),e.jsxs("select",{value:u,onChange:B=>b(B.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"UNPAID",children:"UNPAID"}),e.jsx("option",{value:"PARTIAL",children:"PARTIAL"}),e.jsx("option",{value:"PAID",children:"PAID"})]}),e.jsx("div",{className:"text-[11px] text-slate-500 mt-1",children:"Derived client-side in detail page."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Division"}),e.jsx("input",{value:p,onChange:B=>{y(B.target.value),I(1)},placeholder:"Division UUID",className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Category"}),e.jsxs("select",{value:w,onChange:B=>{S(B.target.value),I(1)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"",children:"All"}),O.map(B=>e.jsxs("option",{value:B.id,children:[B.code," - ",B.name]},B.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Date From"}),e.jsx("input",{type:"date",value:N,onChange:B=>{E(B.target.value),I(1)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Date To"}),e.jsx("input",{type:"date",value:v,onChange:B=>{A(B.target.value),I(1)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Min Amount"}),e.jsx("input",{value:T,onChange:B=>{C(B.target.value),I(1)},placeholder:"0",className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Max Amount"}),e.jsx("input",{value:k,onChange:B=>{D(B.target.value),I(1)},placeholder:"100000",className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Search (title/vendor)"}),e.jsx("input",{value:R,onChange:B=>{L(B.target.value),I(1)},placeholder:"Search",className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]})]}):null]}),M.length===0?e.jsx(ye,{title:"No expenses",description:"No expenses matched your filters."}):e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Scope"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Division"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Source"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Approval"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Payment"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:M.map(B=>{const Q=String(B.status||"").toUpperCase(),ae=Q==="PAID"?"PAID":Q==="APPROVED"?"UNPAID":Q==="CLOSED"?"PAID":"",ie=O.find(we=>String(we.id)===String(B.categoryId));return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:Gb(B.expenseDate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:B.divisionId?String(B.divisionId).slice(0,8)+"":""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:B.isReimbursement?"REIMBURSEMENT":"VENDOR"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:ie?`${ie.code}`:String(B.categoryId||"").slice(0,8)+""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700 text-right",children:Qb(B.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:e.jsx($u,{tone:Vu(Q),children:Q})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:e.jsx($u,{tone:Vu(ae),children:ae})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700 text-right",children:e.jsx("button",{onClick:()=>t(`/finance/expenses/${B.id}`),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium hover:bg-slate-50",children:"View"})})]},B.id)})})]})}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",_," of ",V," (Total: ",P,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{disabled:_<=1,onClick:()=>I(B=>Math.max(1,B-1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:_>=V,onClick:()=>I(B=>Math.min(V,B+1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Next"})]})]})]})]})}function mr(t){const s=Number(t||0);return Number.isFinite(s)?s.toLocaleString(void 0,{maximumFractionDigits:2}):"0"}function Gn(t){if(!t)return"";try{const s=new Date(t);return Number.isFinite(s.getTime())?s.toLocaleString():String(t)}catch{return String(t)}}function zu({tone:t,children:s}){const a=t==="gray"?"bg-slate-100 text-slate-700 border-slate-200":t==="blue"?"bg-blue-50 text-blue-700 border-blue-200":t==="teal"?"bg-teal-50 text-teal-700 border-teal-200":t==="red"?"bg-red-50 text-red-700 border-red-200":t==="yellow"?"bg-amber-50 text-amber-700 border-amber-200":t==="green"?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full border text-xs font-semibold ${a}`,children:s})}function Kb(t){const s=String(t||"").toUpperCase();return s==="DRAFT"?"gray":s==="SUBMITTED"?"blue":s==="APPROVED"?"teal":s==="REJECTED"?"red":s==="PAID"?"green":s==="PARTIAL"?"yellow":"gray"}async function Xb({path:t,filename:s}){const a=Us(),n=xs(),l=await fetch(`${a}${t}`,{method:"GET",headers:{...n?{authorization:`Bearer ${n}`}:{}}});if(!l.ok){const c=await l.text();throw new Error(c||`Download failed (${l.status})`)}const r=await l.blob(),o=window.URL.createObjectURL(r),d=document.createElement("a");d.href=o,d.download=s,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(o),document.body.removeChild(d)}function Zb(){const{expenseId:t}=Dt(),[s,a]=i.useState("loading"),[n,l]=i.useState(null),[r,o]=i.useState(null),[d,c]=i.useState(null),[m,g]=i.useState(null),[x,j]=i.useState([]),[h,f]=i.useState([]),[u,b]=i.useState(""),[p,y]=i.useState("BANK_TRANSFER"),[w,S]=i.useState(""),[N,E]=i.useState(!1),[v,A]=i.useState(null),T=i.useMemo(()=>{const D=Number((r==null?void 0:r.amount)||0),R=Number(m||0);return r?D<=0?{label:"UNPAID",tone:"gray"}:R<=0?{label:"UNPAID",tone:"gray"}:R+1e-5<D?{label:"PARTIAL",tone:"yellow"}:{label:"PAID",tone:"green"}:{label:"",tone:"gray"}},[r,m]);async function C(){try{a("loading"),l(null);const[D,R,L]=await Promise.all([z(`/api/v1/expenses/${t}`),z(`/api/v1/expenses/${t}/receipts`),z(`/api/v1/expenses/${t}/payments`)]);o((D==null?void 0:D.item)||null),c((D==null?void 0:D.remainingAmount)??null),g((D==null?void 0:D.totalPaid)??null),j(Array.isArray(R==null?void 0:R.items)?R.items:Array.isArray(R)?R:[]),f(Array.isArray(L==null?void 0:L.items)?L.items:Array.isArray(L)?L:[]),a("ready")}catch(D){l(D),a("error")}}if(i.useEffect(()=>{t&&C()},[t]),s==="loading")return e.jsx(de,{message:"Loading expense"});if(s==="error")return(n==null?void 0:n.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"EXPENSE_READ"}}):e.jsx(le,{error:n,onRetry:C});if(!r)return e.jsx(ye,{title:"Expense not found",description:"The requested expense could not be loaded."});async function k(){try{E(!0),A(null);const D=await z(`/api/v1/expenses/${t}/mark-paid`,{method:"POST",body:{paidAmount:Number(u),paidAt:new Date,method:p,referenceId:w}});g((D==null?void 0:D.totalPaid)??m),c((D==null?void 0:D.remainingAmount)??d),b(""),S(""),await C()}catch(D){A(D)}finally{E(!1)}}return e.jsxs("div",{className:"space-y-5",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Expense Detail"}),e.jsxs("p",{className:"text-slate-600 mt-1",children:["ID: ",r.id]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zu,{tone:Kb(r.status),children:String(r.status||"")}),e.jsx(zu,{tone:T.tone,children:T.label})]})]})}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Expense Date"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-slate-900",children:String(r.expenseDate||"")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Amount"}),e.jsxs("div",{className:"mt-1 text-sm font-bold text-slate-900",children:[mr(r.amount)," ",r.currency||"INR"]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Paid: ",mr(m)," | Remaining: ",mr(d)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Division"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-slate-900",children:r.divisionId||""})]})]}),e.jsxs("div",{className:"mt-4 border-t border-slate-200 pt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Title"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:r.title||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Vendor / Source"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:r.isReimbursement?"REIMBURSEMENT":r.vendorName||"VENDOR"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Description"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700 whitespace-pre-wrap",children:r.description||""})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Approval timeline"})}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm text-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:"Submitted"}),e.jsx("div",{className:"text-slate-500",children:Gn(r.submittedAt)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:"Approved"}),e.jsx("div",{className:"text-slate-500",children:Gn(r.approvedAt)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:"Rejected"}),e.jsx("div",{className:"text-slate-500",children:Gn(r.rejectedAt)})]}),r.decisionReason?e.jsxs("div",{className:"text-xs text-slate-600 mt-2",children:["Reason: ",r.decisionReason]}):null]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Mark payment"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Amount"}),e.jsx("input",{value:u,onChange:D=>b(D.target.value),placeholder:"0",className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Method"}),e.jsxs("select",{value:p,onChange:D=>y(D.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"BANK_TRANSFER",children:"BANK_TRANSFER"}),e.jsx("option",{value:"UPI",children:"UPI"}),e.jsx("option",{value:"CASH",children:"CASH"}),e.jsx("option",{value:"CARD",children:"CARD"}),e.jsx("option",{value:"OTHER",children:"OTHER"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Reference"}),e.jsx("input",{value:w,onChange:D=>S(D.target.value),placeholder:"UTR / Ref",className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]})]}),v?e.jsx("div",{className:"mt-3 text-sm text-red-700",children:String(v.message||v)}):null,e.jsx("div",{className:"mt-4 flex items-center justify-end",children:e.jsx("button",{disabled:N,onClick:k,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium disabled:opacity-50",children:N?"Saving":"Mark Paid"})}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"w-full h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-2 bg-emerald-500",style:{width:`${Math.min(100,Math.max(0,Number(m||0)/Math.max(1,Number(r.amount||0))*100))}%`}})}),e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"Payment progress"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-slate-200",children:e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Receipts"})}),x.length===0?e.jsx("div",{className:"p-4 text-sm text-slate-600",children:"No receipts uploaded."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"File"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Uploaded"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:x.map(D=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:D.fileName}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:Gn(D.uploadedAt)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>Xb({path:`/api/v1/expenses/${t}/receipts/${D.id}/download`,filename:D.fileName||"receipt"}),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium hover:bg-slate-50",children:"Download"})})]},D.id))})]})})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-slate-200",children:e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Payment history"})}),h.length===0?e.jsx("div",{className:"p-4 text-sm text-slate-600",children:"No payments recorded."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Paid At"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Method"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Reference"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Amount"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:h.map(D=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:Gn(D.paidAt)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:D.method}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:D.referenceId||""}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700 text-right",children:mr(D.paidAmount)})]},D.id))})]})})]})]})]})}function ej(t){return new Promise((s,a)=>{const n=new FileReader;n.onload=()=>{const l=String(n.result||""),r=l.includes("base64,")?l.split("base64,")[1]:l;s(r)},n.onerror=()=>a(new Error("File read failed")),n.readAsDataURL(t)})}function tj(){const t=Ue(),[s,a]=i.useState("loading"),[n,l]=i.useState(null),[r,o]=i.useState([]),[d,c]=i.useState(""),[m,g]=i.useState("COMPANY"),[x,j]=i.useState("VENDOR"),[h,f]=i.useState(""),[u,b]=i.useState(""),[p,y]=i.useState("INR"),[w,S]=i.useState(""),[N,E]=i.useState(""),[v,A]=i.useState(""),[T,C]=i.useState("BANK_TRANSFER"),[k,D]=i.useState(""),[R,L]=i.useState(null),[_,I]=i.useState(!1),[G,O]=i.useState(null),F=i.useMemo(()=>m==="DIVISION",[m]);async function W(){try{a("loading"),l(null);const M=await z("/api/v1/expenses/categories");o(Array.isArray(M==null?void 0:M.items)?M.items:Array.isArray(M)?M:[]),a("ready")}catch(M){l(M),a("error")}}if(i.useEffect(()=>{W()},[]),s==="loading")return e.jsx(de,{message:"Loading"});if(s==="error")return(n==null?void 0:n.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"EXPENSE_CREATE"}}):e.jsx(le,{error:n,onRetry:W});async function $({submit:M}){try{if(I(!0),O(null),F&&!w)throw new Error("Division is required for DIVISION scope");const P={expenseDate:d,categoryId:h,title:N,description:k,amount:Number(u),currency:p,divisionId:w||null,projectId:null,paidByMethod:T,vendorName:x==="VENDOR"?v:null,isReimbursement:x==="REIMBURSEMENT",employeeId:null},V=await z("/api/v1/expenses",{method:"POST",body:P}),U=(V==null?void 0:V.item)||V,B=U==null?void 0:U.id;if(!B)throw new Error("Expense creation failed");if(R){const Q=await ej(R);await z(`/api/v1/expenses/${B}/receipts`,{method:"POST",body:{fileName:R.name,contentType:R.type,fileBase64:Q}})}M&&await z(`/api/v1/expenses/${B}/submit`,{method:"POST",body:{}}),t(`/finance/expenses/${B}`)}catch(P){O(P)}finally{I(!1)}}return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Create Expense"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Save as draft or submit for approval."})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Basic Info"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Expense Date"}),e.jsx("input",{type:"date",value:d,onChange:M=>c(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Title"}),e.jsx("input",{value:N,onChange:M=>E(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:"Expense title"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Scope"}),e.jsxs("select",{value:m,onChange:M=>g(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"COMPANY",children:"COMPANY"}),e.jsx("option",{value:"DIVISION",children:"DIVISION"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Source"}),e.jsxs("select",{value:x,onChange:M=>j(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"VENDOR",children:"VENDOR"}),e.jsx("option",{value:"REIMBURSEMENT",children:"REIMBURSEMENT"}),e.jsx("option",{value:"OTHER",children:"OTHER"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Category"}),e.jsxs("select",{value:h,onChange:M=>f(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"",children:"Select"}),r.map(M=>e.jsxs("option",{value:M.id,children:[M.code," - ",M.name]},M.id))]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Amount"}),e.jsx("input",{value:u,onChange:M=>b(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Currency"}),e.jsx("input",{value:p,onChange:M=>y(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:"INR"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Paid By Method"}),e.jsxs("select",{value:T,onChange:M=>C(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"BANK_TRANSFER",children:"BANK_TRANSFER"}),e.jsx("option",{value:"UPI",children:"UPI"}),e.jsx("option",{value:"CASH",children:"CASH"}),e.jsx("option",{value:"CARD",children:"CARD"}),e.jsx("option",{value:"OTHER",children:"OTHER"})]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Division (conditional)"}),e.jsx("input",{value:w,onChange:M=>S(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:"Division UUID"}),F?e.jsx("div",{className:"text-xs text-amber-700 mt-1",children:"Required when Scope = DIVISION"}):null]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Vendor Name"}),e.jsx("input",{value:v,onChange:M=>A(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:"Vendor"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Description"}),e.jsx("textarea",{value:k,onChange:M=>D(M.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",rows:4})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Attachment upload"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("input",{type:"file",onChange:M=>{var P;return L(((P=M.target.files)==null?void 0:P[0])||null)},className:"block w-full text-sm text-slate-700"}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Accepted: PDF/JPG/PNG (backend enforced)."})]})]}),G?e.jsx("div",{className:"mt-4 text-sm text-red-700",children:String(G.message||G)}):null,e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{disabled:_,onClick:()=>$({submit:!1}),className:"px-4 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-50",children:"Save Draft"}),e.jsx("button",{disabled:_,onClick:()=>$({submit:!0}),className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium disabled:opacity-50",children:"Submit"})]})]})]})}function Wu({open:t,title:s,children:a,onClose:n}){return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 p-4",children:e.jsxs("div",{className:"w-full max-w-xl bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("button",{onClick:n,className:"text-slate-500 hover:text-slate-800 text-sm",children:"Close"})]}),e.jsx("div",{className:"p-5",children:a})]})}):null}function sj(){const[t,s]=i.useState("loading"),[a,n]=i.useState(null),[l,r]=i.useState([]),[o,d]=i.useState(!1),[c,m]=i.useState(!1),[g,x]=i.useState(null),[j,h]=i.useState(""),[f,u]=i.useState(""),[b,p]=i.useState(""),[y,w]=i.useState(""),[S,N]=i.useState(""),[E,v]=i.useState(""),[A,T]=i.useState(!0),[C,k]=i.useState("idle"),[D,R]=i.useState(null);async function L(){try{s("loading"),n(null);const O=await z("/api/v1/expenses/categories");r(Array.isArray(O==null?void 0:O.items)?O.items:Array.isArray(O)?O:[]),s("ready")}catch(O){n(O),s("error")}}if(i.useEffect(()=>{L()},[]),t==="loading")return e.jsx(de,{message:"Loading categories"});if(t==="error")return(a==null?void 0:a.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"EXPENSE_CATEGORY_READ"}}):e.jsx(le,{error:a,onRetry:L});async function _(){try{k("loading"),R(null),await z("/api/v1/expenses/categories",{method:"POST",body:{code:j,name:f,description:b}}),d(!1),h(""),u(""),p(""),await L()}catch(O){R(O)}finally{k("idle")}}function I(O){x(O),w(O.code||""),N(O.name||""),v(O.description||""),T(!!O.isActive),m(!0)}async function G(){try{k("loading"),R(null),await z(`/api/v1/expenses/categories/${g.id}`,{method:"PATCH",body:{code:y,name:S,description:E,isActive:A,version:g.version}}),m(!1),x(null),await L()}catch(O){R(O)}finally{k("idle")}}return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Expense Categories"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Manage active categories used for expense capture."})]}),e.jsx("button",{onClick:()=>{R(null),d(!0)},className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium",children:"Add Category"})]}),l.length===0?e.jsx(ye,{title:"No categories",description:"Create your first expense category."}):e.jsx("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Active"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:l.map(O=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-slate-900",children:O.code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:O.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:O.isActive?"Yes":"No"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("button",{onClick:()=>I(O),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium hover:bg-slate-50",children:"Edit"})})]},O.id))})]})})}),e.jsxs(Wu,{open:o,title:"Add category",onClose:()=>d(!1),children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Code"}),e.jsx("input",{value:j,onChange:O=>h(O.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Name"}),e.jsx("input",{value:f,onChange:O=>u(O.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Description"}),e.jsx("textarea",{value:b,onChange:O=>p(O.target.value),rows:3,className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]})]}),D?e.jsx("div",{className:"mt-3 text-sm text-red-700",children:String(D.message||D)}):null,e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium",children:"Cancel"}),e.jsx("button",{disabled:C==="loading",onClick:_,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium disabled:opacity-50",children:"Save"})]})]}),e.jsx(Wu,{open:c,title:"Edit category",onClose:()=>m(!1),children:g?e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Code"}),e.jsx("input",{value:y,onChange:O=>w(O.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Name"}),e.jsx("input",{value:S,onChange:O=>N(O.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Description"}),e.jsx("textarea",{value:E,onChange:O=>v(O.target.value),rows:3,className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Active"}),e.jsxs("select",{value:A?"true":"false",onChange:O=>T(O.target.value==="true"),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Version"}),e.jsx("input",{value:String(g.version||""),disabled:!0,className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-slate-50"})]})]}),D?e.jsx("div",{className:"mt-3 text-sm text-red-700",children:String(D.message||D)}):null,e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium",children:"Cancel"}),e.jsx("button",{disabled:C==="loading",onClick:G,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium disabled:opacity-50",children:"Save"})]})]}):null})]})}function aj(t){const s=Number(t||0);return Number.isFinite(s)?s.toLocaleString(void 0,{maximumFractionDigits:2}):"0"}function nj(){const t=Ue(),[s,a]=i.useState("loading"),[n,l]=i.useState(null),[r,o]=i.useState(null),[d,c]=i.useState(1),m=20,g=i.useMemo(()=>{const u=new URLSearchParams;return u.set("page",String(d)),u.set("size",String(m)),u.set("status","APPROVED"),u.toString()},[d]);async function x(){try{a("loading"),l(null);const u=await z(`/api/v1/expenses?${g}`);o(u),a("ready")}catch(u){l(u),a("error")}}i.useEffect(()=>{x()},[g]);const j=i.useMemo(()=>Array.isArray(r==null?void 0:r.items)?r.items:[],[r]),h=i.useMemo(()=>Number((r==null?void 0:r.total)||0),[r]),f=i.useMemo(()=>Math.max(1,Math.ceil(h/m)),[h,m]);return s==="loading"?e.jsx(de,{message:"Loading payment queue"}):s==="error"?(n==null?void 0:n.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"EXPENSE_READ"}}):e.jsx(le,{error:n,onRetry:x}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Expense Payments"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Approved expenses awaiting payment or partial settlement."})]}),j.length===0?e.jsx(ye,{title:"No items",description:"No approved expenses found."}):e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Expense"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Division"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:j.map(u=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:u.title||u.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:u.divisionId||""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700 text-right",children:aj(u.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("button",{onClick:()=>t(`/finance/expenses/${u.id}`),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium hover:bg-slate-50",children:"Quick mark paid"})})]},u.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",d," of ",f," (Total: ",h,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{disabled:d<=1,onClick:()=>c(u=>Math.max(1,u-1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:d>=f,onClick:()=>c(u=>Math.min(f,u+1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Next"})]})]})]})]})}function lj(){const[t,s]=i.useState(""),[a,n]=i.useState(""),l=!!String(t||"").trim()&&Number.isFinite(Number(a))&&Number(a)!==0;return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Adjustments"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Append-only adjustments (placeholder UI for future backend wiring)."})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Create adjustment"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Reason"}),e.jsx("input",{value:t,onChange:r=>s(r.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:"Reason"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Amount"}),e.jsx("input",{value:a,onChange:r=>n(r.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:"0"})]})]}),e.jsx("div",{className:"mt-4 flex items-center justify-end",children:e.jsx("button",{disabled:!0,className:"px-4 py-2 rounded-lg bg-slate-200 text-slate-600 text-sm font-medium cursor-not-allowed",children:"Add"})}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Adjustments backend endpoints are not available in this build. This page is UI-only as requested."})]}),e.jsx(ye,{title:"No adjustments",description:l?"Ready to submit, but adjustments API is not wired.":"Enter details above. Adjustments require backend wiring."})]})}function Hu(t){if(!t)return"";const s=String(t);if(/^\d{4}-\d{2}-\d{2}/.test(s))return s.slice(0,10);const a=new Date(t);return Number.isNaN(a.getTime())?"":a.toISOString().slice(0,10)}function Fh(t){return new Promise((s,a)=>{const n=new FileReader;n.onload=()=>{const l=String(n.result||""),r=l.includes("base64,")?l.split("base64,")[1]:l;s(r)},n.onerror=()=>a(new Error("File read failed")),n.readAsDataURL(t)})}async function rj(t){const s=xs(),a=await fetch(`${Us()}${t}`,{method:"GET",headers:{...s?{authorization:`Bearer ${s}`}:{}}});if(!a.ok){const r=await a.text().catch(()=>""),o=new Error(r||`Download failed (${a.status})`);throw o.status=a.status,o}const n=await a.blob(),l=a.headers.get("content-type")||"application/octet-stream";return{blob:n,contentType:l}}async function ij({incomeId:t,docId:s,fileName:a}){const n=`/api/v1/income/${t}/documents/${s}/download`,{blob:l}=await rj(n),r=URL.createObjectURL(l),o=document.createElement("a");o.href=r,o.download=a||"document",document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(r)}const Te={listIncome({page:t=1,size:s=20,status:a,divisionId:n,categoryId:l,clientId:r,from:o,to:d,search:c}){const m=new URLSearchParams;return m.set("page",String(t)),m.set("size",String(s)),a&&m.set("status",String(a)),n&&m.set("divisionId",String(n)),l&&m.set("categoryId",String(l)),r&&m.set("clientId",String(r)),o&&m.set("from",Hu(o)),d&&m.set("to",Hu(d)),c&&m.set("search",String(c)),z(`/api/v1/income?${m.toString()}`)},getIncome(t){return z(`/api/v1/income/${t}`)},createIncome(t){return z("/api/v1/income",{method:"POST",body:t})},updateIncome(t,s){return z(`/api/v1/income/${t}`,{method:"PATCH",body:s})},submitIncome(t){return z(`/api/v1/income/${t}/submit`,{method:"POST",body:{}})},approveIncome(t){return z(`/api/v1/income/${t}/approve`,{method:"POST",body:{}})},rejectIncome(t,s){return z(`/api/v1/income/${t}/reject`,{method:"POST",body:{reason:s}})},markPaid(t,s){return z(`/api/v1/income/${t}/mark-paid`,{method:"POST",body:s})},listPayments(t){return z(`/api/v1/income/${t}/payments`)},listDocuments(t){return z(`/api/v1/income/${t}/documents`)},uploadDocument(t,s){return z(`/api/v1/income/${t}/documents`,{method:"POST",body:s})},listCategories(){return z("/api/v1/income/categories")},createCategory(t){return z("/api/v1/income/categories",{method:"POST",body:t})},updateCategory(t,s){return z(`/api/v1/income/categories/${t}`,{method:"PATCH",body:s})},listClients({page:t=1,size:s=50,active:a,search:n}={}){const l=new URLSearchParams;return l.set("page",String(t)),l.set("size",String(s)),a!==void 0&&l.set("active",String(!!a)),n&&l.set("search",String(n)),z(`/api/v1/income/clients?${l.toString()}`)},createClient(t){return z("/api/v1/income/clients",{method:"POST",body:t})},updateClient(t,s){return z(`/api/v1/income/clients/${t}`,{method:"PATCH",body:s})}};function oj({status:t}){const s=String(t||"").toUpperCase(),a=s==="PAID"?"bg-emerald-50 text-emerald-700 border-emerald-200":s==="APPROVED"?"bg-blue-50 text-blue-700 border-blue-200":s==="SUBMITTED"?"bg-amber-50 text-amber-700 border-amber-200":s==="REJECTED"?"bg-rose-50 text-rose-700 border-rose-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${a}`,children:s})}function qu(t){return Number(t||0).toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2})}function dj(){const t=Ue(),[s,a]=i.useState("loading"),[n,l]=i.useState(null),[r,o]=i.useState(null),[d,c]=i.useState([]),[m,g]=i.useState([]),[x,j]=i.useState(""),[h,f]=i.useState(""),[u,b]=i.useState(""),[p,y]=i.useState(""),[w,S]=i.useState(""),[N,E]=i.useState(""),[v,A]=i.useState(""),[T,C]=i.useState(1),k=20;async function D(){try{a("loading"),l(null);const[I,G,O]=await Promise.all([Te.listIncome({page:T,size:k,status:u||void 0,divisionId:p||void 0,categoryId:w||void 0,clientId:N||void 0,from:x||void 0,to:h||void 0,search:v||void 0}),Te.listCategories(),Te.listClients({page:1,size:200,active:!0})]);o(I),c(Array.isArray(G==null?void 0:G.items)?G.items:Array.isArray(G)?G:[]),g(Array.isArray(O==null?void 0:O.items)?O.items:[]),a("ready")}catch(I){l(I),a("error")}}i.useEffect(()=>{D()},[T,x,h,u,p,w,N,v]);const R=i.useMemo(()=>Array.isArray(r==null?void 0:r.items)?r.items:[],[r]),L=i.useMemo(()=>Number((r==null?void 0:r.total)||0),[r]),_=i.useMemo(()=>Math.max(1,Math.ceil(L/k)),[L]);return s==="loading"?e.jsx(de,{message:"Loading revenue"}):s==="error"?(n==null?void 0:n.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_READ"}}):e.jsx(le,{error:n,onRetry:D}):e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Revenue"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Track income drafts, approvals, and payments."})]}),e.jsx($e,{to:"/finance/revenue/create",className:"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow hover:from-blue-700 hover:to-indigo-800 transition",children:"Create Income"})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"From"}),e.jsx("input",{value:x,onChange:I=>{j(I.target.value),C(1)},type:"date",className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"To"}),e.jsx("input",{value:h,onChange:I=>{f(I.target.value),C(1)},type:"date",className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Status"}),e.jsxs("select",{value:u,onChange:I=>{b(I.target.value),C(1)},className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"SUBMITTED",children:"Submitted"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"}),e.jsx("option",{value:"PARTIALLY_PAID",children:"Partially Paid"}),e.jsx("option",{value:"PAID",children:"Paid"})]})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Division"}),e.jsx("input",{value:p,onChange:I=>{y(I.target.value),C(1)},placeholder:"Division UUID",className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Category"}),e.jsxs("select",{value:w,onChange:I=>{S(I.target.value),C(1)},className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All"}),d.map(I=>e.jsxs("option",{value:I.id,children:[I.code," - ",I.name]},I.id))]})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Client"}),e.jsxs("select",{value:N,onChange:I=>{E(I.target.value),C(1)},className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All"}),m.map(I=>e.jsxs("option",{value:I.id,children:[I.code," - ",I.name]},I.id))]})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Search"}),e.jsx("input",{value:v,onChange:I=>{A(I.target.value),C(1)},placeholder:"Title / Invoice",className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),R.length===0?e.jsx("div",{className:"mt-6",children:e.jsx(ye,{title:"No income found",description:"Try adjusting filters or create a new income entry.",action:e.jsx("button",{onClick:()=>t("/finance/revenue/create"),children:"Create Income"})})}):e.jsx("div",{className:"mt-6 overflow-hidden rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Division"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Client"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Title"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Paid / Due"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:R.map(I=>{const G=Number(I.amount||0),F=String(I.status||"").toUpperCase()==="PAID"?G:0,W=Math.max(0,G-F);return e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:String(I.incomeDate||"").slice(0,10)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:I.divisionId}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:I.categoryName||I.categoryId}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:I.clientName||I.clientId||""}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-900",children:I.title}),e.jsxs("td",{className:"px-4 py-3 text-sm text-right",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:qu(F)}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Due: ",qu(W)]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(oj,{status:I.status})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx($e,{to:`/finance/revenue/${I.id}`,className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-semibold text-blue-700 hover:text-blue-800 hover:bg-blue-50 transition",children:"View"})})]},I.id)})})]})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"text-slate-600",children:["Showing ",e.jsx("span",{className:"font-semibold",children:R.length})," of ",e.jsx("span",{className:"font-semibold",children:L})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition disabled:opacity-50",disabled:T<=1,onClick:()=>C(I=>Math.max(1,I-1)),children:"Prev"}),e.jsx("div",{className:"px-3 py-2 rounded-xl bg-slate-50 border border-slate-200 text-slate-700",children:T}),e.jsx("button",{className:"px-3 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition disabled:opacity-50",disabled:T>=_,onClick:()=>C(I=>Math.min(_,I+1)),children:"Next"})]})]})]})})}function cj(){const t=Ue(),[s,a]=i.useState("loading"),[n,l]=i.useState(null),[r,o]=i.useState([]),[d,c]=i.useState(""),[m,g]=i.useState(!1),[x,j]=i.useState([]),[h,f]=i.useState([]),[u,b]=i.useState({incomeDate:"",divisionId:"",categoryId:"",title:"",description:"",amount:"",clientId:"",invoiceNumber:"",externalReference:""}),[p,y]=i.useState(null),[w,S]=i.useState(!1),[N,E]=i.useState(null),v=i.useMemo(()=>!!(u.incomeDate&&u.divisionId&&u.categoryId&&String(u.title||"").trim()&&String(u.amount||"").trim()),[u]);function A(k,D){b(R=>({...R,[k]:D}))}async function T(){try{a("loading"),l(null);const[k,D]=await Promise.all([Te.listCategories(),Te.listClients({page:1,size:200,active:!0})]);j(Array.isArray(k==null?void 0:k.items)?k.items:Array.isArray(k)?k:[]),f(Array.isArray(D==null?void 0:D.items)?D.items:[]),a("ready")}catch(k){l(k),a("error")}}if(i.useEffect(()=>{T()},[]),i.useEffect(()=>{let k=!1;async function D(){try{g(!0);const R=xs(),L=await fetch(`${Us()}/api/v1/governance/divisions?page=1&pageSize=200`,{method:"GET",headers:{...R?{authorization:`Bearer ${R}`}:{}}});if(!L.ok){console.error("Failed to load divisions",L.status);return}if(!(L.headers.get("content-type")||"").includes("application/json")){console.error("Failed to load divisions (non-JSON response)");return}const I=await L.json(),G=Array.isArray(I==null?void 0:I.items)?I.items:Array.isArray(I)?I:[];k||o(G)}catch(R){console.error("Failed to load divisions",R)}finally{k||g(!1)}}return D(),()=>{k=!0}},[]),s==="loading")return e.jsx(de,{message:"Loading"});if(s==="error")return(n==null?void 0:n.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_CREATE"}}):e.jsx(le,{error:n,onRetry:T});async function C({submit:k}){try{if(S(!0),E(null),!v)throw new Error("Please fill required fields");const D=await Te.createIncome({incomeDate:u.incomeDate,divisionId:u.divisionId,categoryId:u.categoryId,clientId:u.clientId||null,invoiceNumber:u.invoiceNumber||null,title:u.title,description:u.description||null,amount:Number(u.amount),currency:"INR"}),R=(D==null?void 0:D.item)||D,L=R==null?void 0:R.id;if(!L)throw new Error("Income creation failed");if(p){const _=await Fh(p);await Te.uploadDocument(L,{fileName:p.name,contentType:p.type,fileBase64:_})}k&&await Te.submitIncome(L),t(`/finance/revenue/${L}`)}catch(D){E(D)}finally{S(!1)}}return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Create Income"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create a draft income entry and submit for approval."})]}),e.jsx($e,{to:"/finance/revenue",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Income Date"}),e.jsx("input",{type:"date",value:u.incomeDate,onChange:k=>A("incomeDate",k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Division"}),e.jsxs("select",{required:!0,value:d,onChange:k=>{c(k.target.value),A("divisionId",k.target.value)},className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Division"}),m?e.jsx("option",{value:"",children:"Loading divisions..."}):null,r.map(k=>e.jsx("option",{value:k.id,children:k.name},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Category"}),e.jsxs("select",{value:u.categoryId,onChange:k=>A("categoryId",k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select"}),x.map(k=>e.jsxs("option",{value:k.id,children:[k.code," - ",k.name]},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Title"}),e.jsx("input",{value:u.title,onChange:k=>A("title",k.target.value),placeholder:"e.g., Monthly Retainer",className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Description"}),e.jsx("textarea",{value:u.description,onChange:k=>A("description",k.target.value),rows:4,placeholder:"Optional notes",className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Amount"}),e.jsx("input",{value:u.amount,onChange:k=>A("amount",k.target.value),placeholder:"0.00",className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Client"}),e.jsxs("select",{value:u.clientId,onChange:k=>A("clientId",k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select"}),h.map(k=>e.jsxs("option",{value:k.id,children:[k.code," - ",k.name]},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Invoice Number"}),e.jsx("input",{value:u.invoiceNumber,onChange:k=>A("invoiceNumber",k.target.value),placeholder:"INV-001",className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"External Reference"}),e.jsx("input",{value:u.externalReference,onChange:k=>A("externalReference",k.target.value),placeholder:"Optional",className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Documents"}),e.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:"Upload invoice/supporting docs."})]}),e.jsx("input",{type:"file",onChange:k=>{var D;return y(((D=k.target.files)==null?void 0:D[0])||null)},className:"block text-sm text-slate-700"})]}),e.jsx("div",{className:"mt-3 text-sm text-slate-600",children:p?p.name:"No documents added."})]})]})]}),N?e.jsx("div",{className:"mt-4 text-sm text-rose-700",children:String(N.message||N)}):null,e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 justify-end",children:[e.jsx("button",{disabled:w,onClick:()=>C({submit:!1}),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition disabled:opacity-50",children:"Save Draft"}),e.jsx("button",{disabled:w,onClick:()=>C({submit:!0}),className:"px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow hover:from-blue-700 hover:to-indigo-800 transition disabled:opacity-50",children:"Submit"})]})]})})}function mj({status:t}){const s=String(t||"").toUpperCase(),a=s==="PAID"?"bg-emerald-50 text-emerald-700 border-emerald-200":s==="APPROVED"?"bg-blue-50 text-blue-700 border-blue-200":s==="SUBMITTED"?"bg-amber-50 text-amber-700 border-amber-200":s==="REJECTED"?"bg-rose-50 text-rose-700 border-rose-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${a}`,children:s})}function uo(t){return t?String(t).replace("T"," ").replace("Z","").slice(0,16):""}function uj(){const{id:t}=Dt(),s=Ue(),[a,n]=i.useState("overview"),[l,r]=i.useState("loading"),[o,d]=i.useState(null),[c,m]=i.useState(null),[g,x]=i.useState(0),[j,h]=i.useState(0),[f,u]=i.useState([]),[b,p]=i.useState([]),[y,w]=i.useState("idle"),[S,N]=i.useState(null),[E,v]=i.useState(!1),[A,T]=i.useState(""),[C,k]=i.useState(null);async function D(){try{r("loading"),d(null);const[$,M,P]=await Promise.all([Te.getIncome(t),Te.listDocuments(t),Te.listPayments(t)]);m(($==null?void 0:$.item)||null),x(Number(($==null?void 0:$.totalPaid)||0)),h(Number(($==null?void 0:$.remainingAmount)||0)),u(Array.isArray(M==null?void 0:M.items)?M.items:Array.isArray(M)?M:[]),p(Array.isArray(P==null?void 0:P.items)?P.items:Array.isArray(P)?P:[]),r("ready")}catch($){d($),r("error")}}if(i.useEffect(()=>{t&&D()},[t]),l==="loading")return e.jsx(de,{message:"Loading income"});if(l==="error")return(o==null?void 0:o.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_READ"}}):e.jsx(le,{error:o,onRetry:D});if(!c)return e.jsx(ye,{title:"Not found",description:"Income could not be loaded."});const R=String(c.status||"").toUpperCase()==="DRAFT",L=String(c.status||"").toUpperCase()==="SUBMITTED",_=String(c.status||"").toUpperCase()==="SUBMITTED",I=["APPROVED","PARTIALLY_PAID","PAID"].includes(String(c.status||"").toUpperCase());async function G(){try{w("loading"),N(null),await Te.submitIncome(t),w("idle"),await D()}catch($){N($),w("idle")}}async function O(){try{w("loading"),N(null),await Te.approveIncome(t),w("idle"),await D()}catch($){N($),w("idle")}}async function F(){try{w("loading"),N(null),await Te.rejectIncome(t,A),w("idle"),v(!1),T(""),await D()}catch($){N($),w("idle")}}async function W(){if(C)try{w("loading"),N(null);const $=await Fh(C);await Te.uploadDocument(t,{fileName:C.name,contentType:C.type,fileBase64:$}),k(null),w("idle"),await D()}catch($){N($),w("idle")}}return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Income Detail"}),e.jsx(mj,{status:c.status})]}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:["ID: ",c.id]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx($e,{to:"/finance/revenue",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"})})]}),S?e.jsx("div",{className:"mt-4 text-sm text-rose-700",children:String(S.message||S)}):null,e.jsxs("div",{className:"mt-5 flex flex-wrap gap-2",children:[e.jsx("button",{disabled:!R||y==="loading",onClick:G,className:"px-3 py-2 rounded-xl bg-slate-900 text-white font-semibold hover:bg-slate-800 transition disabled:opacity-50",children:"Submit"}),e.jsx("button",{disabled:!L||y==="loading",onClick:O,className:"px-3 py-2 rounded-xl bg-emerald-600 text-white font-semibold hover:bg-emerald-700 transition disabled:opacity-50",children:"Approve"}),e.jsx("button",{disabled:!_||y==="loading",onClick:()=>v(!0),className:"px-3 py-2 rounded-xl bg-rose-600 text-white font-semibold hover:bg-rose-700 transition disabled:opacity-50",children:"Reject"}),e.jsx("button",{disabled:!I,onClick:()=>s(`/finance/revenue/${t}/payments`),className:"px-3 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition font-semibold disabled:opacity-50",children:"Mark Paid"})]}),e.jsx("div",{className:"mt-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>n("overview"),className:`px-4 py-2 text-sm font-semibold rounded-t-xl ${a==="overview"?"bg-slate-50 border border-slate-200 border-b-white":"text-slate-600 hover:text-slate-800"}`,children:"Overview"}),e.jsx("button",{onClick:()=>n("documents"),className:`px-4 py-2 text-sm font-semibold rounded-t-xl ${a==="documents"?"bg-slate-50 border border-slate-200 border-b-white":"text-slate-600 hover:text-slate-800"}`,children:"Documents"}),e.jsx("button",{onClick:()=>n("payments"),className:`px-4 py-2 text-sm font-semibold rounded-t-xl ${a==="payments"?"bg-slate-50 border border-slate-200 border-b-white":"text-slate-600 hover:text-slate-800"}`,children:"Payments"}),e.jsx("button",{onClick:()=>n("timeline"),className:`px-4 py-2 text-sm font-semibold rounded-t-xl ${a==="timeline"?"bg-slate-50 border border-slate-200 border-b-white":"text-slate-600 hover:text-slate-800"}`,children:"Approval Timeline"})]})}),a==="overview"&&e.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Details"}),e.jsxs("dl",{className:"mt-3 grid grid-cols-2 gap-x-4 gap-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Income Date"}),e.jsx("dd",{className:"font-semibold text-slate-900",children:String(c.incomeDate||"").slice(0,10)})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Division"}),e.jsx("dd",{className:"font-semibold text-slate-900",children:c.divisionId})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Category"}),e.jsx("dd",{className:"font-semibold text-slate-900",children:c.categoryName||c.categoryId})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Client"}),e.jsx("dd",{className:"font-semibold text-slate-900",children:c.clientName||c.clientId||""})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Invoice"}),e.jsx("dd",{className:"font-semibold text-slate-900",children:c.invoiceNumber||""})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Amount"}),e.jsxs("dd",{className:"font-semibold text-slate-900",children:["",Number(c.amount||0).toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Total Paid"}),e.jsxs("dd",{className:"font-semibold text-slate-900",children:["",Number(g||0).toLocaleString("en-IN")]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Outstanding"}),e.jsxs("dd",{className:"font-semibold text-slate-900",children:["",Number(j||0).toLocaleString("en-IN")]})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Description"}),e.jsx("div",{className:"mt-3 text-sm text-slate-700 whitespace-pre-wrap",children:c.description||""})]})]}),a==="documents"&&e.jsxs("div",{className:"mt-6 rounded-xl border border-slate-200 p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Documents"}),e.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:"Upload and download supporting files."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",onChange:$=>{var M;return k(((M=$.target.files)==null?void 0:M[0])||null)},className:"block text-sm text-slate-700"}),e.jsx("button",{disabled:!C||y==="loading",onClick:W,className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 transition disabled:opacity-50",children:"Upload"})]})]}),f.length===0?e.jsx("div",{className:"mt-4 text-sm text-slate-600",children:"No documents uploaded."}):e.jsx("div",{className:"mt-4 overflow-hidden rounded-xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"File"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:f.map($=>e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:$.fileName}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:$.contentType}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>ij({incomeId:t,docId:$.id,fileName:$.fileName}),className:"px-3 py-1.5 rounded-lg text-sm font-semibold text-blue-700 hover:bg-blue-50",children:"Download"})})]},$.id))})]})})]}),a==="payments"&&e.jsxs("div",{className:"mt-6 rounded-xl border border-slate-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Payments"}),e.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:"View payment history"})]}),e.jsx($e,{to:`/finance/revenue/${t}/payments`,className:"px-3 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition font-semibold",children:"Open"})]}),b.length===0?e.jsx("div",{className:"mt-4 text-sm text-slate-600",children:"No payments found."}):e.jsxs("div",{className:"mt-4 text-sm text-slate-600",children:["Payments recorded: ",b.length]})]}),a==="timeline"&&e.jsxs("div",{className:"mt-6 rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Approval Timeline"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"p-3 rounded-xl bg-slate-50 border border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Submitted"}),e.jsx("div",{className:"text-xs text-slate-500",children:uo(c.submittedAt)})]}),c.approvedAt?e.jsxs("div",{className:"p-3 rounded-xl bg-slate-50 border border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approved"}),e.jsx("div",{className:"text-xs text-slate-500",children:uo(c.approvedAt)})]}):null,c.rejectedAt?e.jsxs("div",{className:"p-3 rounded-xl bg-slate-50 border border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Rejected"}),e.jsx("div",{className:"text-xs text-slate-500",children:uo(c.rejectedAt)})]}):null,!c.approvedAt&&!c.rejectedAt?e.jsx("div",{className:"p-3 rounded-xl bg-white border border-dashed border-slate-300 text-slate-500 text-sm",children:"Awaiting approval"}):null]})]}),E&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>v(!1)}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white rounded-2xl shadow-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Reject Income"}),e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:"Provide a reason."})]}),e.jsx("button",{onClick:()=>v(!1),className:"p-2 rounded-xl hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Reason"}),e.jsx("textarea",{value:A,onChange:$=>T($.target.value),rows:4,className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"Reason for rejection"})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{disabled:y==="loading",onClick:F,className:"px-4 py-2 rounded-xl bg-rose-600 text-white font-semibold shadow hover:bg-rose-700 disabled:opacity-50",children:"Reject"})]})]})]})]})})}function xj(t){return Number(t||0).toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2})}function hj(){const{id:t}=Dt(),[s,a]=i.useState(!1),[n,l]=i.useState("loading"),[r,o]=i.useState(null),[d,c]=i.useState([]),[m,g]=i.useState("idle"),[x,j]=i.useState(null),[h,f]=i.useState(""),[u,b]=i.useState(""),[p,y]=i.useState("BANK_TRANSFER"),[w,S]=i.useState("");async function N(){try{l("loading"),o(null);const v=await Te.listPayments(t);c(Array.isArray(v==null?void 0:v.items)?v.items:Array.isArray(v)?v:[]),l("ready")}catch(v){o(v),l("error")}}if(i.useEffect(()=>{t&&N()},[t]),n==="loading")return e.jsx(de,{message:"Loading payments"});if(n==="error")return(r==null?void 0:r.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_READ"}}):e.jsx(le,{error:r,onRetry:N});async function E(){try{g("loading"),j(null),await Te.markPaid(t,{paidAmount:Number(h),paidAt:u?new Date(u).toISOString():new Date().toISOString(),method:p,referenceId:w||null}),g("idle"),a(!1),f(""),b(""),y("BANK_TRANSFER"),S(""),await N()}catch(v){j(v),g("idle")}}return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Payments"}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:["Income ID: ",t]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{to:`/finance/revenue/${t}`,className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"}),e.jsx("button",{onClick:()=>a(!0),className:"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow hover:from-blue-700 hover:to-indigo-800 transition",children:"Add Payment"})]})]}),x?e.jsx("div",{className:"mt-4 text-sm text-rose-700",children:String(x.message||x)}):null,d.length===0?e.jsx("div",{className:"mt-6",children:e.jsx(ye,{title:"No payments",description:"No payments recorded yet."})}):e.jsx("div",{className:"mt-6 overflow-hidden rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Paid At"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Method"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Reference"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:d.map(v=>e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:String(v.paidAt||v.paid_at||"").replace("T"," ").slice(0,16)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:v.method}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:v.referenceId||""}),e.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold text-slate-900",children:xj(v.paidAmount)})]},v.id))})]})}),s&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>a(!1)}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white rounded-2xl shadow-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Add Payment"}),e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:"UI only"})]}),e.jsx("button",{onClick:()=>a(!1),className:"p-2 rounded-xl hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Paid Amount"}),e.jsx("input",{value:h,onChange:v=>f(v.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Paid At"}),e.jsx("input",{value:u,onChange:v=>b(v.target.value),type:"datetime-local",className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Method"}),e.jsxs("select",{value:p,onChange:v=>y(v.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm bg-white",children:[e.jsx("option",{value:"BANK_TRANSFER",children:"BANK_TRANSFER"}),e.jsx("option",{value:"UPI",children:"UPI"}),e.jsx("option",{value:"CASH",children:"CASH"}),e.jsx("option",{value:"CARD",children:"CARD"}),e.jsx("option",{value:"OTHER",children:"OTHER"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Reference ID"}),e.jsx("input",{value:w,onChange:v=>S(v.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"UTR/Ref"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{disabled:m==="loading",onClick:E,className:"px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow disabled:opacity-50",children:"Save"})]})]})]})]})})}function pj({status:t}){const s=String(t||"").toUpperCase(),a=s==="SUBMITTED"?"bg-amber-50 text-amber-700 border-amber-200":s==="REJECTED"?"bg-rose-50 text-rose-700 border-rose-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${a}`,children:s})}function fj(){const[t,s]=i.useState(!1),[a,n]=i.useState(""),[l,r]=i.useState(null),[o,d]=i.useState("loading"),[c,m]=i.useState(null),[g,x]=i.useState(null),[j,h]=i.useState("idle"),[f,u]=i.useState(null);async function b(){try{d("loading"),m(null);const S=await Te.listIncome({page:1,size:50,status:"SUBMITTED"});x(S),d("ready")}catch(S){m(S),d("error")}}i.useEffect(()=>{b()},[]);const p=i.useMemo(()=>Array.isArray(g==null?void 0:g.items)?g.items:[],[g]);if(o==="loading")return e.jsx(de,{message:"Loading approvals"});if(o==="error")return(c==null?void 0:c.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_APPROVE"}}):e.jsx(le,{error:c,onRetry:b});async function y(S){try{h("loading"),u(null),await Te.approveIncome(S),h("idle"),await b()}catch(N){u(N),h("idle")}}async function w(){if(l)try{h("loading"),u(null),await Te.rejectIncome(l,a),h("idle"),s(!1),n(""),r(null),await b()}catch(S){u(S),h("idle")}}return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Revenue Approvals"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Review submitted incomes."})]}),e.jsx($e,{to:"/finance/revenue",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"})]}),f?e.jsx("div",{className:"mt-4 text-sm text-rose-700",children:String(f.message||f)}):null,p.length===0?e.jsx("div",{className:"mt-6",children:e.jsx(ye,{title:"No approvals",description:"No submitted income entries found."})}):e.jsx("div",{className:"mt-6 overflow-hidden rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Client"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Title"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:p.map(S=>e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:String(S.incomeDate||"").slice(0,10)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:S.clientName||S.clientId||""}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-900",children:S.title}),e.jsxs("td",{className:"px-4 py-3 text-sm text-right font-semibold text-slate-900",children:["",Number(S.amount||0).toLocaleString("en-IN")]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(pj,{status:S.status})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx("button",{disabled:j==="loading",onClick:()=>y(S.id),className:"px-3 py-1.5 rounded-lg bg-emerald-600 text-white text-sm font-semibold hover:bg-emerald-700 transition disabled:opacity-50",children:"Approve"}),e.jsx("button",{disabled:j==="loading",onClick:()=>{r(S.id),s(!0)},className:"px-3 py-1.5 rounded-lg bg-rose-600 text-white text-sm font-semibold hover:bg-rose-700 transition disabled:opacity-50",children:"Reject"})]})})]},S.id))})]})}),t&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>s(!1)}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white rounded-2xl shadow-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Reject Income"}),e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:"Provide a reason (UI only)."})]}),e.jsx("button",{onClick:()=>s(!1),className:"p-2 rounded-xl hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Reason"}),e.jsx("textarea",{value:a,onChange:S=>n(S.target.value),rows:4,className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"Reason for rejection"})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{disabled:j==="loading",onClick:w,className:"px-4 py-2 rounded-xl bg-rose-600 text-white font-semibold shadow hover:bg-rose-700 disabled:opacity-50",children:"Reject"})]})]})]})]})})}function ur({label:t,value:s,sub:a}){return e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:t}),e.jsx("div",{className:"mt-2 text-2xl font-bold text-slate-900",children:s}),a&&e.jsx("div",{className:"mt-1 text-sm text-slate-500",children:a})]})}function gj(){const[t,s]=i.useState("loading"),[a,n]=i.useState(null),[l,r]=i.useState([]);async function o(){try{s("loading"),n(null);const m=await Te.listIncome({page:1,size:200,status:""});r(Array.isArray(m==null?void 0:m.items)?m.items:[]),s("ready")}catch(m){n(m),s("error")}}i.useEffect(()=>{o()},[]);const d=i.useMemo(()=>{const m=l.reduce((u,b)=>u+Number(b.amount||0),0),g=l.filter(u=>String(u.status||"").toUpperCase()==="PAID").reduce((u,b)=>u+Number(b.amount||0),0),x=Math.max(0,m-g),j=new Date,h=`${j.getFullYear()}-${String(j.getMonth()+1).padStart(2,"0")}`,f=l.filter(u=>String(u.incomeDate||"").slice(0,7)===h).reduce((u,b)=>u+Number(b.amount||0),0);return{totalRevenue:m,paid:g,outstanding:x,thisMonthRevenue:f}},[l]);function c(m){return Number(m||0).toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2})}return t==="loading"?e.jsx(de,{message:"Loading reports"}):t==="error"?(a==null?void 0:a.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_READ"}}):e.jsx(le,{error:a,onRetry:o}):e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Revenue Reports"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Summary and trends (UI only)."})]}),e.jsx($e,{to:"/finance/revenue",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ur,{label:"Total Revenue",value:c(d.totalRevenue),sub:"All time"}),e.jsx(ur,{label:"Paid",value:c(d.paid),sub:"PAID status totals"}),e.jsx(ur,{label:"Outstanding",value:c(d.outstanding),sub:"Derived"}),e.jsx(ur,{label:"This Month",value:c(d.thisMonthRevenue),sub:"Current month"})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-6",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Revenue Trend"}),e.jsx("div",{className:"mt-4 h-56 rounded-xl bg-white border border-dashed border-slate-300"})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-6",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Paid vs Outstanding"}),e.jsx("div",{className:"mt-4 h-56 rounded-xl bg-white border border-dashed border-slate-300"})]})]})]})})}function vj(){const[t,s]=i.useState(!1),[a,n]=i.useState("loading"),[l,r]=i.useState(null),[o,d]=i.useState([]),[c,m]=i.useState(null),[g,x]=i.useState(""),[j,h]=i.useState(""),[f,u]=i.useState(""),[b,p]=i.useState("idle"),[y,w]=i.useState(null);async function S(){try{n("loading"),r(null);const T=await Te.listCategories(),C=Array.isArray(T==null?void 0:T.items)?T.items:Array.isArray(T)?T:[];d(C),n("ready")}catch(T){r(T),n("error")}}i.useEffect(()=>{S()},[]);const N=!!(c!=null&&c.id);if(a==="loading")return e.jsx(de,{message:"Loading categories"});if(a==="error")return(l==null?void 0:l.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_CATEGORY_READ"}}):e.jsx(le,{error:l,onRetry:S});async function E(){try{if(p("loading"),w(null),!String(g||"").trim())throw new Error("Code is required");if(!String(j||"").trim())throw new Error("Name is required");N?await Te.updateCategory(c.id,{code:g,name:j,description:f,isActive:!!c.isActive,version:c.version}):await Te.createCategory({code:g,name:j,description:f}),p("idle"),s(!1),m(null),x(""),h(""),u(""),await S()}catch(T){w(T),p("idle")}}function v(){m(null),x(""),h(""),u(""),w(null),s(!0)}function A(T){m(T),x(T.code||""),h(T.name||""),u(T.description||""),w(null),s(!0)}return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Revenue Categories"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Manage income categories (UI only)."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{to:"/finance/revenue",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"}),e.jsx("button",{onClick:v,className:"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow hover:from-blue-700 hover:to-indigo-800 transition",children:"Add Category"})]})]}),o.length===0?e.jsx("div",{className:"mt-6",children:e.jsx(ye,{title:"No categories",description:"Create your first income category."})}):e.jsx("div",{className:"mt-6 overflow-hidden rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:o.map(T=>e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-slate-900",children:T.code}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:T.name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${T.isActive?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-50 text-slate-700 border-slate-200"}`,children:T.isActive?"ACTIVE":"INACTIVE"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>A(T),className:"px-3 py-1.5 rounded-lg text-sm font-semibold text-blue-700 hover:bg-blue-50",children:"Edit"})})]},T.id))})]})}),t&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>s(!1)}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white rounded-2xl shadow-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Category"}),e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:N?"Edit":"Add"})]}),e.jsx("button",{onClick:()=>s(!1),className:"p-2 rounded-xl hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Code"}),e.jsx("input",{value:g,onChange:T=>x(T.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"CONSULTING"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("input",{value:j,onChange:T=>h(T.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"Consulting"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Description"}),e.jsx("textarea",{value:f,onChange:T=>u(T.target.value),rows:3,className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"Optional"})]})]}),y?e.jsx("div",{className:"mt-4 text-sm text-rose-700",children:String(y.message||y)}):null,e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{disabled:b==="loading",onClick:E,className:"px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow disabled:opacity-50",children:"Save"})]})]})]})]})})}function bj(){const[t,s]=i.useState(!1),[a,n]=i.useState("loading"),[l,r]=i.useState(null),[o,d]=i.useState([]),[c,m]=i.useState(null),[g,x]=i.useState(""),[j,h]=i.useState(""),[f,u]=i.useState(""),[b,p]=i.useState(""),[y,w]=i.useState("idle"),[S,N]=i.useState(null);async function E(){try{n("loading"),r(null);const k=await Te.listClients({page:1,size:200}),D=Array.isArray(k==null?void 0:k.items)?k.items:[];d(D),n("ready")}catch(k){r(k),n("error")}}i.useEffect(()=>{E()},[]);const v=!!(c!=null&&c.id);if(a==="loading")return e.jsx(de,{message:"Loading clients"});if(a==="error")return(l==null?void 0:l.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_CLIENT_READ"}}):e.jsx(le,{error:l,onRetry:E});function A(){m(null),x(""),h(""),u(""),p(""),N(null),s(!0)}function T(k){m(k),x(k.code||""),h(k.name||""),u(k.email||""),p(k.phone||""),N(null),s(!0)}async function C(){try{if(w("loading"),N(null),!String(g||"").trim())throw new Error("Code is required");if(!String(j||"").trim())throw new Error("Name is required");v?await Te.updateClient(c.id,{code:g,name:j,email:f,phone:b,isActive:!!c.isActive,version:c.version}):await Te.createClient({code:g,name:j,email:f,phone:b}),w("idle"),s(!1),await E()}catch(k){N(k),w("idle")}}return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Revenue Clients"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Manage clients (UI only)."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{to:"/finance/revenue",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"}),e.jsx("button",{onClick:A,className:"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow hover:from-blue-700 hover:to-indigo-800 transition",children:"Add Client"})]})]}),o.length===0?e.jsx("div",{className:"mt-6",children:e.jsx(ye,{title:"No clients",description:"Create your first client."})}):e.jsx("div",{className:"mt-6 overflow-hidden rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:o.map(k=>e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-slate-900",children:k.code}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:k.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:k.email}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${k.isActive?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-50 text-slate-700 border-slate-200"}`,children:k.isActive?"ACTIVE":"INACTIVE"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>T(k),className:"px-3 py-1.5 rounded-lg text-sm font-semibold text-blue-700 hover:bg-blue-50",children:"Edit"})})]},k.id))})]})}),t&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>s(!1)}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white rounded-2xl shadow-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Client"}),e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:"Add/Edit (UI only)."})]}),e.jsx("button",{onClick:()=>s(!1),className:"p-2 rounded-xl hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Code"}),e.jsx("input",{value:g,onChange:k=>x(k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"ACME"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("input",{value:j,onChange:k=>h(k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"Acme Corp"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Email"}),e.jsx("input",{value:f,onChange:k=>u(k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"billing@acme.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Phone"}),e.jsx("input",{value:b,onChange:k=>p(k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"9999999999"})]})]}),S?e.jsx("div",{className:"mt-4 text-sm text-rose-700",children:String(S.message||S)}):null,e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{disabled:y==="loading",onClick:C,className:"px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow disabled:opacity-50",children:"Save"})]})]})]})]})})}function ni(t){if(!t)return"";const s=String(t);if(/^\d{4}-\d{2}-\d{2}/.test(s))return s.slice(0,10);const a=new Date(t);return Number.isNaN(a.getTime())?"":a.toISOString().slice(0,10)}function Ga({from:t,to:s,divisionId:a,categoryId:n,groupBy:l,includePayroll:r}={}){const o=new URLSearchParams;return t&&o.set("from",ni(t)),s&&o.set("to",ni(s)),a&&o.set("divisionId",String(a)),n&&o.set("categoryId",String(n)),l&&o.set("groupBy",String(l)),typeof r=="boolean"&&o.set("includePayroll",r?"true":"false"),o}async function jj(t){const s=xs(),a=await fetch(`${Us()}${t}`,{method:"GET",headers:{...s?{authorization:`Bearer ${s}`}:{}}});if(!a.ok){const r=await a.text().catch(()=>""),o=new Error(r||`Download failed (${a.status})`);throw o.status=a.status,o}const n=await a.blob(),l=a.headers.get("content-type")||"application/octet-stream";return{blob:n,contentType:l}}function Nj({blob:t,fileName:s}){const a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=s||"report.csv",document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(a)}const Ns={revenue(t){const s=Ga(t);return z(`/api/v1/reports/revenue?${s.toString()}`)},expense(t){const s=Ga(t);return z(`/api/v1/reports/expense?${s.toString()}`)},pnl(t){const s=Ga(t);return z(`/api/v1/reports/pnl?${s.toString()}`)},receivables(t){const s=Ga(t);return z(`/api/v1/reports/receivables?${s.toString()}`)},payables(t){const s=Ga(t);return z(`/api/v1/reports/payables?${s.toString()}`)},cashflow(t){const s=Ga(t);return z(`/api/v1/reports/cashflow?${s.toString()}`)},exportCsv({reportType:t,filter:s}){return z("/api/v1/reports/exports/csv",{method:"POST",body:{reportType:t,filter:{...s,from:ni(s==null?void 0:s.from),to:ni(s==null?void 0:s.to)}}})},async downloadExport({downloadUrl:t,fileName:s}){const{blob:a}=await jj(t);Nj({blob:a,fileName:s})}};function xr(t){const s=Number(t||0);return Number.isFinite(s)?s.toLocaleString(void 0,{maximumFractionDigits:2}):"0"}function yj(t){const s=Array.isArray(t)?t:[];return s.includes("SUPER_ADMIN")||s.includes("FINANCE_ADMIN")||s.includes("FINANCE_HEAD")}function wj(){var h;const{bootstrap:t}=he(),s=((h=t==null?void 0:t.rbac)==null?void 0:h.roles)||[],[a,n]=i.useState("loading"),[l,r]=i.useState(null),[o,d]=i.useState(null),[c,m]=i.useState(()=>{const f=new Date,u=f.getFullYear(),b=String(f.getMonth()+1).padStart(2,"0");return{from:`${u}-${b}-01`,to:`${u}-${b}-28`}});i.useEffect(()=>{let f=!0;async function u(){try{n("loading"),r(null);const b={from:c.from,to:c.to,groupBy:"DIVISION"},[p,y,w,S]=await Promise.all([Ns.revenue(b),Ns.expense(b),Ns.pnl({...b,includePayroll:!0}),Ns.cashflow({from:c.from,to:c.to,includePayroll:!0})]);if(!f)return;d({rev:p,exp:y,pnl:w,cf:S});const N=Array.isArray(p==null?void 0:p.items)&&p.items.length>0||Array.isArray(y==null?void 0:y.items)&&y.items.length>0||Array.isArray(w==null?void 0:w.items)&&w.items.length>0||Array.isArray(S==null?void 0:S.items)&&S.items.length>0;n(N?"ready":"empty")}catch(b){if(!f)return;r(b),n((b==null?void 0:b.status)===403?"forbidden":"empty")}}return u(),()=>{f=!1}},[c.from,c.to]);const g=i.useMemo(()=>{var E,v,A,T;const f=Array.isArray((E=o==null?void 0:o.rev)==null?void 0:E.items)?o.rev.items:[],u=Array.isArray((v=o==null?void 0:o.exp)==null?void 0:v.items)?o.exp.items:[],b=Array.isArray((A=o==null?void 0:o.pnl)==null?void 0:A.items)?o.pnl.items:[],p=Array.isArray((T=o==null?void 0:o.cf)==null?void 0:T.items)?o.cf.items:[],y=f.reduce((C,k)=>C+Number(k.total_amount||0),0),w=u.reduce((C,k)=>C+Number(k.total_amount||0),0),S=b.reduce((C,k)=>C+Number(k.profit||0),0),N=p.reduce((C,k)=>C+Number(k.inflow||0),0);return[{label:"Revenue",value:y},{label:"Expense",value:w},{label:"Net Profit",value:S},{label:"Cash Inflow",value:N}]},[o]),x=i.useMemo(()=>{var u;return(Array.isArray((u=o==null?void 0:o.pnl)==null?void 0:u.items)?o.pnl.items:[]).filter(b=>b.division_name||b.division_id).map(b=>({division:b.division_name||"",revenue:Number(b.revenue||0),expense:Number(b.expense||0),profit:Number(b.profit||0)}))},[o]);if(!yj(s))return e.jsx("div",{className:"p-6",children:e.jsx(ge,{error:{message:"Access denied"}})});if(a==="forbidden")return e.jsx("div",{className:"p-6",children:e.jsx(ge,{error:{message:(l==null?void 0:l.message)||"Access denied"}})});if(a==="loading")return e.jsx("div",{className:"p-6",children:e.jsx(de,{message:"Loading reports dashboard"})});const j=g;return j.length?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Reports"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Financial overview."})]})}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"From"}),e.jsx("input",{type:"date",value:c.from,onChange:f=>m(u=>({...u,from:f.target.value})),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"To"}),e.jsx("input",{type:"date",value:c.to,onChange:f=>m(u=>({...u,to:f.target.value})),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"button",onClick:()=>m(f=>({...f})),className:"w-full px-4 py-2 rounded-xl bg-slate-900 text-white text-sm font-medium hover:bg-slate-800",children:"Apply Filters"})})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:j.map(f=>e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-5",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:f.label}),e.jsx("div",{className:"mt-2 text-2xl font-bold text-slate-900",children:xr(f.value)})]},f.label))}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Division Profitability"}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Overview by division (live)"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Division"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Revenue"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Expense"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Profit"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:x.map(f=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:f.division}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900 font-semibold text-right",children:xr(f.revenue)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900 font-semibold text-right",children:xr(f.expense)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-emerald-700 font-bold text-right",children:xr(f.profit)})]},f.division))})]})})]})]}):e.jsx("div",{className:"p-6",children:e.jsx(ye,{title:"No report data",description:"No dashboard metrics available for the selected range."})})}function Fl(t){const s=Array.isArray(t)?t:[];return s.includes("SUPER_ADMIN")||s.includes("FINANCE_ADMIN")||s.includes("FINANCE_HEAD")}function Sj(t){const s=Array.isArray(t)?t:[];return!!(s.includes("SUPER_ADMIN")||s.includes("FINANCE_ADMIN")||s.includes("FINANCE_HEAD")||s.includes("MANAGER"))}function Mn({title:t,subtitle:s,filter:a,status:n,canAccess:l,emptyTitle:r,emptyDescription:o,children:d}){return l?n==="forbidden"?e.jsx("div",{className:"p-6",children:e.jsx(ge,{error:{message:"Access denied"}})}):n==="loading"?e.jsx("div",{className:"p-6",children:e.jsx(de,{message:`Loading ${t}`})}):n==="empty"?e.jsx("div",{className:"p-6",children:e.jsx(ye,{title:r||`No ${t}`,description:o||"No data available for the selected filters."})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:t}),s?e.jsx("p",{className:"text-slate-600 mt-1",children:s}):null]})}),a?e.jsx("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:a}):null,d]}):e.jsx("div",{className:"p-6",children:e.jsx(ge,{error:{message:"Access denied"}})})}function Rn({range:t,onChange:s}){return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"From"}),e.jsx("input",{type:"date",value:t.from,onChange:a=>s({...t,from:a.target.value}),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"To"}),e.jsx("input",{type:"date",value:t.to,onChange:a=>s({...t,to:a.target.value}),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"button",onClick:()=>s({...t}),className:"w-full px-4 py-2 rounded-xl bg-slate-900 text-white text-sm font-medium hover:bg-slate-800",children:"Apply Filters"})})]})}function Tn({title:t,subtitle:s,columns:a,rows:n,rowKey:l}){const r=Array.isArray(n)?n:[];return e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:t}),s?e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:s}):null]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsx("tr",{children:(a||[]).map(o=>e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-slate-500 uppercase tracking-wider "+(o.align==="right"?"text-right":"text-left"),children:o.label},o.key))})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:r.map((o,d)=>e.jsx("tr",{className:"hover:bg-slate-50",children:(a||[]).map(c=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm "+(c.align==="right"?"text-right text-slate-900 font-semibold":"text-left text-slate-700"),children:c.render?c.render(o):String((o==null?void 0:o[c.key])??"")},c.key))},l?l(o):d))})]})})]})}function st(t){const s=Number(t||0);return Number.isFinite(s)?s.toLocaleString(void 0,{maximumFractionDigits:2}):"0"}function kj(){var j;const{bootstrap:t}=he(),s=((j=t==null?void 0:t.rbac)==null?void 0:j.roles)||[],[a,n]=i.useState(()=>{const h=new Date,f=h.getFullYear(),u=String(h.getMonth()+1).padStart(2,"0");return{from:`${f}-${u}-01`,to:`${f}-${u}-28`}}),[l,r]=i.useState("loading"),[o,d]=i.useState(null),[c,m]=i.useState(null);i.useEffect(()=>{let h=!0;async function f(){try{r("loading"),d(null);const u=await Ns.revenue({from:a.from,to:a.to,groupBy:"DIVISION"});if(!h)return;m(u);const b=Array.isArray(u==null?void 0:u.items)?u.items:[];r(b.length>0?"ready":"empty")}catch(u){if(!h)return;d(u),r((u==null?void 0:u.status)===403?"forbidden":"empty")}}return f(),()=>{h=!1}},[a.from,a.to]);const g=i.useMemo(()=>(Array.isArray(c==null?void 0:c.items)?c.items:[]).map(f=>({division:f.division_name||"",total:Number(f.total_amount||0),received:Number(f.paid_amount||0),due:Number(f.due_amount||0)})),[c]),x=Fl(s);return e.jsx(Mn,{title:"Revenue",subtitle:l==="forbidden"?(o==null?void 0:o.message)||"Access denied":"Revenue summary (live)",status:l,canAccess:x,filter:e.jsx(Rn,{range:a,onChange:n}),children:e.jsx(Tn,{title:"Revenue table",subtitle:"Totals for selected date range",columns:[{key:"division",label:"Division"},{key:"total",label:"Total",align:"right",render:h=>st(h.total)},{key:"received",label:"Received",align:"right",render:h=>st(h.received)},{key:"due",label:"Due",align:"right",render:h=>st(h.due)}],rows:g,rowKey:h=>h.division})})}function Ej(){var j;const{bootstrap:t}=he(),s=((j=t==null?void 0:t.rbac)==null?void 0:j.roles)||[],[a,n]=i.useState(()=>{const h=new Date,f=h.getFullYear(),u=String(h.getMonth()+1).padStart(2,"0");return{from:`${f}-${u}-01`,to:`${f}-${u}-28`}}),[l,r]=i.useState("loading"),[o,d]=i.useState(null),[c,m]=i.useState(null);i.useEffect(()=>{let h=!0;async function f(){try{r("loading"),d(null);const u=await Ns.expense({from:a.from,to:a.to,groupBy:"DIVISION"});if(!h)return;m(u);const b=Array.isArray(u==null?void 0:u.items)?u.items:[];r(b.length>0?"ready":"empty")}catch(u){if(!h)return;d(u),r((u==null?void 0:u.status)===403?"forbidden":"empty")}}return f(),()=>{h=!1}},[a.from,a.to]);const g=i.useMemo(()=>(Array.isArray(c==null?void 0:c.items)?c.items:[]).map(f=>({division:f.division_name||"",total:Number(f.total_amount||0),paid:Number(f.paid_amount||0),payable:Number(f.due_amount||0)})),[c]),x=Fl(s);return e.jsx(Mn,{title:"Expense",subtitle:l==="forbidden"?(o==null?void 0:o.message)||"Access denied":"Expense summary (live)",status:l,canAccess:x,filter:e.jsx(Rn,{range:a,onChange:n}),children:e.jsx(Tn,{title:"Expense table",subtitle:"Totals for selected date range",columns:[{key:"division",label:"Division"},{key:"total",label:"Total",align:"right",render:h=>st(h.total)},{key:"paid",label:"Paid",align:"right",render:h=>st(h.paid)},{key:"payable",label:"Payable",align:"right",render:h=>st(h.payable)}],rows:g,rowKey:h=>h.division})})}function xo(t,s){const n=String(t||"").trim()||String(s||"").slice(0,7);if(!n)return"";const l=new Date(`${n}-01T00:00:00`);return Number.isNaN(l.getTime())?n:new Intl.DateTimeFormat(void 0,{month:"short",year:"numeric"}).format(l)}function Qn(t){return String(t??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;")}function Cj({title:t,subtitle:s,columns:a,rows:n,fileName:l}){const r=window.open("","_blank");if(!r)return;const o=`
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>${Qn(l||t)}</title>
    <style>
      body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; padding: 24px; color: #0f172a; }
      h1 { font-size: 18px; margin: 0 0 4px; }
      .sub { color: #475569; font-size: 12px; margin: 0 0 16px; }
      table { width: 100%; border-collapse: collapse; font-size: 12px; }
      th, td { border: 1px solid #e2e8f0; padding: 8px; }
      th { background: #f8fafc; text-align: left; }
      td.num { text-align: right; }
      .footer { margin-top: 16px; color: #64748b; font-size: 11px; }
      @media print { body { padding: 0; } }
    </style>
  `,d=`<tr>${a.map(m=>`<th>${Qn(m.label)}</th>`).join("")}</tr>`,c=n.map(m=>`<tr>${a.map(g=>{const x=g.renderText?g.renderText(m):m==null?void 0:m[g.key];return`<td class="${g.align==="right"?"num":""}">${Qn(x??"")}</td>`}).join("")}</tr>`).join("");r.document.open(),r.document.write(`<!doctype html><html><head>${o}</head><body>`),r.document.write(`<h1>${Qn(t)}</h1>`),s&&r.document.write(`<p class="sub">${Qn(s)}</p>`),r.document.write(`<table><thead>${d}</thead><tbody>${c}</tbody></table>`),r.document.write('<div class="footer">Tip: In the print dialog choose Save as PDF.</div>'),r.document.write("</body></html>"),r.document.close(),r.focus(),setTimeout(()=>{r.print()},50)}function Uh({hideConsolidated:t=!1,hideExport:s=!1,forceDivisionOnly:a=!1,initialDivisionId:n=null}={}){var C;const{bootstrap:l}=he(),r=((C=l==null?void 0:l.rbac)==null?void 0:C.roles)||[],[o,d]=i.useState(()=>{const k=new Date,D=k.getFullYear(),R=String(k.getMonth()+1).padStart(2,"0");return{from:`${D}-${R}-01`,to:`${D}-${R}-28`}}),[c,m]=i.useState(n||""),[g,x]=i.useState("DIVISION"),[j,h]=i.useState("loading"),[f,u]=i.useState(null),[b,p]=i.useState(null),[y,w]=i.useState([]),[S,N]=i.useState(!1);i.useEffect(()=>{let k=!0;async function D(){try{const R=await z("/api/v1/governance/divisions");if(!k)return;const L=Array.isArray(R==null?void 0:R.items)?R.items:Array.isArray(R)?R:[];w(L),!a&&!c&&L.length>0}catch{if(!k)return;w([])}}return D(),()=>{k=!1}},[c,a]),i.useEffect(()=>{let k=!0;async function D(){try{h("loading"),u(null);const R=g==="CONSOLIDATED"?"CONSOLIDATED":"DIVISION",L=await Ns.pnl({from:o.from,to:o.to,divisionId:R==="CONSOLIDATED"?null:c||null,groupBy:R,includePayroll:!0});if(!k)return;p(L);const _=Array.isArray(L==null?void 0:L.items)?L.items:[];h(_.length>0?"ready":"empty")}catch(R){if(!k)return;u(R),h((R==null?void 0:R.status)===403?"forbidden":"empty")}}return D(),()=>{k=!1}},[o.from,o.to,c,g]);const E=Sj(r),v=i.useMemo(()=>{const D=(Array.isArray(b==null?void 0:b.items)?b.items:[]).map(R=>{const L=Number(R.revenue||0),_=Number(R.expense||0),I=Number(R.payroll||0),G=Number.isFinite(Number(R.profit))?Number(R.profit):L-_-I;return{month:R.month||null,division:R.division_name||R.divisionName||"",revenue:L,expense:_,payroll:I,profit:G}});if(a)return D;if(g==="CONSOLIDATED"&&D.length>1){const R=D.reduce((L,_)=>({revenue:L.revenue+_.revenue,expense:L.expense+_.expense,payroll:L.payroll+_.payroll,profit:L.profit+_.profit}),{revenue:0,expense:0,payroll:0,profit:0});return[{month:o.from.slice(0,7),division:"All",revenue:R.revenue,expense:R.expense,payroll:R.payroll,profit:R.profit}]}return D},[b,a,o.from,g]);async function A(){var k;if(!s)try{N(!0);const D=xo((k=v==null?void 0:v[0])==null?void 0:k.month,o.from);Cj({title:"Profit & Loss",subtitle:`Month: ${D} | From: ${o.from} | To: ${o.to}`,fileName:`pnl_${D.replace(" ","_")}.pdf`,columns:[{key:"month",label:"Month",renderText:R=>xo(R.month,o.from)},{key:"division",label:"Division",renderText:R=>R.division||""},{key:"revenue",label:"Revenue",align:"right",renderText:R=>st(R.revenue)},{key:"expense",label:"Expense",align:"right",renderText:R=>st(R.expense)},{key:"payroll",label:"Payroll",align:"right",renderText:R=>st(R.payroll)},{key:"profit",label:"Profit",align:"right",renderText:R=>{const L=Number.isFinite(Number(R.profit))?Number(R.profit):Number(R.revenue)-Number(R.expense)-Number(R.payroll);return st(L)}}],rows:v})}finally{N(!1)}}const T=e.jsxs("div",{className:"space-y-4",children:[e.jsx(Rn,{range:o,onChange:d}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Division"}),e.jsxs("select",{value:c,onChange:k=>m(k.target.value),disabled:a,className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[a?null:e.jsx("option",{value:"",children:"All divisions"}),y.map(k=>e.jsx("option",{value:k.id,children:k.name||k.code||k.id},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"View"}),e.jsxs("select",{value:g,onChange:k=>x(k.target.value),disabled:t,className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white disabled:bg-slate-50",children:[e.jsx("option",{value:"DIVISION",children:"Division"}),t?null:e.jsx("option",{value:"CONSOLIDATED",children:"Consolidated"})]})]}),e.jsx("div",{className:"flex items-end",children:s?e.jsx("div",{className:"w-full px-4 py-2 rounded-xl bg-slate-100 text-slate-500 text-sm font-medium text-center",children:"Export hidden"}):e.jsx("button",{type:"button",onClick:A,disabled:S,className:"w-full px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium",children:S?"Preparing":"Export PDF"})})]})]});return e.jsx(Mn,{title:"Profit & Loss",subtitle:j==="forbidden"?(f==null?void 0:f.message)||"Access denied":"P&L overview (live)",status:j,canAccess:E,filter:T,children:e.jsx(Tn,{title:"P&L table",subtitle:"Revenue - Expense - Payroll",columns:[{key:"month",label:"Month",render:k=>xo(k.month,o.from)},{key:"division",label:"Division"},{key:"revenue",label:"Revenue",align:"right",render:k=>st(k.revenue)},{key:"expense",label:"Expense",align:"right",render:k=>st(k.expense)},{key:"payroll",label:"Payroll",align:"right",render:k=>st(k.payroll)},{key:"profit",label:"Profit",align:"right",render:k=>{const D=Number.isFinite(Number(k.profit))?Number(k.profit):Number(k.revenue)-Number(k.expense)-Number(k.payroll),R=D>=0?"text-emerald-700 font-bold":"text-rose-700 font-bold";return e.jsx("span",{className:R,children:st(D)})}}],rows:v,rowKey:k=>`${k.month}-${k.division}`})})}function Aj(){var j;const{bootstrap:t}=he(),s=((j=t==null?void 0:t.rbac)==null?void 0:j.roles)||[],[a,n]=i.useState(()=>{const h=new Date,f=h.getFullYear(),u=String(h.getMonth()+1).padStart(2,"0");return{from:`${f}-${u}-01`,to:`${f}-${u}-28`}}),[l,r]=i.useState("loading"),[o,d]=i.useState(null),[c,m]=i.useState(null);i.useEffect(()=>{let h=!0;async function f(){try{r("loading"),d(null);const u=await Ns.receivables({from:a.from,to:a.to,groupBy:"DIVISION"});if(!h)return;m(u);const b=Array.isArray(u==null?void 0:u.items)?u.items:[];r(b.length>0?"ready":"empty")}catch(u){if(!h)return;d(u),r((u==null?void 0:u.status)===403?"forbidden":"empty")}}return f(),()=>{h=!1}},[a.from,a.to]);const g=i.useMemo(()=>(Array.isArray(c==null?void 0:c.items)?c.items:[]).map(f=>({division:f.division_name||"",due:Number(f.due_amount||0),total:Number(f.total_amount||0),received:Number(f.paid_amount||0)})),[c]),x=Fl(s);return e.jsx(Mn,{title:"Receivables",subtitle:l==="forbidden"?(o==null?void 0:o.message)||"Access denied":"Outstanding customer payments (live)",status:l,canAccess:x,filter:e.jsx(Rn,{range:a,onChange:n}),children:e.jsx(Tn,{title:"Receivables table",subtitle:"Due amounts by division",columns:[{key:"division",label:"Division"},{key:"total",label:"Total",align:"right",render:h=>st(h.total)},{key:"received",label:"Received",align:"right",render:h=>st(h.received)},{key:"due",label:"Due",align:"right",render:h=>st(h.due)}],rows:g,rowKey:h=>h.division})})}function Lj(){var j;const{bootstrap:t}=he(),s=((j=t==null?void 0:t.rbac)==null?void 0:j.roles)||[],[a,n]=i.useState(()=>{const h=new Date,f=h.getFullYear(),u=String(h.getMonth()+1).padStart(2,"0");return{from:`${f}-${u}-01`,to:`${f}-${u}-28`}}),[l,r]=i.useState("loading"),[o,d]=i.useState(null),[c,m]=i.useState(null);i.useEffect(()=>{let h=!0;async function f(){try{r("loading"),d(null);const u=await Ns.payables({from:a.from,to:a.to,groupBy:"DIVISION"});if(!h)return;m(u);const b=Array.isArray(u==null?void 0:u.items)?u.items:[];r(b.length>0?"ready":"empty")}catch(u){if(!h)return;d(u),r((u==null?void 0:u.status)===403?"forbidden":"empty")}}return f(),()=>{h=!1}},[a.from,a.to]);const g=i.useMemo(()=>(Array.isArray(c==null?void 0:c.items)?c.items:[]).map(f=>({division:f.division_name||"",due:Number(f.due_amount||0),total:Number(f.total_amount||0),paid:Number(f.paid_amount||0)})),[c]),x=Fl(s);return e.jsx(Mn,{title:"Payables",subtitle:l==="forbidden"?(o==null?void 0:o.message)||"Access denied":"Outstanding vendor payments (live)",status:l,canAccess:x,filter:e.jsx(Rn,{range:a,onChange:n}),children:e.jsx(Tn,{title:"Payables table",subtitle:"Due amounts by division",columns:[{key:"division",label:"Division"},{key:"total",label:"Total",align:"right",render:h=>st(h.total)},{key:"paid",label:"Paid",align:"right",render:h=>st(h.paid)},{key:"due",label:"Due",align:"right",render:h=>st(h.due)}],rows:g,rowKey:h=>h.division})})}function Dj(){var j;const{bootstrap:t}=he(),s=((j=t==null?void 0:t.rbac)==null?void 0:j.roles)||[],[a,n]=i.useState(()=>{const h=new Date,f=h.getFullYear(),u=String(h.getMonth()+1).padStart(2,"0");return{from:`${f}-${u}-01`,to:`${f}-${u}-28`}}),[l,r]=i.useState("loading"),[o,d]=i.useState(null),[c,m]=i.useState(null);i.useEffect(()=>{let h=!0;async function f(){try{r("loading"),d(null);const u=await Ns.cashflow({from:a.from,to:a.to,includePayroll:!0});if(!h)return;m(u);const b=Array.isArray(u==null?void 0:u.items)?u.items:[];r(b.length>0?"ready":"empty")}catch(u){if(!h)return;d(u),r((u==null?void 0:u.status)===403?"forbidden":"empty")}}return f(),()=>{h=!1}},[a.from,a.to]);const g=i.useMemo(()=>(Array.isArray(c==null?void 0:c.items)?c.items:[]).map(f=>({day:f.day,inflow:Number(f.inflow||0),outflow:Number(f.outflow||0)})),[c]),x=Fl(s);return e.jsx(Mn,{title:"Cashflow",subtitle:l==="forbidden"?(o==null?void 0:o.message)||"Access denied":"Cash inflow/outflow by day (live)",status:l,canAccess:x,filter:e.jsx(Rn,{range:a,onChange:n}),children:e.jsx(Tn,{title:"Cashflow table",subtitle:"Inflow - outflow",columns:[{key:"day",label:"Day"},{key:"inflow",label:"Inflow",align:"right",render:h=>st(h.inflow)},{key:"outflow",label:"Outflow",align:"right",render:h=>st(h.outflow)},{key:"net",label:"Net",align:"right",render:h=>{const f=Number(h.inflow)-Number(h.outflow);return st(f)}}],rows:g,rowKey:h=>h.day})})}function $h({title:t="Operations Dashboard"}){const[s,a]=i.useState(!0),[n,l]=i.useState(null),[r,o]=i.useState([]),[d,c]=i.useState(null),{overdueCount:m}=_h(r),g=i.useCallback(async()=>{var y,w,S;a(!0),l(null);const b=await Promise.allSettled([At.inbox.list(),At.dashboard.summary()]),p=((y=b.find(N=>N.status==="rejected"))==null?void 0:y.reason)||null;b[0].status==="fulfilled"&&o(((w=b[0].value)==null?void 0:w.items)||[]),b[1].status==="fulfilled"&&c(((S=b[1].value)==null?void 0:S.item)||null),l(p),a(!1)},[]);i.useEffect(()=>{g()},[g]);const x=i.useMemo(()=>Number((d==null?void 0:d.approvalsPending)??(r==null?void 0:r.length)??0),[d,r]),j=i.useMemo(()=>Number((d==null?void 0:d.criticalDataIssues)??0),[d]),h=(d==null?void 0:d.receivablesDue)??"",f=(d==null?void 0:d.payablesDue)??"",u=(d==null?void 0:d.payrollStatus)??"";return e.jsx(Bl,{title:t,subtitle:"Cross-functional operational health",loading:s,error:n,onRetry:g,children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(qa,{label:"Pending Approvals",value:x}),e.jsx(qa,{label:"SLA Overdue",value:m}),e.jsx(qa,{label:"Receivables Due",value:h,hint:"From Finance modules"}),e.jsx(qa,{label:"Payables Due",value:f,hint:"From Finance modules"}),e.jsx(qa,{label:"Payroll Status",value:u,hint:"Latest payroll run"}),e.jsx(qa,{label:"Critical Data Issues",value:j})]})})}function Mj(){return e.jsx($h,{title:"Operations Dashboard"})}function Rj(){return e.jsx(Ei,{title:"Inbox"})}function Tj(){return e.jsx(Tc,{title:"Alerts"})}function Pj(...t){return t.filter(Boolean).join(" ")}function ho({active:t,children:s,onClick:a}){return e.jsx("button",{type:"button",onClick:a,className:Pj("px-3 py-2 rounded-lg text-sm font-medium border transition-colors",t?"bg-blue-50 text-blue-700 border-blue-200":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:s})}function Vh({title:t="Overrides"}){const[s,a]=i.useState(!0),[n,l]=i.useState(null),[r,o]=i.useState([]),[d,c]=i.useState("REQUESTED"),[m,g]=i.useState(!1),[x,j]=i.useState("MONTH_CLOSE"),[h,f]=i.useState("MONTH_CLOSE"),[u,b]=i.useState(""),[p,y]=i.useState("CLOSE"),[w,S]=i.useState(""),[N,E]=i.useState(!1),[v,A]=i.useState(!1),[T,C]=i.useState("APPROVE"),[k,D]=i.useState(""),[R,L]=i.useState(null),[_,I]=i.useState(!1),[G,O]=i.useState(null),F=i.useCallback(async()=>{try{a(!0),l(null);const U=await At.overrides.list({status:d});o((U==null?void 0:U.items)||[])}catch(U){l(U)}finally{a(!1)}},[d]);i.useEffect(()=>{F()},[F]);const W=i.useMemo(()=>[{key:"type",label:"Override Type"},{key:"target",label:"Target"},{key:"status",label:"Status"},{key:"requested",label:"Requested By"},{key:"actions",label:"Actions",align:"right"}],[]);async function $(){const U=String(w||"").trim();if(U)try{E(!0),await At.overrides.create({overrideType:x,divisionId:null,targetEntityType:h,targetEntityId:u,requestedAction:p,reason:U}),g(!1),b(""),S(""),await F()}catch(B){l(B)}finally{E(!1)}}function M(U,B){L(U),C(B),D(""),A(!0)}async function P(){const U=String(k||"").trim();if(R&&U)try{I(!0),T==="APPROVE"?await At.overrides.approve(R.id,{approvalReason:U}):await At.overrides.reject(R.id,{approvalReason:U}),A(!1),L(null),D(""),await F()}catch(B){l(B)}finally{I(!1)}}async function V(U){try{O(U.id),await At.overrides.execute(U.id,{reason:""}),await F()}catch(B){l(B)}finally{O(null)}}return e.jsxs(e.Fragment,{children:[e.jsxs(Bl,{title:t,subtitle:"Governance overrides require explicit approval",loading:s,error:n,empty:!s&&!n&&(r||[]).length===0?{title:"No overrides",description:"No override requests found for this status."}:null,onRetry:F,children:[e.jsx("div",{className:"rounded-xl border border-amber-200 bg-amber-50 shadow-sm p-4 text-sm text-amber-800",children:"Overrides allow exceptional actions that may bypass standard policies. Use with caution."}),e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ho,{active:d==="REQUESTED",onClick:()=>c("REQUESTED"),children:"Requested"}),e.jsx(ho,{active:d==="APPROVED",onClick:()=>c("APPROVED"),children:"Approved"}),e.jsx(ho,{active:d==="EXECUTED",onClick:()=>c("EXECUTED"),children:"Executed"})]}),e.jsx(vt,{variant:"primary",onClick:()=>g(!0),children:"Create Override"})]}),e.jsx(ki,{columns:W,children:(r||[]).map(U=>{const B=String(U.status||"").toUpperCase();return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-900 font-medium",children:U.override_type||U.overrideType}),e.jsxs("td",{className:"px-4 py-3 text-sm text-slate-700",children:[U.target_entity_type||U.targetEntityType,":"," ",String(U.target_entity_id||U.targetEntityId||"").slice(0,8)]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx(Ml,{status:U.status})}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:String(U.requested_by||U.requestedBy||"").slice(0,8)||""}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[B==="REQUESTED"?e.jsxs(e.Fragment,{children:[e.jsx(vt,{disabled:G===U.id,onClick:()=>M(U,"APPROVE"),children:"Approve"}),e.jsx(vt,{variant:"danger",disabled:G===U.id,onClick:()=>M(U,"REJECT"),children:"Reject"})]}):null,B==="APPROVED"?e.jsx(vt,{variant:"primary",disabled:G===U.id,onClick:()=>V(U),children:"Execute"}):null]})})]},U.id)})})]}),e.jsx(Ad,{open:m,title:"Create override",onClose:()=>g(!1),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Override type"}),e.jsxs("select",{value:x,onChange:U=>j(U.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"MONTH_CLOSE",children:"MONTH_CLOSE"}),e.jsx("option",{value:"EXPENSE",children:"EXPENSE"}),e.jsx("option",{value:"INCOME",children:"INCOME"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Requested action"}),e.jsxs("select",{value:p,onChange:U=>y(U.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"CLOSE",children:"CLOSE"}),e.jsx("option",{value:"OPEN",children:"OPEN"}),e.jsx("option",{value:"APPROVE",children:"APPROVE"}),e.jsx("option",{value:"REJECT",children:"REJECT"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Target entity type"}),e.jsx("input",{value:h,onChange:U=>f(U.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. MONTH_CLOSE"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Target entity ID"}),e.jsx("input",{value:u,onChange:U=>b(U.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"UUID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Reason (required)"}),e.jsx("textarea",{value:w,onChange:U=>S(U.target.value),rows:4,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Required"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(vt,{disabled:N,onClick:()=>g(!1),children:"Cancel"}),e.jsx(vt,{variant:"primary",disabled:N||!String(w||"").trim(),onClick:$,children:N?"Creating":"Create"})]})]})}),e.jsx(Ad,{open:v,title:T==="APPROVE"?"Approve override":"Reject override",onClose:()=>A(!1),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-slate-700",children:"Reason is required."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Reason"}),e.jsx("textarea",{value:k,onChange:U=>D(U.target.value),rows:4,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Required"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(vt,{disabled:_,onClick:()=>A(!1),children:"Cancel"}),e.jsx(vt,{variant:T==="APPROVE"?"primary":"danger",disabled:_||!String(k||"").trim(),onClick:P,children:_?"Submitting":T==="APPROVE"?"Approve":"Reject"})]})]})})]})}function Ij(){return e.jsx(Vh,{title:"Overrides"})}function Oj(){return e.jsx(Pc,{title:"Data Quality"})}function _j(t){return new Promise((s,a)=>{const n=new FileReader;n.onload=()=>{const l=String(n.result||""),r=l.includes("base64,")?l.split("base64,")[1]:l;s(r)},n.onerror=()=>a(new Error("File read failed")),n.readAsDataURL(t)})}async function Bj(t){const s=xs(),a=await fetch(`${Us()}${t}`,{method:"GET",headers:{...s?{authorization:`Bearer ${s}`}:{}}});if(!a.ok){const r=await a.text().catch(()=>""),o=new Error(r||`Download failed (${a.status})`);throw o.status=a.status,o}const n=await a.blob(),l=a.headers.get("content-type")||"application/octet-stream";return{blob:n,contentType:l}}function po(t={}){const s=new URLSearchParams;for(const[n,l]of Object.entries(t||{}))l==null||l===""||s.set(n,String(l));const a=s.toString();return a?`?${a}`:""}const Je={getMyReimbursements(t={}){const{page:s=1,pageSize:a=20,status:n,month:l}=t,r=po({page:s,pageSize:a,status:n,month:l});return z(`/api/v1/reimbursements/my${r}`)},getAllReimbursements(t={}){const{page:s=1,pageSize:a=20,status:n,divisionId:l,month:r}=t,o=po({page:s,pageSize:a,status:n,divisionId:l,month:r});return z(`/api/v1/reimbursements${o}`)},createDraft(t){return z("/api/v1/reimbursements/draft",{method:"POST",body:t})},updateDraft(t,s){return z(`/api/v1/reimbursements/${t}`,{method:"PATCH",body:s})},submitReimbursement(t,s={}){return z(`/api/v1/reimbursements/${t}/submit`,{method:"POST",body:s})},approveReimbursement(t,s={}){return z(`/api/v1/reimbursements/${t}/approve`,{method:"POST",body:s})},rejectReimbursement(t,s,a={}){return z(`/api/v1/reimbursements/${t}/reject`,{method:"POST",body:{...a,decisionReason:String(s||"")}})},addReimbursementPayment(t,s){return z(`/api/v1/reimbursements/${t}/payments`,{method:"POST",body:s})},closeReimbursement(t,s={}){return z(`/api/v1/reimbursements/${t}/close`,{method:"POST",body:s})},getReimbursementById(t){return z(`/api/v1/reimbursements/${t}`)},async uploadReceipt(t,s,{monthCloseOverrideReason:a}={}){const n=(s==null?void 0:s.name)||"receipt",l=(s==null?void 0:s.type)||"application/octet-stream",r=await _j(s);return z(`/api/v1/reimbursements/${t}/receipts`,{method:"POST",body:{fileName:n,contentType:l,fileBase64:r,monthCloseOverrideReason:a||null}})},async downloadReceipt(t,s,a){const n=`/api/v1/reimbursements/${t}/receipts/${s}/download`,{blob:l}=await Bj(n),r=URL.createObjectURL(l),o=document.createElement("a");o.href=r,o.download=a||"receipt",document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(r)},listReceipts(t){return z(`/api/v1/reimbursements/${t}/receipts`)},listPayments(t,{page:s=1,pageSize:a=50}={}){const n=po({page:s,pageSize:a});return z(`/api/v1/reimbursements/${t}/payments${n}`)}},Fj={DRAFT:"bg-slate-100 text-slate-700 border-slate-200",SUBMITTED:"bg-amber-100 text-amber-800 border-amber-200",APPROVED:"bg-blue-100 text-blue-800 border-blue-200",REJECTED:"bg-rose-100 text-rose-800 border-rose-200",PAID:"bg-emerald-100 text-emerald-800 border-emerald-200",CLOSED:"bg-emerald-200 text-emerald-900 border-emerald-300"};function kn({status:t}){const s=String(t||"").toUpperCase()||"",a=Fj[s]||"bg-slate-100 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${a}`,children:s})}function fo(t){const s=Number(t);return Number.isFinite(s)?s.toLocaleString("en-IN",{style:"currency",currency:"INR"}):""}function Yu(t){return t?String(t).slice(0,10):""}function Ci({rows:t,loading:s,empty:a,onRowClick:n,variant:l}){const r=i.useMemo(()=>l==="manager"?[{key:"employeeName",title:"Employee",render:(o,d)=>e.jsx("span",{className:"text-slate-900 font-medium",children:o||""})},{key:"title",title:"Title",render:o=>e.jsx("span",{className:"text-slate-900 font-medium",children:o||""})},{key:"totalAmount",title:"Amount",render:o=>e.jsx("span",{className:"text-slate-700",children:fo(o)})},{key:"scope",title:"Scope",render:o=>e.jsx("span",{className:"text-slate-700",children:String(o||"")})},{key:"submittedAt",title:"Submitted",render:o=>e.jsx("span",{className:"text-slate-700",children:Yu(o)})},{key:"receiptCount",title:"Receipts",render:o=>e.jsx("span",{className:"text-slate-700",children:o??""})},{key:"status",title:"Status",render:o=>e.jsx(kn,{status:o})}]:[{key:"claimDate",title:"Claim Date",render:o=>e.jsx("span",{className:"text-slate-700",children:Yu(o)})},{key:"title",title:"Title",render:o=>e.jsx("span",{className:"text-slate-900 font-medium",children:o||""})},{key:"totalAmount",title:"Amount",render:o=>e.jsx("span",{className:"text-slate-700",children:fo(o)})},{key:"status",title:"Status",render:o=>e.jsx(kn,{status:o})},{key:"dueAmount",title:"Due",render:o=>e.jsx("span",{className:"text-slate-700",children:fo(o)})}],[l]);return e.jsx(ha,{columns:r,data:t||[],loading:s,empty:a,onRowClick:n})}function Uj(t,s){const a=t||[];return a.includes("SYSTEM_FULL_ACCESS")||a.includes(s)}function $j(){var w;const t=Ue(),{bootstrap:s}=he(),a=((w=s==null?void 0:s.rbac)==null?void 0:w.permissions)||[],n=Uj(a,"REIMBURSEMENT_VIEW_DIVISION"),[l,r]=i.useState("loading"),[o,d]=i.useState(null),[c,m]=i.useState(null),[g,x]=i.useState(1),j=20,[h,f]=i.useState("");async function u(){try{r("loading"),d(null);const S=await Je.getAllReimbursements({page:g,pageSize:j,status:"APPROVED",month:h||null});m(S),r("ready")}catch(S){d(S),r("error")}}i.useEffect(()=>{n&&u()},[g,h,n]);const b=i.useMemo(()=>Array.isArray(c==null?void 0:c.items)?c.items:[],[c]),p=i.useMemo(()=>Number((c==null?void 0:c.total)||0),[c]),y=i.useMemo(()=>Math.max(1,Math.ceil(p/j)),[p,j]);return n?l==="loading"?e.jsx(de,{message:"Loading reimbursements"}):l==="error"?e.jsx(le,{error:o,onRetry:u}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Approved Reimbursements"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Add payments and close settled reimbursements."})]}),e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-4",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Month"}),e.jsx("input",{type:"month",value:h,onChange:S=>{f(S.target.value),x(1)},className:"w-full px-3 py-2 rounded-xl border border-slate-200 text-sm bg-white"})]})})}),b.length===0?e.jsx(ye,{title:"No approved claims",description:"There are no approved reimbursements awaiting payment."}):e.jsx(Ci,{rows:b,loading:!1,empty:"No approved claims",onRowClick:S=>t(`/finance/reimbursements/${S.id}`)}),e.jsxs("div",{className:"flex items-center justify-between bg-white rounded-2xl border border-slate-200/60 shadow-sm px-4 py-3",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",g," of ",y," (Total: ",p,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{disabled:g<=1,onClick:()=>x(S=>Math.max(1,S-1)),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:g>=y,onClick:()=>x(S=>Math.min(y,S+1)),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Next"})]})]})]}):e.jsx(ye,{title:"No access",description:"You don't have permission to view reimbursements."})}function Vj(t){const s=Number(t);return Number.isFinite(s)?s.toLocaleString("en-IN",{style:"currency",currency:"INR"}):""}function zj(t){return t?new Date(t).toLocaleString("en-GB",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""}function Ai({payments:t}){const s=i.useMemo(()=>t||[],[t]);return e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-4",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Payments"}),s.length===0?e.jsx("div",{className:"mt-3 text-sm text-slate-600",children:"No payments yet."}):e.jsx("div",{className:"mt-3 space-y-3",children:s.map(a=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 mt-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:Vj(a.paidAmount)}),e.jsx("div",{className:"text-xs text-slate-600",children:zj(a.paidAt)})]}),e.jsxs("div",{className:"text-xs text-slate-600 mt-1",children:[e.jsx("span",{className:"font-medium",children:a.method}),a.referenceId?`  Ref: ${a.referenceId}`:""]}),a.note?e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:a.note}):null]})]},a.id))})]})}const Wj=["BANK_TRANSFER","UPI","CASH","OTHER"];function Hj({open:t,onClose:s,onSubmit:a,maxAmount:n}){const[l,r]=i.useState(""),[o,d]=i.useState("BANK_TRANSFER"),[c,m]=i.useState(""),[g,x]=i.useState(""),j=i.useMemo(()=>{const h=Number(l);if(!Number.isFinite(h)||h<=0)return!1;if(n!=null){const f=Number(n);if(Number.isFinite(f)&&h>f)return!1}return!0},[l,n]);return t?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:s}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-emerald-50 to-teal-50 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Add Payment"}),e.jsx("button",{onClick:s,className:"text-slate-600 hover:text-slate-900",children:""})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",value:l,onChange:h=>r(h.target.value),className:"mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100 outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Method"}),e.jsx("select",{value:o,onChange:h=>d(h.target.value),className:"mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100 outline-none",children:Wj.map(h=>e.jsx("option",{value:h,children:h},h))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Reference ID"}),e.jsx("input",{type:"text",value:c,onChange:h=>m(h.target.value),className:"mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100 outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Note"}),e.jsx("textarea",{rows:3,value:g,onChange:h=>x(h.target.value),className:"mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100 outline-none"})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-slate-200 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 rounded-xl text-sm font-semibold bg-slate-100 text-slate-700 hover:bg-slate-200",children:"Cancel"}),e.jsx("button",{disabled:!j,onClick:()=>a&&a({amount:Number(l),method:o,referenceId:c||null,note:g||null}),className:`px-4 py-2 rounded-xl text-sm font-semibold transition ${j?"bg-gradient-to-r from-emerald-600 to-teal-600 text-white hover:from-emerald-700 hover:to-teal-700":"bg-slate-200 text-slate-500"}`,children:"Add Payment"})]})]})]}):null}function go(t,s){const a=t||[];return a.includes("SYSTEM_FULL_ACCESS")||a.includes(s)}function vo(t){const s=Number(t);return Number.isFinite(s)?s.toLocaleString("en-IN",{style:"currency",currency:"INR"}):""}function qj(){var T;const{id:t}=Dt(),s=Ue(),{bootstrap:a}=he(),n=((T=a==null?void 0:a.rbac)==null?void 0:T.permissions)||[],l=go(n,"REIMBURSEMENT_VIEW_DIVISION"),r=go(n,"REIMBURSEMENT_ADD_PAYMENT"),o=go(n,"REIMBURSEMENT_CLOSE"),[d,c]=i.useState("loading"),[m,g]=i.useState(null),[x,j]=i.useState(null),[h,f]=i.useState([]),[u,b]=i.useState(!1),[p,y]=i.useState(!1);async function w(){try{c("loading"),g(null);const C=await Je.getReimbursementById(t);j((C==null?void 0:C.item)||null);const k=await Je.listPayments(t,{page:1,pageSize:200});f(Array.isArray(k==null?void 0:k.items)?k.items:[]),c("ready")}catch(C){g(C),c("error")}}i.useEffect(()=>{l&&w()},[t,l]);const S=String((x==null?void 0:x.status)||"").toUpperCase(),N=r&&S==="APPROVED",E=o&&S==="PAID";async function v(C){if(x)try{b(!0),g(null),await Je.addReimbursementPayment(t,{paidAmount:Number(C.amount),method:C.method,referenceId:C.referenceId||null,note:C.note||null,paidAt:new Date().toISOString(),version:x.version}),y(!1),await w()}catch(k){g(k)}finally{b(!1)}}async function A(){if(x)try{b(!0),g(null),await Je.closeReimbursement(t,{version:x.version}),await w()}catch(C){g(C)}finally{b(!1)}}return l?d==="loading"?e.jsx(de,{message:"Loading claim"}):d==="error"?e.jsx(le,{error:m,onRetry:w}):x?e.jsxs("div",{className:"max-w-5xl mx-auto space-y-5",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Finance Settlement"}),e.jsx(kn,{status:x.status})]}),e.jsxs("p",{className:"text-slate-600 mt-1",children:["ID: ",x.id]})]}),e.jsx("button",{onClick:()=>s("/finance/reimbursements"),className:"px-4 py-2 rounded-xl bg-slate-100 text-slate-700 text-sm font-semibold hover:bg-slate-200",children:"Back"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Total"}),e.jsx("div",{className:"text-lg font-bold text-slate-900",children:vo(x.totalAmount)})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Paid"}),e.jsx("div",{className:"text-lg font-bold text-slate-900",children:vo(x.paidAmount)})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Due"}),e.jsx("div",{className:"text-lg font-bold text-slate-900",children:vo(x.dueAmount)})]})]}),x.linkedExpenseId?e.jsxs("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-xl p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-800",children:"Linked Expense (read-only)"}),e.jsx("div",{className:"text-sm text-blue-900 mt-1",children:x.linkedExpenseId})]}):null,e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[N?e.jsx("button",{disabled:u,onClick:()=>y(!0),className:"px-4 py-2 rounded-xl text-sm font-semibold bg-gradient-to-r from-emerald-600 to-teal-600 text-white hover:from-emerald-700 hover:to-teal-700 disabled:opacity-50",children:"Add Payment"}):null,E?e.jsx("button",{disabled:u,onClick:A,className:"px-4 py-2 rounded-xl text-sm font-semibold bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-50",children:"Close"}):null]}),S==="APPROVED"?e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Payments allowed only when status is APPROVED."}):null,S==="PAID"?e.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"Close is available only when status is PAID."}):null]}),m?e.jsx(le,{error:m,onRetry:w}):null,e.jsx(Ai,{payments:h}),e.jsx(Hj,{open:p,onClose:()=>y(!1),onSubmit:v,maxAmount:Number(x.dueAmount||0)})]}):e.jsx(ye,{title:"Not found",description:"Reimbursement not found."}):e.jsx(ye,{title:"No access",description:"You don't have permission to view this claim."})}function ts({title:t,value:s,icon:a,color:n="blue"}){const l={blue:"bg-blue-50 text-blue-600 border-blue-200",green:"bg-green-50 text-green-600 border-green-200",amber:"bg-amber-50 text-amber-600 border-amber-200",red:"bg-red-50 text-red-600 border-red-200",purple:"bg-purple-50 text-purple-600 border-purple-200"};return e.jsx("div",{className:"bg-white rounded-lg border border-slate-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600 mb-1",children:t}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:s})]}),e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center border ${l[n]}`,children:a})]})})}function Yj(){var w,S;const{bootstrap:t}=he(),[s,a]=i.useState(!0),[n,l]=i.useState(null),[r,o]=i.useState({totalEmployees:0,presentToday:0,onLeaveToday:0,pendingApprovals:0}),[d,c]=i.useState([]),[m,g]=i.useState([]),[x,j]=i.useState([]),[h,f]=i.useState([]),u=(w=t==null?void 0:t.user)==null?void 0:w.id,b=new Date().toISOString().slice(0,7),p=new Date().toISOString().slice(0,10),y=async()=>{var N,E,v,A,T,C;if(u)try{a(!0),l(null);let k={items:[]},D=[],R={records:[]};try{k=await z(`/api/v1/attendance/team-month?month=${b}`)}catch(F){console.warn("Failed to fetch attendance data:",F)}try{D=await z("/api/v1/leave/team?status=SUBMITTED")}catch(F){console.warn("Failed to fetch leave data:",F)}try{R=await z(`/api/v1/timesheets/team?week=${p}&status=SUBMITTED`)}catch(F){console.warn("Failed to fetch timesheet data:",F)}const L=new Set(((N=k.items)==null?void 0:N.map(F=>F.employeeId))||[]).size,_=((E=k.items)==null?void 0:E.filter(F=>F.attendanceDate===p&&F.status==="PRESENT").length)||0,I=((v=k.items)==null?void 0:v.filter(F=>F.attendanceDate===p&&F.status==="LEAVE").length)||0,G=((D==null?void 0:D.length)||0)+(((A=R.records)==null?void 0:A.filter(F=>F.status==="SUBMITTED").length)||0);o({totalEmployees:L,presentToday:_,onLeaveToday:I,pendingApprovals:G}),c((D==null?void 0:D.slice(0,5))||[]),j((D==null?void 0:D.slice(0,3))||[]),f(((T=R.records)==null?void 0:T.slice(0,3))||[]);const O=[];for(let F=6;F>=0;F--){const W=new Date;W.setDate(W.getDate()-F);const $=W.toISOString().slice(0,10),M=((C=k.items)==null?void 0:C.filter(P=>P.attendanceDate===$))||[];O.push({date:$,present:M.filter(P=>P.status==="PRESENT").length,absent:M.filter(P=>P.status==="ABSENT").length,total:M.length})}g(O)}catch(k){console.error("Failed to fetch dashboard data:",k);let D="Unable to load dashboard data. Please try again later.";k.status===403?D="You do not have permission to view dashboard data. Please contact your administrator.":k.status>=500?D="Server is experiencing issues. Please try again in a few minutes.":(k.code==="NETWORK_ERROR"||!navigator.onLine)&&(D="Network connection lost. Please check your internet connection."),l(D)}finally{a(!1)}};return i.useEffect(()=>{y()},[u]),s?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Manager Dashboard"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(de,{})})]}):n?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Manager Dashboard"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-red-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-4xl mb-4",children:""}),e.jsx("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"Dashboard Error"}),e.jsx("p",{className:"text-red-600 mb-4",children:n}),e.jsx("button",{onClick:y,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-colors",children:"Try Again"})]})})})]}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Manager Dashboard"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900",children:["Welcome back, ",((S=t==null?void 0:t.user)==null?void 0:S.firstName)||"Manager","!"]}),e.jsx("p",{className:"text-slate-600 mt-2",children:"Here's what's happening with your team today."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(ts,{title:"Total Team Members",value:r.totalEmployees,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),color:"blue"}),e.jsx(ts,{title:"Present Today",value:r.presentToday,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green"}),e.jsx(ts,{title:"On Leave Today",value:r.onLeaveToday,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),color:"amber"}),e.jsx(ts,{title:"Pending Approvals",value:r.pendingApprovals,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),color:"red"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Pending Leave Requests"})}),e.jsx("div",{className:"p-6",children:x.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-sm text-slate-600",children:"No pending leave requests"})]}):e.jsx("div",{className:"space-y-4",children:x.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:N.employeeName}),e.jsxs("p",{className:"text-xs text-slate-500",children:[N.days," days"]})]}),e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"Pending"})]},N.id))})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Timesheet Approvals"})}),e.jsx("div",{className:"p-6",children:h.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-sm text-slate-600",children:"No pending timesheets"})]}):e.jsx("div",{className:"space-y-4",children:h.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:N.employeeName}),e.jsxs("p",{className:"text-xs text-slate-500",children:[N.totalHours||0," hours"]})]}),e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:"Review"})]},N.id))})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"7-Day Attendance Trend"})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-3",children:m.map((N,E)=>{const v=N.total>0?Math.round(N.present/N.total*100):0;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm text-slate-600",children:new Date(N.date).toLocaleDateString("en",{weekday:"short"})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${v}%`}})})})]}),e.jsxs("span",{className:"text-sm font-medium text-slate-900",children:[v,"%"]})]},N.date)})})})]})})]}),e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Quick Actions"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("button",{className:"flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Mark Attendance"]}),e.jsxs("button",{className:"flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"View Reports"]}),e.jsxs("button",{className:"flex items-center justify-center px-4 py-3 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Team Schedule"]}),e.jsxs("button",{className:"flex items-center justify-center px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Analytics"]})]})})]})})]})]})}function Ic({permission:t}){return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-slate-600 mb-1",children:"You don't have permission to view this page."}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Required permission: ",e.jsx("code",{className:"bg-slate-100 px-2 py-1 rounded text-xs",children:t})]})]})})}function Gj(){var F,W;const{bootstrap:t}=he(),[s,a]=i.useState([]),[n,l]=i.useState([]),[r,o]=i.useState({totalEmployees:0,presentCount:0,absentCount:0,leaveCount:0}),[d,c]=i.useState([]),[m,g]=i.useState({totalEmployees:0,presentCount:0,absentCount:0,leaveCount:0}),[x,j]=i.useState({startDate:null,endDate:null}),[h,f]=i.useState(!0),[u,b]=i.useState(null),[p,y]=i.useState(""),[w,S]=i.useState(new Date().toISOString().slice(0,7)),[N,E]=i.useState("all"),[v,A]=i.useState(!1),T=(F=t==null?void 0:t.user)==null?void 0:F.id;if(!(((W=t==null?void 0:t.rbac)==null?void 0:W.permissions)||[]).includes("ATTENDANCE_VIEW_TEAM"))return e.jsx(Ic,{permission:"ATTENDANCE_VIEW_TEAM"});const D=$=>{if(!$){const P=new Date,V=P.getDay(),U=P.getDate()-V+(V===0?-6:1);return new Date(P.setDate(U)).toISOString().slice(0,10)}const M=$.match(/(\d{4})-W(\d{2})/);if(M){const P=parseInt(M[1]),V=parseInt(M[2]),U=new Date(P,0,1),B=(V-1)*7-U.getDay();return new Date(P,0,1+B).toISOString().slice(0,10)}return $};i.useEffect(()=>{const $=new Date,M=$.getFullYear(),P=Math.ceil((($-new Date(M,0,1))/864e5+$.getDay()+1)/7),V=`${M}-W${String(P).padStart(2,"0")}`;y(V)},[]);const R=async()=>{if(T)try{f(!0),b(null);const $=D(p),M=await z(`/api/v1/attendance/team?week=${$}`),P=M.employees||[];l(P);let V=M.records||[];N!=="all"&&(V=V.filter(Q=>Q.employeeId===N)),a(V),M.summary&&o(M.summary);const U=await z(`/api/v1/attendance/team-month?month=${w}`),B=U.items||[];c(N==="all"?B:B.filter(Q=>Q.employeeId===N)),g(U.summary||{totalEmployees:0,presentCount:0,absentCount:0,leaveCount:0}),j({startDate:U.startDate||null,endDate:U.endDate||null})}catch($){console.error("Failed to fetch team data:",$),$.status===403?b("You do not have permission to view team attendance. Required permission: ATTENDANCE_VIEW_TEAM"):b($.message||"Failed to load team data")}finally{f(!1),A(!1)}},L=async()=>{A(!0),await R()};i.useEffect(()=>{R()},[T,p,w,N]);const _=$=>new Date($).toLocaleDateString(),I=$=>({PRESENT:"bg-green-100 text-green-800",ABSENT:"bg-red-100 text-red-800",LATE:"bg-yellow-100 text-yellow-800"})[$]||"bg-gray-100 text-gray-800";(()=>{if(r.totalEmployees!==void 0)return{total:r.totalEmployees,present:r.presentCount,absent:r.absentCount,late:s.filter(B=>B.status==="LATE").length,onLeave:s.filter(B=>B.status==="LEAVE").length};const $=s.length,M=s.filter(B=>B.status==="PRESENT").length,P=s.filter(B=>B.status==="ABSENT").length,V=s.filter(B=>B.status==="LATE").length,U=s.filter(B=>B.status==="LEAVE").length;return{total:$,present:M,absent:P,late:V,onLeave:U}})();const O=(()=>{const $=d||[],M=P=>String(P||"").toUpperCase();return{totalEmployees:n.length,presentCount:$.filter(P=>M(P.status)==="PRESENT").length,absentCount:$.filter(P=>M(P.status)==="ABSENT").length,leaveCount:$.filter(P=>M(P.status)==="LEAVE").length}})();return h?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Team Attendance"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(de,{})})]}):u?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Team Attendance"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(le,{error:u})})]}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Team Attendance",subtitle:"Month Overview"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(ts,{title:"Total Employees",value:O.totalEmployees,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),color:"blue"}),e.jsx(ts,{title:"Present Count",value:O.presentCount,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green"}),e.jsx(ts,{title:"Absent Count",value:O.absentCount,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"red"}),e.jsx(ts,{title:"Leave Count",value:O.leaveCount,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),color:"amber"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Month Selector"}),e.jsx("input",{type:"month",value:w,onChange:$=>S($.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Employee"}),e.jsxs("select",{value:N,onChange:$=>E($.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Employees"}),n.map($=>e.jsx("option",{value:$.id,children:$.employeeName||`${$.firstName||""} ${$.lastName||""}`.trim()},$.id))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:L,disabled:v,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:v?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Refreshing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden mb-8",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Attendance Overview (Month)"}),e.jsx("div",{className:"text-sm text-slate-600 mt-1",children:x.startDate&&x.endDate?`${x.startDate} to ${x.endDate}`:""})]})}),d.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No monthly attendance found"}),e.jsx("p",{className:"text-slate-600",children:"No attendance data available for the selected month."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Employee Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Source"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:d.map(($,M)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900",children:$.employeeName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:_($.attendanceDate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I($.status)}`,children:$.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:$.source||"SYSTEM"})]},$.id||M))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Attendance Records"})}),h?e.jsx("div",{className:"p-8",children:e.jsx(de,{})}):s.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No attendance records found"}),e.jsx("p",{className:"text-slate-600",children:"No attendance data available for the selected week."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Employee Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Source"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:s.map(($,M)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900",children:$.employeeName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:_($.date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I($.status)}`,children:$.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:$.source||"SYSTEM"})]},M))})]})})]})]})]})}function Qj(){var we,De;const{bootstrap:t}=he(),[s,a]=i.useState([]),[n,l]=i.useState([]),[r,o]=i.useState([]),[d,c]=i.useState({total:0,pendingL1:0,approved:0,rejected:0}),[m,g]=i.useState(!0),[x,j]=i.useState(null),[h,f]=i.useState("all"),[u,b]=i.useState("all"),[p,y]=i.useState("all"),[w,S]=i.useState(new Date().toISOString().slice(0,7)),[N,E]=i.useState(!1),[v,A]=i.useState(!1),[T,C]=i.useState(!1),[k,D]=i.useState(null),[R,L]=i.useState(""),[_,I]=i.useState(!1),G=(we=t==null?void 0:t.user)==null?void 0:we.id,O=((De=t==null?void 0:t.rbac)==null?void 0:De.permissions)||[],F=O.includes("LEAVE_APPROVE_TEAM"),W=F;if(!F)return e.jsx(Ic,{permission:"LEAVE_APPROVE_TEAM"});const $=async()=>{try{console.log("Fetching leave types from DB...");const ve=await z("/api/v1/leave/types")||[];console.log("Leave types fetched:",ve),o(Array.isArray(ve)?ve:[])}catch(Z){console.error("Failed to fetch leave types:",Z),o([])}},M=async()=>{if(!G){console.log("Leave: No userId found, skipping fetch");return}console.log("Leave: User ID:",G),console.log("Leave: User permissions:",O),console.log("Leave: Has permission:",F);try{j(null);const Z=p||"all";console.log("Fetching team leave with status:",Z);const ve=await z(`/api/v1/leave/team?status=${encodeURIComponent(Z)}`);console.log("Team leave API response:",ve);let ue=ve||[];console.log("Leave data before filtering:",ue);const re=new Map;(ue||[]).forEach(q=>{if(!(q!=null&&q.employeeId)||re.has(q.employeeId))return;const Y=String(q.employeeName||"").trim(),[xe,...J]=Y.split(" ");re.set(q.employeeId,{id:q.employeeId,firstName:xe||Y||"",lastName:J.join(" ")||"",employeeCode:q.employeeCode||null})}),l(Array.from(re.values())),w&&(ue=ue.filter(q=>{const Y=q.startDate||q.createdAt;if(!Y)return!0;try{return new Date(Y).toISOString().slice(0,7)===w}catch{return!0}})),h!=="all"&&(ue=ue.filter(q=>q.employeeId===h)),u!=="all"&&(ue=ue.filter(q=>q.leaveType===u)),console.log("Leave data after all filtering:",ue),a(ue);const Re=ue.length,ne=ue.filter(q=>q.status==="SUBMITTED"||q.status==="PENDING_L1").length,H=ue.filter(q=>q.status==="APPROVED").length,te=ue.filter(q=>q.status==="REJECTED").length;c({total:Re,pendingL1:ne,approved:H,rejected:te}),console.log("Leave summary set:",{total:Re,pendingL1:ne,approved:H,rejected:te})}catch(Z){console.error("Failed to fetch team leave requests:",Z),Z.status===403?j("You do not have permission to view team leave. Required permission: LEAVE_APPROVE_TEAM"):j(Z.message||"Failed to load team leave requests")}},P=async()=>{E(!0);try{await M()}finally{E(!1)}};i.useEffect(()=>{(async()=>{if(G){g(!0);try{await $(),await M()}catch(ve){console.error("Error initializing data:",ve)}finally{g(!1)}}})()},[G]),i.useEffect(()=>{G&&!m&&M()},[p,h,u,w]);const V=Z=>{D(Z),A(!0)},U=Z=>{D(Z),C(!0),L("")},B=async()=>{if(k)try{I(!0),await z(`/api/v1/leave/requests/${k.id}/approve`,{method:"POST"}),A(!1),D(null),M(),console.log("Leave request approved successfully")}catch(Z){console.error("Failed to approve leave:",Z)}finally{I(!1)}},Q=async()=>{if(!(!k||!R.trim()))try{I(!0),await z(`/api/v1/leave/requests/${k.id}/reject`,{method:"POST",body:{reason:R.trim()}}),C(!1),D(null),L(""),M(),console.log("Leave request rejected successfully")}catch(Z){console.error("Failed to reject leave:",Z)}finally{I(!1)}},ae=Z=>new Date(Z).toLocaleDateString(),ie=Z=>{const ve={SUBMITTED:"bg-yellow-100 text-yellow-800",PENDING_L2:"bg-orange-100 text-orange-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${ve[Z]||"bg-gray-100 text-gray-800"}`,children:Z})};return W?m?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Team Leave Approvals"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(de,{})})]}):x?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Team Leave Approvals"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(le,{error:x})})]}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Team Leave Approvals"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(ts,{title:"Total",value:d.total,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),color:"blue"}),e.jsx(ts,{title:"Pending",value:d.pendingL1,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"amber"}),e.jsx(ts,{title:"Approved",value:d.approved,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green"}),e.jsx(ts,{title:"Rejected",value:d.rejected,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"red"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6 mb-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Employee"}),e.jsxs("select",{value:h,onChange:Z=>f(Z.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Employees"}),n.map(Z=>e.jsxs("option",{value:Z.id,children:[Z.firstName," ",Z.lastName]},Z.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Leave Type"}),e.jsxs("select",{value:u,onChange:Z=>b(Z.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Types"}),Array.isArray(r)&&r.map(Z=>e.jsx("option",{value:Z.code,children:Z.name},Z.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Status"}),e.jsxs("select",{value:p,onChange:Z=>y(Z.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"SUBMITTED",children:"Pending Approval"}),e.jsx("option",{value:"PENDING_L1",children:"Pending L1 Approval"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Month"}),e.jsx("input",{type:"month",value:w,onChange:Z=>S(Z.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:P,disabled:N,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:N?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Refreshing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Leave Requests"})}),m?e.jsx("div",{className:"p-8",children:e.jsx(de,{})}):s.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No leave requests found"}),e.jsx("p",{className:"text-slate-600",children:"No leave requests matching the selected criteria."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Employee Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date Range"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Days"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Submitted At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:s.map(Z=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900",children:Z.employeeName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:Z.employeeCode||"N/A"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:[Z.startDate," - ",Z.endDate]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:Z.leaveType}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:Z.days}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-600",children:Z.submittedAt?ae(Z.submittedAt):"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ie(Z.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:Z.status==="SUBMITTED"||Z.status==="PENDING_L1"?e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>V(Z),className:"text-green-600 hover:text-green-900 px-3 py-1 bg-green-50 rounded hover:bg-green-100 transition-colors",children:"Approve"}),e.jsx("button",{onClick:()=>U(Z),className:"text-red-600 hover:text-red-900 px-3 py-1 bg-red-50 rounded hover:bg-red-100 transition-colors",children:"Reject"})]}):e.jsx("span",{className:"text-slate-400",children:""})})]},Z.id))})]})})]})]}),v&&k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-4",children:"Approve Leave Request"}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Employee:"}),e.jsx("span",{className:"text-sm font-medium",children:k.employeeName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Date Range:"}),e.jsxs("span",{className:"text-sm font-medium",children:[ae(k.startDate)," - ",ae(k.endDate)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Leave Type:"}),e.jsx("span",{className:"text-sm font-medium",children:k.leaveType})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Days:"}),e.jsx("span",{className:"text-sm font-medium",children:k.days})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{A(!1),D(null)},className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:"Cancel"}),e.jsx("button",{onClick:B,disabled:_,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 disabled:opacity-50",children:_?"Approving...":"Approve"})]})]})}),T&&k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-4",children:"Reject Leave Request"}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Employee:"}),e.jsx("span",{className:"text-sm font-medium",children:k.employeeName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Date Range:"}),e.jsxs("span",{className:"text-sm font-medium",children:[ae(k.startDate)," - ",ae(k.endDate)]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Reason for Rejection *"}),e.jsx("textarea",{value:R,onChange:Z=>L(Z.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Please provide a reason for rejection..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{C(!1),D(null),L("")},className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:"Cancel"}),e.jsx("button",{onClick:Q,disabled:_||!R.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:opacity-50",children:_?"Rejecting...":"Reject"})]})]})})]}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Team Leave Approvals"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:e.jsx("p",{className:"text-slate-600",children:"You don't have permission to access this page."})})})]})}function Jj(){var W,$;const{bootstrap:t}=he(),[s,a]=i.useState([]),[n,l]=i.useState({pending:0,approved:0,rejected:0}),[r,o]=i.useState(!0),[d,c]=i.useState(null),[m,g]=i.useState("2026-W06"),[x,j]=i.useState("all"),[h,f]=i.useState("SUBMITTED"),[u,b]=i.useState(!1),[p,y]=i.useState(!1),[w,S]=i.useState(null),[N,E]=i.useState(""),v=(W=t==null?void 0:t.user)==null?void 0:W.id,A=(($=t==null?void 0:t.rbac)==null?void 0:$.permissions)||[],T=A.includes("TIMESHEET_APPROVE_TEAM");if(!T)return e.jsx(Ic,{permission:"TIMESHEET_APPROVE_TEAM"});i.useEffect(()=>{console.log("Component mounted - forcing week to 2026-W06"),g("2026-W06"),window.caches&&window.caches.keys().then(M=>{M.forEach(P=>{P.includes("timesheet")&&window.caches.delete(P)})})},[]);const C=M=>{if(console.log("getWeekStartDate called with:",M),!M){const U=new Date().toISOString().slice(0,10);return console.log("No weekString, using today:",U),U}const P=M.match(/(\d{4})-W(\d{2})/);if(P){const U=parseInt(P[1]),B=parseInt(P[2]);console.log("Parsed year:",U,"week:",B);const Q=new Date(U,0,1),ae=(B-1)*7-Q.getDay()+1,ie=new Date(U,0,1+ae),we=ie.getFullYear(),De=ie.getMonth(),Z=ie.getDate(),ve=`${we}-${String(De+1).padStart(2,"0")}-${String(Z).padStart(2,"0")}`;return console.log(`Week ${M} converts to date: ${ve}`),console.log("Calculation details:"),console.log("- firstDayOfYear:",Q),console.log("- firstDayOfYear.getDay():",Q.getDay()),console.log("- daysOffset:",ae),console.log("- weekStartDate:",ie),console.log("- Local date components:",{year_local:we,month_local:De,day_local:Z}),ve}const V=new Date().toISOString().slice(0,10);return console.log("Invalid format, using today:",V),V},k=async()=>{var M;if(!v){console.log("No userId found, skipping fetch");return}console.log("User ID:",v),console.log("User permissions:",A),console.log("Has permission:",T);try{o(!0),c(null);const P=C(m);console.log("Fetching team timesheets for week:",P),console.log("Making API call to:",`/api/v1/timesheets/team?week=${P}&status=${h}`);const V=localStorage.getItem("jasiq_token");console.log("Auth token exists:",!!V),console.log("Token length:",(V==null?void 0:V.length)||0);try{console.log("Starting API call with 10 second timeout...");const U=await z(`/api/v1/timesheets/team?week=${P}&status=${encodeURIComponent(h)}`);console.log("Team timesheets API response received:",U);const B=U.records||[];let Q=B;console.log("Timesheets data before filtering:",Q),console.log("Response structure:",{hasRecords:!!U.records,recordsLength:(M=U.records)==null?void 0:M.length,responseType:typeof U,responseKeys:Object.keys(U)});const ae=B.filter(De=>De.status==="SUBMITTED").length,ie=B.filter(De=>De.status==="APPROVED").length,we=B.filter(De=>De.status==="REJECTED").length;l({pending:ae,approved:ie,rejected:we}),console.log("Summary set:",{pending:ae,approved:ie,rejected:we}),h&&h.toLowerCase()!=="all"&&(Q=Q.filter(De=>De.status===h)),console.log("Timesheets data after status filter:",Q),x!=="all"&&(Q=Q.filter(De=>De.employeeId===x)),console.log("Final timesheets data to set:",Q),a(Q)}catch(U){throw console.error("API call failed:",U),U}}catch(P){console.error("Failed to fetch team timesheets:",P),P.status===403?c("You do not have permission to view team timesheets. Required permission: TIMESHEET_APPROVE_TEAM"):c(P.message||"Failed to load team timesheets")}finally{o(!1),b(!1)}},D=async()=>{b(!0),await k()},R=async M=>{try{await z(`/api/v1/timesheets/${M}/approve`,{method:"POST",body:{action:"approve"}}),await k()}catch(P){console.error("Failed to approve timesheet:",P)}},L=async M=>{S(M),E(""),y(!0)},_=async()=>{if(!w)return;const M=String(N||"").trim();if(!M){c("Reject reason is required");return}try{c(null),await z(`/api/v1/timesheets/${w}/reject`,{method:"POST",body:{action:"reject",reason:M}}),y(!1),S(null),E(""),await k()}catch(P){console.error("Failed to reject timesheet:",P),c((P==null?void 0:P.message)||"Failed to reject timesheet")}},I=()=>{y(!1),S(null),E("")};i.useEffect(()=>{console.log("useEffect triggered - userId:",v,"selectedWeek:",m),k()},[v,m,x,h]);const G=M=>new Date(M).toLocaleDateString(),O=M=>{const P={DRAFT:"bg-gray-100 text-gray-800",SUBMITTED:"bg-blue-100 text-blue-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${P[M]||"bg-gray-100 text-gray-800"}`,children:M})},F=M=>{var P;return((P=M.entries)==null?void 0:P.reduce((V,U)=>V+(U.hours||0),0))||0};return r?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Team Timesheets"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(de,{})})]}):d?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Team Timesheets"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(le,{error:d})})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-slate-100",children:[e.jsx(We,{title:"Team Timesheet Approvals"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200/60 p-4 sm:p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsxs("div",{className:"ml-3 sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-slate-600",children:"Pending"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:n.pending})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200/60 p-4 sm:p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsxs("div",{className:"ml-3 sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-slate-600",children:"Approved"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:n.approved})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200/60 p-4 sm:p-6 hover:shadow-md transition-shadow sm:col-span-2 lg:col-span-1",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsxs("div",{className:"ml-3 sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-slate-600",children:"Rejected"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:n.rejected})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200/60 p-4 sm:p-6 mb-6 sm:mb-8",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-900",children:"Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Employee"}),e.jsxs("select",{value:x,onChange:M=>j(M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm",children:[e.jsx("option",{value:"all",children:"All Employees"}),s.filter((M,P,V)=>V.findIndex(U=>U.employeeId===M.employeeId)===P).map(M=>e.jsx("option",{value:M.employeeId,children:M.employeeName},M.employeeId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Status"}),e.jsxs("select",{value:h,onChange:M=>f(M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"SUBMITTED",children:"Submitted"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Week Range"}),e.jsx("input",{type:"week",value:m,onChange:M=>g(M.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:D,disabled:u,className:"w-full px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center shadow-sm hover:shadow-md text-sm font-medium",children:u?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Refreshing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200/60 overflow-hidden",children:[e.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-200/60 bg-slate-50/50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-slate-900 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),"Approval Queue"]}),e.jsxs("span",{className:"text-xs sm:text-sm text-slate-500",children:[s.length," ",s.length===1?"timesheet":"timesheets"]})]})}),r?e.jsx("div",{className:"p-8",children:e.jsx(de,{})}):s.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No timesheets found"}),e.jsx("p",{className:"text-slate-600",children:"No submitted timesheets requiring approval."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-full",children:e.jsxs("table",{className:"w-full divide-y divide-slate-200/60",children:[e.jsx("thead",{className:"bg-slate-50/80",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider whitespace-nowrap",children:"Employee"}),e.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider whitespace-nowrap hidden sm:table-cell",children:"Employee Code"}),e.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider whitespace-nowrap",children:"Week Range"}),e.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider whitespace-nowrap",children:"Total Hours"}),e.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider whitespace-nowrap hidden lg:table-cell",children:"Submitted On"}),e.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider whitespace-nowrap",children:"Status"}),e.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider whitespace-nowrap hidden md:table-cell",children:"Approval Level"}),e.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200/40",children:s.map(M=>{var P,V;return e.jsxs("tr",{className:"hover:bg-slate-50/60 transition-colors",children:[e.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm font-medium text-slate-900",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-slate-100 rounded-full flex items-center justify-center mr-2 sm:mr-3",children:e.jsx("span",{className:"text-xs font-medium text-slate-600",children:((V=(P=M.employeeName)==null?void 0:P.charAt(0))==null?void 0:V.toUpperCase())||"E"})}),e.jsx("div",{className:"truncate max-w-[120px] sm:max-w-none",children:M.employeeName})]})}),e.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-slate-600 hidden sm:table-cell",children:M.employeeCode||"N/A"}),e.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-slate-600",children:e.jsx("div",{className:"truncate max-w-[100px] sm:max-w-none",children:M.weekStart?`${G(M.weekStart)} - ${G(M.weekEnd)}`:m})}),e.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-slate-600",children:e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 sm:px-2.5 sm:py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[F(M),"h"]})}),e.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-slate-600 hidden lg:table-cell",children:M.submittedAt?G(M.submittedAt):"N/A"}),e.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap",children:O(M.status)}),e.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm text-slate-600 hidden md:table-cell",children:e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 sm:px-2.5 sm:py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 border border-blue-200/60",children:"L1"})}),e.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-sm font-medium",children:M.status==="SUBMITTED"?e.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:[e.jsxs("button",{onClick:()=>R(M.id),className:"inline-flex items-center px-2 py-1 sm:px-3 sm:py-1.5 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors text-xs font-medium border border-green-200/60",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"hidden sm:inline",children:"Approve"}),e.jsx("span",{className:"sm:hidden",children:""})]}),e.jsxs("button",{onClick:()=>L(M.id),className:"inline-flex items-center px-2 py-1 sm:px-3 sm:py-1.5 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors text-xs font-medium border border-red-200/60",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{className:"hidden sm:inline",children:"Reject"}),e.jsx("span",{className:"sm:hidden",children:""})]})]}):e.jsx("span",{className:"text-slate-400 text-sm",children:""})})]},M.id)})})]})})})]}),p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:e.jsxs("div",{className:"w-full max-w-md sm:max-w-lg rounded-xl bg-white shadow-2xl border border-slate-200/60 overflow-hidden",children:[e.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-200/60 bg-slate-50/50",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-slate-900 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),"Reject Timesheet"]}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Please provide a reason for rejection."})]}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Reason"}),e.jsx("textarea",{value:N,onChange:M=>E(M.target.value),rows:4,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors text-sm",placeholder:"Enter rejection reason..."})]}),e.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-t border-slate-200/60 bg-slate-50/30 flex flex-col sm:flex-row sm:items-center sm:justify-end gap-3",children:[e.jsx("button",{onClick:I,className:"w-full sm:w-auto px-4 py-2 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50 transition-colors font-medium text-sm order-2 sm:order-1",children:"Cancel"}),e.jsx("button",{onClick:_,className:"w-full sm:w-auto px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors font-medium shadow-sm hover:shadow-md text-sm order-1 sm:order-2",children:"Reject"})]})]})})]})]})}function Kj(){var h;const{bootstrap:t}=he(),[s,a]=i.useState([]),[n,l]=i.useState(!0),[r,o]=i.useState(null),[d,c]=i.useState(new Date().toISOString().slice(0,7)),m=(h=t==null?void 0:t.user)==null?void 0:h.id,g=async()=>{if(m)try{l(!0),o(null);const f=await z(`/api/v1/attendance/me?month=${d}`);a(f.items||[])}catch(f){console.error("Failed to fetch attendance records:",f),o(f.message||"Failed to load attendance records")}finally{l(!1)}};i.useEffect(()=>{g()},[m,d]);const x=f=>new Date(f).toLocaleDateString(),j=f=>{const u={PRESENT:"bg-green-100 text-green-800",ABSENT:"bg-red-100 text-red-800",LATE:"bg-yellow-100 text-yellow-800",HALF_DAY:"bg-orange-100 text-orange-800",LEAVE:"bg-blue-100 text-blue-800"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${u[f]||"bg-gray-100 text-gray-800"}`,children:f})};return n?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Attendance"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(de,{})})]}):r?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Attendance"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(le,{error:r})})]}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Attendance"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Select Month"}),e.jsx("input",{type:"month",value:d,onChange:f=>c(f.target.value),className:"px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.length===0?e.jsx(ye,{title:"No attendance records found",description:"There are no attendance records for the selected month."}):e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Check In"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Check Out"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Total Hours"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Notes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:s.map(f=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-slate-900",children:x(f.attendanceDate)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:f.marked_at?new Date(f.marked_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j(f.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:f.note||"-"})})]},f.id))})]})})})]})]})}function Xj(){var b;const{bootstrap:t}=he(),[s,a]=i.useState([]),[n,l]=i.useState({}),[r,o]=i.useState(!0),[d,c]=i.useState(null),[m,g]=i.useState("all"),x=(b=t==null?void 0:t.user)==null?void 0:b.id,j=async()=>{if(x)try{o(!0),c(null);const p=await z("/api/v1/leave/me");a(p.items||[]);const y=await z("/api/v1/leave/balance/me");l(y||{})}catch(p){console.error("Failed to fetch leave data:",p),c(p.message||"Failed to load leave data")}finally{o(!1)}};i.useEffect(()=>{j()},[x]);const h=p=>new Date(p).toLocaleDateString(),f=p=>{const y={PENDING:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800",CANCELLED:"bg-gray-100 text-gray-800"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${y[p]||"bg-gray-100 text-gray-800"}`,children:p})},u=s.filter(p=>m==="all"?!0:m==="pending"?p.status==="PENDING":m==="approved"?p.status==="APPROVED":m==="rejected"?p.status==="REJECTED":!0);return r?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Leave"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(de,{})})]}):d?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Leave"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(le,{error:d})})]}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Leave"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 bg-blue-100 rounded-lg p-3",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Total Leave"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:n.total||0})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 bg-green-100 rounded-lg p-3",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Available"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:n.available||0})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 bg-yellow-100 rounded-lg p-3",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Used"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:n.used||0})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 bg-purple-100 rounded-lg p-3",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:n.pending||0})]})]})})]}),e.jsx("div",{className:"border-b border-slate-200 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:["all","pending","approved","rejected"].map(p=>e.jsx("button",{onClick:()=>g(p),className:`py-2 px-1 border-b-2 font-medium text-sm capitalize ${m===p?"border-blue-500 text-blue-600":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:p},p))})}),u.length===0?e.jsx(ye,{title:"No leave requests found",description:`There are no ${m==="all"?"":m} leave requests.`}):e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Leave Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date Range"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Days"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Reason"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Applied On"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:u.map(p=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-slate-900",children:p.leaveType})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-slate-900",children:[h(p.startDate)," - ",h(p.endDate)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:p.days})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-slate-900 max-w-xs truncate",children:p.reason||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f(p.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:h(p.createdAt)})})]},p.id))})]})})})]})]})}function Zj(){var f;const{bootstrap:t}=he(),[s,a]=i.useState([]),[n,l]=i.useState(!0),[r,o]=i.useState(null),[d,c]=i.useState(new Date().toISOString().slice(0,10)),m=(f=t==null?void 0:t.user)==null?void 0:f.id,g=async()=>{if(m)try{l(!0),o(null);const u=await z(`/api/v1/timesheets/me?week=${d}`);a(u.items||[])}catch(u){console.error("Failed to fetch timesheets:",u),o(u.message||"Failed to load timesheets")}finally{l(!1)}};i.useEffect(()=>{g()},[m,d]);const x=u=>new Date(u).toLocaleDateString(),j=u=>{const b={DRAFT:"bg-gray-100 text-gray-800",SUBMITTED:"bg-blue-100 text-blue-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${b[u]||"bg-gray-100 text-gray-800"}`,children:u})},h=u=>{var b;return((b=u.entries)==null?void 0:b.reduce((p,y)=>p+(y.hours||0),0))||0};return n?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Timesheets"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(de,{})})]}):r?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Timesheets"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(le,{error:r})})]}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Timesheets"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Select Week"}),e.jsx("input",{type:"week",value:d,onChange:u=>c(u.target.value),className:"px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.length===0?e.jsx(ye,{title:"No timesheets found",description:"There are no timesheets for the selected week."}):e.jsx("div",{className:"space-y-6",children:s.map(u=>{var b;return e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-slate-900",children:["Week: ",x(u.weekStart)," - ",x(u.weekEnd)]}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Total Hours: ",h(u)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[j(u.status),u.status==="DRAFT"&&e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:"Submit"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Project"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Task"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Hours"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Description"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:(b=u.entries)==null?void 0:b.map((p,y)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:x(p.date)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:p.project||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:p.task||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:p.hours||0})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-slate-900 max-w-xs truncate",children:p.description||"-"})})]},y))})]})})]},u.id)})})]})]})}function e2(){var m;const{bootstrap:t}=he(),[s,a]=i.useState(null),[n,l]=i.useState(!0),[r,o]=i.useState(null),d=(m=t==null?void 0:t.user)==null?void 0:m.id,c=async()=>{if(d)try{l(!0),o(null);const g=await z("/api/v1/employees/me"),x=(g==null?void 0:g.item)||g;a(x)}catch(g){console.error("Failed to fetch profile:",g),o(g.message||"Failed to load profile")}finally{l(!1)}};return i.useEffect(()=>{c()},[d]),n?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Profile"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(de,{})})]}):r?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Profile"}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(le,{error:r})})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-slate-100",children:[e.jsx(We,{title:"My Profile"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200/60 overflow-hidden mb-6 sm:mb-8",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-10",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 lg:space-x-6 space-y-4 sm:space-y-0",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-white/20 backdrop-blur rounded-full flex items-center justify-center shadow-inner mx-auto sm:mx-0",children:e.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsxs("div",{className:"text-white text-center sm:text-left",children:[e.jsxs("h1",{className:"text-xl sm:text-2xl font-bold",children:[s==null?void 0:s.firstName," ",s==null?void 0:s.lastName]}),e.jsx("p",{className:"text-blue-100 text-sm mt-1",children:(s==null?void 0:s.designation)||"Employee"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:mt-2 space-y-2 sm:space-y-0 sm:space-x-4 text-xs text-blue-200",children:[e.jsxs("span",{className:"flex items-center justify-center sm:justify-start",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),(s==null?void 0:s.employeeCode)||"N/A"]}),e.jsxs("span",{className:"flex items-center justify-center sm:justify-start",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(s==null?void 0:s.status)||"N/A"]})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"xl:col-span-2 bg-white rounded-xl shadow-sm border border-slate-200/60",children:[e.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-200/60",children:e.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-slate-900 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Contact Information"]})}),e.jsx("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"group",children:[e.jsxs("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1.5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]}),e.jsx("p",{className:"mt-2 text-sm text-slate-900 font-medium bg-slate-50 px-3 py-2 rounded-lg border border-slate-200/60 group-hover:border-blue-300/60 transition-colors break-all",children:(s==null?void 0:s.email)||"-"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1.5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Phone"]}),e.jsx("p",{className:"mt-2 text-sm text-slate-900 font-medium bg-slate-50 px-3 py-2 rounded-lg border border-slate-200/60 group-hover:border-blue-300/60 transition-colors",children:(s==null?void 0:s.phone)||"-"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200/60",children:[e.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-200/60",children:e.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-slate-900 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Organization"]})}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Scope"}),e.jsx("p",{className:"mt-1.5 text-sm text-slate-900 font-medium break-words",children:(s==null?void 0:s.scope)||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Reporting Manager"}),e.jsx("p",{className:"mt-1.5 text-sm text-slate-900 font-medium break-words",children:(s==null?void 0:s.reportingManagerName)||"-"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mt-4 sm:mt-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200/60",children:[e.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-200/60",children:e.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-slate-900 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Timestamps"]})}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Created At"}),e.jsx("p",{className:"mt-1.5 text-sm text-slate-900 font-medium break-words",children:s!=null&&s.createdAt?new Date(s.createdAt).toLocaleString():"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Updated At"}),e.jsx("p",{className:"mt-1.5 text-sm text-slate-900 font-medium break-words",children:s!=null&&s.updatedAt?new Date(s.updatedAt).toLocaleString():"-"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200/60",children:[e.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-200/60",children:e.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-slate-900 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"Roles"]})}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Functional Roles"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1.5 sm:gap-2",children:Array.isArray(s==null?void 0:s.functionalRoles)&&s.functionalRoles.length>0?s.functionalRoles.map((g,x)=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 sm:px-2.5 sm:py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 border border-blue-200/60",children:g},x)):e.jsx("span",{className:"text-sm text-slate-500",children:"-"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:"System Roles"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1.5 sm:gap-2",children:Array.isArray(s==null?void 0:s.systemRoles)&&s.systemRoles.length>0?s.systemRoles.map((g,x)=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 sm:px-2.5 sm:py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800 border border-slate-200/60",children:g},x)):e.jsx("span",{className:"text-sm text-slate-500",children:"-"})})]})]})]})]})]})]})}function t2(t){const s=Number(t||0);return Number.isFinite(s)?s.toLocaleString(void 0,{maximumFractionDigits:2}):"0"}function s2({tone:t,children:s}){const a=t==="gray"?"bg-slate-100 text-slate-700 border-slate-200":t==="blue"?"bg-blue-50 text-blue-700 border-blue-200":t==="teal"?"bg-teal-50 text-teal-700 border-teal-200":t==="red"?"bg-red-50 text-red-700 border-red-200":t==="yellow"?"bg-amber-50 text-amber-700 border-amber-200":t==="green"?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full border text-xs font-semibold ${a}`,children:s})}function a2(t){const s=String(t||"").toUpperCase();return s==="SUBMITTED"?"blue":s==="APPROVED"?"teal":s==="REJECTED"?"red":"gray"}function n2(){const t=Ue(),[s,a]=i.useState("loading"),[n,l]=i.useState(null),[r,o]=i.useState(null),[d,c]=i.useState(""),[m,g]=i.useState(""),[x,j]=i.useState(""),[h,f]=i.useState(""),[u,b]=i.useState(1),p=20,y=i.useMemo(()=>{const v=new URLSearchParams;return v.set("page",String(u)),v.set("size",String(p)),v.set("status","SUBMITTED"),d&&v.set("divisionId",d),m&&v.set("from",m),x&&v.set("to",x),h&&v.set("search",h),v.toString()},[u,d,m,x,h]);async function w(){try{a("loading"),l(null);const v=await z(`/api/v1/expenses?${y}`);o(v),a("ready")}catch(v){l(v),a("error")}}i.useEffect(()=>{w()},[y]);const S=i.useMemo(()=>Array.isArray(r==null?void 0:r.items)?r.items:[],[r]),N=i.useMemo(()=>Number((r==null?void 0:r.total)||0),[r]),E=i.useMemo(()=>Math.max(1,Math.ceil(N/p)),[N,p]);return s==="loading"?e.jsx(de,{message:"Loading team expenses"}):s==="error"?e.jsx(le,{error:n,onRetry:w}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Team Expense Approvals"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Review submitted division expenses."})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Division"}),e.jsx("input",{value:d,onChange:v=>{c(v.target.value),b(1)},placeholder:"Division UUID",className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Date From"}),e.jsx("input",{type:"date",value:m,onChange:v=>{g(v.target.value),b(1)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Date To"}),e.jsx("input",{type:"date",value:x,onChange:v=>{j(v.target.value),b(1)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{className:"sm:col-span-3",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Search"}),e.jsx("input",{value:h,onChange:v=>{f(v.target.value),b(1)},placeholder:"Search title/vendor",className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]})]})]}),S.length===0?e.jsx(ye,{title:"No submitted expenses",description:"No items matched your filters."}):e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Scope"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:S.map(v=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:v.employeeName?String(v.employeeName):v.employeeId?String(v.employeeId).slice(0,8)+"":""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:v.categoryName?String(v.categoryName):v.categoryId?String(v.categoryId).slice(0,8)+"":""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700 text-right",children:t2(v.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:v.divisionId?"DIVISION":"COMPANY"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:e.jsx(s2,{tone:a2(v.status),children:String(v.status||"")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("button",{onClick:()=>t(`/manager/expenses/${v.id}/review`),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium hover:bg-slate-50",children:"Review"})})]},v.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",u," of ",E," (Total: ",N,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{disabled:u<=1,onClick:()=>b(v=>Math.max(1,v-1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:u>=E,onClick:()=>b(v=>Math.min(E,v+1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Next"})]})]})]})]})}function l2(t){const s=Number(t||0);return Number.isFinite(s)?s.toLocaleString(void 0,{maximumFractionDigits:2}):"0"}function r2(t){if(!t)return"";try{const s=new Date(t);return Number.isFinite(s.getTime())?s.toLocaleString():String(t)}catch{return String(t)}}function i2({tone:t,children:s}){const a=t==="gray"?"bg-slate-100 text-slate-700 border-slate-200":t==="blue"?"bg-blue-50 text-blue-700 border-blue-200":t==="teal"?"bg-teal-50 text-teal-700 border-teal-200":t==="red"?"bg-red-50 text-red-700 border-red-200":t==="yellow"?"bg-amber-50 text-amber-700 border-amber-200":t==="green"?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full border text-xs font-semibold ${a}`,children:s})}function o2(t){const s=String(t||"").toUpperCase();return s==="SUBMITTED"?"blue":s==="APPROVED"?"teal":s==="REJECTED"?"red":"gray"}async function d2({path:t,filename:s}){const a=Us(),n=xs(),l=await fetch(`${a}${t}`,{method:"GET",headers:{...n?{authorization:`Bearer ${n}`}:{}}});if(!l.ok){const c=await l.text();throw new Error(c||`Download failed (${l.status})`)}const r=await l.blob(),o=window.URL.createObjectURL(r),d=document.createElement("a");d.href=o,d.download=s,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(o),document.body.removeChild(d)}function c2({open:t,title:s,children:a,onClose:n}){return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 p-4",children:e.jsxs("div",{className:"w-full max-w-xl bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:s}),e.jsx("button",{onClick:n,className:"text-slate-500 hover:text-slate-800 text-sm",children:"Close"})]}),e.jsx("div",{className:"p-5",children:a})]})}):null}function m2(){const t=Ue(),{expenseId:s}=Dt(),[a,n]=i.useState("loading"),[l,r]=i.useState(null),[o,d]=i.useState(null),[c,m]=i.useState([]),[g,x]=i.useState("idle"),[j,h]=i.useState(null),[f,u]=i.useState(!1),[b,p]=i.useState("");async function y(){try{n("loading"),r(null);const[E,v]=await Promise.all([z(`/api/v1/expenses/${s}`),z(`/api/v1/expenses/${s}/receipts`)]);d((E==null?void 0:E.item)||null),m(Array.isArray(v==null?void 0:v.items)?v.items:Array.isArray(v)?v:[]),n("ready")}catch(E){r(E),n("error")}}if(i.useEffect(()=>{s&&y()},[s]),a==="loading")return e.jsx(de,{message:"Loading"});if(a==="error")return e.jsx(le,{error:l,onRetry:y});if(!o)return e.jsx(ye,{title:"Not found",description:"Expense could not be loaded."});const w=String(o.status||"").toUpperCase()==="SUBMITTED";async function S(){try{x("loading"),h(null),await z(`/api/v1/expenses/${s}/approve`,{method:"POST",body:{}}),x("idle"),await y()}catch(E){h(E),x("idle")}}async function N(){try{x("loading"),h(null),await z(`/api/v1/expenses/${s}/reject`,{method:"POST",body:{reason:b}}),x("idle"),u(!1),p(""),await y()}catch(E){h(E),x("idle")}}return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Expense Review"}),e.jsxs("p",{className:"text-slate-600 mt-1",children:["ID: ",o.id]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i2,{tone:o2(o.status),children:String(o.status||"")}),e.jsx("button",{onClick:()=>t(-1),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium hover:bg-slate-50",children:"Back"})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Expense Date"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-slate-900",children:String(o.expenseDate||"")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Amount"}),e.jsxs("div",{className:"mt-1 text-sm font-bold text-slate-900",children:[l2(o.amount)," ",o.currency||"INR"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Employee"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-slate-900",children:o.employeeName||o.employeeId||""})]})]}),e.jsxs("div",{className:"mt-4 border-t border-slate-200 pt-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Category"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-slate-900",children:o.categoryName||o.categoryId||""})]})}),e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Title"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:o.title||""}),e.jsx("div",{className:"mt-3 text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Description"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700 whitespace-pre-wrap",children:o.description||""})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-slate-200",children:e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Receipts"})}),c.length===0?e.jsx("div",{className:"p-4 text-sm text-slate-600",children:"No receipts uploaded."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"File"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Uploaded"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:c.map(E=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:E.fileName}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:r2(E.uploadedAt)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>d2({path:`/api/v1/expenses/${s}/receipts/${E.id}/download`,filename:E.fileName||"receipt"}),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium hover:bg-slate-50",children:"Download"})})]},E.id))})]})})]}),j?e.jsx("div",{className:"text-sm text-red-700",children:String(j.message||j)}):null,e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{disabled:!w||g==="loading",onClick:()=>u(!0),className:"px-4 py-2 rounded-lg border border-red-200 bg-white text-red-700 text-sm font-medium hover:bg-red-50 disabled:opacity-50",children:"Reject"}),e.jsx("button",{disabled:!w||g==="loading",onClick:S,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-teal-600 to-emerald-600 hover:from-teal-700 hover:to-emerald-700 text-white text-sm font-medium disabled:opacity-50",children:"Approve"})]}),e.jsx(c2,{open:f,title:"Reject expense",onClose:()=>u(!1),children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Reason (required)"}),e.jsx("textarea",{value:b,onChange:E=>p(E.target.value),rows:4,className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium",children:"Cancel"}),e.jsx("button",{disabled:g==="loading"||!String(b||"").trim(),onClick:N,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700 text-white text-sm font-medium disabled:opacity-50",children:"Reject"})]})]})})]})}function u2({status:t}){const s=String(t||"").toUpperCase(),a=s==="SUBMITTED"?"bg-amber-50 text-amber-700 border-amber-200":s==="APPROVED"?"bg-blue-50 text-blue-700 border-blue-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${a}`,children:s})}function x2(){const[t,s]=i.useState("loading"),[a,n]=i.useState(null),[l,r]=i.useState(null);async function o(){try{s("loading"),n(null);const c=await Te.listIncome({page:1,size:50});r(c),s("ready")}catch(c){n(c),s("error")}}i.useEffect(()=>{o()},[]);const d=i.useMemo(()=>Array.isArray(l==null?void 0:l.items)?l.items:[],[l]);return t==="loading"?e.jsx(de,{message:"Loading revenue"}):t==="error"?(a==null?void 0:a.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_READ"}}):e.jsx(le,{error:a,onRetry:o}):e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Revenue"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create and track income (UI only)."})]}),e.jsx($e,{to:"/manager/revenue/create",className:"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow hover:from-blue-700 hover:to-indigo-800 transition",children:"Create Income"})]}),d.length===0?e.jsx("div",{className:"mt-6",children:e.jsx(ye,{title:"No income",description:"No income entries found."})}):e.jsx("div",{className:"mt-6 overflow-hidden rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Client"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Title"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:d.map(c=>e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:String(c.incomeDate||"").slice(0,10)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:c.clientName||c.clientId||""}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-900",children:c.title}),e.jsxs("td",{className:"px-4 py-3 text-sm text-right font-semibold text-slate-900",children:["",Number(c.amount).toLocaleString("en-IN")]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(u2,{status:c.status})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx($e,{to:`/manager/revenue/${c.id}`,className:"px-3 py-1.5 rounded-lg text-sm font-semibold text-blue-700 hover:bg-blue-50",children:"View"})})]},c.id))})]})})]})})}function h2(){const t=Ue(),[s,a]=i.useState("loading"),[n,l]=i.useState(null),[r,o]=i.useState([]),[d,c]=i.useState(""),[m,g]=i.useState(!1),[x,j]=i.useState([]),[h,f]=i.useState({incomeDate:"",divisionId:"",categoryId:"",title:"",description:"",amount:""}),[u,b]=i.useState(!1),[p,y]=i.useState(null),w=i.useMemo(()=>!!(h.incomeDate&&h.divisionId&&h.categoryId&&String(h.title||"").trim()&&String(h.amount||"").trim()),[h]);function S(v,A){f(T=>({...T,[v]:A}))}async function N(){try{a("loading"),l(null);const v=await Te.listCategories();j(Array.isArray(v==null?void 0:v.items)?v.items:Array.isArray(v)?v:[]),a("ready")}catch(v){l(v),a("error")}}if(i.useEffect(()=>{N()},[]),i.useEffect(()=>{let v=!1;async function A(){try{g(!0);const T=xs(),C=await fetch(`${Us()}/api/v1/governance/divisions?page=1&pageSize=200`,{method:"GET",headers:{...T?{authorization:`Bearer ${T}`}:{}}});if(!C.ok){console.error("Failed to load divisions",C.status);return}if(!(C.headers.get("content-type")||"").includes("application/json")){console.error("Failed to load divisions (non-JSON response)");return}const D=await C.json(),R=Array.isArray(D==null?void 0:D.items)?D.items:Array.isArray(D)?D:[];v||o(R)}catch(T){console.error("Failed to load divisions",T)}finally{v||g(!1)}}return A(),()=>{v=!0}},[]),s==="loading")return e.jsx(de,{message:"Loading"});if(s==="error")return(n==null?void 0:n.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_CREATE"}}):e.jsx(le,{error:n,onRetry:N});async function E({submit:v}){try{if(b(!0),y(null),!w)throw new Error("Please fill required fields");const A=await Te.createIncome({incomeDate:h.incomeDate,divisionId:h.divisionId,categoryId:h.categoryId,title:h.title,description:h.description||null,amount:Number(h.amount),currency:"INR",clientId:null,invoiceNumber:null}),T=(A==null?void 0:A.item)||A,C=T==null?void 0:T.id;if(!C)throw new Error("Income creation failed");v&&await Te.submitIncome(C),t(`/manager/revenue/${C}`)}catch(A){y(A)}finally{b(!1)}}return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Create Income"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Manager view (UI only)."})]}),e.jsx($e,{to:"/manager/revenue",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Income Date"}),e.jsx("input",{type:"date",value:h.incomeDate,onChange:v=>S("incomeDate",v.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Division"}),e.jsxs("select",{required:!0,value:d,onChange:v=>{c(v.target.value),S("divisionId",v.target.value)},className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm bg-white",children:[e.jsx("option",{value:"",children:"Select Division"}),m?e.jsx("option",{value:"",children:"Loading divisions..."}):null,r.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Category"}),e.jsxs("select",{value:h.categoryId,onChange:v=>S("categoryId",v.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm bg-white",children:[e.jsx("option",{value:"",children:"Select"}),x.map(v=>e.jsxs("option",{value:v.id,children:[v.code," - ",v.name]},v.id))]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Title"}),e.jsx("input",{value:h.title,onChange:v=>S("title",v.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"e.g., Service Delivery"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Description"}),e.jsx("textarea",{value:h.description,onChange:v=>S("description",v.target.value),rows:4,className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"Optional"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Amount"}),e.jsx("input",{value:h.amount,onChange:v=>S("amount",v.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"0.00"})]})]})]}),p?e.jsx("div",{className:"mt-4 text-sm text-rose-700",children:String(p.message||p)}):null,e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 justify-end",children:[e.jsx("button",{disabled:u,onClick:()=>E({submit:!1}),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition disabled:opacity-50",children:"Save Draft"}),e.jsx("button",{disabled:u,onClick:()=>E({submit:!0}),className:"px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow disabled:opacity-50",children:"Submit"})]})]})})}function p2({status:t}){const s=String(t||"").toUpperCase(),a=s==="APPROVED"?"bg-blue-50 text-blue-700 border-blue-200":s==="SUBMITTED"?"bg-amber-50 text-amber-700 border-amber-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${a}`,children:s})}function f2(){const{id:t}=Dt(),[s,a]=i.useState("overview"),[n,l]=i.useState("loading"),[r,o]=i.useState(null),[d,c]=i.useState(null),[m,g]=i.useState([]),[x,j]=i.useState([]);async function h(){try{l("loading"),o(null);const[f,u,b]=await Promise.all([Te.getIncome(t),Te.listDocuments(t),Te.listPayments(t)]);c((f==null?void 0:f.item)||null),g(Array.isArray(u==null?void 0:u.items)?u.items:Array.isArray(u)?u:[]),j(Array.isArray(b==null?void 0:b.items)?b.items:Array.isArray(b)?b:[]),l("ready")}catch(f){o(f),l("error")}}return i.useEffect(()=>{t&&h()},[t]),n==="loading"?e.jsx(de,{message:"Loading income"}):n==="error"?(r==null?void 0:r.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_READ"}}):e.jsx(le,{error:r,onRetry:h}):d?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Income Detail"}),e.jsx(p2,{status:d.status})]}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:["ID: ",d.id]})]}),e.jsx($e,{to:"/manager/revenue",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"})]}),e.jsx("div",{className:"mt-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>a("overview"),className:`px-4 py-2 text-sm font-semibold rounded-t-xl ${s==="overview"?"bg-slate-50 border border-slate-200 border-b-white":"text-slate-600 hover:text-slate-800"}`,children:"Overview"}),e.jsx("button",{onClick:()=>a("documents"),className:`px-4 py-2 text-sm font-semibold rounded-t-xl ${s==="documents"?"bg-slate-50 border border-slate-200 border-b-white":"text-slate-600 hover:text-slate-800"}`,children:"Documents"}),e.jsx("button",{onClick:()=>a("payments"),className:`px-4 py-2 text-sm font-semibold rounded-t-xl ${s==="payments"?"bg-slate-50 border border-slate-200 border-b-white":"text-slate-600 hover:text-slate-800"}`,children:"Payments"}),e.jsx("button",{onClick:()=>a("timeline"),className:`px-4 py-2 text-sm font-semibold rounded-t-xl ${s==="timeline"?"bg-slate-50 border border-slate-200 border-b-white":"text-slate-600 hover:text-slate-800"}`,children:"Approval Timeline"})]})}),s==="overview"&&e.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Details"}),e.jsxs("dl",{className:"mt-3 grid grid-cols-2 gap-x-4 gap-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Income Date"}),e.jsx("dd",{className:"font-semibold text-slate-900",children:String(d.incomeDate||"").slice(0,10)})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Division"}),e.jsx("dd",{className:"font-semibold text-slate-900",children:d.divisionId})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Category"}),e.jsx("dd",{className:"font-semibold text-slate-900",children:d.categoryName||d.categoryId})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-slate-500",children:"Amount"}),e.jsxs("dd",{className:"font-semibold text-slate-900",children:["",Number(d.amount||0).toLocaleString("en-IN")]})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Description"}),e.jsx("div",{className:"mt-3 text-sm text-slate-700 whitespace-pre-wrap",children:d.description||""})]})]}),s==="documents"&&e.jsxs("div",{className:"mt-6 rounded-xl border border-slate-200 p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Documents"}),e.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:"Uploaded documents"})]}),e.jsx("span",{className:"text-xs text-slate-500",children:"Upload handled by Finance"})]}),m.length===0?e.jsx("div",{className:"mt-4 text-sm text-slate-600",children:"No documents uploaded."}):e.jsxs("div",{className:"mt-4 text-sm text-slate-600",children:["Documents: ",m.length]})]}),s==="payments"&&e.jsxs("div",{className:"mt-6 rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Payments"}),x.length===0?e.jsx("div",{className:"mt-4 text-sm text-slate-600",children:"No payments found."}):e.jsxs("div",{className:"mt-4 text-sm text-slate-600",children:["Payments recorded: ",x.length]})]}),s==="timeline"&&e.jsxs("div",{className:"mt-6 rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:"Approval Timeline"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"p-3 rounded-xl bg-slate-50 border border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Submitted"}),e.jsx("div",{className:"text-xs text-slate-500",children:d.submittedAt?String(d.submittedAt).replace("T"," ").slice(0,16):""})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-slate-50 border border-slate-200",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approved"}),e.jsx("div",{className:"text-xs text-slate-500",children:d.approvedAt?String(d.approvedAt).replace("T"," ").slice(0,16):""})]})]})]})]})}):e.jsx(ye,{title:"Not found",description:"Income could not be loaded."})}function g2(){var l,r,o,d;const{bootstrap:t}=he(),s=((l=t==null?void 0:t.rbac)==null?void 0:l.roles)||[],a=((r=t==null?void 0:t.user)==null?void 0:r.primaryDivisionId)||((o=t==null?void 0:t.user)==null?void 0:o.primary_division_id)||((d=t==null?void 0:t.user)==null?void 0:d.divisionId)||null;return s.includes("MANAGER")||s.includes("SUPER_ADMIN")?a?e.jsx(Uh,{hideConsolidated:!0,hideExport:!0,forceDivisionOnly:!0,initialDivisionId:a}):e.jsx("div",{className:"p-6",children:e.jsx(ge,{error:{message:"Division scope is required for Manager reports"}})}):e.jsx("div",{className:"p-6",children:e.jsx(ge,{error:{message:"Access denied"}})})}function v2(){return e.jsx(Ei,{title:"Inbox"})}function b2(t,s){const a=t||[];return a.includes("SYSTEM_FULL_ACCESS")||a.includes(s)}function j2(){var w;const t=Ue(),{bootstrap:s}=he(),a=((w=s==null?void 0:s.rbac)==null?void 0:w.permissions)||[],n=b2(a,"REIMBURSEMENT_VIEW_DIVISION"),[l,r]=i.useState("loading"),[o,d]=i.useState(null),[c,m]=i.useState(null),[g,x]=i.useState(1),j=20,[h,f]=i.useState("");async function u(){try{r("loading"),d(null);const S=await Je.getAllReimbursements({page:g,pageSize:j,status:"SUBMITTED",month:h||null});m(S),r("ready")}catch(S){d(S),r("error")}}i.useEffect(()=>{n&&u()},[g,h,n]);const b=i.useMemo(()=>Array.isArray(c==null?void 0:c.items)?c.items:[],[c]),p=i.useMemo(()=>Number((c==null?void 0:c.total)||0),[c]),y=i.useMemo(()=>Math.max(1,Math.ceil(p/j)),[p,j]);return n?l==="loading"?e.jsx(de,{message:"Loading approvals"}):l==="error"?e.jsx(le,{error:o,onRetry:u}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Reimbursement Approvals"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Review submitted claims for your division."})]}),e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-4",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Month"}),e.jsx("input",{type:"month",value:h,onChange:S=>{f(S.target.value),x(1)},className:"w-full px-3 py-2 rounded-xl border border-slate-200 text-sm bg-white"})]})})}),b.length===0?e.jsx(ye,{title:"No submitted claims",description:"There are no submitted reimbursements to review."}):e.jsx(Ci,{variant:"manager",rows:b,loading:!1,empty:"No submitted claims",onRowClick:S=>t(`/manager/reimbursements/${S.id}`)}),e.jsxs("div",{className:"flex items-center justify-between bg-white rounded-2xl border border-slate-200/60 shadow-sm px-4 py-3",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",g," of ",y," (Total: ",p,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{disabled:g<=1,onClick:()=>x(S=>Math.max(1,S-1)),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:g>=y,onClick:()=>x(S=>Math.min(y,S+1)),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Next"})]})]})]}):e.jsx(ye,{title:"No access",description:"You don't have permission to view division reimbursements."})}function bo(t,s){const a=t||[];return a.includes("SYSTEM_FULL_ACCESS")||a.includes(s)}function N2(t){const s=Number(t);return Number.isFinite(s)?s.toLocaleString("en-IN",{style:"currency",currency:"INR"}):""}function y2({open:t,onClose:s,onSubmit:a}){const[n,l]=i.useState(""),r=String(n||"").trim().length>0;return t?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:s}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-rose-50 to-pink-50 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Reject Claim"}),e.jsx("button",{onClick:s,className:"text-slate-600 hover:text-slate-900",children:""})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Reason (required)"}),e.jsx("textarea",{rows:4,value:n,onChange:o=>l(o.target.value),className:"mt-2 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:border-rose-500 focus:ring-2 focus:ring-rose-100 outline-none"})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-slate-200 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 rounded-xl text-sm font-semibold bg-slate-100 text-slate-700 hover:bg-slate-200",children:"Cancel"}),e.jsx("button",{disabled:!r,onClick:()=>a&&a(String(n||"").trim()),className:`px-4 py-2 rounded-xl text-sm font-semibold transition ${r?"bg-gradient-to-r from-rose-600 to-pink-600 text-white hover:from-rose-700 hover:to-pink-700":"bg-slate-200 text-slate-500"}`,children:"Reject"})]})]})]}):null}function w2(){var C;const{id:t}=Dt(),s=Ue(),{bootstrap:a}=he(),n=((C=a==null?void 0:a.rbac)==null?void 0:C.permissions)||[],l=bo(n,"REIMBURSEMENT_VIEW_DIVISION"),r=bo(n,"REIMBURSEMENT_APPROVE"),o=bo(n,"REIMBURSEMENT_REJECT"),[d,c]=i.useState("loading"),[m,g]=i.useState(null),[x,j]=i.useState(null),[h,f]=i.useState([]),[u,b]=i.useState([]),[p,y]=i.useState(!1),[w,S]=i.useState(!1);async function N(){try{c("loading"),g(null);const k=await Je.getReimbursementById(t),D=k==null?void 0:k.item;j(D);const[R,L]=await Promise.all([Je.listReceipts(t),Je.listPayments(t,{page:1,pageSize:200})]);f(Array.isArray(R==null?void 0:R.items)?R.items:Array.isArray(R)?R:[]),b(Array.isArray(L==null?void 0:L.items)?L.items:[]),c("ready")}catch(k){g(k),c("error")}}i.useEffect(()=>{l&&N()},[t,l]);const v=String((x==null?void 0:x.status)||"").toUpperCase()==="SUBMITTED";async function A(){if(x)try{y(!0),g(null),await Je.approveReimbursement(t,{version:x.version}),await N()}catch(k){g(k)}finally{y(!1)}}async function T(k){if(x)try{y(!0),g(null),await Je.rejectReimbursement(t,k,{version:x.version}),S(!1),await N()}catch(D){g(D)}finally{y(!1)}}return l?d==="loading"?e.jsx(de,{message:"Loading claim"}):d==="error"?e.jsx(le,{error:m,onRetry:N}):x?e.jsxs("div",{className:"max-w-5xl mx-auto space-y-5",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Reimbursement Review"}),e.jsx(kn,{status:x.status})]}),e.jsxs("p",{className:"text-slate-600 mt-1",children:["Employee: ",x.employeeName||x.employeeId]}),e.jsxs("p",{className:"text-slate-600",children:["ID: ",x.id]})]}),e.jsx("button",{onClick:()=>s("/manager/reimbursements"),className:"px-4 py-2 rounded-xl bg-slate-100 text-slate-700 text-sm font-semibold hover:bg-slate-200",children:"Back"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Title"}),e.jsx("div",{className:"text-sm font-bold text-slate-900 mt-1",children:x.title})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Amount"}),e.jsx("div",{className:"text-lg font-bold text-slate-900",children:N2(x.totalAmount)})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Scope"}),e.jsx("div",{className:"text-sm font-bold text-slate-900 mt-1",children:x.scope})]})]}),x.description?e.jsxs("div",{className:"mt-4 bg-white rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-600",children:"Description"}),e.jsx("div",{className:"text-sm text-slate-900 mt-1 whitespace-pre-wrap",children:x.description})]}):null,e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[o?e.jsx("button",{disabled:!v||p,onClick:()=>S(!0),className:`px-4 py-2 rounded-xl text-sm font-semibold transition ${!v||p?"bg-slate-200 text-slate-500":"bg-gradient-to-r from-rose-600 to-pink-600 text-white hover:from-rose-700 hover:to-pink-700"}`,children:"Reject"}):null,r?e.jsx("button",{disabled:!v||p,onClick:A,className:`px-4 py-2 rounded-xl text-sm font-semibold transition ${!v||p?"bg-slate-200 text-slate-500":"bg-gradient-to-r from-emerald-600 to-teal-600 text-white hover:from-emerald-700 hover:to-teal-700"}`,children:"Approve"}):null]})]}),m?e.jsx(le,{error:m,onRetry:N}):null,e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Receipts"}),(h||[]).length===0?e.jsx("div",{className:"mt-3 text-sm text-slate-600",children:"No receipts uploaded."}):e.jsx("div",{className:"mt-3 space-y-2",children:h.map(k=>e.jsxs("div",{className:"flex items-center justify-between gap-3 bg-slate-50 border border-slate-200 rounded-xl p-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:k.fileName}),e.jsxs("div",{className:"text-xs text-slate-600",children:[k.contentType,"  ",Number(k.fileSize||0).toLocaleString()," bytes"]})]}),e.jsx("button",{onClick:()=>Je.downloadReceipt(t,k.id,k.fileName),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm font-semibold hover:bg-slate-100",children:"Download"})]},k.id))})]}),e.jsx(Ai,{payments:u}),e.jsx(y2,{open:w,onClose:()=>S(!1),onSubmit:T})]}):e.jsx(ye,{title:"Not found",description:"Reimbursement not found."}):e.jsx(ye,{title:"No access",description:"You don't have permission to view this claim."})}function S2(){var A,T;const{bootstrap:t}=he(),[s,a]=i.useState(null),[n,l]=i.useState(null),[r,o]=i.useState(null),[d,c]=i.useState(null),[m,g]=i.useState(null),[x,j]=i.useState(!0),[h,f]=i.useState(null);if(i.useEffect(()=>{async function C(){try{j(!0);const k=await z("/api/v1/employees/me");a(k.item||k);const D=new Date().toLocaleDateString("en-CA");console.log("Current date (local):",D),console.log("Current date (ISO):",new Date().toISOString().slice(0,10));try{const L=(await z(`/api/v1/attendance/me?month=${new Date().toISOString().slice(0,7)}`)).items||[];console.log("Attendance records:",L),console.log("Looking for date:",D),L.length>0&&(console.log("First record date:",L[0].attendanceDate),console.log("First record status:",L[0].status));const _=L.find(I=>I.attendanceDate===D);console.log("Today's attendance:",_),l(_)}catch(R){console.warn("Failed to fetch attendance:",R),l(null)}try{const R=await z("/api/v1/timesheets/me"),L=R.items||R||[];let _=null;if(L.length>0){const I=L.find(G=>G.status==="DRAFT");I?_=I:_=L[0]}if(_){const I=await z(`/api/v1/timesheets/me/${_.id}`),G=I.item||I,O=(G==null?void 0:G.header)||G;o({weeklyStatus:(O==null?void 0:O.status)||"DRAFT",weekStart:(O==null?void 0:O.periodStart)||_.weekStart})}else o({weeklyStatus:null,weekStart:null})}catch(R){console.warn("Failed to fetch timesheets:",R),o({weeklyStatus:null,weekStart:null})}try{const R=await z("/api/v1/leave/balance/me");c(R)}catch(R){console.warn("Failed to fetch leave balance:",R),c({items:[]})}try{const R=await z("/api/v1/communications/notices");g(R)}catch(R){console.warn("Failed to fetch notices:",R),g({items:[]})}f(null)}catch(k){f(k)}finally{j(!1)}}C()},[]),x)return e.jsx("div",{className:"p-6",children:e.jsx(de,{message:"Loading your dashboard"})});if(h)return e.jsx("div",{className:"p-6",children:e.jsx(le,{error:h})});const u=C=>{switch(C){case"ACTIVE":return"Active";case"ON_HOLD":return"On-hold";case"EXITED":return"Exited";default:return C||""}},b=C=>{switch(C){case"ACTIVE":return"bg-green-100 text-green-800";case"ON_HOLD":return"bg-amber-100 text-amber-800";case"EXITED":return"bg-slate-100 text-slate-800";default:return"bg-slate-100 text-slate-800"}},p=C=>{switch(C){case"PRESENT":return"bg-emerald-100 text-emerald-800";case"ABSENT":return"bg-rose-100 text-rose-800";case"LEAVE":return"bg-amber-100 text-amber-800";default:return"bg-slate-100 text-slate-800"}},y=C=>{switch(C){case"PRESENT":return"Present";case"ABSENT":return"Absent";case"LEAVE":return"On Leave";default:return"Not Marked"}},w=C=>{switch(C){case"DRAFT":return"Draft";case"SUBMITTED":return"Submitted";case"PENDING":return"Pending";case"APPROVED":return"Approved";case"REJECTED":return"Rejected";default:return"No submission yet"}},S=C=>{switch(C){case"DRAFT":return"bg-slate-100 text-slate-800";case"SUBMITTED":return"bg-blue-100 text-blue-800";case"PENDING":return"bg-amber-100 text-amber-800";case"APPROVED":return"bg-green-100 text-green-800";case"REJECTED":return"bg-rose-100 text-rose-800";default:return"bg-slate-100 text-slate-800"}},N=C=>{if(!C||!Array.isArray(C.items))return"0 days";const k=["ANNUAL","SICK","CASUAL"];return`${C.items.filter(L=>{var _;return k.includes((_=L.leaveTypeCode)==null?void 0:_.toUpperCase())}).reduce((L,_)=>L+(typeof _.availableDays=="number"?_.availableDays:0),0)} days`},E=C=>{if(!C||!Array.isArray(C.items))return"Annual leave";const k=["ANNUAL","SICK","CASUAL"],R=C.items.filter(L=>{var _;return k.includes((_=L.leaveTypeCode)==null?void 0:_.toUpperCase())}).filter(L=>(L.availableDays||0)>0).map(L=>L.leaveTypeName||L.leaveTypeCode).slice(0,2);return R.length===0?"Annual leave":R.length===1?R[0]:`${R[0]} + ${R.length-1} more`},v=C=>{if(!C||!Array.isArray(C.items))return"No new notices";const k=C.items.filter(D=>!D.read).length;return k===0?"No new notices":`${k} new notice${k>1?"s":""}`};return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Employment Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Employee ID"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900 font-mono",children:(s==null?void 0:s.employeeCode)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Designation"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:(s==null?void 0:s.designation)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Reporting Manager"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:(s==null?void 0:s.reportingManager)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Employment Status"}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${b(s==null?void 0:s.status)}`,children:u(s==null?void 0:s.status)})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:""})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"Attendance"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Today"})]})]})}),e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${p(n==null?void 0:n.status)}`,children:y(n==null?void 0:n.status)}),(n==null?void 0:n.markedAt)&&e.jsxs("span",{className:"text-xs text-slate-500",children:["at ",new Date(n.markedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:n!=null&&n.status?`Marked via ${((A=n.source)==null?void 0:A.toLowerCase())||"system"}`:"Mark your attendance for today"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:""})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"Timesheets"}),e.jsx("p",{className:"text-sm text-slate-600",children:"This week"})]})]})}),e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${S(r==null?void 0:r.weeklyStatus)}`,children:w(r==null?void 0:r.weeklyStatus)})}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:r!=null&&r.weeklyStatus?`Week of ${r.weekStart||"this week"}`:"Submit your weekly timesheet"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:""})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"Leave"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Balance"})]})]})}),e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("div",{className:"font-medium",children:N(d)}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[E(d)," available"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-lg",children:""})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"Notices"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Updates"})]})]})}),e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("div",{className:"font-medium",children:v(m)}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:((T=m==null?void 0:m.items)==null?void 0:T.length)>0?`${m.items.length} total notice${m.items.length>1?"s":""}`:"Check back later for updates"})]})]})]}),e.jsxs("div",{className:"mt-8 bg-slate-50 rounded-xl border border-slate-200 p-6",children:[e.jsx("h3",{className:"font-semibold text-slate-900 mb-3",children:"Quick Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-700",children:"Joining Date"}),e.jsx("div",{className:"text-slate-600",children:s!=null&&s.createdAt?new Date(s.createdAt).toLocaleDateString():""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-700",children:"Email"}),e.jsx("div",{className:"text-slate-600",children:(s==null?void 0:s.email)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-700",children:"Phone"}),e.jsx("div",{className:"text-slate-600",children:(s==null?void 0:s.phone)||""})]})]})]})]})}function k2(){const{bootstrap:t}=he(),[s,a]=i.useState(null),[n,l]=i.useState(!0),[r,o]=i.useState(null);if(i.useEffect(()=>{async function g(){try{l(!0);const x=await z("/api/v1/employees/me");a(x.item||x),o(null)}catch(x){o(x)}finally{l(!1)}}g()},[]),n)return e.jsx("div",{className:"p-6",children:e.jsx(de,{message:"Loading your profile"})});if(r)return e.jsx("div",{className:"p-6",children:e.jsx(le,{error:r})});const d=g=>g&&`${g.firstName||""} ${g.lastName||""}`.trim()||"",c=g=>{switch(g){case"ACTIVE":return"Active";case"ON_HOLD":return"On-hold";case"EXITED":return"Exited";default:return g||""}},m=g=>{switch(g){case"ACTIVE":return"bg-green-100 text-green-800";case"ON_HOLD":return"bg-amber-100 text-amber-800";case"EXITED":return"bg-slate-100 text-slate-800";default:return"bg-slate-100 text-slate-800"}};return e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Full Name"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:d(s)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Email"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:(s==null?void 0:s.email)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Phone"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:(s==null?void 0:s.phone)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Employee ID"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900 font-mono",children:(s==null?void 0:s.employeeCode)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Joining Date"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:s!=null&&s.createdAt?new Date(s.createdAt).toLocaleDateString():""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Employment Status"}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${m(s==null?void 0:s.status)}`,children:c(s==null?void 0:s.status)})})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-slate-50 rounded-lg border border-slate-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),e.jsx("div",{className:"text-sm text-slate-700",children:e.jsx("strong",{children:"For profile corrections, please contact HR."})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Employment Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Designation"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:(s==null?void 0:s.designation)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Reporting Manager"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:(s==null?void 0:s.reportingManagerName)||""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Employment Type"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:(s==null?void 0:s.scope)==="COMPANY"?"Company":(s==null?void 0:s.scope)==="DIVISION"?"Division":""})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-500",children:"Division"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:(s==null?void 0:s.scope)==="DIVISION"?(s==null?void 0:s.primaryDivisionName)||"":"Not applicable"})]})]})]}),e.jsxs("div",{className:"bg-amber-50 rounded-xl border border-amber-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-amber-900 mb-3",children:"Important Information"}),e.jsxs("div",{className:"space-y-2 text-sm text-amber-800",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"Employee ID is immutable and cannot be changed."})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"Employment scope and division changes require HR approval."})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"Keep your contact information updated for important communications."})]})]})]})]})}function E2(){const{bootstrap:t}=he(),[s,a]=i.useState([]),[n,l]=i.useState(!0),[r,o]=i.useState(null),[d,c]=i.useState(null),m=()=>{const L=new Date,_=L.getFullYear(),I=String(L.getMonth()+1).padStart(2,"0"),G=String(L.getDate()).padStart(2,"0");return`${_}-${I}-${G}`},[g,x]=i.useState(m().slice(0,7)),[j,h]=i.useState(!1),[f,u]=i.useState(!1),[b,p]=i.useState(null);i.useEffect(()=>{const L=localStorage.getItem("todayAttendanceStatus"),_=localStorage.getItem("todayAttendanceDate"),I=m();L&&_===I&&(console.log("Loading today's attendance from localStorage:",{storedStatus:L,storedDate:_,today:I}),u(!0),p(L))},[]);const y=L=>{var _,I,G;return L?L.code==="FORBIDDEN"||L.status===403?"You are not allowed to mark attendance.":L.status===400?"Invalid attendance request. Please try again.":L.status===409?"Attendance already marked for today.":(_=L.message)!=null&&_.includes("Self marking is disabled")?"Self marking is currently disabled.":(I=L.message)!=null&&I.includes("Past dates are not allowed")?"Cannot mark attendance for past dates.":(G=L.message)!=null&&G.includes("Future dates are not allowed")?"Cannot mark attendance for future dates.":"Something went wrong. Please try again later.":null},w=()=>{c(null)};i.useEffect(()=>{if(d){const L=setTimeout(()=>{c(null)},5e3);return()=>clearTimeout(L)}},[d]),i.useEffect(()=>{async function L(){try{l(!0),c(null);let _;try{console.log("Trying API without month parameter..."),_=await z("/api/v1/attendance/me"),console.log("API without month response:",JSON.stringify(_,null,2)),console.log("Response type:",typeof _),console.log("Has items property:","items"in _),console.log("Items length:",_.items?_.items.length:"N/A"),(!_.items||_.items.length===0)&&(console.log("Empty response, trying with month parameter..."),_=await z(`/api/v1/attendance/me?month=${g}`),console.log("API with month response:",JSON.stringify(_,null,2)),console.log("Response type:",typeof _),console.log("Has items property:","items"in _),console.log("Items length:",_.items?_.items.length:"N/A"))}catch(F){console.error("API call failed:",F),_={items:[]}}let I=[];Array.isArray(_)?I=_:_&&Array.isArray(_.items)?I=_.items:_&&Array.isArray(_.data)?I=_.data:_&&(I=[_]),console.log("Processed attendance data:",I),a(I),o(null);const G=m(),O=I.find(F=>F.attendanceDate===G);console.log("Today Check Debug:",{today:G,attendanceDataLength:I.length,attendanceData:JSON.stringify(I,null,2),todayRecord:JSON.stringify(O,null,2),todayMarked:!!O}),u(!!O)}catch(_){console.error("Attendance data fetch error:",_),o(_),c(y(_))}finally{l(!1)}}L()},[]);const S=async L=>{try{h(!0),c(null);const _=m();await z("/api/v1/attendance/me",{method:"POST",body:{date:_,status:L}}),console.log("Refreshing attendance data after marking..."),await new Promise(W=>setTimeout(W,1e3));let I=[];try{const W=await z("/api/v1/attendance/me");if(console.log("Refresh response 1 (no month):",JSON.stringify(W,null,2)),I=W.items||[],I.length===0){const M=await z(`/api/v1/attendance/me?month=${g}`);console.log("Refresh response 2 (with month):",JSON.stringify(M,null,2)),I=M.items||[]}}catch(W){console.error("Refresh failed:",W)}const G=I;a(Array.isArray(G)?G:[]),o(null);const O=m(),F=G.find(W=>W.attendanceDate===O);if(console.log("After refresh - Today check:",{today:O,todayRecord:F,todayMarked:!!F}),!F&&L){console.log("API returned empty but marking was successful, storing status locally:",L);const W=m();localStorage.setItem("todayAttendanceStatus",L),localStorage.setItem("todayAttendanceDate",W),u(!0),p(L)}else if(u(!!F),F){p(F.status);const W=m();localStorage.setItem("todayAttendanceStatus",F.status),localStorage.setItem("todayAttendanceDate",W)}}catch(_){console.error("Attendance marking error:",_),o(_),c(y(_))}finally{h(!1)}},N=L=>{const _=L.getFullYear(),I=L.getMonth(),G=new Date(_,I,1),F=new Date(_,I+1,0).getDate(),W=G.getDay(),$=[];for(let M=0;M<W;M++)$.push(null);for(let M=1;M<=F;M++)$.push(new Date(_,I,M));return $},E=L=>{const _=L.getFullYear()+"-"+String(L.getMonth()+1).padStart(2,"0")+"-"+String(L.getDate()).padStart(2,"0");let I=s.find(O=>O.attendanceDate===_);!I&&_===m()&&f&&b&&(I={attendanceDate:_,status:b,source:"SELF",isLocal:!0});const G=m();return _===G&&console.log("getAttendanceForDate Debug for today:",{dateStr:_,today:G,result:JSON.stringify(I,null,2),allAttendance:JSON.stringify(s,null,2),todayMarked:f,todayAttendanceStatus:b}),I},v=L=>{const _=new Date;_.setHours(0,0,0,0);const I=new Date(L);return I.setHours(0,0,0,0),I.getTime()===_.getTime()},A=L=>{const _=new Date;_.setHours(0,0,0,0);const I=new Date(L);return I.setHours(0,0,0,0),I.getTime()>_.getTime()},T=L=>{const _=new Date;_.setHours(0,0,0,0);const I=new Date(L);return I.setHours(0,0,0,0),I.getTime()<_.getTime()},C=L=>{switch(L){case"PRESENT":return{text:"Present",icon:"",class:"text-green-600 bg-green-50"};case"ABSENT":return{text:"Absent",icon:"",class:"text-gray-500 bg-gray-50"};case"LEAVE":return{text:"Leave",icon:"L",class:"text-blue-600 border border-blue-200 bg-blue-50"};default:return{text:"",icon:"",class:"text-gray-400"}}};if(n)return e.jsx("div",{className:"p-6",children:e.jsx(de,{message:"Loading attendance data"})});if(r)return e.jsx("div",{className:"p-6",children:e.jsx(le,{error:r})});const k=new Date(g+"-01"),D=N(k),R=new Date;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 py-6 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[d&&e.jsx("div",{className:"animate-fade-in",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("p",{className:"text-sm text-red-800 font-medium",children:"Error"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:d})]}),e.jsx("div",{className:"ml-auto pl-3",children:e.jsx("button",{onClick:w,className:"inline-flex text-red-400 hover:text-red-600 focus:outline-none focus:text-red-600 transition-colors duration-200",children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})})}),e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-3 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Select Month"]}),e.jsx("input",{type:"month",value:g,onChange:L=>x(L.target.value),max:m().slice(0,7),className:"w-full sm:w-auto px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-sm font-medium"})]}),e.jsxs("div",{className:"text-center sm:text-right bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-blue-700 mb-1",children:"Current Month"}),e.jsx("div",{className:"text-xl font-bold text-slate-900",children:k.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:f?" Attendance Marked":" Pending"})]})]})}),v(R)&&e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Today's Attendance"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-600 mb-1",children:R.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-lg font-medium text-slate-900",children:f?"Marked for today":"Not marked yet"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>S("PRESENT"),disabled:f||j,className:"flex-1 sm:flex-none px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors",children:j?"Marking...":"Present"}),e.jsx("button",{onClick:()=>S("ABSENT"),disabled:f||j,className:"flex-1 sm:flex-none px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors",children:j?"Marking...":"Absent"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg p-6 mb-8",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Attendance Calendar"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-3",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(L=>e.jsx("div",{className:"text-center text-xs font-bold text-slate-600 py-3 bg-slate-50 rounded-lg",children:L},L))}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:D.map((L,_)=>{if(!L)return e.jsx("div",{className:"aspect-square"},`empty-${_}`);const I=E(L),G=C(I==null?void 0:I.status),O=v(L),F=A(L),W=T(L);return e.jsxs("div",{className:`
                      aspect-square border-2 rounded-xl p-2 flex flex-col items-center justify-center transition-all duration-300 transform hover:scale-105
                      ${O?"border-blue-400 bg-gradient-to-br from-blue-50 to-indigo-50 shadow-lg ring-2 ring-blue-200":"border-slate-200"}
                      ${W?"bg-gray-50 opacity-60 cursor-not-allowed":""}
                      ${F?"bg-gray-50 opacity-50 cursor-not-allowed":"bg-white hover:shadow-md"}
                      
                    `,children:[e.jsx("div",{className:`text-sm font-bold ${O?"text-blue-700":W?"text-gray-500":"text-slate-700"}`,children:L.getDate()}),I&&e.jsx("div",{className:`text-xs px-1.5 py-0.5 rounded-full mt-1 font-medium ${G.class}`,children:G.icon}),!I&&W&&e.jsx("div",{className:"text-xs text-gray-400 mt-1 font-medium",children:"Closed"}),!I&&F&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:""}),O&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full animate-pulse"}),!1]},L.toISOString())})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-gradient-to-r from-slate-50 to-blue-50",children:e.jsxs("h2",{className:"text-xl font-bold text-slate-900 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Attendance Details"]})}),e.jsx("div",{className:"block sm:hidden p-4 space-y-3",children:D.filter(L=>L).map(L=>{const _=E(L),I=C(_==null?void 0:_.status),G=v(L),O=A(L),F=T(L);return e.jsxs("div",{className:`
                  border rounded-xl p-4 transition-all duration-200
                  ${G?"border-blue-300 bg-gradient-to-r from-blue-50 to-indigo-50":"border-slate-200 bg-white"}
                  ${F?"opacity-60":""}
                  ${O?"opacity-50":""}
                `,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:`text-lg font-bold ${G?"text-blue-700":"text-slate-900"}`,children:L.getDate()}),e.jsx("div",{className:"text-sm text-slate-600",children:L.toLocaleDateString("en-US",{weekday:"short",month:"short",year:"numeric"})})]}),e.jsx("div",{className:"text-right",children:_?e.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-bold rounded-full ${I.class}`,children:I.text}):e.jsx("span",{className:"text-slate-400 text-sm",children:""})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:[G&&" Today",F&&" Closed",O&&" Future"]}),e.jsx("div",{className:"flex gap-2",children:O?e.jsx("span",{className:"text-slate-400 text-xs px-2 py-1 bg-slate-100 rounded-lg",children:"Not Allowed"}):(_==null?void 0:_.status)==="LEAVE"?e.jsx("span",{className:"text-slate-400 text-xs px-2 py-1 bg-blue-100 rounded-lg",children:"Leave"}):G&&!f?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>S("PRESENT"),disabled:j,className:"px-3 py-1.5 text-xs font-bold bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 disabled:from-slate-300 disabled:to-slate-400 transition-all duration-200 shadow-sm",children:j?"...":"Present"}),e.jsx("button",{onClick:()=>S("ABSENT"),disabled:j,className:"px-3 py-1.5 text-xs font-bold bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg hover:from-gray-600 hover:to-gray-700 disabled:from-slate-300 disabled:to-slate-400 transition-all duration-200 shadow-sm",children:j?"...":"Absent"})]}):F?e.jsx("span",{className:"text-slate-400 text-xs px-2 py-1 bg-gray-100 rounded-lg",children:"Closed"}):e.jsx("span",{className:"text-slate-400 text-xs",children:""})})]})]},L.toISOString())})}),e.jsx("div",{className:"hidden sm:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Day"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-100",children:D.filter(L=>L).map(L=>{const _=E(L),I=C(_==null?void 0:_.status),G=v(L),O=A(L),F=T(L);return e.jsxs("tr",{className:`
                      transition-all duration-200 hover:bg-slate-50
                      ${G?"bg-gradient-to-r from-blue-50 to-indigo-50":""}
                      ${F?"opacity-60":""}
                      ${O?"opacity-50":""}
                    `,children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900",children:L.toLocaleDateString()}),G&&e.jsx("div",{className:"text-xs text-blue-600 font-medium mt-1",children:" Today"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`text-sm font-medium ${F?"text-gray-500":"text-slate-600"}`,children:L.toLocaleDateString("en-US",{weekday:"short"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:_?e.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-bold rounded-full ${I.class}`,children:I.text}):e.jsx("span",{className:"text-slate-400 text-sm",children:""})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:O?e.jsx("span",{className:"text-slate-400 text-xs px-3 py-1.5 bg-slate-100 rounded-lg font-medium",children:"Not Allowed"}):(_==null?void 0:_.status)==="LEAVE"?e.jsx("span",{className:"text-slate-400 text-xs px-3 py-1.5 bg-blue-100 rounded-lg font-medium",children:"Leave day"}):G&&!f?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>S("PRESENT"),disabled:j,className:"px-4 py-2 text-xs font-bold bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 disabled:from-slate-300 disabled:to-slate-400 transition-all duration-200 shadow-sm hover:shadow-md",children:j?"Marking...":"Present"}),e.jsx("button",{onClick:()=>S("ABSENT"),disabled:j,className:"px-4 py-2 text-xs font-bold bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg hover:from-gray-600 hover:to-gray-700 disabled:from-slate-300 disabled:to-slate-400 transition-all duration-200 shadow-sm hover:shadow-md",children:j?"Marking...":"Absent"})]}):F?e.jsx("span",{className:"text-slate-400 text-xs px-3 py-1.5 bg-gray-100 rounded-lg font-medium",children:"Closed"}):e.jsx("span",{className:"text-slate-400 text-xs",children:""})})]},L.toISOString())})})]})})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Important Information"}),e.jsxs("div",{className:"space-y-3 text-sm text-slate-700",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"Attendance does not affect salary directly"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"Leave days are auto-synced from leave system"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"Locked months cannot be edited"})]})]})]})]})}function hr(...t){return t.filter(Boolean).join(" ")}function C2(t,s){let a;return function(...l){const r=()=>{clearTimeout(a),t(...l)};clearTimeout(a),a=setTimeout(r,s)}}function A2(){var Re,ne;const{bootstrap:t}=he(),[s,a]=i.useState([]),[n,l]=i.useState(!0),[r,o]=i.useState(null),[d,c]=i.useState(!1),[m,g]=i.useState(new Set),[x,j]=i.useState(!1),[h,f]=i.useState("idle"),[u,b]=i.useState(null),[p,y]=i.useState(null),[w,S]=i.useState({}),[N,E]=i.useState({weekStart:null,totalHours:0,status:"DRAFT",locked:!1,entries:[]}),v=t==null?void 0:t.employee,A=(v==null?void 0:v.scope)||"DIVISION",T=v==null?void 0:v.divisionId,C=(t==null?void 0:t.systemConfig)||{},k=parseInt((Re=C==null?void 0:C.TIMESHEET_MAX_HOURS_PER_DAY)==null?void 0:Re.value)||8,[D,R]=i.useState({}),L=i.useRef({}),_=()=>{const H=new Date,te=H.getDay(),q=H.getDate()-te+(te===0?-6:1);return new Date(H.setDate(q)).toISOString().split("T")[0]},I=H=>{const te=[],q=new Date(H);for(let Y=0;Y<7;Y++){const xe=new Date(q);xe.setDate(q.getDate()+Y);const J=xe.toISOString().split("T")[0];te.push({date:J,hours:"",division:A==="COMPANY"?"":T,description:"",project:null,isExpanded:!1})}return te};i.useEffect(()=>{async function H(){try{l(!0);const te=await z("/api/v1/timesheets/me"),q=te.items||te||[];a(Array.isArray(q)?q:[]);let Y=null;if(q.length>0){const xe=q.find(J=>J.status==="DRAFT");xe?Y=xe:Y=q[0]}if(Y){const xe=await z(`/api/v1/timesheets/me/${Y.id}`),J=xe.item||xe,me=(J==null?void 0:J.header)||J,K=(J==null?void 0:J.worklogs)??[],be=me==null?void 0:me.periodStart,je=(me==null?void 0:me.totalHours)??(K==null?void 0:K.reduce((Ae,Se)=>Ae+(Se.hours??0),0))??0,pe=K&&K.length>0?K.map(Ae=>{var Se;return{date:Ae.workDate,hours:((Se=Ae.hours)==null?void 0:Se.toString())||"0",description:Ae.task||Ae.description||"",project:Ae.projectId||null}}):I(be);E({weekStart:be,totalHours:je,status:(me==null?void 0:me.status)||"DRAFT",locked:(me==null?void 0:me.locked)??!1,entries:pe,approvalMetadata:(me==null?void 0:me.approvalMetadata)||null})}else{const xe=_();E({weekStart:xe,totalHours:0,status:"DRAFT",locked:!1,entries:I(xe),approvalMetadata:null})}o(null)}catch(te){o(te)}finally{l(!1)}}H()},[]);const G=i.useMemo(()=>N.entries.reduce((H,te)=>H+(parseFloat(te.hours)||0),0),[N.entries]),O=i.useMemo(()=>{const H={totalHoursValid:G>0,descriptionsCompleted:N.entries.every(te=>!te.hours||parseFloat(te.hours)===0||te.description&&te.description.trim().length>0),noFutureEntries:N.entries.every(te=>{if(!te.hours||parseFloat(te.hours)===0)return!0;const q=new Date(te.date),Y=new Date;return Y.setHours(0,0,0,0),q<=Y}),divisionValid:A==="DIVISION"||N.entries.every(te=>!te.hours||parseFloat(te.hours)===0||te.division)};return{...H,allValid:Object.values(H).every(Boolean)}},[N.entries,G,A]),F=async H=>{try{const te=await z(`/api/v1/timesheets/me/${H}`),q=te.item||te;return((q==null?void 0:q.worklogs)??[]).reduce((xe,J)=>xe+(J.hours||0),0)}catch(te){return console.error("Error fetching worklogs for total hours:",te),0}},[W,$]=i.useState({});i.useEffect(()=>{const H=async()=>{const te=s.filter(Y=>Y.status!=="DRAFT"),q={};for(const Y of te)Y.id&&!Y.totalHours?q[Y.id]=await F(Y.id):q[Y.id]=Y.totalHours||0;$(q)};s.length>0&&H()},[s]),i.useEffect(()=>{},[]);const M=i.useCallback(C2(async H=>{if(!(!H.hours||parseFloat(H.hours)===0||!H.description||!H.description.trim()))try{R(te=>({...te,[H.date]:"saving"})),await z("/api/v1/timesheets/me",{method:"POST",body:{workDate:H.date,task:H.description,hours:Number(H.hours),description:H.description||null,projectId:H.project||null}}),R(te=>({...te,[H.date]:"saved"})),setTimeout(()=>{R(te=>({...te,[H.date]:null}))},2e3)}catch(te){console.error("Auto-save failed:",te),R(q=>({...q,[H.date]:"error"})),setTimeout(()=>{R(q=>({...q,[H.date]:null}))},3e3)}},800),[]),P=(H,te,q)=>{const Y={...N};if(Y.entries=[...Y.entries],Y.entries[H]={...Y.entries[H],[te]:q},E(Y),te==="hours"||te==="description"||te==="project"){const xe=Y.entries[H];L.current[xe.date]&&clearTimeout(L.current[xe.date]),L.current[xe.date]=setTimeout(()=>{M(xe)},800)}},V=async H=>{var te;try{if(!H||H===""||H===void 0){console.warn("Invalid startDate provided to loadWeek:",H);return}console.log("Loading week for startDate:",H);const Y=(te=(await z("/api/v1/timesheets/me")).items)==null?void 0:te.find(Se=>Se.periodStart===H),xe=I(H);if(!Y){console.log("No existing sheet found, creating new week for:",H),E({weekStart:H,status:"DRAFT",locked:!1,entries:xe,totalHours:0,approvalMetadata:null});return}const J=await z(`/api/v1/timesheets/me/${Y.id}`),me=J.item||J;console.log("Full sheet data:",me);const K=(me==null?void 0:me.header)||me,be=(me==null?void 0:me.worklogs)??[],je=(K==null?void 0:K.totalHours)??(be==null?void 0:be.reduce((Se,Me)=>Se+(Me.hours??0),0))??0,pe=xe.map(Se=>{var ce;const Me=be.find(Ce=>Ce.workDate===Se.date);return Me?{...Se,hours:((ce=Me.hours)==null?void 0:ce.toString())||"0",description:Me.task||Me.description||"",project:Me.projectId||null}:{...Se,hours:"0",description:"",project:null}}),Ae={weekStart:(K==null?void 0:K.periodStart)??H,status:(K==null?void 0:K.status)??"DRAFT",locked:(K==null?void 0:K.locked)??!1,entries:pe,totalHours:je,approvalMetadata:(K==null?void 0:K.approvalMetadata)||null};console.log("Setting week state from loadWeek:",Ae),E(Ae)}catch(q){console.error("Error loading week:",q)}},U=H=>{const te=new Set(m);te.has(H)?te.delete(H):te.add(H),g(te)},B=H=>{var xe,J,me,K,be,je,pe;const te=(me=(J=(xe=H==null?void 0:H.response)==null?void 0:xe.data)==null?void 0:J.error)==null?void 0:me.code,q=((je=(be=(K=H==null?void 0:H.response)==null?void 0:K.data)==null?void 0:be.error)==null?void 0:je.message)||"",Y=(pe=H==null?void 0:H.response)==null?void 0:pe.status;if(te==="INTERNAL"){o({title:"Server Error",message:"We're having trouble saving your timesheet right now. Please try again in a moment."});return}if(q.includes("duplicate key value")){o({title:"Duplicate Timesheet",message:"A timesheet for this period already exists. Please refresh the page."});return}if(q.includes("Total hours exceed")){o({title:"Hours Limit Exceeded",message:"You have exceeded the maximum allowed 8 hours for a day. Please adjust your entries."});return}if(Y===400){o({title:"Validation Error",message:"Please fill all required fields before submitting."});return}o({title:"Submission Error",message:"Something went wrong. Please try again."})},Q=async()=>{var H;try{c(!0);const te=N.entries.filter(J=>parseFloat(J.hours)>0&&J.description&&J.description.trim()!=="");if(te.length===0){o({title:"Validation Error",message:"Please fill all required fields before submitting."});return}console.log(`Submitting ${te.length} entries sequentially...`);let q=null;for(const J of te){const me={workDate:J.date,task:J.description,hours:Number(J.hours),description:J.description||null,projectId:J.project||null};console.log("Submitting entry:",me);try{const K=await z("/api/v1/timesheets/me",{method:"POST",body:me});console.log("Entry submitted successfully:",J.date),!q&&((H=K==null?void 0:K.header)!=null&&H.id)&&(q=K.header.id,console.log("Found timesheet ID:",q))}catch(K){throw console.error("Failed to submit entry:",J.date,K),K}}if(!q)throw new Error("No timesheet ID found after saving worklogs");console.log("All entries submitted successfully, submitting timesheet...");const Y=await z(`/api/v1/timesheets/${q}/submit`,{method:"POST",body:{}});console.log("Submit response:",Y);const xe=Y.item||Y;if(console.log("Submitted timesheet data:",xe),xe){const J=(xe==null?void 0:xe.header)||xe,me=(xe==null?void 0:xe.worklogs)??[],K=(J==null?void 0:J.totalHours)??(me==null?void 0:me.reduce((Me,ce)=>Me+(ce.hours??0),0))??0,be=me&&me.length>0?me.map(Me=>{var ce;return{date:Me.workDate,hours:((ce=Me.hours)==null?void 0:ce.toString())||"0",description:Me.task||Me.description||"",project:Me.projectId||null}}):I(N.weekStart),je={weekStart:(J==null?void 0:J.periodStart)??N.weekStart,status:(J==null?void 0:J.status)??"DRAFT",locked:(J==null?void 0:J.locked)??!1,entries:be,totalHours:K,approvalMetadata:(J==null?void 0:J.approvalMetadata)||null};console.log("Setting new week state:",je),console.log("New status will be:",J==null?void 0:J.status),E(je);const pe=await z("/api/v1/timesheets/me"),Ae=pe.items||pe||[],Se=Array.isArray(Ae)?Ae.map(Me=>Me.id===(J==null?void 0:J.id)?{...Me,totalHours:K,status:J==null?void 0:J.status,submittedAt:(J==null?void 0:J.submittedAt)||Me.submittedAt}:Me):Ae;a(Se),o({title:"Success",message:"Timesheet submitted successfully."})}else throw new Error("No timesheet data returned from submit API")}catch(te){console.error("Submission error:",te),B(te)}finally{c(!1)}},ae=H=>{const te={DRAFT:"bg-slate-100 text-slate-800",SUBMITTED:"bg-blue-100 text-blue-800",APPROVED:"bg-emerald-100 text-emerald-800",LOCKED:"bg-slate-800 text-white"};return te[H]||te.DRAFT},ie=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],we=H=>{if(!H)return"";try{const te=new Date(H);return Number.isFinite(te.getTime())?te.toLocaleString():String(H)}catch{return String(H)}},De=async H=>{try{if(j(!0),f("loading"),b(null),y(null),!(H!=null&&H.id))throw new Error("Timesheet id missing");const te=await z(`/api/v1/timesheets/me/${H.id}`),q=(te==null?void 0:te.item)||te,Y=(q==null?void 0:q.header)||q,xe=[Y==null?void 0:Y.submittedBy,Y==null?void 0:Y.approvedL1By,Y==null?void 0:Y.approvedL2By,Y==null?void 0:Y.rejectedBy].filter(Boolean).map(K=>String(K)),me=Array.from(new Set(xe)).filter(K=>w[K]===void 0);if(me.length>0)try{const K=await z(`/api/v1/app/users/resolve?ids=${encodeURIComponent(me.join(","))}`),be=Array.isArray(K==null?void 0:K.items)?K.items:[];S(je=>{const pe={...je};for(const Ae of be)Ae!=null&&Ae.id&&(pe[String(Ae.id)]=Ae.displayName||null);for(const Ae of me)pe[String(Ae)]===void 0&&(pe[String(Ae)]=null);return pe})}catch{S(K=>{const be={...K};for(const je of me)be[String(je)]===void 0&&(be[String(je)]=null);return be})}y({id:Y==null?void 0:Y.id,periodStart:Y==null?void 0:Y.periodStart,periodEnd:Y==null?void 0:Y.periodEnd,status:Y==null?void 0:Y.status,submittedAt:Y==null?void 0:Y.submittedAt,submittedBy:Y==null?void 0:Y.submittedBy,approvedL1At:Y==null?void 0:Y.approvedL1At,approvedL1By:Y==null?void 0:Y.approvedL1By,approvedL2At:Y==null?void 0:Y.approvedL2At,approvedL2By:Y==null?void 0:Y.approvedL2By,rejectedAt:Y==null?void 0:Y.rejectedAt,rejectedBy:Y==null?void 0:Y.rejectedBy,rejectedReason:Y==null?void 0:Y.rejectedReason}),f("ready")}catch(te){b(te),f("error")}},Z=()=>{j(!1),f("idle"),b(null),y(null)},ve=H=>H?w[String(H)]||String(H):"";if(n)return e.jsx("div",{className:"p-6",children:e.jsx(de,{message:"Loading timesheets"})});if(r)return e.jsx("div",{className:"p-6",children:e.jsx(le,{error:r})});const re=!((N==null?void 0:N.status)==="DRAFT"||(N==null?void 0:N.status)==="REJECTED");return e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Week"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:N.weekStart,onChange:H=>{const te=H.target.value;E(q=>({...q,weekStart:te})),V(te)},className:"rounded-md border-slate-300 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsxs("span",{className:"text-sm text-slate-600",children:[N.weekStart&&new Date(N.weekStart).toLocaleDateString()," -",N.weekStart&&new Date(new Date(N.weekStart).getTime()+6*24*60*60*1e3).toLocaleDateString()]})]})]}),A==="COMPANY"&&e.jsx("span",{className:"inline-flex items-center rounded-full bg-amber-50 px-2 py-1 text-xs font-medium text-amber-800",children:"Shared"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Total Hours"}),e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:G})]}),e.jsx("span",{className:hr("inline-flex px-3 py-1 text-sm font-medium rounded-full",ae(N.status)),children:N.status})]})]}),N.approvalMetadata&&e.jsx("div",{className:"border-t border-slate-200 pt-4 mt-4",children:e.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-600",children:[N.approvalMetadata.submittedAt&&e.jsxs("div",{children:["Submitted at ",new Date(N.approvalMetadata.submittedAt).toLocaleString()]}),N.approvalMetadata.approvedBy&&e.jsxs("div",{children:["Approved by ",N.approvalMetadata.approvedBy]}),N.approvalMetadata.approvedAt&&e.jsxs("div",{children:["Approved at ",new Date(N.approvalMetadata.approvedAt).toLocaleString()]}),N.approvalMetadata.rejectionReason&&e.jsxs("div",{className:"text-rose-600",children:["Reason: ",N.approvalMetadata.rejectionReason]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm mb-6",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Hours"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider w-8"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:N.entries.map((H,te)=>{var xe;const q=m.has(te),Y=new Date(H.date)>new Date;return e.jsxs(Ca.Fragment,{children:[e.jsxs("tr",{className:Y?"bg-amber-50":"",children:[e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:ie[te]}),e.jsx("div",{className:"text-sm text-slate-600",children:new Date(H.date).toLocaleDateString()}),Y&&e.jsx("div",{className:"text-xs text-amber-600 mt-1",children:"Future date"})]}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[e.jsx("input",{type:"number",min:"0",max:k,step:"0.5",value:H.hours??"0",onChange:J=>P(te,"hours",J.target.value),disabled:re,className:"w-20 px-2 py-1 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-slate-500 disabled:bg-slate-50",placeholder:"0"}),parseFloat(H.hours)>k&&e.jsxs("div",{className:"text-xs text-rose-600 mt-1",children:["Max ",k," hours"]})]}),e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("input",{type:"text",value:H.description??"",onChange:J=>P(te,"description",J.target.value),disabled:re,className:"w-full px-2 py-1 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-slate-500 disabled:bg-slate-50",placeholder:"Task description"}),H.hours&&parseFloat(H.hours)>0&&!H.description&&e.jsx("div",{className:"text-xs text-rose-600 mt-1",children:"Description required"}),D[H.date]&&e.jsxs("div",{className:hr("text-xs mt-1 flex items-center gap-1",D[H.date]==="saving"&&"text-blue-600",D[H.date]==="saved"&&"text-green-600",D[H.date]==="error"&&"text-red-600"),children:[D[H.date]==="saving"&&e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}),D[H.date]==="saved"&&e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]}),D[H.date]==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Save failed"]})]})]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>U(te),disabled:re,className:"text-slate-400 hover:text-slate-600 disabled:opacity-50",children:e.jsx("svg",{className:hr("w-4 h-4 transition-transform",q&&"rotate-90"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})})]}),q&&e.jsx("tr",{className:"bg-slate-50",children:e.jsx("td",{colSpan:"4",className:"px-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[A==="COMPANY"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Division"}),e.jsxs("select",{value:H.division||"",onChange:J=>P(te,"division",J.target.value),disabled:re,className:"w-full rounded-md border-slate-300 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select Division"}),(xe=t==null?void 0:t.divisions)==null?void 0:xe.map(J=>e.jsx("option",{value:J.id,children:J.name},J.id))]}),H.hours&&parseFloat(H.hours)>0&&!H.division&&e.jsx("div",{className:"text-xs text-rose-600 mt-1",children:"Division required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Project / Program"}),e.jsx("input",{type:"text",value:H.project||"",onChange:J=>P(te,"project",J.target.value),disabled:re,className:"w-full rounded-md border-slate-300 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"Work Type"}),e.jsxs("select",{value:H.workType||"",onChange:J=>P(te,"workType",J.target.value),disabled:re,className:"w-full rounded-md border-slate-300 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"DEVELOPMENT",children:"Development"}),e.jsx("option",{value:"MEETING",children:"Meeting"}),e.jsx("option",{value:"REVIEW",children:"Review"}),e.jsx("option",{value:"PLANNING",children:"Planning"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]})]})})})]},te)})})]})}),!re&&e.jsx("div",{className:"border-t border-slate-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:O.totalHoursValid?"text-emerald-600":"text-rose-600",children:O.totalHoursValid?"":""}),e.jsx("span",{className:O.totalHoursValid?"text-slate-700":"text-slate-500",children:"Total hours valid"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:O.descriptionsCompleted?"text-emerald-600":"text-rose-600",children:O.descriptionsCompleted?"":""}),e.jsx("span",{className:O.descriptionsCompleted?"text-slate-700":"text-slate-500",children:"All descriptions completed"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:O.noFutureEntries?"text-emerald-600":"text-rose-600",children:O.noFutureEntries?"":""}),e.jsx("span",{className:O.noFutureEntries?"text-slate-700":"text-slate-500",children:"No future entries"})]}),A==="COMPANY"&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:O.divisionValid?"text-emerald-600":"text-rose-600",children:O.divisionValid?"":""}),e.jsx("span",{className:O.divisionValid?"text-slate-700":"text-slate-500",children:"Division assigned"})]})]}),e.jsx("button",{onClick:Q,disabled:!O.allValid||d,className:"px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors",children:d?"Submitting...":"Submit Week"})]})}),N.status==="SUBMITTED"&&e.jsx("div",{className:"border-t border-slate-200 p-4 bg-blue-50",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-sm",children:"Timesheet submitted. Awaiting manager review."})]})}),N.status==="APPROVED"&&e.jsx("div",{className:"border-t border-slate-200 p-4 bg-emerald-50",children:e.jsxs("div",{className:"flex items-center gap-2 text-emerald-800",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-sm",children:"Timesheet approved."})]})}),N.status==="REJECTED"&&e.jsxs("div",{className:"border-t border-slate-200 p-4 bg-rose-50",children:[e.jsxs("div",{className:"flex items-center gap-2 text-rose-800",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-sm font-medium",children:"Timesheet rejected."})]}),((ne=N.approvalMetadata)==null?void 0:ne.rejectedReason)&&e.jsxs("div",{className:"mt-2 text-sm text-rose-700",children:["Reason: ",N.approvalMetadata.rejectedReason]})]}),N.status==="LOCKED"&&e.jsx("div",{className:"border-t border-slate-200 p-4 bg-slate-100",children:e.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("span",{className:"text-sm",children:"This week is locked due to month close."})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Previous Timesheets"}),(()=>{const H=s.filter(te=>te.status!=="DRAFT").sort((te,q)=>new Date(q.periodStart)-new Date(te.periodStart));return console.log("Previous weeks data:",H),console.log("Timesheets data:",s),H.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-500",children:[e.jsx("div",{className:"text-4xl mb-2",children:""}),e.jsx("div",{children:"No previous timesheets found"}),e.jsx("div",{className:"text-sm mt-1",children:"Your submitted timesheets will appear here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Week Start"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Total Hours"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Submitted On"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:H.map(te=>{const q=W[te.id]??te.totalHours??0;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-slate-900",children:te.periodStart?new Date(te.periodStart).toLocaleDateString():""}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-slate-900",children:q}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:hr("inline-flex px-2 py-1 text-xs font-medium rounded-full",ae(te.status)),children:te.status})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-slate-900",children:te.submittedAt?new Date(te.submittedAt).toLocaleDateString():""}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:e.jsx("button",{type:"button",onClick:()=>De(te),className:"inline-flex items-center px-3 py-1.5 text-xs font-medium text-blue-700 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors border border-blue-200",children:"View"})})]},te.id||te.periodStart)})})]})})})()]}),x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"relative w-full max-w-2xl rounded-2xl bg-white border border-slate-200 shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Timesheet"}),e.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:p!=null&&p.id?`ID: ${p.id}`:""})]}),e.jsx("button",{onClick:Z,className:"p-2 rounded-lg hover:bg-white hover:bg-opacity-70 transition-colors","aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"p-6",children:[h==="loading"&&e.jsx(de,{message:"Loading timesheet"}),h==="error"&&e.jsx(le,{error:u}),h==="ready"&&p&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Period"}),e.jsxs("div",{className:"mt-1 text-sm font-medium text-slate-900",children:[p.periodStart||""," to ",p.periodEnd||""]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Status"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-slate-900",children:p.status||""})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Approval Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Submitted"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:we(p.submittedAt)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500",children:"By"}),e.jsx("div",{className:"text-sm font-medium text-slate-900",children:ve(p.submittedBy)})]})]})}),e.jsx("div",{className:"rounded-xl border border-blue-200 bg-blue-50 p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-blue-800",children:"Approved by L1"}),e.jsx("div",{className:"text-xs text-blue-700 mt-1",children:we(p.approvedL1At)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-700",children:"By"}),e.jsx("div",{className:"text-sm font-medium text-blue-900",children:ve(p.approvedL1By)})]})]})}),e.jsx("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-emerald-800",children:"Approved by L2"}),e.jsx("div",{className:"text-xs text-emerald-700 mt-1",children:we(p.approvedL2At)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-semibold text-emerald-700",children:"By"}),e.jsx("div",{className:"text-sm font-medium text-emerald-900",children:ve(p.approvedL2By)})]})]})}),p.rejectedAt&&e.jsxs("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-rose-800",children:"Rejected"}),e.jsx("div",{className:"text-xs text-rose-700 mt-1",children:we(p.rejectedAt)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-semibold text-rose-700",children:"By"}),e.jsx("div",{className:"text-sm font-medium text-rose-900",children:ve(p.rejectedBy)})]})]}),p.rejectedReason?e.jsxs("div",{className:"mt-3 text-sm text-rose-800 whitespace-pre-wrap",children:["Reason: ",p.rejectedReason]}):null]})]})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{onClick:Z,className:"px-5 py-2.5 rounded-xl border border-slate-200 bg-white text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Close"})})]})]})]})})]})}function L2(){const{bootstrap:t}=he(),[s,a]=i.useState([]),[n,l]=i.useState({}),[r,o]=i.useState([]),[d,c]=i.useState(!0),[m,g]=i.useState(null),[x,j]=i.useState(null),[h,f]=i.useState({}),[u,b]=i.useState(!1),[p,y]=i.useState(!1),[w,S]=i.useState(!1),[N,E]=i.useState({leaveType:"",startDate:"",endDate:"",reason:""}),v=["ANNUAL_LEAVE","SICK_LEAVE","CASUAL_LEAVE"],A=P=>!n||!Array.isArray(n.items)?null:n.items.find(V=>{var U;return((U=V.leaveType)==null?void 0:U.code)===P}),T=P=>{switch(P){case"ANNUAL_LEAVE":return"Annual Leave";case"SICK_LEAVE":return"Sick Leave";case"CASUAL_LEAVE":return"Casual Leave";default:return P||"Leave"}};i.useEffect(()=>{async function P(){try{c(!0);const V=await z("/api/v1/leave/me"),U=V.items||V||[];a(Array.isArray(U)?U:[]);const B=new Date().getFullYear(),Q=await z(`/api/v1/leave/balance/me?year=${B}`);l(Q||{});const ae=await z("/api/v1/leave/types"),ie=ae.items||ae||[];o(Array.isArray(ie)?ie:[]),g(null)}catch(V){g(V)}finally{c(!1)}}P()},[]);const C=P=>{const{name:V,value:U}=P.target;E(B=>({...B,[V]:U}))},k=async P=>{P.preventDefault();try{y(!0),await z("/api/v1/leave/me",{method:"POST",body:{leaveTypeId:N.leaveType,startDate:N.startDate,endDate:N.endDate,reason:N.reason,unit:"FULL_DAY"}}),E({leaveType:"",startDate:"",endDate:"",reason:""}),b(!1);const V=await z("/api/v1/leave/me"),U=V.items||V||[];a(Array.isArray(U)?U:[]);const B=await z("/api/v1/leave/balance/me");l(B||{})}catch(V){g(V)}finally{y(!1)}},D=async P=>{try{await z(`/api/v1/leave/me/requests/${P}/cancel`,{method:"POST",body:{reason:"Cancelled by employee"}});const V=await z("/api/v1/leave/me"),U=V.items||V||[];a(Array.isArray(U)?U:[])}catch(V){g(V)}},R=P=>{switch(P){case"PENDING":return"Pending";case"APPROVED":return"Approved";case"REJECTED":return"Rejected";case"CANCELLED":return"Cancelled";default:return P||""}},L=P=>{switch(P){case"PENDING":return"bg-blue-50 text-blue-700 border-blue-200";case"APPROVED":return"bg-green-50 text-green-700 border-green-200";case"REJECTED":return"bg-red-50 text-red-700 border-red-200";case"CANCELLED":return"bg-gray-50 text-gray-600 border-gray-200";default:return"bg-gray-50 text-gray-600 border-gray-200"}},_=()=>{let P=0;return v.forEach(V=>{const U=A(V);if(U){const B=U.availableBalance||0;P+=B}}),P},I=(P,V)=>{if(!P&&!V)return"";if(!V)return new Date(P).toLocaleDateString();if(!P)return new Date(V).toLocaleDateString();const U=new Date(P),B=new Date(V);return U.toDateString()===B.toDateString()?U.toLocaleDateString():`${U.toLocaleDateString()} - ${B.toLocaleDateString()}`},G=(P,V)=>{if(!P||!V)return"";const U=new Date(P),B=new Date(V),Q=Math.abs(B-U);return Math.ceil(Q/(1e3*60*60*24))+1},O=P=>P==="PENDING",F=async P=>{const U=Array.from(new Set((P||[]).filter(Boolean).map(B=>String(B)))).filter(B=>h[B]===void 0);if(U.length!==0)try{const B=await z(`/api/v1/app/users/resolve?ids=${encodeURIComponent(U.join(","))}`),Q=Array.isArray(B==null?void 0:B.items)?B.items:[];f(ae=>{const ie={...ae};for(const we of Q)we!=null&&we.id&&(ie[String(we.id)]=we.displayName||null);for(const we of U)ie[String(we)]===void 0&&(ie[String(we)]=null);return ie})}catch{f(B=>{const Q={...B};for(const ae of U)Q[String(ae)]===void 0&&(Q[String(ae)]=null);return Q})}};i.useEffect(()=>{x&&F([x.approvedL1By,x.approvedL2By,x.rejectedBy,x.cancelledBy])},[x==null?void 0:x.id]);const W=P=>P?h[String(P)]||String(P):"",$=P=>{if(!P)return"";try{const V=new Date(P);return Number.isFinite(V.getTime())?V.toLocaleString():String(P)}catch{return String(P)}},M=({label:P,by:V,at:U,tone:B})=>{const Q=B==="green"?"bg-emerald-50 border-emerald-200 text-emerald-800":B==="blue"?"bg-blue-50 border-blue-200 text-blue-800":B==="red"?"bg-rose-50 border-rose-200 text-rose-800":"bg-slate-50 border-slate-200 text-slate-800";return e.jsx("div",{className:`rounded-xl border p-4 ${Q}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold",children:P}),e.jsx("div",{className:"text-xs opacity-80 mt-1",children:U?$(U):""})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs font-semibold opacity-70",children:"By"}),e.jsx("div",{className:"text-sm font-medium",children:W(V)})]})]})})};return d?e.jsx("div",{className:"p-6",children:e.jsx(de,{message:"Loading leave data"})}):m?e.jsx("div",{className:"p-6",children:e.jsx(le,{error:m})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto bg-gradient-to-br from-slate-50 via-white to-blue-50 min-h-screen",children:[w&&e.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-xl shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("p",{className:"text-sm text-amber-800 font-medium",children:"Leave records for this month are locked."})]})}),e.jsxs("div",{className:"mb-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-blue-500 to-blue-600 rounded-full"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Leave Balance"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("button",{onClick:()=>b(!0),disabled:w,className:"px-6 py-3 bg-gradient-to-r from-slate-900 to-slate-700 text-white rounded-xl hover:from-slate-800 hover:to-slate-600 transition-all duration-200 disabled:from-slate-300 disabled:to-slate-400 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Apply for Leave"]})}),_()===0&&e.jsx("div",{className:"text-xs text-amber-600 mt-2 font-medium",children:"You currently have 0 remaining leave balance."})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map((P,V)=>{const U=["from-blue-50 to-indigo-50 border-blue-200","from-emerald-50 to-teal-50 border-emerald-200","from-purple-50 to-pink-50 border-purple-200"],B=["text-blue-600","text-emerald-600","text-purple-600"],Q=[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],ae=A(P),ie=ae&&ae.availableBalance||0,we=ae&&ae.grantedBalance||0,De=ae&&ae.consumedBalance||0;return e.jsxs("div",{className:`bg-gradient-to-br ${U[V]} border rounded-xl p-5 h-full flex flex-col shadow-sm hover:shadow-md transition-all duration-200 relative overflow-hidden`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white opacity-10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`p-2 rounded-lg bg-white bg-opacity-70 ${B[V]}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q[V]})}),e.jsx("div",{className:"text-sm font-semibold text-slate-700",children:T(P)})]}),e.jsxs("div",{className:"space-y-3 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-sm text-slate-600 font-medium",children:"Remaining"}),e.jsx("span",{className:"text-2xl font-bold text-slate-900",children:ie})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Total"}),e.jsx("span",{className:"text-sm font-medium text-slate-500",children:we})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Used"}),e.jsx("span",{className:"text-sm font-medium text-slate-500",children:De})]})]})]})]},P)})})]}),e.jsx("div",{className:"mb-10 p-4 bg-gradient-to-r from-slate-50 to-blue-50 rounded-xl border border-slate-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("p",{className:"text-sm text-slate-700 leading-relaxed",children:[e.jsx("strong",{className:"font-semibold text-slate-900",children:"Policy Notice:"})," Approved leave automatically updates attendance. Leave does not directly impact payroll in v1."]})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-blue-500 to-blue-600 rounded-full"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Leave History"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Date Range"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Leave Type"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Days"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-600 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-100",children:s.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-16 text-center bg-gradient-to-br from-slate-50 to-blue-50",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-slate-200 to-slate-300 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"You have not submitted any leave requests yet."}),e.jsx("div",{className:"text-sm text-slate-600 max-w-md",children:"Apply for leave to record planned time off and track your attendance."})]})})}):s.map((P,V)=>{var U,B;return e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900 font-medium",children:I(P.startDate,P.endDate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-700",children:((U=P.leaveType)==null?void 0:U.displayName)||((B=P.leaveType)==null?void 0:B.name)||""})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900 font-semibold",children:P.days||G(P.startDate,P.endDate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full border ${L(P.status)}`,children:R(P.status)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{className:"inline-flex items-center px-3 py-1 text-xs font-medium text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>{j(P)},children:[e.jsxs("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]}),O(P.status)&&e.jsxs("button",{className:"inline-flex items-center px-3 py-1 text-xs font-medium text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors",onClick:()=>D(P.id),children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]})]})})]},P.id)})})]})})]}),u&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50 backdrop-blur-sm",children:e.jsxs("div",{className:"relative w-full max-w-md rounded-2xl bg-white border border-slate-200 shadow-2xl transform transition-all",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 px-6 py-4 border-b border-slate-200 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Apply for Leave"}),e.jsx("button",{onClick:()=>b(!1),className:"p-2 rounded-lg hover:bg-white hover:bg-opacity-70 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:k,className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Leave Type"}),e.jsxs("select",{name:"leaveType",value:N.leaveType,onChange:C,required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[e.jsx("option",{value:"",children:"Select leave type"}),r.map(P=>e.jsx("option",{value:P.id||P.name,children:P.displayName||P.name},P.id||P.name))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:N.startDate,onChange:C,required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:N.endDate,onChange:C,required:!0,min:N.startDate,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Reason"}),e.jsx("textarea",{name:"reason",value:N.reason,onChange:C,required:!0,rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none",placeholder:"Please provide a reason for your leave request"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>b(!1),className:"flex-1 px-4 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:p,className:"flex-1 px-4 py-3 bg-gradient-to-r from-slate-900 to-slate-700 text-white rounded-lg hover:from-slate-800 hover:to-slate-600 disabled:from-slate-300 disabled:to-slate-400 font-medium transition-all duration-200 shadow-lg hover:shadow-xl",children:p?"Submitting...":"Apply Leave"})]})]})]})}),x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"relative w-full max-w-2xl rounded-2xl bg-white border border-slate-200 shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Leave Request"}),e.jsxs("div",{className:"text-xs text-slate-600 mt-0.5",children:["ID: ",x.id]})]}),e.jsx("button",{onClick:()=>j(null),className:"p-2 rounded-lg hover:bg-white hover:bg-opacity-70 transition-colors","aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Date Range"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-slate-900",children:I(x.startDate,x.endDate)})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full border ${L(x.status)}`,children:R(x.status)})})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Approval Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(M,{label:"Approved by L1",by:x.approvedL1By,at:x.approvedL1At,tone:"blue"}),e.jsx(M,{label:"Approved by L2",by:x.approvedL2By,at:x.approvedL2At,tone:"green"}),x.rejectedAt&&e.jsx(M,{label:"Rejected",by:x.rejectedBy,at:x.rejectedAt,tone:"red"})]}),x.rejectionReason?e.jsxs("div",{className:"mt-3 rounded-xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-800",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide text-rose-700",children:"Rejection Reason"}),e.jsx("div",{className:"mt-1 whitespace-pre-wrap",children:x.rejectionReason})]}):null]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{onClick:()=>j(null),className:"px-5 py-2.5 rounded-xl border border-slate-200 bg-white text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Close"})})]})]})})]})}function D2(){const{bootstrap:t}=he(),[s,a]=i.useState([]),[n,l]=i.useState(!0),[r,o]=i.useState(null);i.useEffect(()=>{async function j(){try{l(!0);const h=await z("/api/v1/employees/me/documents"),f=h.items||h||[];a(Array.isArray(f)?f:[]),o(null)}catch(h){o(h)}finally{l(!1)}}j()},[]);const d=async j=>{try{const h=await z(`/api/v1/employees/me/documents/${j.id}/download`),f=window.URL.createObjectURL(new Blob([h])),u=document.createElement("a");u.href=f,u.setAttribute("download",j.fileName||j.filename||"document"),document.body.appendChild(u),u.click(),u.remove(),window.URL.revokeObjectURL(f)}catch(h){o(h)}};if(n)return e.jsx("div",{className:"p-6",children:e.jsx(de,{message:"Loading documents"})});if(r)return e.jsx("div",{className:"p-6",children:e.jsx(le,{error:r})});const c=j=>{if(!j)return"";const h=["Bytes","KB","MB","GB"],f=Math.floor(Math.log(j)/Math.log(1024));return Math.round(j/Math.pow(1024,f)*100)/100+" "+h[f]},m=j=>{const h=(j||"").toLowerCase();return h.includes("pdf")?"":h.includes("doc")||h.includes("word")?"":h.includes("xls")||h.includes("excel")?"":h.includes("ppt")||h.includes("powerpoint")?"":h.includes("jpg")||h.includes("png")||h.includes("image")?"":""},x=[...[{id:"offer-letter",type:"Offer Letter",fileName:"Offer Letter.pdf",description:"Your employment offer letter",uploadDate:new Date().toISOString(),isStandard:!0},{id:"employee-handbook",type:"Employee Handbook",fileName:"Employee Handbook.pdf",description:"Company policies and procedures",uploadDate:new Date().toISOString(),isStandard:!0},{id:"code-of-conduct",type:"Code of Conduct",fileName:"Code of Conduct.pdf",description:"Company code of conduct and ethics",uploadDate:new Date().toISOString(),isStandard:!0}],...s];return e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(j=>e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:m(j.type)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:j.type}),e.jsx("p",{className:"text-sm text-slate-600",children:j.fileName})]})]}),j.isStandard&&e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:"Standard"})]}),e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:j.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[e.jsxs("span",{children:["Uploaded: ",j.uploadDate?new Date(j.uploadDate).toLocaleDateString():""]}),j.sizeBytes&&e.jsx("span",{children:c(j.sizeBytes)})]}),e.jsx("button",{onClick:()=>d(j),className:"w-full px-3 py-2 bg-slate-900 text-white text-sm rounded-lg hover:bg-slate-800 transition-colors",children:"Download"})]})]},j.id))}),x.length===0&&e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-slate-200",children:[e.jsx("div",{className:"text-4xl mb-2",children:""}),e.jsx("div",{className:"text-lg font-medium text-slate-900 mb-1",children:"No documents available"}),e.jsx("div",{className:"text-sm text-slate-600",children:"Your documents will appear here once uploaded by HR"})]}),e.jsxs("div",{className:"mt-8 bg-slate-50 rounded-xl border border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Important Information"}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-700",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"These documents are confidential and for your personal use only."})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"For document updates or corrections, please contact HR."})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"Download and save important documents for your records."})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"Standard documents are provided by the company to all employees."})]})]})]}),e.jsxs("div",{className:"mt-6 bg-blue-50 rounded-xl border border-blue-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Need Help?"}),e.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"If you have questions about any document, please reach out to the HR department."})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5",children:""}),e.jsx("div",{children:"HR Contact: hr@company.com or extension 1234"})]})]})]})]})}function M2(){return e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Quick Links"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsx("li",{children:e.jsxs("a",{href:"#",className:"text-blue-600 hover:text-blue-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Employee Handbook"]})}),e.jsx("li",{children:e.jsxs("a",{href:"#",className:"text-blue-600 hover:text-blue-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Company Policies"]})}),e.jsx("li",{children:e.jsxs("a",{href:"#",className:"text-blue-600 hover:text-blue-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"IT Support"]})}),e.jsx("li",{children:e.jsxs("a",{href:"#",className:"text-blue-600 hover:text-blue-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"HR Contact"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Frequently Asked Questions"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsx("li",{children:e.jsxs("a",{href:"#",className:"text-blue-600 hover:text-blue-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"How do I request leave?"]})}),e.jsx("li",{children:e.jsxs("a",{href:"#",className:"text-blue-600 hover:text-blue-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"How do I submit timesheet?"]})}),e.jsx("li",{children:e.jsxs("a",{href:"#",className:"text-blue-600 hover:text-blue-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Where can I find my payslips?"]})}),e.jsx("li",{children:e.jsxs("a",{href:"#",className:"text-blue-600 hover:text-blue-800 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"How do I update my profile?"]})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900 mb-2",children:"HR Department"}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Email: hr@company.com"}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Phone: +1 (555) 123-4567"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Hours: 9:00 AM - 6:00 PM"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900 mb-2",children:"IT Support"}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Email: it@company.com"}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Phone: +1 (555) 987-6543"}),e.jsx("p",{className:"text-sm text-slate-600",children:"24/7 Support Available"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900 mb-2",children:"Finance Department"}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Email: finance@company.com"}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Phone: +1 (555) 456-7890"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Hours: 9:00 AM - 5:00 PM"})]})]})]})]})}function R2(t){if(!t)return"-";const s=new Date(`${String(t).slice(0,7)}-01T00:00:00.000Z`);return Number.isNaN(s.getTime())?String(t):s.toLocaleDateString("en-US",{month:"long",year:"numeric"})}function jo(t){const s=Number(typeof t=="string"?t:t??0),a=Number.isFinite(s)?s:0;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a)}function T2(t){const s=String(t||"").toUpperCase(),a={DRAFT:"bg-slate-100 text-slate-800 border-slate-200",REVIEWED:"bg-slate-100 text-slate-800 border-slate-200",LOCKED:"bg-amber-100 text-amber-800 border-amber-200",PAID:"bg-green-100 text-green-800 border-green-200",CLOSED:"bg-slate-900 text-white border-slate-900"};return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${a[s]||a.DRAFT}`,children:s||"-"})}function P2(){var j;const{bootstrap:t}=he(),[s,a]=i.useState(!0),[n,l]=i.useState(null),[r,o]=i.useState([]),[d,c]=i.useState(!1),m=((j=t==null?void 0:t.user)==null?void 0:j.id)||null,g=async()=>{try{if(a(!0),l(null),c(!1),!m){o([]);return}const h=await z("/api/v1/employees/me/payslips");o(Array.isArray(h)?h:[])}catch(h){if((h==null?void 0:h.status)===403){c(!0),o([]);return}l((h==null?void 0:h.message)||"Failed to load payslips")}finally{a(!1)}};i.useEffect(()=>{g()},[m]);const x=async h=>{if(h)try{const f=localStorage.getItem("jasiq_token"),b=await fetch(`http://localhost:4000/api/v1/payroll/payslips/${h}/download`,{headers:{...f?{authorization:`Bearer ${f}`}:{}}});if(!b.ok){const S=new Error(`Download failed (${b.status})`);throw S.status=b.status,S}const p=await b.blob(),y=window.URL.createObjectURL(p),w=document.createElement("a");w.href=y,w.download=`payslip-${h}.pdf`,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(y),document.body.removeChild(w)}catch(f){if((f==null?void 0:f.status)===403){c(!0);return}l((f==null?void 0:f.message)||"Failed to download payslip")}};return s?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"My Payslips"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"View your payslips."})]}),e.jsx(de,{})]}):n?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"My Payslips"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"View your payslips."})]}),e.jsx(le,{error:n})]}):d?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"My Payslips"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"View your payslips."})]}),e.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50 px-4 py-3 text-amber-900",children:[e.jsx("div",{className:"text-sm font-medium",children:"You dont have permission to view payslips."}),e.jsx("div",{className:"text-xs text-amber-800 mt-1",children:"Please contact HR/Payroll if you believe this is a mistake."})]})]}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"My Payslips"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"View your payslips."})]}),r.length===0?e.jsx("div",{className:"rounded-lg border border-slate-200 bg-white p-10 text-center",children:e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"No payslips available yet."})}):e.jsx("div",{className:"bg-white border border-slate-200 rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Month"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Gross"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Deductions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Net"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Download"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:r.map(h=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-slate-900",children:R2(h.month)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:jo(h.gross)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:jo(h.total_deductions)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:jo(h.net)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:T2(h.payment_status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("button",{type:"button",onClick:()=>x(h.id),className:"inline-flex items-center px-3 py-1.5 text-xs font-medium text-blue-700 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors border border-blue-200",children:"Download"})})]},h.id))})]})})})]})}function I2(t){if(!t)return"";try{const s=new Date(t);return Number.isFinite(s.getTime())?s.toLocaleDateString():String(t)}catch{return String(t)}}function O2({tone:t,children:s}){const a=t==="gray"?"bg-slate-100 text-slate-700 border-slate-200":t==="blue"?"bg-blue-50 text-blue-700 border-blue-200":t==="teal"?"bg-teal-50 text-teal-700 border-teal-200":t==="red"?"bg-red-50 text-red-700 border-red-200":t==="yellow"?"bg-amber-50 text-amber-700 border-amber-200":t==="green"?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full border text-xs font-semibold ${a}`,children:s})}function _2(t){const s=String(t||"").toUpperCase();return s==="DRAFT"?"gray":s==="SUBMITTED"?"blue":s==="APPROVED"?"teal":s==="REJECTED"?"red":s==="PAID"?"green":s==="PARTIAL"?"yellow":"gray"}function B2(){var v,A;const t=Ue(),{bootstrap:s}=he(),[a,n]=i.useState("loading"),[l,r]=i.useState(null),[o,d]=i.useState(null),[c,m]=i.useState(""),[g,x]=i.useState(""),[j,h]=i.useState(""),[f,u]=i.useState(1),b=20,p=((v=s==null?void 0:s.user)==null?void 0:v.employeeId)||((A=s==null?void 0:s.user)==null?void 0:A.employee_id)||null,y=i.useMemo(()=>{const T=new URLSearchParams;return T.set("page",String(f)),T.set("size",String(b)),c&&T.set("status",c),g&&T.set("from",g),j&&T.set("to",j),T.set("reimbursement","true"),T.toString()},[f,c,g,j]);async function w(){try{n("loading"),r(null);const T=await z(`/api/v1/expenses?${y}`);d(T),n("ready")}catch(T){r(T),n("error")}}i.useEffect(()=>{w()},[y]);const S=i.useMemo(()=>Array.isArray(o==null?void 0:o.items)?o.items:[],[o]),N=i.useMemo(()=>Number((o==null?void 0:o.total)||0),[o]),E=i.useMemo(()=>Math.max(1,Math.ceil(N/b)),[N,b]);return a==="loading"?e.jsx(de,{message:"Loading expenses"}):a==="error"?e.jsx(le,{error:l,onRetry:w}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"My Reimbursements"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Submit reimbursement expenses for approval."})]}),e.jsx("button",{onClick:()=>t("/employee/expenses/create"),className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium",children:"Create"})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Status"}),e.jsxs("select",{value:c,onChange:T=>{m(T.target.value),u(1)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"}),e.jsx("option",{value:"APPROVED",children:"APPROVED"}),e.jsx("option",{value:"REJECTED",children:"REJECTED"}),e.jsx("option",{value:"PAID",children:"PAID"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"From"}),e.jsx("input",{type:"date",value:g,onChange:T=>{x(T.target.value),u(1)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"To"}),e.jsx("input",{type:"date",value:j,onChange:T=>{h(T.target.value),u(1)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]})]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-3",children:["Employee: ",p?String(p):""]})]}),S.length===0?e.jsx(ye,{title:"No expenses",description:"No reimbursements matched your filters."}):e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:S.map(T=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:I2(T.expenseDate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:T.title||""}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:e.jsx(O2,{tone:_2(T.status),children:String(T.status||"")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("button",{onClick:()=>t(`/employee/expenses/${T.id}`),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium hover:bg-slate-50",children:"View"})})]},T.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",f," of ",E," (Total: ",N,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{disabled:f<=1,onClick:()=>u(T=>Math.max(1,T-1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:f>=E,onClick:()=>u(T=>Math.min(E,T+1)),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Next"})]})]})]})]})}function F2(t){return new Promise((s,a)=>{const n=new FileReader;n.onload=()=>{const l=String(n.result||""),r=l.includes("base64,")?l.split("base64,")[1]:l;s(r)},n.onerror=()=>a(new Error("File read failed")),n.readAsDataURL(t)})}function U2(){const t=Ue(),{bootstrap:s}=he(),[a,n]=i.useState("loading"),[l,r]=i.useState(null),[o,d]=i.useState([]),[c,m]=i.useState(""),[g,x]=i.useState(""),[j,h]=i.useState(""),[f,u]=i.useState(""),[b,p]=i.useState(""),[y,w]=i.useState(""),[S,N]=i.useState(""),[E,v]=i.useState(""),[A,T]=i.useState(null),[C,k]=i.useState(!1),[D,R]=i.useState(null);async function L(){try{n("loading"),r(null);const I=await z("/api/v1/expenses/categories");d(Array.isArray(I==null?void 0:I.items)?I.items:Array.isArray(I)?I:[]),n("ready")}catch(I){r(I),n("error")}}if(i.useEffect(()=>{L()},[]),a==="loading")return e.jsx(de,{message:"Loading"});if(a==="error")return e.jsx(le,{error:l,onRetry:L});async function _({submit:I}){if(!g){N("Category is required.");return}if(!String(j||"").trim()){v("Title is required.");return}try{k(!0),R(null);const G={expenseDate:c,categoryId:g,amount:Number(b),title:j,description:f,paidByMethod:"OTHER",isReimbursement:!0,vendorName:y||""},O=await z("/api/v1/expenses",{method:"POST",body:G}),F=(O==null?void 0:O.item)||O,W=F==null?void 0:F.id;if(!W)throw new Error("Expense creation failed");if(A){const $=await F2(A);await z(`/api/v1/expenses/${W}/receipts`,{method:"POST",body:{fileName:A.name,contentType:A.type,fileBase64:$}})}I&&await z(`/api/v1/expenses/${W}/submit`,{method:"POST",body:{}}),t(`/employee/expenses/${W}`)}catch(G){R(G)}finally{k(!1)}}return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Create Reimbursement"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Source is fixed to REIMBURSEMENT. Scope is DIVISION."})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Expense Date"}),e.jsx("input",{type:"date",value:c,onChange:I=>m(I.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Category"}),e.jsxs("select",{value:g,onChange:I=>{x(I.target.value),I.target.value&&N("")},disabled:o.length===0,className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm bg-white disabled:bg-slate-50 disabled:text-slate-500",children:[e.jsx("option",{value:"",children:"Select"}),o.map(I=>e.jsxs("option",{value:I.id,children:[I.code," - ",I.name]},I.id))]}),o.length===0?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"No categories available."}):null,S?e.jsx("div",{className:"mt-1 text-xs text-red-700",children:S}):null]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Amount"}),e.jsx("input",{value:b,onChange:I=>p(I.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:"0"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Vendor Name"}),e.jsx("input",{value:y,onChange:I=>w(I.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:""})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Title"}),e.jsx("input",{value:j,onChange:I=>{h(I.target.value),String(I.target.value||"").trim()&&v("")},className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm",placeholder:"Taxi reimbursement"}),E?e.jsx("div",{className:"mt-1 text-xs text-red-700",children:E}):null]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Description"}),e.jsx("textarea",{value:f,onChange:I=>u(I.target.value),rows:4,className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Receipt upload"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"file",onChange:I=>{var G;return T(((G=I.target.files)==null?void 0:G[0])||null)},className:"block w-full text-sm text-slate-700"})})]}),D?e.jsx("div",{className:"mt-4 text-sm text-red-700",children:String(D.message||D)}):null,e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{disabled:C,onClick:()=>_({submit:!1}),className:"px-4 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-50",children:"Save Draft"}),e.jsx("button",{disabled:C,onClick:()=>_({submit:!0}),className:"px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium disabled:opacity-50",children:"Submit"})]})]})]})}function $2(t){const s=Number(t||0);return Number.isFinite(s)?s.toLocaleString(void 0,{maximumFractionDigits:2}):"0"}function V2(t){if(!t)return"";try{const s=new Date(t);return Number.isFinite(s.getTime())?s.toLocaleString():String(t)}catch{return String(t)}}function z2({tone:t,children:s}){const a=t==="gray"?"bg-slate-100 text-slate-700 border-slate-200":t==="blue"?"bg-blue-50 text-blue-700 border-blue-200":t==="teal"?"bg-teal-50 text-teal-700 border-teal-200":t==="red"?"bg-red-50 text-red-700 border-red-200":t==="yellow"?"bg-amber-50 text-amber-700 border-amber-200":t==="green"?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full border text-xs font-semibold ${a}`,children:s})}function W2(t){const s=String(t||"").toUpperCase();return s==="DRAFT"?"gray":s==="SUBMITTED"?"blue":s==="APPROVED"?"teal":s==="REJECTED"?"red":s==="PAID"?"green":s==="PARTIAL"?"yellow":"gray"}async function H2({path:t,filename:s}){const a=Us(),n=xs(),l=await fetch(`${a}${t}`,{method:"GET",headers:{...n?{authorization:`Bearer ${n}`}:{}}});if(!l.ok){const c=await l.text();throw new Error(c||`Download failed (${l.status})`)}const r=await l.blob(),o=window.URL.createObjectURL(r),d=document.createElement("a");d.href=o,d.download=s,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(o),document.body.removeChild(d)}function q2(){const{expenseId:t}=Dt(),[s,a]=i.useState("loading"),[n,l]=i.useState(null),[r,o]=i.useState(null),[d,c]=i.useState([]);async function m(){try{a("loading"),l(null);const[x,j]=await Promise.all([z(`/api/v1/expenses/${t}`),z(`/api/v1/expenses/${t}/receipts`)]);o((x==null?void 0:x.item)||null),c(Array.isArray(j==null?void 0:j.items)?j.items:Array.isArray(j)?j:[]),a("ready")}catch(x){l(x),a("error")}}if(i.useEffect(()=>{t&&m()},[t]),s==="loading")return e.jsx(de,{message:"Loading"});if(s==="error")return e.jsx(le,{error:n,onRetry:m});if(!r)return e.jsx(ye,{title:"Not found",description:"Expense could not be loaded."});const g=String(r.status||"").toUpperCase()==="DRAFT";return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Reimbursement Detail"}),e.jsxs("p",{className:"text-slate-600 mt-1",children:["ID: ",r.id]})]}),e.jsx(z2,{tone:W2(r.status),children:String(r.status||"")})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Date"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-slate-900",children:String(r.expenseDate||"")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Amount"}),e.jsxs("div",{className:"mt-1 text-sm font-bold text-slate-900",children:[$2(r.amount)," ",r.currency||"INR"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Division"}),e.jsx("div",{className:"mt-1 text-sm font-medium text-slate-900",children:r.divisionId||""})]})]}),e.jsxs("div",{className:"mt-4 border-t border-slate-200 pt-4",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Title"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:r.title||""}),e.jsx("div",{className:"mt-3 text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Description"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700 whitespace-pre-wrap",children:r.description||""})]}),e.jsxs("div",{className:"mt-4 text-xs text-slate-500",children:["Editing is ",g?"allowed (DRAFT)":"disabled after submission","."]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-slate-200",children:e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:"Receipts"})}),d.length===0?e.jsx("div",{className:"p-4 text-sm text-slate-600",children:"No receipts uploaded."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"File"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Uploaded"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:d.map(x=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:x.fileName}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:V2(x.uploadedAt)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>H2({path:`/api/v1/expenses/${t}/receipts/${x.id}/download`,filename:x.fileName||"receipt"}),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm font-medium hover:bg-slate-50",children:"Download"})})]},x.id))})]})})]})]})}function Gu(t,s){const a=t||[];return a.includes("SYSTEM_FULL_ACCESS")||a.includes(s)}function Y2(){var E;const t=Ue(),{bootstrap:s}=he(),a=((E=s==null?void 0:s.rbac)==null?void 0:E.permissions)||[],n=Gu(a,"REIMBURSEMENT_CREATE_SELF"),l=Gu(a,"REIMBURSEMENT_VIEW_SELF"),[r,o]=i.useState("loading"),[d,c]=i.useState(null),[m,g]=i.useState(null),[x,j]=i.useState(1),h=20,[f,u]=i.useState(""),[b,p]=i.useState("");async function y(){try{o("loading"),c(null);const v=await Je.getMyReimbursements({page:x,pageSize:h,status:f||null,month:b||null});g(v),o("ready")}catch(v){c(v),o("error")}}i.useEffect(()=>{l&&y()},[x,h,f,b,l]);const w=i.useMemo(()=>Array.isArray(m==null?void 0:m.items)?m.items:[],[m]),S=i.useMemo(()=>Number((m==null?void 0:m.total)||0),[m]),N=i.useMemo(()=>Math.max(1,Math.ceil(S/h)),[S,h]);return l?r==="loading"?e.jsx(de,{message:"Loading reimbursements"}):r==="error"?e.jsx(le,{error:d,onRetry:y}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"My Reimbursements"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Create and track reimbursement claims. Claim will be locked after submission."})]}),n?e.jsx("button",{onClick:()=>t("/employee/reimbursements/new"),className:"px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white text-sm font-semibold",children:"New Claim"}):null]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-4",children:[e.jsx("div",{className:"text-sm font-bold text-slate-900 mb-3",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Month"}),e.jsx("input",{type:"month",value:b,onChange:v=>{p(v.target.value),j(1)},className:"w-full px-3 py-2 rounded-xl border border-slate-200 text-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Status"}),e.jsxs("select",{value:f,onChange:v=>{u(v.target.value),j(1)},className:"w-full px-3 py-2 rounded-xl border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"}),e.jsx("option",{value:"APPROVED",children:"APPROVED"}),e.jsx("option",{value:"REJECTED",children:"REJECTED"}),e.jsx("option",{value:"PAID",children:"PAID"}),e.jsx("option",{value:"CLOSED",children:"CLOSED"})]})]})]})]}),w.length===0?e.jsx(ye,{title:"No claims",description:"No reimbursements matched your filters."}):e.jsx(Ci,{rows:w,loading:!1,empty:"No reimbursements",onRowClick:v=>t(`/employee/reimbursements/${v.id}`)}),e.jsxs("div",{className:"flex items-center justify-between bg-white rounded-2xl border border-slate-200/60 shadow-sm px-4 py-3",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",x," of ",N," (Total: ",S,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{disabled:x<=1,onClick:()=>j(v=>Math.max(1,v-1)),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:x>=N,onClick:()=>j(v=>Math.min(N,v+1)),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Next"})]})]})]}):e.jsx(ye,{title:"No access",description:"You don't have permission to view reimbursements."})}function G2(t){const s=Number(t);return Number.isFinite(s)?String(s):""}function zh({value:t,onChange:s,disabled:a,errors:n}){const l=t||{},r=n||{},o=c=>s&&s({...l,...c}),d=i.useMemo(()=>`mt-1 w-full rounded-xl border bg-white px-3 py-2 text-sm outline-none transition ${a?"border-slate-200 text-slate-400":"border-slate-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-100"}`,[a]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Claim Date"}),e.jsx("input",{type:"date",className:d,value:l.claimDate||"",disabled:a,onChange:c=>o({claimDate:c.target.value})}),r.claimDate?e.jsx("p",{className:"text-xs text-rose-600 mt-1",children:r.claimDate}):null]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",className:d,value:G2(l.totalAmount),disabled:a,onChange:c=>o({totalAmount:c.target.value})}),r.totalAmount?e.jsx("p",{className:"text-xs text-rose-600 mt-1",children:r.totalAmount}):null]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Title"}),e.jsx("input",{type:"text",className:d,value:l.title||"",disabled:a,onChange:c=>o({title:c.target.value})}),r.title?e.jsx("p",{className:"text-xs text-rose-600 mt-1",children:r.title}):null]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Description"}),e.jsx("textarea",{rows:4,className:d,value:l.description||"",disabled:a,onChange:c=>o({description:c.target.value})}),r.description?e.jsx("p",{className:"text-xs text-rose-600 mt-1",children:r.description}):null]})]})}function Q2(t,s){const a=t||[];return a.includes("SYSTEM_FULL_ACCESS")||a.includes(s)}function J2(){var j;const t=Ue(),{bootstrap:s}=he(),a=((j=s==null?void 0:s.rbac)==null?void 0:j.permissions)||[],n=Q2(a,"REIMBURSEMENT_CREATE_SELF"),[l,r]=i.useState({claimDate:new Date().toISOString().slice(0,10),title:"",description:"",totalAmount:""}),[o,d]=i.useState("idle"),[c,m]=i.useState(null),g=i.useMemo(()=>{if(!n||!l.claimDate||!String(l.title||"").trim())return!1;const h=Number(l.totalAmount);return!(!Number.isFinite(h)||h<0)},[l,n]);async function x(){var h;try{d("loading"),m(null);const f=await Je.createDraft({claimDate:l.claimDate,title:String(l.title||"").trim(),description:String(l.description||"").trim()||null,totalAmount:Number(l.totalAmount)}),u=(h=f==null?void 0:f.item)==null?void 0:h.id;if(u){t(`/employee/reimbursements/${u}`);return}t("/employee/reimbursements")}catch(f){m(f),d("error")}}return n?e.jsxs("div",{className:"max-w-3xl mx-auto space-y-5",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"New Reimbursement Claim"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Create a draft claim. It will be locked after submission."})]}),c?e.jsx(le,{error:c,onRetry:x}):null,e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsx(zh,{value:l,onChange:r,disabled:o==="loading"}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>t("/employee/reimbursements"),className:"px-4 py-2 rounded-xl text-sm font-semibold bg-slate-100 text-slate-700 hover:bg-slate-200",children:"Cancel"}),e.jsx("button",{disabled:!g||o==="loading",onClick:x,className:`px-4 py-2 rounded-xl text-sm font-semibold transition ${!g||o==="loading"?"bg-slate-200 text-slate-500":"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700"}`,children:o==="loading"?"Creating":"Create Draft"})]})]})]}):e.jsx(le,{error:{status:403,message:"Required permission: REIMBURSEMENT_CREATE_SELF"}})}const Qu=["application/pdf","image/jpeg","image/png"];function K2({reimbursementId:t,disabled:s,onUploaded:a}){const[n,l]=i.useState(null),[r,o]=i.useState("idle"),[d,c]=i.useState(null),m=i.useMemo(()=>!(s||!n||!Qu.includes(String(n.type||"").toLowerCase())),[s,n]),g=async()=>{o("loading"),c(null);try{await Je.uploadReceipt(t,n),o("ready"),l(null),a&&a()}catch(j){c(j),o("error")}},x=n&&!Qu.includes(String(n.type||"").toLowerCase())?"Only PDF, JPG, PNG allowed":"PDF, JPG, PNG  max 5MB";return e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Upload Receipt"}),e.jsx("p",{className:"text-xs text-slate-600 mt-1",children:x}),d?e.jsx("p",{className:"text-xs text-rose-600 mt-2",children:d.message||"Upload failed"}):null]}),e.jsx("button",{onClick:g,disabled:!m||r==="loading",className:`px-4 py-2 rounded-xl text-sm font-semibold transition ${!m||r==="loading"?"bg-slate-200 text-slate-500":"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700"}`,children:r==="loading"?"Uploading":"Upload"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("input",{type:"file",disabled:s,accept:"application/pdf,image/jpeg,image/png",onChange:j=>{var h;return l(((h=j.target.files)==null?void 0:h[0])||null)},className:"block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-4 file:rounded-xl file:border-0 file:text-sm file:font-semibold file:bg-slate-100 file:text-slate-700 hover:file:bg-slate-200"})})]})}function No(t,s){const a=t||[];return a.includes("SYSTEM_FULL_ACCESS")||a.includes(s)}function yo(t){const s=Number(t);return Number.isFinite(s)?s.toLocaleString("en-IN",{style:"currency",currency:"INR"}):""}function X2(){var I,G;const{id:t}=Dt(),s=Ue(),{bootstrap:a}=he(),n=((I=a==null?void 0:a.rbac)==null?void 0:I.permissions)||[],l=(a==null?void 0:a.systemConfig)||{},r=((G=l==null?void 0:l.REIMBURSEMENT_RECEIPT_REQUIRED)==null?void 0:G.value)??(l==null?void 0:l.REIMBURSEMENT_RECEIPT_REQUIRED),o=String(r??"").trim().toLowerCase(),d=o==="true"||o==="1"||o==="yes"||o==="enabled"||o==="on",c=No(n,"REIMBURSEMENT_VIEW_SELF"),m=No(n,"REIMBURSEMENT_EDIT_SELF_DRAFT"),g=No(n,"REIMBURSEMENT_SUBMIT_SELF"),[x,j]=i.useState("loading"),[h,f]=i.useState(null),[u,b]=i.useState(null),[p,y]=i.useState([]),[w,S]=i.useState([]),[N,E]=i.useState(null),[v,A]=i.useState(!1);async function T(){try{j("loading"),f(null);const O=await Je.getReimbursementById(t),F=O==null?void 0:O.item;b(F),E({claimDate:F!=null&&F.claimDate?String(F.claimDate).slice(0,10):"",title:(F==null?void 0:F.title)||"",description:(F==null?void 0:F.description)||"",totalAmount:(F==null?void 0:F.totalAmount)??""});const[W,$]=await Promise.all([Je.listReceipts(t),Je.listPayments(t,{page:1,pageSize:200})]);y(Array.isArray(W==null?void 0:W.items)?W.items:Array.isArray(W)?W:[]),S(Array.isArray($==null?void 0:$.items)?$.items:[]),j("ready")}catch(O){f(O),j("error")}}i.useEffect(()=>{c&&T()},[t,c]);const k=String((u==null?void 0:u.status)||"").toUpperCase()==="DRAFT",D=m&&k,R=i.useMemo(()=>!(!g||!k||d&&((p==null?void 0:p.length)||0)===0),[g,k,d,p]);async function L(){if(u)try{A(!0),f(null);const O=await Je.updateDraft(t,{title:String((N==null?void 0:N.title)||"").trim(),description:String((N==null?void 0:N.description)||"").trim()||null,totalAmount:Number(N==null?void 0:N.totalAmount),version:u.version});b((O==null?void 0:O.item)||u),await T()}catch(O){f(O)}finally{A(!1)}}async function _(){if(u)try{A(!0),f(null),await Je.submitReimbursement(t,{version:u.version}),await T()}catch(O){f(O)}finally{A(!1)}}return c?x==="loading"?e.jsx(de,{message:"Loading claim"}):x==="error"?e.jsx(le,{error:h,onRetry:T}):u?e.jsxs("div",{className:"max-w-5xl mx-auto space-y-5",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Reimbursement"}),e.jsx(kn,{status:u.status})]}),e.jsxs("p",{className:"text-slate-600 mt-1",children:["ID: ",u.id]})]}),e.jsx("button",{onClick:()=>s("/employee/reimbursements"),className:"px-4 py-2 rounded-xl bg-slate-100 text-slate-700 text-sm font-semibold hover:bg-slate-200",children:"Back"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Total"}),e.jsx("div",{className:"text-lg font-bold text-slate-900",children:yo(u.totalAmount)})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Paid"}),e.jsx("div",{className:"text-lg font-bold text-slate-900",children:yo(u.paidAmount)})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Due"}),e.jsx("div",{className:"text-lg font-bold text-slate-900",children:yo(u.dueAmount)})]})]}),u.linkedExpenseId?e.jsxs("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-xl p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-800",children:"Linked Expense (read-only)"}),e.jsx("div",{className:"text-sm text-blue-900 mt-1",children:u.linkedExpenseId})]}):null,e.jsxs("div",{className:"mt-4 bg-amber-50 border border-amber-200 rounded-xl p-3",children:[e.jsx("div",{className:"text-sm font-semibold text-amber-900",children:"Important"}),e.jsx("div",{className:"text-sm text-amber-800 mt-1",children:"Claim will be locked after submission."})]})]}),h?e.jsx(le,{error:h,onRetry:T}):null,e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Details"}),e.jsx("div",{className:"mt-4",children:e.jsx(zh,{value:N,onChange:E,disabled:!D||v})}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[D?e.jsx("button",{onClick:L,disabled:v,className:"px-4 py-2 rounded-xl text-sm font-semibold bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-50",children:"Save Draft"}):null,g?e.jsx("button",{onClick:_,disabled:!R||v,className:`px-4 py-2 rounded-xl text-sm font-semibold transition ${!R||v?"bg-slate-200 text-slate-500":"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700"}`,children:"Submit"}):null]}),k&&d&&((p==null?void 0:p.length)||0)===0?e.jsx("div",{className:"mt-3 text-xs text-amber-700",children:"Receipt is required before submission."}):null]}),e.jsx(K2,{reimbursementId:t,disabled:!k||v,onUploaded:T}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Receipts"}),(p||[]).length===0?e.jsx("div",{className:"mt-3 text-sm text-slate-600",children:"No receipts uploaded."}):e.jsx("div",{className:"mt-3 space-y-2",children:p.map(O=>e.jsxs("div",{className:"flex items-center justify-between gap-3 bg-slate-50 border border-slate-200 rounded-xl p-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:O.fileName}),e.jsxs("div",{className:"text-xs text-slate-600",children:[O.contentType,"  ",Number(O.fileSize||0).toLocaleString()," bytes"]})]}),e.jsx("button",{onClick:()=>Je.downloadReceipt(t,O.id,O.fileName),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm font-semibold hover:bg-slate-100",children:"Download"})]},O.id))})]}),e.jsx(Ai,{payments:w})]}):e.jsx(ye,{title:"Not found",description:"Reimbursement not found."}):e.jsx(ye,{title:"No access",description:"You don't have permission to view this claim."})}class Z2{static async fetchAllStats(){const s={employees:0,divisions:0,timesheets:0,leaveRequests:0};try{const a=[this.fetchEmployeesCount(),this.fetchDivisionsCount(),this.fetchTimesheetsCount(),this.fetchLeaveRequestsCount()],[n,l,r,o]=await Promise.allSettled(a);s.employees=n.status==="fulfilled"?n.value:0,s.divisions=l.status==="fulfilled"?l.value:0,s.timesheets=r.status==="fulfilled"?r.value:0,s.leaveRequests=o.status==="fulfilled"?o.value:0,console.log("Dashboard stats fetched from actual pages:",s)}catch(a){console.warn("Dashboard service error:",a)}return s}static async fetchEmployeesCount(){var s;try{const a="/api/v1/employees?page=1&pageSize=1";console.log("Fetching employees from actual page logic:",a);const n=await z(a);console.log("Employees API response (from page logic):",n);const l=((s=n==null?void 0:n.pagination)==null?void 0:s.total)||(n==null?void 0:n.total)||0;return console.log("Employees count (from page logic):",l),l}catch(a){return console.warn("Employees fetch failed:",a),0}}static async fetchDivisionsCount(){var s;try{const a="/api/v1/governance/divisions?page=1&pageSize=1";console.log("Fetching divisions from actual page logic:",a);const n=await z(a);console.log("Divisions API response (from page logic):",n);const l=((s=n==null?void 0:n.pagination)==null?void 0:s.total)||(n==null?void 0:n.total)||0;return console.log("Divisions count (from page logic):",l),l}catch(a){return console.warn("Divisions fetch failed:",a),0}}static async fetchTimesheetsCount(){var s;try{const a="/api/v1/timesheets/approvals?page=1&pageSize=1";console.log("Fetching timesheets from actual page logic:",a);const n=await z(a);console.log("Timesheets API response (from page logic):",n);const l=((s=n==null?void 0:n.pagination)==null?void 0:s.total)||(n==null?void 0:n.total)||0;return console.log("Timesheets count (from page logic):",l),l}catch(a){return console.warn("Timesheets fetch failed:",a),0}}static async fetchLeaveRequestsCount(){var s;try{const a="/api/v1/leave/requests?page=1&pageSize=1";console.log("Fetching leave requests from actual page logic:",a);const n=await z(a);console.log("Leave requests API response (from page logic):",n);const l=((s=n==null?void 0:n.pagination)==null?void 0:s.total)||(n==null?void 0:n.total)||0;return console.log("Leave requests count (from page logic):",l),l}catch(a){return console.warn("Leave requests fetch failed:",a),0}}}function eN(){const t=Ue(),[s,a]=i.useState({employees:0,divisions:0,timesheets:0,leaveRequests:0}),[n,l]=i.useState(!0),[r,o]=i.useState(null),d=c=>{try{console.log("Navigating to:",c),t(c)}catch(m){console.error("Navigation failed:",m),window.location.href=c}};return i.useEffect(()=>{(async()=>{try{l(!0);const m=await Z2.fetchAllStats();a(m)}catch{}finally{l(!1)}})()},[]),n?e.jsx("div",{className:"max-w-7xl mx-auto space-y-8",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(de,{message:"Loading dashboard..."})})}):e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4 py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-3xl shadow-xl mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-900 to-slate-700 bg-clip-text text-transparent",children:"Super Admin Dashboard"}),e.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Welcome to JASIQ CoreOps. Manage your organization with powerful tools and insights."})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Quick Access"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{onClick:()=>d("/super-admin/employees"),className:"group cursor-pointer rounded-xl border border-slate-200 p-4 text-center transition-all duration-200 hover:shadow-lg hover:border-blue-300 hover:bg-blue-50",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-blue-200 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-blue-700 transition-colors",children:"Employee List"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"View all employees"})]}),e.jsxs("div",{onClick:()=>d("/super-admin/divisions"),className:"group cursor-pointer rounded-xl border border-slate-200 p-4 text-center transition-all duration-200 hover:shadow-lg hover:border-emerald-300 hover:bg-emerald-50",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-emerald-200 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-emerald-700 transition-colors",children:"Divisions"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Manage divisions"})]}),e.jsxs("div",{onClick:()=>d("/super-admin/timesheets"),className:"group cursor-pointer rounded-xl border border-slate-200 p-4 text-center transition-all duration-200 hover:shadow-lg hover:border-purple-300 hover:bg-purple-50",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-purple-200 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-purple-700 transition-colors",children:"Timesheets"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Review timesheets"})]}),e.jsxs("div",{onClick:()=>d("/super-admin/audit-logs"),className:"group cursor-pointer rounded-xl border border-slate-200 p-4 text-center transition-all duration-200 hover:shadow-lg hover:border-amber-300 hover:bg-amber-50",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center mx-auto mb-3 group-hover:bg-amber-200 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-amber-700 transition-colors",children:"Audit Logs"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"View system logs"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("span",{className:"text-3xl font-bold text-blue-900",children:s.employees.toLocaleString()})]}),e.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Total Employees"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Manage your workforce"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 border border-emerald-100 rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-500 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e.jsx("span",{className:"text-3xl font-bold text-emerald-900",children:s.divisions.toLocaleString()})]}),e.jsx("h3",{className:"text-lg font-semibold text-emerald-900",children:"Divisions"}),e.jsx("p",{className:"text-sm text-emerald-700 mt-1",children:"Organizational structure"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-100 rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),e.jsx("span",{className:"text-3xl font-bold text-purple-900",children:s.timesheets.toLocaleString()})]}),e.jsx("h3",{className:"text-lg font-semibold text-purple-900",children:"Timesheets"}),e.jsx("p",{className:"text-sm text-purple-700 mt-1",children:"Track time & attendance"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 border border-amber-100 rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-amber-500 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("span",{className:"text-3xl font-bold text-amber-900",children:s.leaveRequests.toLocaleString()})]}),e.jsx("h3",{className:"text-lg font-semibold text-amber-900",children:"Leave Requests"}),e.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Manage time off"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx("div",{onClick:()=>t("/super-admin/employees/create"),className:"group cursor-pointer rounded-xl border border-slate-200 p-6 transition-all duration-200 hover:shadow-lg hover:border-blue-300 hover:bg-blue-50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center group-hover:bg-blue-200 transition-colors",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-blue-700 transition-colors",children:"Add Employee"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Create new employee record"})]})]})}),e.jsx("div",{onClick:()=>t("/super-admin/divisions/create"),className:"group cursor-pointer rounded-xl border border-slate-200 p-6 transition-all duration-200 hover:shadow-lg hover:border-emerald-300 hover:bg-emerald-50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center group-hover:bg-emerald-200 transition-colors",children:e.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-emerald-700 transition-colors",children:"Create Division"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Add new organizational unit"})]})]})}),e.jsx("div",{onClick:()=>t("/super-admin/system-config"),className:"group cursor-pointer rounded-xl border border-slate-200 p-6 transition-all duration-200 hover:shadow-lg hover:border-purple-300 hover:bg-purple-50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center group-hover:bg-purple-200 transition-colors",children:e.jsxs("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 group-hover:text-purple-700 transition-colors",children:"System Config"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Manage system settings"})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-6",children:"System Overview"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Platform Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-green-50 border border-green-200",children:[e.jsx("span",{className:"text-sm font-medium text-green-800",children:"API Services"}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-green-700",children:"Operational"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-green-50 border border-green-200",children:[e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Database"}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-green-700",children:"Connected"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 border border-blue-200",children:[e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Authentication"}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-blue-700",children:"Active"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Quick Access"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>d("/super-admin/employees"),className:"p-3 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 transition-colors text-left cursor-pointer",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Employee List"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"View all employees"})]}),e.jsxs("button",{onClick:()=>d("/super-admin/divisions"),className:"p-3 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 transition-colors text-left cursor-pointer",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Divisions"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Manage departments"})]}),e.jsxs("button",{onClick:()=>d("/super-admin/timesheets"),className:"p-3 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 transition-colors text-left cursor-pointer",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Timesheets"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Approve timesheets"})]}),e.jsxs("button",{onClick:()=>d("/super-admin/audit-logs"),className:"p-3 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 transition-colors text-left cursor-pointer",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Audit Logs"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"View system logs"})]})]})]})]})]})]})}function tN(){return e.jsx(Dh,{})}function sN(){var R,L,_,I,G,O;const{bootstrap:t}=he(),s=((_=(L=(R=t==null?void 0:t.ui)==null?void 0:R.screens)==null?void 0:L.systemConfig)==null?void 0:_.title)||"System Configuration",[a]=i.useState(1),[n]=i.useState(200),l=((I=t==null?void 0:t.rbac)==null?void 0:I.permissions)||[],r=i.useMemo(()=>l.includes("GOV_SYSTEM_CONFIG_WRITE"),[l]),[o,d]=i.useState(!1),[c,m]=i.useState(!1),[g,x]=i.useState(null),[j,h]=i.useState(""),[f,u]=i.useState(""),[b,p]=i.useState(""),[y,w]=i.useState(""),S=F=>{x(F),m(!0)},N=F=>{x(F),h((F==null?void 0:F.key)||""),u((F==null?void 0:F.value)||""),p((F==null?void 0:F.description)||""),w(""),d(!0)},E=Pe({path:"/api/v1/governance/system-config",page:a,pageSize:n,enabled:!0}),v=Be(async()=>z(`/api/v1/governance/system-config/${encodeURIComponent(j)}`,{method:"PUT",body:{value:f,description:b||null,reason:y||null}})),A=F=>({ATTENDANCE_MODE:"Attendance Mode",PROJECTS_ENABLED:"Projects Module",FINANCE_LOCK_DATE:"Finance Lock Date",PAYROLL_APPROVAL_REQUIRED:"Payroll Approval",MONTH_CLOSE_ENABLED:"Month Close",AUDIT_RETENTION_DAYS:"Audit Retention",USER_SESSION_TIMEOUT:"Session Timeout",EMAIL_NOTIFICATIONS:"Email Notifications"})[F]||F.replace(/_/g," ").replace(/\b\w/g,$=>$.toUpperCase()),T=F=>F==="true"||F===!0?"Enabled":F==="false"||F===!1?"Disabled":F==="STANDARD"?"Standard Mode":F==="ADVANCED"?"Advanced Mode":F==="REQUIRED"?"Required":F==="OPTIONAL"?"Optional":String(F),C=F=>({ATTENDANCE_MODE:"Attendance Module",PROJECTS_ENABLED:"Projects Module",FINANCE_LOCK_DATE:"Finance & Payroll",PAYROLL_APPROVAL_REQUIRED:"Finance & Payroll",MONTH_CLOSE_ENABLED:"Company-wide",AUDIT_RETENTION_DAYS:"Company-wide",USER_SESSION_TIMEOUT:"Company-wide",EMAIL_NOTIFICATIONS:"Company-wide"})[F]||"Company-wide",k=F=>["FINANCE_LOCK_DATE","MONTH_CLOSE_ENABLED"].includes(F)?{text:"Locked",color:"text-red-700 bg-red-50"}:["AUDIT_RETENTION_DAYS"].includes(F)?{text:"Read-only",color:"text-amber-700 bg-amber-50"}:{text:"Open",color:"text-slate-700 bg-slate-50"};if(E.status==="loading"&&!E.data)return e.jsx(de,{});if(E.status==="error")return((G=E.error)==null?void 0:G.status)===403?e.jsx(ge,{}):e.jsx(le,{error:E.error});const D=((O=E.data)==null?void 0:O.items)||[];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-5",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:s}),e.jsx("p",{className:"text-sm text-gray-500",children:"Central system behavior, enforced across all modules"})]}),e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800",children:"System Configuration is critical."}),e.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"Changes affect system-wide behavior and are permanently audited."})]})]}),e.jsx("div",{className:"w-full px-4 py-4 shadow-sm mb-6 relative z-10",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Governance Access"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:r?"You can request configuration changes.":"Read-only: GOV_SYSTEM_CONFIG_WRITE is required to request changes."})]})})}),e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-slate-200",children:e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"System Policies"})}),D.length===0?e.jsx("div",{className:"p-8",children:e.jsx(ye,{title:"No system policies configured"})}):e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-3 md:hidden",children:D.map(F=>{const W=k(F.key);return e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-4 cursor-pointer hover:bg-slate-50 transition-colors",onClick:()=>S(F),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-sm text-slate-900",children:A(F.key)}),e.jsx("div",{className:"mt-1 font-mono text-xs text-slate-500",children:F.key}),e.jsx("div",{className:"mt-2 text-sm text-slate-700",children:T(F.value)}),e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:C(F.key)})]}),e.jsx("div",{className:"ml-3",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${W.color}`,children:W.text})})]}),e.jsx("div",{className:"mt-3",children:e.jsx("button",{type:"button",className:"w-full rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-100",onClick:$=>{$.stopPropagation(),S(F)},children:"View"})})]},F.key)})}),e.jsx("div",{className:"hidden md:block overflow-x-auto relative z-10",children:e.jsx(ha,{columns:[{key:"config",title:"Configuration",render:(F,W)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-slate-900",children:A(W.key)}),e.jsx("div",{className:"font-mono text-xs text-slate-500 mt-1",children:W.key})]})},{key:"value",title:"Current State",render:(F,W)=>e.jsx("span",{className:"text-sm text-slate-700",children:T(W.value)})},{key:"scope",title:"Scope",render:(F,W)=>e.jsx("span",{className:"text-sm text-slate-700",children:C(W.key)})},{key:"status",title:"Status",render:(F,W)=>{const $=k(W.key);return e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${$.color}`,children:$.text})}},{key:"action",title:"Action",render:(F,W)=>e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-100",onClick:()=>S(W),children:"View"})}],data:D.map(F=>({key:F.key,value:F.value,description:F.description,config:A(F.key),scope:C(F.key),status:k(F.key)}))})})]})]}),c&&g?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>m(!1)}),e.jsx("div",{className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl",children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:A(g.key)}),e.jsx("p",{className:"text-sm text-slate-500 font-mono mt-1",children:g.key})]}),e.jsx("button",{type:"button",className:"text-slate-400 hover:text-slate-600 transition-colors",onClick:()=>m(!1),children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-900 mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-700",children:g.description||`System configuration that controls ${A(g.key).toLowerCase()} behavior across the platform.`})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-900 mb-2",children:"Current Value"}),e.jsx("div",{className:"bg-slate-50 p-3 rounded-md",children:e.jsx("span",{className:"text-sm font-medium text-slate-900",children:T(g.value)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-900 mb-2",children:"Impact"}),e.jsxs("ul",{className:"text-sm text-slate-700 space-y-1",children:[e.jsxs("li",{children:[" Applies to ",C(g.key)]}),e.jsx("li",{children:" Enforced company-wide"}),e.jsx("li",{children:" Affects all system operations"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-900 mb-2",children:"Governance State"}),e.jsx("div",{className:"bg-slate-50 p-3 rounded-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${k(g.key).color}`,children:k(g.key).text}),k(g.key).text==="Locked"&&e.jsx("span",{className:"text-xs text-slate-500",children:"Month Close in progress"})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-900 mb-2",children:"Change History"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-slate-50 p-3 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium text-slate-900",children:"System Admin"}),e.jsx("span",{className:"text-xs text-slate-500",children:"2 days ago"})]}),e.jsx("div",{className:"text-xs text-slate-700 mt-1",children:"Updated configuration value"})]}),e.jsxs("div",{className:"bg-slate-50 p-3 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium text-slate-900",children:"System Admin"}),e.jsx("span",{className:"text-xs text-slate-500",children:"1 week ago"})]}),e.jsx("div",{className:"text-xs text-slate-700 mt-1",children:"Initial configuration"})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("a",{href:"/super-admin/audit-logs",className:"text-xs text-indigo-600 hover:text-indigo-800",children:"View full Audit Logs "})})]})]}),e.jsx("div",{className:"px-6 py-4 border-t border-slate-200",children:r&&k(g.key).text!=="Locked"?e.jsx("button",{type:"button",className:"w-full px-4 py-2 bg-slate-900 text-white rounded-md text-sm font-medium hover:bg-slate-800 transition-colors",onClick:()=>{m(!1),N(g)},children:"Request Change"}):e.jsx("button",{type:"button",className:"w-full px-4 py-2 bg-slate-100 text-slate-400 rounded-md text-sm font-medium cursor-not-allowed",disabled:!0,title:k(g.key).text==="Locked"?"Configuration is locked during Month Close":"Insufficient permissions",children:k(g.key).text==="Locked"?"Configuration Locked":"Edit Not Available"})})]})})]}):null,o?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>{v.status!=="loading"&&d(!1)}}),e.jsxs("div",{className:"relative w-full max-w-lg rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:"Request Configuration Change"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"All changes are audited and require approval."}),e.jsx("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-red-800",children:[e.jsx("strong",{children:"Warning:"})," This change affects system-wide behavior and will be recorded in Audit Logs."]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Configuration"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono bg-slate-50",value:(g==null?void 0:g.key)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Current Value"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm bg-slate-50",value:T((g==null?void 0:g.value)||""),disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"New Value"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:f,onChange:F=>u(F.target.value),placeholder:"Enter new value",disabled:v.status==="loading"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Reason (required)"}),e.jsx("textarea",{className:"mt-1 w-full h-24 rounded-md border-slate-300 text-sm",value:y,onChange:F=>w(F.target.value),disabled:v.status==="loading",placeholder:"Explain why this change is needed and its expected impact"}),y.trim().length===0?e.jsx("div",{className:"mt-1 text-xs text-rose-700",children:"Reason is required."}):null]})]}),v.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:v.error})}):null,e.jsxs("div",{className:"mt-4 flex flex-col-reverse sm:flex-row sm:items-center sm:justify-end gap-2",children:[e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:v.status==="loading",onClick:()=>d(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md bg-slate-900 px-4 py-2 text-sm font-medium text-white disabled:bg-slate-400",disabled:v.status==="loading"||!f.trim()||y.trim().length===0,onClick:async()=>{await v.run(),d(!1),E.refresh()},children:v.status==="loading"?"Submitting":"Submit Request"})]})]})]}):null]})})}function aN(){return e.jsx(sN,{})}function nN(){return e.jsx(Mc,{})}function lN(){var ne,H,te,q,Y,xe,J,me,K,be,je,pe,Ae,Se,Me;const{bootstrap:t}=he();(te=(H=(ne=t==null?void 0:t.ui)==null?void 0:ne.screens)==null?void 0:H.divisions)!=null&&te.title,(q=t==null?void 0:t.permissions)!=null&&q.includes("DIVISION_MANAGE");const s=Ue(),a=ct(),{id:n}=Dt(),r=(((Y=t==null?void 0:t.rbac)==null?void 0:Y.roles)||[]).includes("SUPER_ADMIN"),[o,d]=i.useState("list"),[c,m]=i.useState(null),[g,x]=i.useState(!1);i.useEffect(()=>{if(((a==null?void 0:a.pathname)||"").endsWith("/divisions/create")){d("create"),m(null);return}if(n){d("view"),m(n);return}d("list"),m(null)},[n,a==null?void 0:a.pathname]);const[j,h]=i.useState(()=>{try{return window.localStorage.getItem("divisions_context_banner_dismissed")==="1"}catch{return!1}}),[f,u]=i.useState(1),[b]=i.useState(20),[p,y]=i.useState(""),[w,S]=i.useState(""),[N,E]=i.useState(""),[v,A]=i.useState("INTERNAL"),[T,C]=i.useState(""),[k,D]=i.useState(""),[R,L]=i.useState(!1),[_,I]=i.useState(null),[G,O]=i.useState(!1),[F,W]=i.useState(""),[$,M]=i.useState(()=>{try{const ce=window.localStorage.getItem("divisions_notification_count"),Ce=ce?Number(ce):0;return Number.isFinite(Ce)&&Ce>=0?Ce:0}catch{return 0}}),P=()=>{M(ce=>{const Ce=(Number(ce)||0)+1;try{window.localStorage.setItem("divisions_notification_count",String(Ce))}catch{}return Ce})},V=Pe({path:"/api/v1/governance/divisions",page:f,pageSize:b,enabled:!0}),U=Pe({path:c?`/api/v1/governance/divisions/${c}`:"/api/v1/governance/divisions/__none__",page:1,pageSize:1,enabled:o==="view"&&!!c}),B=Be(async()=>z("/api/v1/governance/divisions",{method:"POST",body:{code:w.trim(),name:N.trim(),type:v,description:T.trim()||null,reason:k||null}})),Q=Be(async({id:ce,isActive:Ce,reason:xt})=>z(`/api/v1/governance/divisions/${ce}/activation`,{method:"PATCH",body:{isActive:Ce,reason:xt}})),ae=i.useMemo(()=>w.trim().length>0&&N.trim().length>0,[w,N]),ie=((xe=V.data)==null?void 0:xe.items)||[],we=((J=V.data)==null?void 0:J.total)||0,De=i.useMemo(()=>{const ce=p.trim().toLowerCase();return ce?ie.filter(Ce=>{const xt=String((Ce==null?void 0:Ce.code)||"").toLowerCase(),hs=String((Ce==null?void 0:Ce.name)||"").toLowerCase();return xt.includes(ce)||hs.includes(ce)}):ie},[ie,p]),Z=i.useMemo(()=>{var ce;return o!=="view"||!c?null:((ce=U.data)==null?void 0:ce.item)||ie.find(Ce=>Ce.id===c)||null},[U.data,ie,o,c]),ve=ce=>{s(`/super-admin/divisions/${ce}`)},ue=i.useMemo(()=>{const ce=Z==null?void 0:Z.createdAt,Ce=ce?new Date(ce):null;return Ce&&!Number.isNaN(Ce.getTime())?new Intl.DateTimeFormat("en-US",{month:"long",year:"numeric"}).format(Ce):""},[Z]),re=ce=>{const Ce=String((ce==null?void 0:ce.createdAt)||"");return Ce?Ce.slice(0,10):""},Re=ce=>{const Ce=ce==null?void 0:ce.type;return Ce==="REVENUE"?"Revenue":Ce==="INTERNAL"?"Internal":""};return V.status==="loading"&&!V.data?e.jsx(de,{}):V.status==="error"?((me=V.error)==null?void 0:me.status)===403?e.jsx(ge,{}):e.jsx(le,{error:V.error}):e.jsxs("div",{className:"max-w-6xl mx-auto space-y-5",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Divisions"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Root of financial attribution"})]}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[r?e.jsxs("button",{type:"button",className:"group relative inline-flex items-center gap-3 rounded-2xl bg-gradient-to-r from-emerald-600 to-green-600 px-6 py-3 text-sm font-semibold text-white shadow-lg hover:shadow-xl hover:from-emerald-700 hover:to-green-700 transition-all duration-200 transform hover:scale-105",onClick:()=>s("/super-admin/divisions/create"),children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-white opacity-0 group-hover:opacity-20 transition-opacity"}),e.jsx("svg",{className:"w-5 h-5 relative",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"relative",children:"Add Division"})]}):null,ue?e.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-full",children:[e.jsx("span",{className:"text-sm text-emerald-700 font-medium",children:ue}),e.jsx("span",{className:"text-emerald-600 font-bold text-xs bg-emerald-200 px-2 py-1 rounded-full",children:"OPEN"})]}):null]})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-emerald-50 to-green-50/50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-4.35-4.35m1.35-5.65a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"})})}),e.jsx("input",{className:"w-full pl-11 pr-4 py-3 rounded-xl border border-slate-300 bg-white text-sm placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md",placeholder:"Search divisions by name or code",value:p,onChange:ce=>y(ce.target.value)})]})}),e.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 px-4 py-3 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-xl hover:bg-slate-50 transition-all duration-200 shadow-sm",onClick:()=>{y(""),s("/super-admin/divisions")},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear"]})]})}),e.jsxs("div",{className:"p-4",children:[j?null:e.jsx("div",{className:"mb-4 rounded-lg border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("div",{children:"Divisions define financial truth."}),e.jsx("div",{children:"Every salary, expense, and income is ultimately attributed here."})]}),e.jsx("button",{type:"button",className:"text-sm font-medium text-indigo-800 hover:underline",onClick:()=>{h(!0);try{window.localStorage.setItem("divisions_context_banner_dismissed","1")}catch{}},children:"Dismiss"})]})}),o==="list"?e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-emerald-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),"Divisions"]}),e.jsx("div",{className:"bg-white px-3 py-1 rounded-full border border-slate-200 shadow-sm",children:e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[we," total"]})})]})}),e.jsx("div",{className:"p-4",children:ie.length===0?e.jsx(ye,{title:"No divisions",description:"No divisions found."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 md:hidden p-4",children:De.map(ce=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"mb-4 pb-3 border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("button",{type:"button",className:"text-lg font-bold text-slate-900 hover:text-emerald-700 transition-colors text-left flex-1",onClick:()=>{ve(ce.id)},children:ce.name}),e.jsx("div",{children:ce.isActive?e.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700 border border-emerald-200",children:"Active"}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600 border border-slate-200",children:"Inactive"})})]}),e.jsxs("div",{className:"flex items-center text-sm text-slate-600",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Created ",re(ce)]})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 font-semibold",children:"Code"}),e.jsx("span",{className:"font-mono text-slate-900 bg-slate-50 px-3 py-1 rounded-lg border border-slate-200",children:ce.code})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 font-semibold",children:"Type"}),e.jsx("span",{className:"inline-flex rounded-full border border-slate-300 px-3 py-1 text-xs font-medium text-slate-700 bg-white",children:Re(ce)})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-slate-100",children:e.jsxs("button",{type:"button",className:"w-full flex items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-emerald-50 to-green-50 px-4 py-3 text-sm font-semibold text-emerald-800 hover:from-emerald-100 hover:to-green-100 transition-all duration-200 border border-emerald-200",onClick:()=>{ve(ce.id)},children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View Details"]})})]},ce.id))}),e.jsx("div",{className:"hidden md:block",children:e.jsx(ha,{columns:[{key:"code",title:"Division Code",render:(ce,Ce)=>e.jsx("span",{className:"font-mono text-sm text-slate-900",children:Ce.code})},{key:"name",title:"Division Name",render:(ce,Ce)=>e.jsx("button",{type:"button",className:"text-sm text-indigo-800 hover:underline",onClick:()=>{ve(Ce.id)},children:Ce.name})},{key:"type",title:"Type",render:(ce,Ce)=>e.jsx("span",{className:"inline-flex rounded-full border border-slate-300 px-2 py-0.5 text-xs text-slate-700",children:Re(Ce)})},{key:"status",title:"Status",render:(ce,Ce)=>Ce.isActive?e.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-sm font-medium text-emerald-700",children:"Active"}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-sm font-medium text-slate-600",children:"Inactive"})},{key:"createdOn",title:"Created On",render:(ce,Ce)=>e.jsx("span",{className:"text-sm text-slate-700",children:re(Ce)})},{key:"action",title:"Action",render:(ce,Ce)=>e.jsx("button",{type:"button",className:"text-sm font-medium text-indigo-800 hover:underline",onClick:()=>{ve(Ce.id)},children:"View"})}],data:De.map(ce=>({...ce,type:ce.type,status:ce.isActive,createdOn:re(ce),action:ce.id})),empty:"No divisions found"})})]})})]}):e.jsx("div",{className:"mx-auto max-w-[640px]",children:e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:o==="create"?"Add Division":"Division"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Root of financial attribution. Changes must be explicit and auditable."})]}),e.jsx("button",{type:"button",className:"rounded-md border border-slate-400 bg-slate-800 px-3 py-2 text-sm font-medium text-white shadow-md hover:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2",onClick:()=>{s("/super-admin/divisions")},children:" Back"})]}),o==="view"&&U.status==="loading"&&!U.data?e.jsx("div",{className:"mt-4",children:e.jsx(de,{})}):null,o==="view"&&U.status==="error"?e.jsx("div",{className:"mt-4",children:((K=U.error)==null?void 0:K.status)===403?e.jsx(ge,{}):e.jsx(le,{error:U.error})}):null,e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Division Code"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("input",{className:"w-full rounded-md border-slate-300 text-sm font-mono bg-white disabled:bg-slate-50",value:o==="view"?String((Z==null?void 0:Z.code)||""):w,onChange:ce=>S(ce.target.value),disabled:o==="view",maxLength:((pe=(je=(be=t==null?void 0:t.validation)==null?void 0:be.rules)==null?void 0:je.division)==null?void 0:pe.codeMax)||20}),e.jsx("div",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Division codes are permanent. Choose carefully."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Division Name"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm bg-white disabled:bg-slate-50",value:o==="view"?String((Z==null?void 0:Z.name)||""):N,onChange:ce=>E(ce.target.value),disabled:o==="view",maxLength:((Me=(Se=(Ae=t==null?void 0:t.validation)==null?void 0:Ae.rules)==null?void 0:Se.division)==null?void 0:Me.nameMax)||100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Description"}),e.jsx("textarea",{className:"mt-1 w-full h-24 rounded-md border-slate-300 text-sm bg-white disabled:bg-slate-50",value:o==="create"?T:String((Z==null?void 0:Z.description)||""),onChange:ce=>C(ce.target.value),disabled:o!=="create"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"block text-sm font-medium text-slate-700",children:"Division Type"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[e.jsx("input",{type:"radio",className:"border-slate-300",checked:o==="create"?v==="REVENUE":(Z==null?void 0:Z.type)==="REVENUE",onChange:()=>A("REVENUE"),disabled:o!=="create"}),"Revenue Generating"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[e.jsx("input",{type:"radio",className:"border-slate-300",checked:o==="create"?v==="INTERNAL":(Z==null?void 0:Z.type)==="INTERNAL",onChange:()=>A("INTERNAL"),disabled:o!=="create"}),"Internal / Support"]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"block text-sm font-medium text-slate-700",children:"Status"}),e.jsx("div",{className:(Z==null?void 0:Z.isActive)??!0?"mt-1 text-sm text-emerald-700":"mt-1 text-sm text-slate-500",children:(Z==null?void 0:Z.isActive)??!0?"Active":"Inactive"})]}),o==="create"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason (optional)"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm bg-white",value:k,onChange:ce=>D(ce.target.value)})]}):null]}),B.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:B.error})}):null,e.jsxs("div",{className:"mt-5 flex flex-col sm:flex-row gap-2 sm:justify-end",children:[o==="create"?e.jsx("button",{type:"button",className:"rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-black disabled:bg-slate-400",disabled:!ae||B.status==="loading",onClick:async()=>{await B.run(),P(),d("list"),m(null),S(""),E(""),A("INTERNAL"),C(""),D(""),V.refresh()},children:B.status==="loading"?"Creating":"Create Division"}):null,null,o==="view"&&(Z!=null&&Z.isActive)&&(Z==null?void 0:Z.canDeactivate)===!1?e.jsxs("div",{className:"rounded-lg border border-slate-300 bg-slate-50 p-3 text-slate-600",children:[e.jsx("div",{className:"text-sm",children:"Cannot deactivate division:"}),e.jsx("div",{className:"mt-1 text-sm",children:Array.isArray(Z.blockedReasons)&&Z.blockedReasons.length>0?e.jsx("div",{className:"space-y-0.5",children:Z.blockedReasons.map((ce,Ce)=>e.jsx("div",{children:ce},Ce))}):e.jsx("div",{children:"Blocked by system rules"})})]}):null]})]})}),R?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>{Q.status!=="loading"&&(L(!1),I(null),W(""))}}),e.jsxs("div",{className:"relative w-full max-w-lg rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:G?"Activate Division":"Deactivate Division"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:_?e.jsxs("span",{children:[_.code,"  ",_.name]}):null}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason (required)"}),e.jsx("textarea",{className:"mt-1 w-full h-28 rounded-md border-slate-300 text-sm bg-white focus:ring-2 focus:ring-slate-900 focus:border-slate-900",value:F,onChange:ce=>W(ce.target.value),placeholder:"Explain why this activation change is needed"}),F.trim().length===0?e.jsx("div",{className:"mt-1 text-xs text-rose-700",children:"Reason is required."}):null]}),Q.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:Q.error})}):null,e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 disabled:bg-slate-50",disabled:Q.status==="loading",onClick:()=>{L(!1),I(null),W("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-black disabled:bg-slate-400",disabled:Q.status==="loading"||F.trim().length===0||!_,onClick:async()=>{await Q.run({id:_.id,isActive:G,reason:F.trim()}),G===!1&&P(),L(!1),I(null),W(""),V.refresh(),o==="view"&&U.refresh()},children:Q.status==="loading"?"Saving":"Confirm"})]})]})]}):null,e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 disabled:bg-slate-50",disabled:f<=1,onClick:()=>u(ce=>Math.max(1,ce-1)),children:"Prev"}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",f]}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 disabled:bg-slate-50",disabled:f*b>=we,onClick:()=>u(ce=>ce+1),children:"Next"})]})]})]})]})}function wo(){return e.jsx(lN,{})}function rN(t){const s=new URL("/api/v1/governance/projects","http://local");return t&&s.searchParams.set("divisionId",t),s.pathname+s.search}function iN(){var we,De,Z,ve,ue,re,Re;const{bootstrap:t}=he();(Z=(De=(we=t==null?void 0:t.ui)==null?void 0:we.screens)==null?void 0:De.projects)!=null&&Z.title;const[s,a]=i.useState("list"),[n,l]=i.useState(null),[r,o]=i.useState(1),[d]=i.useState(20),[c,m]=i.useState(""),[g,x]=i.useState(()=>{try{return window.localStorage.getItem("projects_context_banner_dismissed")==="1"}catch{return!1}}),[j,h]=i.useState(""),[f,u]=i.useState(""),[b,p]=i.useState(""),[y,w]=i.useState(""),[S,N]=i.useState(!1),[E,v]=i.useState(!1),[A,T]=i.useState(null),[C,k]=i.useState(!1),[D,R]=i.useState(""),L=Pe({path:"/api/v1/governance/divisions",page:1,pageSize:200,enabled:!0}),_=Pe({path:rN(j||null),page:r,pageSize:d,enabled:!0}),I=Pe({path:n?`/api/v1/governance/projects/${n}`:"/api/v1/governance/projects/__none__",page:1,pageSize:1,enabled:!!n}),G=Be(async()=>z("/api/v1/governance/projects",{method:"POST",body:{divisionId:j,code:f.trim(),name:b.trim(),reason:y||null}})),O=Be(async({id:ne,isActive:H,reason:te})=>z(`/api/v1/governance/projects/${ne}`,{method:"PATCH",body:{isActive:H,reason:te}}));i.useMemo(()=>j.trim().length>0&&f.trim().length>0&&b.trim().length>0,[j,f,b]);const F=((ve=_.data)==null?void 0:ve.items)||[],W=((ue=_.data)==null?void 0:ue.total)||0,$=((re=L.data)==null?void 0:re.items)||[],M=i.useMemo(()=>{const ne=c.trim().toLowerCase();return ne?F.filter(H=>{const te=String((H==null?void 0:H.code)||"").toLowerCase(),q=String((H==null?void 0:H.name)||"").toLowerCase();return te.includes(ne)||q.includes(ne)}):F},[F,c]),P=ne=>{const H=String((ne==null?void 0:ne.createdAt)||"");return H?H.slice(0,10):""},V=ne=>{var H;return((H=$.find(te=>te.id===ne.divisionId))==null?void 0:H.name)||""},U=ne=>ne?typeof ne=="string"&&ne.includes("-")&&ne.length>20?"System Admin":typeof ne=="string"&&!ne.includes("-")?ne:"System":"System",B=i.useMemo(()=>{var H;if(!n)return null;const ne=F.find(te=>te.id===n);return ne||((H=I.data)==null?void 0:H.item)||null},[F,n,I.data]),Q=ne=>{l(n===ne?null:ne)},ae=ne=>{const H=String((ne==null?void 0:ne.createdAt)||"");return H?H.slice(0,10):""},ie=()=>f.trim()&&b.trim()&&y.trim();return _.status==="loading"&&!_.data?e.jsx(de,{}):_.status==="error"?((Re=_.error)==null?void 0:Re.status)===403?e.jsx(ge,{}):e.jsx(le,{error:_.error}):e.jsxs("div",{className:"max-w-6xl mx-auto space-y-5",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Projects / Programs"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Work attribution and reporting context"})]}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1 max-w-md hidden sm:block",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-4.35-4.35m1.35-5.65a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"})})}),e.jsx("input",{className:"w-full pl-11 pr-4 py-3 rounded-xl border border-slate-300 bg-white text-sm placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md",placeholder:"Search projects by name or code",value:c,onChange:ne=>m(ne.target.value)})]})}),e.jsxs("button",{type:"button",className:"group relative inline-flex items-center gap-3 rounded-2xl bg-gradient-to-r from-purple-600 to-violet-600 px-6 py-3 text-sm font-semibold text-white shadow-lg hover:shadow-xl hover:from-purple-700 hover:to-violet-700 transition-all duration-200 transform hover:scale-105",onClick:()=>{N(!0)},children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-white opacity-0 group-hover:opacity-20 transition-opacity"}),e.jsx("svg",{className:"w-5 h-5 relative",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"relative hidden sm:inline",children:"Create Project"}),e.jsx("span",{className:"relative sm:hidden",children:"Create"})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50/50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),"Projects"]}),e.jsx("div",{className:"bg-white px-3 py-1 rounded-full border border-slate-200 shadow-sm",children:e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[W," total"]})})]})}),g?null:e.jsx("div",{className:"mb-4 rounded-lg border border-slate-200 bg-white p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:[e.jsx("div",{children:"Projects are optional."}),e.jsx("div",{children:"They help understand where time was spent, not where money was booked."})]}),e.jsx("button",{type:"button",className:"text-sm font-medium text-indigo-800 hover:underline",onClick:()=>{x(!0);try{window.localStorage.setItem("projects_context_banner_dismissed","1")}catch{}},children:"Dismiss"})]})}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm overflow-hidden mx-4 my-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-base font-bold text-slate-900",children:"Project List"}),e.jsxs("div",{className:"text-xs text-slate-500",children:[M.length," of ",W]})]})}),e.jsx("div",{className:"p-4",children:F.length===0?e.jsx(ye,{title:"No projects yet",description:"Projects help teams understand where effort was spent. They are optional and can be added anytime.",action:e.jsx("button",{type:"button",className:"rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-black",onClick:()=>{var ne;(ne=document.getElementById("create-project-form"))==null||ne.scrollIntoView({behavior:"smooth"})},children:"Create Project"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 md:hidden p-4",children:M.map(ne=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"mb-4 pb-3 border-b border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("button",{type:"button",className:"text-lg font-bold text-slate-900 hover:text-purple-700 transition-colors text-left flex-1",onClick:()=>{Q(ne.id)},children:ne.name}),e.jsx("div",{children:ne.isActive?e.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700 border border-emerald-200",children:"Active"}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600 border border-slate-200",children:"Inactive"})})]}),e.jsxs("div",{className:"flex items-center text-sm text-slate-600",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Created ",P(ne)]})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-600 font-semibold",children:"Code"}),e.jsx("span",{className:"font-mono text-slate-900 bg-slate-50 px-3 py-1 rounded-lg border border-slate-200",children:ne.code})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("span",{className:"text-slate-600 font-semibold",children:"Division"}),e.jsx("span",{className:"text-slate-900 text-right max-w-[140px] truncate font-medium",children:V(ne)})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-slate-100",children:e.jsxs("button",{type:"button",className:"w-full flex items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-purple-50 to-violet-50 px-4 py-3 text-sm font-semibold text-purple-800 hover:from-purple-100 hover:to-violet-100 transition-all duration-200 border border-purple-200",onClick:()=>{Q(ne.id)},children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),n===ne.id?"Hide Details":"View Details"]})}),n===ne.id&&B?e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 bg-slate-50 -mx-4 px-4 -mb-4 pb-4 rounded-b-lg",children:[e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Project Code:"}),e.jsx("span",{className:"font-mono text-slate-900",children:B.code})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Project Name:"}),e.jsx("span",{className:"text-slate-900",children:B.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Linked Division:"}),e.jsx("span",{className:"text-slate-900",children:V(B)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Status:"}),e.jsx("span",{children:B.isActive?e.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-100 px-2 py-1 text-xs font-medium text-emerald-700",children:"Active"}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-1 text-xs font-medium text-slate-600",children:"Inactive"})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Created Date:"}),e.jsx("span",{className:"text-slate-900",children:ae(B)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Created by:"}),e.jsx("span",{className:"text-slate-900",children:U(B.createdBy)})]})]}),B.isActive&&e.jsx("div",{className:"mt-4 pt-3 border-t border-slate-200",children:e.jsx("button",{type:"button",className:"w-full rounded-md bg-rose-600 px-3 py-2 text-sm font-medium text-white hover:bg-rose-700",onClick:()=>{T(B),k(!1),R(""),v(!0)},children:"Deactivate Project"})}),e.jsx("div",{className:"mt-4 pt-3 border-t border-slate-200",children:e.jsx("button",{type:"button",className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",onClick:()=>l(null),children:"Close"})})]}):null]},ne.id))}),e.jsx("div",{className:"hidden md:block",children:e.jsx(ha,{columns:[{key:"code",title:"Project Code",render:(ne,H)=>e.jsx("span",{className:"font-mono text-sm text-slate-900",children:H.code})},{key:"name",title:"Project Name",render:(ne,H)=>e.jsx("button",{type:"button",className:"text-sm text-indigo-800 hover:underline",onClick:()=>{Q(H.id)},children:H.name})},{key:"division",title:"Linked Division",render:(ne,H)=>e.jsx("span",{className:"text-sm text-slate-700",children:V(H)})},{key:"status",title:"Status",render:(ne,H)=>H.isActive?e.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-sm font-medium text-emerald-700",children:"Active"}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-sm font-medium text-slate-600",children:"Inactive"})},{key:"createdOn",title:"Created On",render:(ne,H)=>e.jsx("span",{className:"text-sm text-slate-700",children:P(H)})},{key:"action",title:"Action",render:(ne,H)=>e.jsx("button",{type:"button",className:"text-sm font-medium text-indigo-800 hover:underline",onClick:()=>{Q(H.id)},children:n===H.id?"Hide":"View"})}],data:M.map(ne=>({...ne,code:ne.code,name:ne.name,division:V(ne),status:ne.isActive,createdOn:P(ne),action:ne.id})),empty:"No projects found"})}),n&&B?e.jsxs("div",{className:"mt-6 rounded-xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:"Project Details"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Work attribution and reporting context."})]}),e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50",onClick:()=>l(null),children:"Close"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Project Code"}),e.jsx("div",{className:"mt-1 font-mono text-sm text-slate-900",children:B.code})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Status"}),e.jsx("div",{className:"mt-1",children:B.isActive?e.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-sm font-medium text-emerald-700",children:"Active"}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-sm font-medium text-slate-600",children:"Inactive"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Project Name"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:B.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Linked Division"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:V(B)})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Created Date (YYYY-MM-DD)"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:ae(B)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Created by"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:U(B.createdBy)})]})]}),B.isActive&&e.jsx("div",{className:"pt-6 border-t border-slate-200",children:e.jsx("button",{type:"button",className:"rounded-md bg-rose-600 px-4 py-2 text-sm font-medium text-white hover:bg-rose-700 shadow-sm",onClick:()=>{T(B),k(!1),R(""),v(!0)},children:"Deactivate Project"})})]})]}):null]})})]}),E?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>{O.status!=="loading"&&(v(!1),T(null),R(""))}}),e.jsxs("div",{className:"relative w-full max-w-lg rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:C?"Activate Project":"Deactivate Project"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:C?A?e.jsxs("span",{children:[A.code,"  ",A.name]}):null:e.jsx("span",{children:"Deactivating a project stops further usage. This action is audited."})}),!C&&A&&e.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:[e.jsx("strong",{children:"Project:"})," ",A.code,"  ",A.name]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:C?"Reason (required)":"Reason for deactivation (required)"}),e.jsx("textarea",{className:"mt-1 w-full h-28 rounded-md border-slate-300 text-sm",value:D,onChange:ne=>R(ne.target.value),placeholder:C?"Explain why this activation change is needed":"Enter reason for deactivation (minimum 10 characters)"}),D.trim().length>0&&D.trim().length<10?e.jsx("div",{className:"mt-1 text-xs text-rose-700",children:"Reason must be at least 10 characters."}):null,D.trim().length===0?e.jsx("div",{className:"mt-1 text-xs text-rose-700",children:"Reason is required."}):null]}),O.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:O.error})}):null,e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:O.status==="loading",onClick:()=>{v(!1),T(null),R("")},children:"Cancel"}),e.jsx("button",{type:"button",className:`rounded-md px-3 py-2 text-sm font-medium text-white disabled:bg-slate-400 ${C?"bg-slate-900 hover:bg-black":"bg-rose-600 hover:bg-rose-700"}`,disabled:O.status==="loading"||D.trim().length===0||D.trim().length<10||!A,onClick:async()=>{await O.run({id:A.id,isActive:C,reason:D.trim()}),v(!1),T(null),R(""),_.refresh()},children:O.status==="loading"?"Saving":C?"Confirm":"Confirm Deactivate"})]})]})]}):null,S?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>{G.status!=="loading"&&N(!1)}}),e.jsxs("div",{className:"relative w-full max-w-lg rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:"Create Project"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Add a new project to track work attribution and reporting context."}),e.jsxs("form",{onSubmit:async ne=>{if(ne.preventDefault(),!!ie())try{await G.run(),N(!1),u(""),p(""),w(""),_.refresh()}catch(H){console.error("Create project failed:",H)}},children:[e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Division"}),e.jsxs("select",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:j,onChange:ne=>h(ne.target.value),children:[e.jsx("option",{value:"",children:"Select division"}),$.map(ne=>e.jsx("option",{value:ne.id,children:ne.name},ne.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Project Code"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:f,onChange:ne=>u(ne.target.value),placeholder:"PROJ001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Project Name"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:b,onChange:ne=>p(ne.target.value),placeholder:"Project name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason"}),e.jsx("textarea",{className:"mt-1 w-full h-20 rounded-md border-slate-300 text-sm",value:y,onChange:ne=>w(ne.target.value),placeholder:"Why create this project?"})]})]}),G.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:G.error})}):null,e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:G.status==="loading",onClick:()=>{N(!1)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white disabled:bg-slate-400",disabled:G.status==="loading"||!ie(),children:G.status==="loading"?"Creating":"Create Project"})]})]})]})]}):null]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:r<=1,onClick:()=>o(ne=>Math.max(1,ne-1)),children:"Previous"}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",r]}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:r*d>=W,onClick:()=>o(ne=>ne+1),children:"Next"})]})]})}function oN(){return e.jsx(iN,{})}function dN(...t){return t.filter(Boolean).join(" ")}function cN(t){const s=String(t??"").trim().toLowerCase();return s==="true"||s==="1"||s==="yes"||s==="enabled"||s==="on"}function So(t){const s=String((t==null?void 0:t.firstName)||"").trim(),a=String((t==null?void 0:t.lastName)||"").trim();return`${s} ${a}`.trim()||""}function mN(t){const s=String(t||"").toUpperCase();return s==="SUBMITTED"?"bg-blue-50 text-blue-800":s==="APPROVED"?"bg-emerald-50 text-emerald-800":s==="REJECTED"?"bg-rose-50 text-rose-800":s==="REVISION_REQUIRED"?"bg-amber-50 text-amber-800":"bg-slate-100 text-slate-800"}function uN({status:t,approvalLevel:s}){const a=String(t||"").toUpperCase(),n=String(s||"").toUpperCase();return a==="SUBMITTED"?n==="L2"?"Pending for L2":"Pending for L1":a||"-"}function Ju({status:t,approvalLevel:s}){const a=String(t||"").toUpperCase();if(!a)return null;const n=uN({status:a,approvalLevel:s});return e.jsx("span",{className:dN("inline-flex rounded-full px-2 py-1 text-xs font-semibold",mN(a)),children:n})}function xN(){var y,w,S,N,E;const{bootstrap:t}=he(),s=((y=t==null?void 0:t.rbac)==null?void 0:y.permissions)||[],a=((w=t==null?void 0:t.rbac)==null?void 0:w.roles)||[],n=s.includes("TIMESHEET_APPROVAL_QUEUE_READ"),l=a.includes("SUPER_ADMIN"),r=(t==null?void 0:t.systemConfig)||{},o=cN(((S=r==null?void 0:r.TIMESHEET_ENABLED)==null?void 0:S.value)??(r==null?void 0:r.TIMESHEET_ENABLED)),[d,c]=i.useState(1),[m]=i.useState(20),[g,x]=i.useState(""),j=Pe({path:"/api/v1/timesheets/approvals",page:d,pageSize:m,enabled:n&&o}),h=Array.isArray((N=j.data)==null?void 0:N.items)?j.data.items:[],f=Number((E=j.data)==null?void 0:E.total)||0,u=i.useMemo(()=>{if(!Array.isArray(h))return[];const v=String(g||"").trim().toLowerCase();return v?h.filter(A=>`${(A==null?void 0:A.employeeCode)||""} ${So(A)} ${(A==null?void 0:A.periodStart)||""} ${(A==null?void 0:A.periodEnd)||""}`.toLowerCase().includes(v)):h},[h,g]),b=i.useMemo(()=>{const v=[{key:"employee",header:"Employee",render:A=>e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:So(A)}),e.jsx("div",{className:"mt-1 font-mono text-xs text-slate-600",children:(A==null?void 0:A.employeeCode)||""})]})},{key:"week",header:"Week",render:A=>e.jsxs("span",{className:"font-mono text-sm",children:[(A==null?void 0:A.periodStart)||"","  ",(A==null?void 0:A.periodEnd)||""]})},{key:"status",header:"Status",render:A=>e.jsx(Ju,{status:A==null?void 0:A.status,approvalLevel:A==null?void 0:A.approvalLevel})}];return l||v.push({key:"action",header:"Action",render:A=>e.jsx("div",{className:"flex items-center justify-end",children:e.jsx($e,{to:`/timesheet/${A==null?void 0:A.id}`,className:"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"View"})})}),v},[l]),p=i.useMemo(()=>{var v;return n?o?j.status==="loading"&&!j.data?e.jsx(de,{}):j.status==="error"?((v=j.error)==null?void 0:v.status)===403?e.jsx(ge,{}):e.jsx(le,{error:j.error}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Search"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:g,onChange:A=>{x(A.target.value),c(1)},placeholder:"Employee code or name"})]}),e.jsx("div",{className:"md:col-span-1 flex items-end justify-end",children:e.jsx("button",{type:"button",className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:j.refresh,disabled:j.status==="loading",children:j.status==="loading"?"Refreshing":"Refresh"})})]})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50/50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),"Timesheet Approval Queue"]}),e.jsx("div",{className:"bg-white px-3 py-1 rounded-full border border-slate-200 shadow-sm",children:e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[f," total"]})})]})}),e.jsxs("div",{className:"p-4",children:[!Array.isArray(u)||u.length===0?e.jsx(ye,{title:"No timesheets available",description:"No timesheets found in the approval queue."}):e.jsx("div",{className:"hidden md:block",children:e.jsx(ha,{columns:b,rows:u.map(A=>({key:(A==null?void 0:A.id)||Math.random(),data:A}))})}),e.jsx("div",{className:"grid grid-cols-1 gap-3 md:hidden",children:u.map(A=>e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:So(A)}),e.jsx("div",{className:"mt-1 font-mono text-xs text-slate-600",children:(A==null?void 0:A.employeeCode)||""})]}),e.jsx(Ju,{status:A==null?void 0:A.status,approvalLevel:A==null?void 0:A.approvalLevel})]}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Week"}),e.jsxs("div",{className:"mt-1 font-mono text-sm text-slate-900",children:[(A==null?void 0:A.periodStart)||"","  ",(A==null?void 0:A.periodEnd)||""]}),e.jsx("div",{className:"mt-3",children:!l&&e.jsx($e,{to:`/timesheet/${A==null?void 0:A.id}`,className:"inline-flex w-full items-center justify-center rounded-md border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"View"})})]},(A==null?void 0:A.id)||Math.random()))})]}),e.jsx("div",{className:"p-4 pt-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:d<=1,onClick:()=>c(A=>Math.max(1,A-1)),children:"Previous"}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",d]}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:d*m>=f,onClick:()=>c(A=>A+1),children:"Next"})]})})]})]}):e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Timesheet is disabled"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"TIMESHEET_ENABLED must be enabled in system config."})]}):e.jsx(ge,{})},[n,u,j,d,m,g,o,f,l,b]);return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Timesheets"}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-8",children:e.jsx("div",{className:"mt-4",children:p})})]})}function hN({status:t}){const s=String(t||"").toUpperCase(),a=s==="PAID"?"bg-emerald-50 text-emerald-700 border-emerald-200":s==="APPROVED"?"bg-blue-50 text-blue-700 border-blue-200":s==="SUBMITTED"?"bg-amber-50 text-amber-700 border-amber-200":s==="REJECTED"?"bg-rose-50 text-rose-700 border-rose-200":"bg-slate-50 text-slate-700 border-slate-200";return e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${a}`,children:s})}function Ku(t){return Number(t||0).toLocaleString("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2})}function pN(){const[t,s]=i.useState("loading"),[a,n]=i.useState(null),[l,r]=i.useState(null);async function o(){try{s("loading"),n(null);const c=await Te.listIncome({page:1,size:50});r(c),s("ready")}catch(c){n(c),s("error")}}i.useEffect(()=>{o()},[]);const d=i.useMemo(()=>Array.isArray(l==null?void 0:l.items)?l.items:[],[l]);return t==="loading"?e.jsx(de,{message:"Loading revenue"}):t==="error"?(a==null?void 0:a.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_READ"}}):e.jsx(le,{error:a,onRetry:o}):e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Revenue"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"View organization revenue (UI only)."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{to:"/super-admin/reports",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Reports"}),e.jsx($e,{to:"/super-admin/revenue/categories",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Categories"}),e.jsx($e,{to:"/super-admin/revenue/clients",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Clients"})]})]}),d.length===0?e.jsx("div",{className:"mt-6",children:e.jsx(ye,{title:"No income",description:"No income entries found."})}):e.jsx("div",{className:"mt-6 overflow-hidden rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Division"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Client"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Title"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Paid / Due"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:d.map(c=>{const m=Number(c.amount||0),x=String(c.status||"").toUpperCase()==="PAID"?m:0,j=Math.max(0,m-x);return e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:String(c.incomeDate||"").slice(0,10)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:c.divisionId}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:c.categoryName||c.categoryId}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:c.clientName||c.clientId||""}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-900",children:c.title}),e.jsxs("td",{className:"px-4 py-3 text-sm text-right",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Ku(x)}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Due: ",Ku(j)]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(hN,{status:c.status})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx($e,{to:"#",className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-semibold text-blue-700 hover:text-blue-800 hover:bg-blue-50 transition",children:"View"})})]},c.id)})})]})})]})})}function fN(){const[t,s]=i.useState(!1),[a,n]=i.useState("loading"),[l,r]=i.useState(null),[o,d]=i.useState([]),[c,m]=i.useState(null),[g,x]=i.useState(""),[j,h]=i.useState(""),[f,u]=i.useState(""),[b,p]=i.useState("idle"),[y,w]=i.useState(null),S=!!(c!=null&&c.id);async function N(){try{n("loading"),r(null);const T=await Te.listCategories(),C=Array.isArray(T==null?void 0:T.items)?T.items:Array.isArray(T)?T:[];d(C),n("ready")}catch(T){r(T),n("error")}}if(i.useEffect(()=>{N()},[]),a==="loading")return e.jsx(de,{message:"Loading categories"});if(a==="error")return(l==null?void 0:l.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_CATEGORY_READ"}}):e.jsx(le,{error:l,onRetry:N});function E(){m(null),x(""),h(""),u(""),w(null),s(!0)}function v(T){m(T),x(T.code||""),h(T.name||""),u(T.description||""),w(null),s(!0)}async function A(){try{if(p("loading"),w(null),!String(g||"").trim())throw new Error("Code is required");if(!String(j||"").trim())throw new Error("Name is required");S?await Te.updateCategory(c.id,{code:g,name:j,description:f,isActive:!!c.isActive,version:c.version}):await Te.createCategory({code:g,name:j,description:f}),p("idle"),s(!1),await N()}catch(T){w(T),p("idle")}}return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Revenue Categories"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Manage categories (UI only)."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{to:"/super-admin/revenue",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"}),e.jsx("button",{onClick:E,className:"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow hover:from-blue-700 hover:to-indigo-800 transition",children:"Add Category"})]})]}),o.length===0?e.jsx("div",{className:"mt-6",children:e.jsx(ye,{title:"No categories",description:"Create your first category."})}):e.jsx("div",{className:"mt-6 overflow-hidden rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:o.map(T=>e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-slate-900",children:T.code}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:T.name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${T.isActive?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-50 text-slate-700 border-slate-200"}`,children:T.isActive?"ACTIVE":"INACTIVE"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>v(T),className:"px-3 py-1.5 rounded-lg text-sm font-semibold text-blue-700 hover:bg-blue-50",children:"Edit"})})]},T.id))})]})}),t&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>s(!1)}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white rounded-2xl shadow-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Category"}),e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:"Add/Edit (UI only)."})]}),e.jsx("button",{onClick:()=>s(!1),className:"p-2 rounded-xl hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Code"}),e.jsx("input",{value:g,onChange:T=>x(T.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"CONSULTING"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("input",{value:j,onChange:T=>h(T.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"Consulting"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Description"}),e.jsx("textarea",{value:f,onChange:T=>u(T.target.value),rows:3,className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"Optional"})]})]}),y?e.jsx("div",{className:"mt-4 text-sm text-rose-700",children:String(y.message||y)}):null,e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{disabled:b==="loading",onClick:A,className:"px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow disabled:opacity-50",children:"Save"})]})]})]})]})})}function gN(){const[t,s]=i.useState(!1),[a,n]=i.useState("loading"),[l,r]=i.useState(null),[o,d]=i.useState([]),[c,m]=i.useState(null),[g,x]=i.useState(""),[j,h]=i.useState(""),[f,u]=i.useState(""),[b,p]=i.useState(""),[y,w]=i.useState("idle"),[S,N]=i.useState(null),E=!!(c!=null&&c.id);async function v(){try{n("loading"),r(null);const k=await Te.listClients({page:1,size:200});d(Array.isArray(k==null?void 0:k.items)?k.items:[]),n("ready")}catch(k){r(k),n("error")}}if(i.useEffect(()=>{v()},[]),a==="loading")return e.jsx(de,{message:"Loading clients"});if(a==="error")return(l==null?void 0:l.status)===403?e.jsx(ge,{error:{message:"Forbidden",requiredPermission:"INCOME_CLIENT_READ"}}):e.jsx(le,{error:l,onRetry:v});function A(){m(null),x(""),h(""),u(""),p(""),N(null),s(!0)}function T(k){m(k),x(k.code||""),h(k.name||""),u(k.email||""),p(k.phone||""),N(null),s(!0)}async function C(){try{if(w("loading"),N(null),!String(g||"").trim())throw new Error("Code is required");if(!String(j||"").trim())throw new Error("Name is required");E?await Te.updateClient(c.id,{code:g,name:j,email:f,phone:b,isActive:!!c.isActive,version:c.version}):await Te.createClient({code:g,name:j,email:f,phone:b}),w("idle"),s(!1),await v()}catch(k){N(k),w("idle")}}return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Revenue Clients"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Manage clients (UI only)."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{to:"/super-admin/revenue",className:"inline-flex items-center px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50 transition",children:"Back"}),e.jsx("button",{onClick:A,className:"inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow hover:from-blue-700 hover:to-indigo-800 transition",children:"Add Client"})]})]}),o.length===0?e.jsx("div",{className:"mt-6",children:e.jsx(ye,{title:"No clients",description:"Create your first client."})}):e.jsx("div",{className:"mt-6 overflow-hidden rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:o.map(k=>e.jsxs("tr",{className:"hover:bg-slate-50/60 transition",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-slate-900",children:k.code}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:k.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:k.email}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold border ${k.isActive?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-50 text-slate-700 border-slate-200"}`,children:k.isActive?"ACTIVE":"INACTIVE"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{onClick:()=>T(k),className:"px-3 py-1.5 rounded-lg text-sm font-semibold text-blue-700 hover:bg-blue-50",children:"Edit"})})]},k.id))})]})}),t&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>s(!1)}),e.jsxs("div",{className:"relative w-full max-w-lg bg-white rounded-2xl shadow-xl p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:"Client"}),e.jsx("div",{className:"text-sm text-slate-500 mt-1",children:"Add/Edit (UI only)."})]}),e.jsx("button",{onClick:()=>s(!1),className:"p-2 rounded-xl hover:bg-slate-100",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Code"}),e.jsx("input",{value:g,onChange:k=>x(k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"ACME"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Name"}),e.jsx("input",{value:j,onChange:k=>h(k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"Acme Corp"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Email"}),e.jsx("input",{value:f,onChange:k=>u(k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"billing@acme.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600",children:"Phone"}),e.jsx("input",{value:b,onChange:k=>p(k.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",placeholder:"9999999999"})]})]}),S?e.jsx("div",{className:"mt-4 text-sm text-rose-700",children:String(S.message||S)}):null,e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-700 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{disabled:y==="loading",onClick:C,className:"px-4 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-700 text-white font-semibold shadow disabled:opacity-50",children:"Save"})]})]})]})]})})}function vN(){return e.jsx($h,{title:"Operations Dashboard"})}function bN(){return e.jsx(Ei,{title:"Inbox"})}function jN(){return e.jsx(Tc,{title:"Alerts"})}function NN(){return e.jsx(Vh,{title:"Overrides"})}function yN(){return e.jsx(Pc,{title:"Data Quality"})}function Xu(t,s){const a=t||[];return a.includes("SYSTEM_FULL_ACCESS")||a.includes(s)}function wN(){var N;const t=Ue(),{bootstrap:s}=he(),a=((N=s==null?void 0:s.rbac)==null?void 0:N.permissions)||[],n=Xu(a,"REIMBURSEMENT_VIEW_DIVISION")||Xu(a,"REIMBURSEMENT_VIEW_SELF"),[l,r]=i.useState("loading"),[o,d]=i.useState(null),[c,m]=i.useState(null),[g,x]=i.useState(1),j=20,[h,f]=i.useState(""),[u,b]=i.useState("");async function p(){try{r("loading"),d(null);const E=await Je.getAllReimbursements({page:g,pageSize:j,status:h||null,month:u||null});m(E),r("ready")}catch(E){d(E),r("error")}}i.useEffect(()=>{n&&p()},[g,h,u,n]);const y=i.useMemo(()=>Array.isArray(c==null?void 0:c.items)?c.items:[],[c]),w=i.useMemo(()=>Number((c==null?void 0:c.total)||0),[c]),S=i.useMemo(()=>Math.max(1,Math.ceil(w/j)),[w,j]);return n?l==="loading"?e.jsx(de,{message:"Loading reimbursements"}):l==="error"?e.jsx(le,{error:o,onRetry:p}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Reimbursements"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Global view (role/permission gated)."})]}),e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Month"}),e.jsx("input",{type:"month",value:u,onChange:E=>{b(E.target.value),x(1)},className:"w-full px-3 py-2 rounded-xl border border-slate-200 text-sm bg-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Status"}),e.jsxs("select",{value:h,onChange:E=>{f(E.target.value),x(1)},className:"w-full px-3 py-2 rounded-xl border border-slate-200 text-sm bg-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"}),e.jsx("option",{value:"APPROVED",children:"APPROVED"}),e.jsx("option",{value:"REJECTED",children:"REJECTED"}),e.jsx("option",{value:"PAID",children:"PAID"}),e.jsx("option",{value:"CLOSED",children:"CLOSED"})]})]})]})}),y.length===0?e.jsx(ye,{title:"No data",description:"No reimbursements matched your filters."}):e.jsx(Ci,{rows:y,loading:!1,empty:"No reimbursements",onRowClick:E=>t(`/super-admin/reimbursements/${E.id}`)}),e.jsxs("div",{className:"flex items-center justify-between bg-white rounded-2xl border border-slate-200/60 shadow-sm px-4 py-3",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",g," of ",S," (Total: ",w,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{disabled:g<=1,onClick:()=>x(E=>Math.max(1,E-1)),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:g>=S,onClick:()=>x(E=>Math.min(S,E+1)),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm disabled:opacity-50",children:"Next"})]})]})]}):e.jsx(ye,{title:"No access",description:"You don't have permission to view reimbursements."})}function ko(t,s){const a=t||[];return a.includes("SYSTEM_FULL_ACCESS")||a.includes(s)}function Eo(t){const s=Number(t);return Number.isFinite(s)?s.toLocaleString("en-IN",{style:"currency",currency:"INR"}):""}function SN(){var w,S;const{id:t}=Dt(),s=Ue(),{bootstrap:a}=he(),n=((w=a==null?void 0:a.rbac)==null?void 0:w.permissions)||[],l=ko(n,"REIMBURSEMENT_VIEW_DIVISION")||ko(n,"REIMBURSEMENT_VIEW_SELF"),[r,o]=i.useState("loading"),[d,c]=i.useState(null),[m,g]=i.useState(null),[x,j]=i.useState([]),[h,f]=i.useState([]),u=ko(n,"GOV_AUDIT_READ"),b=i.useMemo(()=>{const N=new URL("/api/v1/governance/audit","http://local");return N.searchParams.set("entityId",String(t)),N.searchParams.set("page","1"),N.searchParams.set("pageSize","50"),N.pathname+N.search},[t]),p=Pe({path:b,page:1,pageSize:50,enabled:u});async function y(){try{o("loading"),c(null);const N=await Je.getReimbursementById(t);g((N==null?void 0:N.item)||null);const[E,v]=await Promise.all([Je.listReceipts(t),Je.listPayments(t,{page:1,pageSize:200})]);j(Array.isArray(E==null?void 0:E.items)?E.items:Array.isArray(E)?E:[]),f(Array.isArray(v==null?void 0:v.items)?v.items:[]),o("ready")}catch(N){c(N),o("error")}}return i.useEffect(()=>{l&&y()},[t,l]),l?r==="loading"?e.jsx(de,{message:"Loading claim"}):r==="error"?e.jsx(le,{error:d,onRetry:y}):m?e.jsxs("div",{className:"max-w-6xl mx-auto space-y-5",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Reimbursement"}),e.jsx(kn,{status:m.status})]}),e.jsxs("p",{className:"text-slate-600 mt-1",children:["Employee: ",m.employeeName||m.employeeId]}),e.jsxs("p",{className:"text-slate-600",children:["ID: ",m.id]})]}),e.jsx("button",{onClick:()=>s("/super-admin/reimbursements"),className:"px-4 py-2 rounded-xl bg-slate-100 text-slate-700 text-sm font-semibold hover:bg-slate-200",children:"Back"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Total"}),e.jsx("div",{className:"text-lg font-bold text-slate-900",children:Eo(m.totalAmount)})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Paid"}),e.jsx("div",{className:"text-lg font-bold text-slate-900",children:Eo(m.paidAmount)})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-3",children:[e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:"Due"}),e.jsx("div",{className:"text-lg font-bold text-slate-900",children:Eo(m.dueAmount)})]})]}),m.linkedExpenseId?e.jsxs("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-xl p-3",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-800",children:"Linked Expense (read-only)"}),e.jsx("div",{className:"text-sm text-blue-900 mt-1",children:m.linkedExpenseId})]}):null]}),d?e.jsx(le,{error:d,onRetry:y}):null,e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Receipts"}),(x||[]).length===0?e.jsx("div",{className:"mt-3 text-sm text-slate-600",children:"No receipts uploaded."}):e.jsx("div",{className:"mt-3 space-y-2",children:x.map(N=>e.jsxs("div",{className:"flex items-center justify-between gap-3 bg-slate-50 border border-slate-200 rounded-xl p-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:N.fileName}),e.jsxs("div",{className:"text-xs text-slate-600",children:[N.contentType,"  ",Number(N.fileSize||0).toLocaleString()," bytes"]})]}),e.jsx("button",{onClick:()=>Je.downloadReceipt(t,N.id,N.fileName),className:"px-3 py-2 rounded-xl border border-slate-200 bg-white text-sm font-semibold hover:bg-slate-100",children:"Download"})]},N.id))})]}),e.jsx(Ai,{payments:h}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Audit Trail"}),u?null:e.jsx("div",{className:"text-xs text-slate-500",children:"Requires GOV_AUDIT_READ"})]}),u?p.status==="loading"&&!p.data?e.jsx("div",{className:"mt-3 text-sm text-slate-600",children:"Loading audit"}):p.status==="error"?e.jsx("div",{className:"mt-3 text-sm text-rose-600",children:"Failed to load audit."}):e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-600 uppercase",children:"When"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-600 uppercase",children:"Action"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-600 uppercase",children:"Actor"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-slate-600 uppercase",children:"Reason"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:(((S=p.data)==null?void 0:S.items)||[]).map(N=>e.jsxs("tr",{className:"hover:bg-slate-50/60",children:[e.jsx("td",{className:"px-4 py-2 text-sm text-slate-700",children:String(N.createdAt||N.created_at||"").replace("T"," ").slice(0,19)}),e.jsx("td",{className:"px-4 py-2 text-sm font-semibold text-slate-900",children:N.action}),e.jsx("td",{className:"px-4 py-2 text-sm text-slate-700",children:N.actorId||N.actor_id||""}),e.jsx("td",{className:"px-4 py-2 text-sm text-slate-700",children:N.reason||""})]},N.id))})]})}):e.jsx("div",{className:"mt-3 text-sm text-slate-600",children:"Audit trail not available."})]})]}):e.jsx(ye,{title:"Not found",description:"Reimbursement not found."}):e.jsx(ye,{title:"No access",description:"You don't have permission to view this claim."})}function Dd(t){const s=t instanceof Date?t:new Date(t);return new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth()+1,0)).toISOString().slice(0,10)}function pr(t){return Dd((t==null?void 0:t.monthEnd)||(t==null?void 0:t.monthStart)||(t==null?void 0:t.month))}function Jn(t){return new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",year:"numeric"})}function kN(){var v,A,T,C,k,D;const{bootstrap:t}=he();(T=(A=(v=t==null?void 0:t.ui)==null?void 0:v.screens)==null?void 0:A.monthClose)!=null&&T.title;const a=(((C=t==null?void 0:t.rbac)==null?void 0:C.roles)||[]).includes("SUPER_ADMIN"),[n,l]=i.useState(1),[r]=i.useState(20),[o,d]=i.useState(!1),[c,m]=i.useState(null),[g,x]=i.useState({irreversible:!1}),[j,h]=i.useState(""),[f,u]=i.useState(null),b=Pe({path:"/api/month-close",page:n,pageSize:r,enabled:!0});i.useEffect(()=>{b.refresh()},[]),i.useEffect(()=>{var R;b.status==="error"&&console.error("Month Close data fetch error:",b.error),(R=b.data)!=null&&R.items&&console.log("Month Close data loaded:",b.data.items.length,"items")},[b.status,b.data,b.error]);const p=Be(async R=>z("/api/month-close",{method:"POST",body:{month:R,status:"CLOSED",reason:"Month close completed through governance interface"}})),y=((k=b.data)==null?void 0:k.items)||[];(D=b.data)!=null&&D.total;const w=i.useMemo(()=>{const R=[],L=new Date,I=[...y].sort((O,F)=>{const W=new Date(pr(O));return new Date(pr(F)).getTime()-W.getTime()}).find(O=>O.status==="CLOSED"),G=Dd(L);for(let O=5;O>=0;O--){const F=new Date(L.getFullYear(),L.getMonth()-O,1),W=Dd(F),$=y.find(ae=>pr(ae)===W),M=!$&&(!I||new Date(W)>new Date(pr(I))),P=new Date(W)>new Date(G);let V,U,B,Q;$&&$.status==="CLOSED"?(V="CLOSED",U="Locked",B="Locked",Q="Locked"):P?(V="LOCKED",U="Locked",B="Locked",Q="Locked"):M?(V="OPEN  Current",U=O<2?"Locked":"Open",B=O<1?"Locked":"Open",Q="Open"):(V="OPEN",U="Locked",B="Locked",Q="Open"),R.push({month:Jn(W),monthEnd:W,attendance:U,payroll:B,finance:Q,status:V,record:$,isOpenMonth:M,isFutureMonth:P})}return R},[y]),S=async()=>{const R=await z(b.url);return(R==null?void 0:R.items)||[]},N=async()=>{try{await p.run(c.monthEnd),u({month:c.month,monthEnd:c.monthEnd}),await S(),d(!1),m(null)}catch(R){console.error("Failed to close month:",R)}},E=()=>{const R=`CLOSE ${Jn((c==null?void 0:c.monthEnd)||"").toUpperCase()}`;return g.irreversible&&j===R};return a?b.status==="loading"&&!b.data?e.jsx(de,{}):b.status==="error"?e.jsx(le,{error:b.error}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Month Close"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Financial period management and reporting"})]}),f&&e.jsx("div",{className:"bg-gradient-to-r from-emerald-50 to-green-50 border border-emerald-200 rounded-2xl p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-bold text-emerald-900 mb-1",children:[f.month," is now closed."]}),e.jsx("p",{className:"text-emerald-700 mb-4",children:"All records are locked and ready for reporting."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{className:"bg-gradient-to-r from-emerald-600 to-green-600 text-white px-4 py-2 rounded-xl font-semibold hover:from-emerald-700 hover:to-green-700 transition-all duration-200 shadow-sm hover:shadow-md",onClick:()=>u(null),children:"View Reports"}),e.jsx("button",{className:"border border-emerald-300 text-emerald-700 px-4 py-2 rounded-xl font-semibold hover:bg-emerald-50 transition-all duration-200",onClick:()=>u(null),children:"Return to Month Close Dashboard"})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50/50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),"Month Close Records"]}),e.jsx("div",{className:"bg-white px-3 py-1 rounded-full border border-slate-200 shadow-sm",children:e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[w.length," records"]})})]})}),e.jsx("div",{className:"p-6",children:w.length===0?e.jsx(ye,{title:"No month records found",description:"No month records found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-[900px] w-full",children:[e.jsx("thead",{className:"sticky top-0 bg-gradient-to-r from-slate-50 to-slate-100 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-4 px-4 font-bold text-slate-900",children:"Month"}),e.jsx("th",{className:"text-left py-4 px-4 font-bold text-slate-900",children:"Status"}),e.jsx("th",{className:"text-left py-4 px-4 font-bold text-slate-900",children:"Attendance"}),e.jsx("th",{className:"text-left py-4 px-4 font-bold text-slate-900",children:"Payroll"}),e.jsx("th",{className:"text-left py-4 px-4 font-bold text-slate-900",children:"Finance"}),e.jsx("th",{className:"text-left py-4 px-4 font-bold text-slate-900",children:"Actions"})]})}),e.jsx("tbody",{children:w.map(R=>e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50 transition-colors",children:[e.jsxs("td",{className:"py-4 px-4",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:Jn(R.monthEnd)}),e.jsx("div",{className:"text-sm text-slate-500 font-mono",children:R.monthEnd})]}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-bold rounded-full border ${R.status==="CLOSED"?"bg-emerald-100 text-emerald-800 border-emerald-200":R.status.includes("Current")?"bg-blue-100 text-blue-800 border-blue-200":"bg-slate-100 text-slate-800 border-slate-200"}`,children:R.status})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-semibold rounded-full bg-slate-100 text-slate-700 border border-slate-200",children:"View only"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-semibold rounded-full bg-slate-100 text-slate-700 border border-slate-200",children:"View only"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:"inline-flex px-3 py-1 text-xs font-semibold rounded-full bg-slate-100 text-slate-700 border border-slate-200",children:"View only"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"flex gap-2",children:R.status!=="CLOSED"&&R.status!=="LOCKED"?e.jsxs("button",{onClick:()=>{m(R),d(!0)},className:"inline-flex items-center gap-2 px-3 py-2 text-sm font-semibold text-amber-700 bg-amber-50 border border-amber-200 rounded-lg hover:bg-amber-100 transition-all duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Close Month"]}):e.jsx("span",{className:"text-sm text-slate-500 font-medium",children:"Closed"})})})]},R.monthEnd))})]})})})]}),o&&c?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>{p.status!=="loading"&&(d(!1),m(null),x({irreversible:!1}),h(""))}}),e.jsxs("div",{className:"relative w-full max-w-lg rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:"Close Month"}),e.jsxs("div",{className:"mt-1 text-sm text-slate-600",children:[Jn(c.monthEnd)," (",c.monthEnd,")"]})]}),e.jsx("button",{type:"button",className:"rounded-md p-2 text-slate-500 hover:bg-slate-100",onClick:()=>{p.status!=="loading"&&(d(!1),m(null),x({irreversible:!1}),h(""))},children:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M18 6 6 18M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("label",{className:"flex items-start gap-3 text-sm text-slate-700",children:[e.jsx("input",{type:"checkbox",className:"mt-1",checked:g.irreversible,onChange:R=>x(L=>({...L,irreversible:R.target.checked}))}),e.jsx("span",{children:"I understand this action is irreversible."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Type confirmation"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Type: ",e.jsxs("span",{className:"font-mono",children:["CLOSE ",Jn(c.monthEnd).toUpperCase()]})]}),e.jsx("input",{className:"mt-2 w-full rounded-md border-slate-300 text-sm bg-white",value:j,onChange:R=>h(R.target.value)})]}),p.status==="error"?e.jsx(le,{error:p.error}):null]}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 disabled:bg-slate-50",disabled:p.status==="loading",onClick:()=>{d(!1),m(null),x({irreversible:!1}),h("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-black disabled:bg-slate-400",disabled:p.status==="loading"||!E(),onClick:N,children:p.status==="loading"?"Closing":"Confirm Close"})]})]})]}):null]}):e.jsx(ge,{})}const Zu=[{label:"Admin",value:"00000000-0000-0000-0000-000000000001"},{label:"System",value:"system"},{label:"Service Account",value:"service-account"}],ex=[{label:"Finance",value:"finance"},{label:"Payroll",value:"payroll"},{label:"Attendance",value:"attendance"},{label:"Governance",value:"governance"},{label:"System",value:"system"}],tx=[{label:"Open",value:"open"},{label:"Locked",value:"locked"},{label:"Closed",value:"closed"},{label:"Read-only",value:"read-only"}];function EN(t){const s=new URL("/api/v1/governance/audit","http://local");for(const[a,n]of Object.entries(t))n==null||n===""||n==="undefined"||s.searchParams.set(a,String(n));return s.pathname+s.search}function li(t){return{CREATE:"Open",UPDATE:"Read-only",ADMIN_LOGIN:"Read-only",LOCK:"Locked",CLOSE:"Closed"}[t]||"Read-only"}function sx(t){switch(li(t)){case"Closed":return"text-red-700";case"Locked":return"text-amber-700";case"Open":return"text-slate-700";case"Read-only":return"text-slate-700";default:return"text-slate-700"}}function CN(t){switch(li(t)){case"Closed":return"bg-red-500";case"Locked":return"bg-amber-500";case"Open":return"bg-slate-400";case"Read-only":return"bg-slate-400";default:return"bg-slate-400"}}function ba(t){return t?t==="00000000-0000-0000-0000-000000000001"?{name:"Admin",role:"Administrator",id:t}:t==="system"?{name:"System",role:"System",id:"system"}:t==="service-account"?{name:"Service Account",role:"Service",id:"service-account"}:t.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i)?{name:"User",role:"User",id:t}:{name:t.includes("user")?"User":t,role:"User",id:t}:{name:"System",role:"System",id:"system"}}function fr(t,s,a=""){if(!t)return{display:"",id:null};let n="";switch(t.toLowerCase()){case"admin_user":n="Admin User";break;case"user":n="User";break;case"division":n="Division";break;case"project":n="Project";break;case"month_close":n="Month Close";break;case"attendance":n="Attendance";break;case"payroll":n="Payroll";break;case"finance":n="Finance";break;case"governance":n="Governance";break;case"system":n="System";break;default:n=t.charAt(0).toUpperCase()+t.slice(1)}let l="";switch(a==null?void 0:a.toLowerCase()){case"create":case"open":l="Creation Event";break;case"update":case"read-only":l="Modification Event";break;case"lock":case"locked":l="Lock Event";break;case"close":case"closed":l="Closure Event";break;case"admin_login":l="Login Event";break;case"delete":case"deactivate":l="Deletion Event";break;case"activate":l="Activation Event";break;default:l=a?`${a.charAt(0).toUpperCase()+a.slice(1)} Event`:"Event"}return{display:`${n}  ${l}`,id:s||null,module:n,actionContext:l}}function Co(t){if(!t)return{display:"",iso:""};let s=String(t).trim();/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}(\.\d+)?$/.test(s)&&(s=s.replace(" ","T"));const a=new Date(s);return Number.isNaN(a.getTime())?{display:String(t),iso:String(t)}:{display:a.toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"UTC"}).replace(","," ")+" UTC",iso:a.toISOString()}}function AN(){var k,D,R;const{bootstrap:t}=he(),[s,a]=i.useState(1),[n]=i.useState(20),[l,r]=i.useState("7"),[o,d]=i.useState(""),[c,m]=i.useState(""),[g,x]=i.useState(""),[j,h]=i.useState(""),[f,u]=i.useState(null),[b,p]=i.useState(!1),y=o==="system"||o==="service-account";i.useEffect(()=>{const L=setTimeout(()=>{a(1)},300);return()=>clearTimeout(L)},[l,o,c,g,j]);const w=i.useMemo(()=>{if(y)return"";const L={};if(c&&(L.entityType=c),j&&(L.entityId=j),o&&(L.actorId=o),g){const _={open:"CREATE","read-only":"UPDATE",locked:"LOCK",closed:"CLOSE"};L.action=_[g]}if(l){const _=parseInt(l),I=new Date,G=new Date;G.setDate(I.getDate()-_),L.startDate=G.toISOString().split("T")[0],L.endDate=I.toISOString().split("T")[0]}return EN(L)},[l,o,c,g,j,y]),S=Pe({path:w||"/api/v1/governance/audit",page:s,pageSize:n,enabled:!!w&&!y}),N=((k=S.data)==null?void 0:k.items)||[],E=((D=S.data)==null?void 0:D.total)||0,v=i.useMemo(()=>{const L=[];if(l&&L.push({label:`Last ${l} days`,key:"dateRange"}),o){const _=Zu.find(I=>I.value===o);_&&L.push({label:`Actor: ${_.label}`,key:"actor"})}if(c){const _=ex.find(I=>I.value===c);_&&L.push({label:`Module: ${_.label}`,key:"module"})}if(g){const _=tx.find(I=>I.value===g);_&&L.push({label:`Action: ${_.label}`,key:"actionType"})}return j&&L.push({label:`Reference: ${j}`,key:"entityReference"}),L},[l,o,c,g,j]),A=L=>{u(L),p(!0)},T=()=>{p(!1),u(null)},C=L=>{switch(L){case"dateRange":r("");break;case"actor":d("");break;case"module":m("");break;case"actionType":x("");break;case"entityReference":h("");break}};return S.status==="loading"&&!S.data?e.jsx(de,{}):S.status==="error"?((R=S.error)==null?void 0:R.status)===403?e.jsx(ge,{}):e.jsx(le,{error:S.error}):e.jsxs("div",{className:"max-w-6xl mx-auto space-y-5",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-amber-500 to-orange-600 rounded-3xl shadow-xl mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-900 to-slate-700 bg-clip-text text-transparent",children:"Audit Logs"}),e.jsx("p",{className:"text-lg text-slate-600 max-w-2xl mx-auto",children:"Every critical action, permanently recorded with full traceability"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50/50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Filter Audit Logs"}),e.jsx("div",{className:"bg-white px-3 py-1 rounded-full border border-slate-200 shadow-sm",children:e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[E," total"]})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"w-full pl-11 pr-4 py-3 rounded-xl border border-slate-300 bg-white text-sm placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md appearance-none cursor-pointer",value:l,onChange:L=>r(L.target.value),children:[e.jsx("option",{value:"",children:"All dates"}),e.jsx("option",{value:"1",children:"Last 24 hours"}),e.jsx("option",{value:"7",children:"Last 7 days"}),e.jsx("option",{value:"30",children:"Last 30 days"}),e.jsx("option",{value:"90",children:"Last 90 days"})]}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"w-full pl-11 pr-4 py-3 rounded-xl border border-slate-300 bg-white text-sm placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md appearance-none cursor-pointer",value:o,onChange:L=>d(L.target.value),children:[e.jsx("option",{value:"",children:"All actors"}),Zu.map(L=>e.jsx("option",{value:L.value,children:L.label},L.value))]}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"w-full pl-11 pr-4 py-3 rounded-xl border border-slate-300 bg-white text-sm placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md appearance-none cursor-pointer",value:c,onChange:L=>m(L.target.value),children:[e.jsx("option",{value:"",children:"All modules"}),ex.map(L=>e.jsx("option",{value:L.value,children:L.label},L.value))]}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"w-full pl-11 pr-4 py-3 rounded-xl border border-slate-300 bg-white text-sm placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md appearance-none cursor-pointer",value:g,onChange:L=>x(L.target.value),children:[e.jsx("option",{value:"",children:"All actions"}),tx.map(L=>e.jsx("option",{value:L.value,children:L.label},L.value))]}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"w-full pl-11 pr-4 py-3 rounded-xl border border-slate-300 bg-white text-sm placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md",placeholder:"Entity reference",value:j,onChange:L=>h(L.target.value)}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})})]})]}),v.length>0&&e.jsx("div",{className:"flex flex-wrap gap-3 mt-6 pt-4 border-t border-slate-200",children:v.map(L=>e.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-2 bg-amber-50 border border-amber-200 text-amber-700 text-sm rounded-full leading-none shadow-sm hover:shadow-md transition-all duration-200",children:[L.label,e.jsx("button",{type:"button",className:"text-amber-400 hover:text-amber-600 leading-none transition-colors duration-200 hover:scale-110 transform",onClick:()=>C(L.key),children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},L.key))})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50/50 px-6 py-4 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Forensic Timeline"}),e.jsx("div",{className:"bg-white px-3 py-1 rounded-full border border-slate-200 shadow-sm",children:e.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[N.length," entries"]})})]})}),N.length===0?e.jsx("div",{className:"p-8",children:e.jsx(ye,{title:"No audit logs found",description:"Try adjusting your filters to see more results."})}):e.jsx("div",{className:"divide-y divide-slate-200",children:N.map(L=>{const _=ba(L.actorId),I=li(L.action),G=sx(L.action),O=CN(L.action),F=Co(L.createdAt??L.created_at),W=fr(L.entityType,L.entityId,L.action);return e.jsxs("div",{className:"relative hover:bg-slate-50 cursor-pointer transition-colors",onClick:()=>A(L),children:[e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-[3px] ${O}`}),e.jsx("div",{className:"p-5 pl-6",children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-mono text-xs text-slate-500 mb-3",title:F.iso,children:F.display}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"font-bold text-slate-900 text-base",children:_.name}),e.jsx("div",{className:"text-sm text-slate-500 mt-0.5",children:_.role})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsx("span",{className:`font-semibold ${G}`,children:I}),e.jsx("span",{className:"text-slate-600",children:W.display})]})]})})})]},L.id)})})]}),e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200/60 shadow-sm p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsx("button",{type:"button",className:"w-full sm:w-auto px-6 py-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white rounded-xl text-sm font-semibold hover:from-amber-600 hover:to-orange-700 disabled:from-slate-300 disabled:to-slate-400 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl disabled:shadow-none transform hover:scale-105 disabled:scale-100",disabled:s<=1,onClick:()=>a(L=>Math.max(1,L-1)),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-900",children:["Page ",s]}),e.jsxs("div",{className:"text-xs text-slate-500",children:[E," total entries"]})]}),e.jsx("button",{type:"button",className:"w-full sm:w-auto px-6 py-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white rounded-xl text-sm font-semibold hover:from-amber-600 hover:to-orange-700 disabled:from-slate-300 disabled:to-slate-400 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl disabled:shadow-none transform hover:scale-105 disabled:scale-100",disabled:s*n>=E,onClick:()=>a(L=>L+1),children:e.jsxs("div",{className:"flex items-center gap-2",children:["Next",e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})}),b&&f&&e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-25",onClick:T}),e.jsxs("div",{className:"absolute right-0 top-0 h-full w-full md:w-2/5 lg:w-2/5 xl:w-2/5 bg-white shadow-xl overflow-y-auto",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-slate-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Audit Details"}),e.jsx("button",{type:"button",className:"text-slate-300 opacity-60",onClick:T,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-1",children:"Action"}),e.jsx("div",{className:`font-medium ${sx(f.action)}`,children:li(f.action)})]}),e.jsxs("div",{className:"pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-1",children:"Entity"}),e.jsx("div",{className:"text-slate-900 mb-3",children:fr(f.entityType,f.entityId,f.action).display}),fr(f.entityType,f.entityId,f.action).id&&e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"text-slate-500 mb-1",children:"Reference ID"}),e.jsx("div",{className:"font-mono bg-slate-50 p-2 rounded border border-slate-200 text-slate-700",children:fr(f.entityType,f.entityId,f.action).id})]})]}),e.jsxs("div",{className:"pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-1",children:"Actor"}),e.jsxs("div",{className:"text-slate-900 mb-2",children:[e.jsx("div",{className:"font-medium",children:ba(f.actorId).name}),e.jsxs("div",{className:"text-sm text-slate-500",children:["Role: ",ba(f.actorId).role]})]}),ba(f.actorId).id&&ba(f.actorId).id!==ba(f.actorId).name&&e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"text-slate-500 mb-1",children:"Actor ID"}),e.jsx("div",{className:"font-mono bg-slate-50 p-2 rounded border border-slate-200 text-slate-700",children:ba(f.actorId).id})]})]}),e.jsxs("div",{className:"pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-1",children:"Timestamp"}),e.jsx("div",{className:"font-mono text-sm text-slate-700",title:Co(f.createdAt??f.created_at).iso,children:Co(f.createdAt??f.created_at).display})]}),f.ipAddress&&e.jsxs("div",{className:"pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-1",children:"IP Address"}),e.jsx("div",{className:"font-mono text-sm text-slate-900",children:f.ipAddress})]}),f.userAgent&&e.jsxs("div",{className:"pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-1",children:"Device"}),e.jsx("div",{className:"text-sm text-slate-900",children:f.userAgent})]}),f.reason&&e.jsxs("div",{className:"pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-1",children:"Reason"}),e.jsx("div",{className:"text-sm text-slate-900",children:f.reason})]}),f.source&&e.jsxs("div",{className:"pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-1",children:"Source"}),e.jsx("div",{className:"font-mono text-xs text-slate-500 bg-slate-50 p-2 rounded border border-slate-200",children:f.source})]}),(f.beforeState||f.afterState)&&e.jsxs("div",{className:"pb-4",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500 mb-3",children:"State Changes"}),f.beforeState&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 mb-2",children:"Before"}),e.jsx("pre",{className:"bg-slate-50 p-3 rounded-md text-xs font-mono text-slate-800 overflow-x-auto whitespace-pre-wrap",children:JSON.stringify(JSON.parse(f.beforeState),null,2)})]}),f.afterState&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-slate-500 mb-2",children:"After"}),e.jsx("pre",{className:"bg-slate-50 p-3 rounded-md text-xs font-mono text-slate-800 overflow-x-auto whitespace-pre-wrap",children:JSON.stringify(JSON.parse(f.afterState),null,2)})]})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-100",children:[e.jsx("button",{type:"button",className:"w-full px-4 py-2 bg-slate-100 text-slate-500 rounded-lg text-sm font-medium cursor-not-allowed",disabled:!0,title:"Export requires additional permissions",children:"Export Audit Logs"}),e.jsx("p",{className:"text-xs text-slate-500 mt-3 text-center leading-relaxed",children:"Exported audit logs are immutable and watermarked for compliance."})]})]})]})]})]})}function LN(...t){return t.filter(Boolean).join(" ")}function DN(t){const s=String(t??"").trim().toLowerCase();return s==="true"||s==="1"||s==="yes"||s==="enabled"||s==="on"}function MN(t){const s=String(t||"").toUpperCase();return s==="SUBMITTED"?"bg-blue-50 text-blue-800":s==="APPROVED"?"bg-emerald-50 text-emerald-800":s==="REJECTED"?"bg-rose-50 text-rose-800":s==="REVISION_REQUIRED"?"bg-amber-50 text-amber-800":"bg-slate-100 text-slate-800"}function ax({status:t}){const s=String(t||"").toUpperCase();return s?e.jsx("span",{className:LN("inline-flex rounded-full px-2 py-1 text-xs font-semibold",MN(s)),children:s}):null}function RN(t){var a,n;const s=String(((n=(a=t==null?void 0:t.payload)==null?void 0:a.error)==null?void 0:n.message)||(t==null?void 0:t.message)||"").toLowerCase();return(t==null?void 0:t.status)===400&&(s.includes("employee not found")||s.includes("not found"))}function TN(){var b,p,y,w,S,N,E;const{bootstrap:t,token:s}=he(),a=((b=t==null?void 0:t.rbac)==null?void 0:b.permissions)||[],n=((p=t==null?void 0:t.rbac)==null?void 0:p.roles)||[];let l=n;if(n.length===0&&s)try{const v=JSON.parse(atob(s.split(".")[1])),A=v.role||((y=v==null?void 0:v.claims)==null?void 0:y.role)||((w=v==null?void 0:v.roles)==null?void 0:w[0]);A&&(l=[A])}catch{}const r=a.includes("TIMESHEET_READ")||l.includes("EMPLOYEE");l.includes("SUPER_ADMIN"),l.includes("MANAGER");const o=(t==null?void 0:t.systemConfig)||{},d=DN(((S=o==null?void 0:o.TIMESHEET_ENABLED)==null?void 0:S.value)??(o==null?void 0:o.TIMESHEET_ENABLED)),[c,m]=i.useState(1),[g]=i.useState(20),x=Pe({path:"/api/v1/timesheets/my",page:c,pageSize:g,enabled:r&&d}),j=((N=x.data)==null?void 0:N.items)||[],h=((E=x.data)==null?void 0:E.total)||0,f=x.status==="error"&&RN(x.error),u=i.useMemo(()=>{var v;return r?d?x.status==="loading"&&!x.data?e.jsx(de,{}):f?e.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-amber-900",children:"Employee not linked"}),e.jsx("div",{className:"mt-1 text-sm text-amber-800",children:"You are not linked as an employee in the system. Please contact HR/Admin."})]}):x.status==="error"?((v=x.error)==null?void 0:v.status)===403?e.jsx(ge,{}):e.jsx(le,{error:x.error}):e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Timesheets"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Total: ",h]})]}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:x.refresh,disabled:x.status==="loading",children:x.status==="loading"?"Refreshing":"Refresh"})]}),e.jsxs("div",{className:"p-4",children:[j.length===0?e.jsx(ye,{title:"No timesheets",description:"No weekly timesheets found."}):e.jsx("div",{className:"hidden md:block",children:e.jsx(ha,{columns:[{key:"week",header:"Week",render:A=>e.jsxs("span",{className:"font-mono text-sm",children:[A.periodStart,"  ",A.periodEnd]})},{key:"status",header:"Status",render:A=>e.jsx(ax,{status:A.status})},{key:"action",header:"Action",render:A=>e.jsx("div",{className:"flex items-center justify-end",children:e.jsx($e,{to:`/timesheet/${A.id}`,className:"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"View"})})}],rows:j.map(A=>({key:A.id,data:A}))})}),e.jsx("div",{className:"grid grid-cols-1 gap-3 md:hidden",children:j.map(A=>e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Week"}),e.jsxs("div",{className:"mt-1 font-mono text-sm text-slate-900",children:[A.periodStart,"  ",A.periodEnd]})]}),e.jsx(ax,{status:A.status})]}),e.jsx("div",{className:"mt-3",children:e.jsx($e,{to:`/timesheet/${A.id}`,className:"inline-flex w-full items-center justify-center rounded-md border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"View"})})]},A.id))})]}),e.jsx("div",{className:"p-4 pt-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:c<=1,onClick:()=>m(A=>Math.max(1,A-1)),children:"Previous"}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",c]}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:c*g>=h,onClick:()=>m(A=>A+1),children:"Next"})]})})]}):e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Timesheet is disabled"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"TIMESHEET_ENABLED must be enabled in system config."})]}):e.jsx(ge,{})},[r,f,j,x,c,g,d,h]);return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"My Timesheet"}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-8",children:e.jsx("div",{className:"mt-4",children:u})})]})}function Wh(...t){return t.filter(Boolean).join(" ")}function PN(t){const s=String(t??"").trim().toLowerCase();return s==="true"||s==="1"||s==="yes"||s==="enabled"||s==="on"}function IN(t){const s=String(t||"").toUpperCase();return s==="SUBMITTED"?"bg-blue-50 text-blue-800":s==="APPROVED"?"bg-emerald-50 text-emerald-800":s==="REJECTED"?"bg-rose-50 text-rose-800":s==="REVISION_REQUIRED"?"bg-amber-50 text-amber-800":"bg-slate-100 text-slate-800"}function ON({status:t}){const s=String(t||"").toUpperCase();return s?e.jsx("span",{className:Wh("inline-flex rounded-full px-2 py-1 text-xs font-semibold",IN(s)),children:s}):null}function _N(t){const s=new Date(`${t}T00:00:00.000Z`);return new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth()+1,0)).toISOString().slice(0,10)}function Qa(t){if(!t)return"";try{return new Date(t).toLocaleString()}catch{return String(t)}}function BN(t,s){const a=({id:n,label:l})=>{const r=t===n;return e.jsx("button",{type:"button",className:Wh("rounded-full px-3 py-1.5 text-sm font-medium border transition-colors",r?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),onClick:()=>s(n),children:l})};return e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(a,{id:"worklogs",label:"Worklogs"}),e.jsx(a,{id:"timeline",label:"Approval Timeline"}),e.jsx(a,{id:"audit",label:"Audit Trail"})]})}function FN(){var ue,re,Re,ne,H,te,q;const{id:t}=Dt(),s=Ue(),{bootstrap:a}=he(),n=((ue=a==null?void 0:a.rbac)==null?void 0:ue.permissions)||[],l=((re=a==null?void 0:a.rbac)==null?void 0:re.roles)||[],r=n.includes("TIMESHEET_READ")||n.includes("TIMESHEET_APPROVAL_QUEUE_READ")||n.includes("TIMESHEET_APPROVE_L1")||n.includes("TIMESHEET_APPROVE_L2"),o=n.includes("TIMESHEET_SUBMIT"),d=n.includes("TIMESHEET_APPROVE_L1"),c=n.includes("TIMESHEET_APPROVE_L2"),m=n.includes("TIMESHEET_WORKLOG_WRITE"),g=n.includes("GOV_MONTH_CLOSE_READ"),x=n.includes("GOV_AUDIT_READ"),j=l.includes("SUPER_ADMIN");l.includes("MANAGER")||l.includes("SUPERADMIN")||l.includes("FOUNDER");const h=(a==null?void 0:a.systemConfig)||{},f=((Re=a==null?void 0:a.features)==null?void 0:Re.flags)||{},u=PN(((ne=h==null?void 0:h.TIMESHEET_ENABLED)==null?void 0:ne.value)??(h==null?void 0:h.TIMESHEET_ENABLED)),b=!!(f!=null&&f.MONTH_CLOSE_ENABLED),[p,y]=i.useState("worklogs"),[w,S]=i.useState({status:"idle",data:null,error:null,refreshIndex:0}),N=()=>S(Y=>({...Y,refreshIndex:Y.refreshIndex+1}));i.useEffect(()=>{y("worklogs")},[t]),i.useEffect(()=>{if(!r||!u||!t)return;let Y=!0;async function xe(){S(J=>({...J,status:"loading",error:null}));try{const J=await z(`/api/v1/timesheets/${t}`);if(!Y)return;S(me=>({...me,status:"ready",data:J,error:null}))}catch(J){if(!Y)return;S(me=>({...me,status:"error",error:J}))}}return xe(),()=>{Y=!1}},[r,t,w.refreshIndex,u]);const E=((H=w.data)==null?void 0:H.header)||null,v=((te=w.data)==null?void 0:te.worklogs)||[],A=E!=null&&E.periodEnd?_N(E.periodEnd):null,T=Pe({path:"/api/v1/governance/month-close",page:1,pageSize:200,enabled:b&&g&&!!A}),C=i.useMemo(()=>{var xe;const Y=new Set;for(const J of((xe=T.data)==null?void 0:xe.items)||[]){const me=(J==null?void 0:J.monthEnd)||(J==null?void 0:J.monthStart)||(J==null?void 0:J.month);me&&String((J==null?void 0:J.status)||"").toUpperCase()==="CLOSED"&&Y.add(String(me).slice(0,10))}return Y},[T.data]),k=!!(A&&C.has(A)),D=Pe({path:E!=null&&E.id?(()=>{const Y=new URL("/api/v1/governance/audit","http://local");return Y.searchParams.set("entityType","TIMESHEET"),Y.searchParams.set("entityId",E.id),Y.pathname+Y.search})():"/api/v1/governance/audit",page:1,pageSize:50,enabled:p==="audit"&&x&&!!(E!=null&&E.id)}),R=Be(async Y=>z("/api/v1/timesheets/worklog",{method:"POST",body:Y})),L=Be(async()=>z(`/api/v1/timesheets/${t}/submit`,{method:"POST",body:{}})),_=Be(async()=>z(`/api/v1/timesheets/${t}/approve`,{method:"POST",body:{}})),I=Be(async({reason:Y})=>z(`/api/v1/timesheets/${t}/reject`,{method:"POST",body:{reason:Y}})),G=Be(async({reason:Y})=>z(`/api/v1/timesheets/${t}/request-revision`,{method:"POST",body:{reason:Y}})),[O,F]=i.useState(""),[W,$]=i.useState(""),[M,P]=i.useState(""),[V,U]=i.useState(""),[B,Q]=i.useState(""),ae=i.useMemo(()=>{const Y=new Map;for(const J of v){const me=String(J.workDate||"").slice(0,10);me&&(Y.has(me)||Y.set(me,[]),Y.get(me).push(J))}return Array.from(Y.entries()).sort((J,me)=>J[0]<me[0]?1:-1).map(([J,me])=>{const K=me.slice().sort((je,pe)=>String(je.updatedAt||"")<String(pe.updatedAt||"")?1:-1),be=K.reduce((je,pe)=>je+(Number(pe.hours)||0),0);return{date:J,items:K,totalHours:be}})},[v]),ie=!!(E&&String(E.employeeId)===String((q=a==null?void 0:a.user)==null?void 0:q.id)&&m&&!k&&String(E.status||"").toUpperCase()!=="SUBMITTED"&&String(E.status||"").toUpperCase()!=="APPROVED"&&!j),we=!!((d||c)&&E&&String(E.status||"").toUpperCase()==="SUBMITTED"&&!k&&!j),De=!!(o&&E&&String(E.status||"").toUpperCase()==="DRAFT"&&!k&&!j),Z=n.includes("TIMESHEET_APPROVAL_QUEUE_READ")?"/timesheet/approvals":"/timesheet/my",ve=i.useMemo(()=>{var Y,xe,J,me;return r?u?w.status==="loading"&&!w.data?e.jsx(de,{}):w.status==="error"?((Y=w.error)==null?void 0:Y.status)===403?e.jsx(ge,{}):e.jsx(le,{error:w.error}):E?e.jsxs("div",{className:"space-y-4",children:[k?e.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-amber-900",children:"Month is CLOSED"}),e.jsx("div",{className:"mt-1 text-sm text-amber-800",children:"This timesheet falls within a closed payroll month and is read-only."})]}):null,e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Week"}),e.jsxs("div",{className:"mt-1 font-mono text-sm text-slate-800",children:[E.periodStart,"  ",E.periodEnd]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Timesheet ID: ",e.jsxs("span",{className:"font-mono",children:[String(E.id).slice(0,12),""]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ON,{status:E.status}),e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:N,disabled:w.status==="loading",children:w.status==="loading"?"Refreshing":"Refresh"})]})]}),e.jsx("div",{className:"mt-4",children:BN(p,y)})]}),p==="worklogs"?e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Worklogs"}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[v.length," entries"]})]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[ie?e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Add Worklog"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Date"}),e.jsx("input",{type:"date",className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:O,onChange:K=>F(K.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Task"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:W,onChange:K=>$(K.target.value),placeholder:"e.g., Client support"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Hours"}),e.jsx("input",{type:"number",step:"0.25",className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:M,onChange:K=>P(K.target.value),placeholder:"8"})]}),e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Description (optional)"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:V,onChange:K=>U(K.target.value),placeholder:"Short note"})]})]}),e.jsx("div",{className:"mt-3 flex flex-col sm:flex-row items-center justify-end gap-2",children:e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md bg-slate-900 px-4 py-2 text-sm font-medium text-white disabled:bg-slate-400",disabled:R.status==="loading"||!O||!W.trim()||!M||!E,onClick:async()=>{const K=Number(M);await R.run({employeeId:E.employeeId,workDate:O,task:W.trim(),hours:K,description:V.trim()||null,projectId:null}),$(""),P(""),U(""),N()},children:R.status==="loading"?"Saving":"Add"})}),R.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:R.error})}):null]}):null,ae.length===0?e.jsx(ye,{title:"No worklogs",description:"This timesheet has no worklogs."}):e.jsx("div",{className:"overflow-x-auto rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Task"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-slate-600",children:"Hours"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:ae.map(K=>e.jsxs(Ca.Fragment,{children:[K.items.map((be,je)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-mono text-slate-800",children:je===0?K.date:""}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-800",children:be.task||""}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-800 text-right",children:be.hours??""})]},`${K.date}-${be.id}`)),e.jsxs("tr",{className:"bg-slate-50",children:[e.jsx("td",{className:"px-4 py-2 text-xs text-slate-500"}),e.jsx("td",{className:"px-4 py-2 text-xs font-semibold text-slate-600",children:"Total"}),e.jsx("td",{className:"px-4 py-2 text-xs font-semibold text-slate-800 text-right",children:K.totalHours})]})]},K.date))})]})}),De?e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Submit"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Submit this timesheet for approval."}),e.jsx("div",{className:"mt-3 flex items-center justify-end",children:e.jsx("button",{type:"button",className:"rounded-md bg-slate-900 px-4 py-2 text-sm font-medium text-white disabled:bg-slate-400",disabled:L.status==="loading",onClick:async()=>{await L.run(),N()},children:L.status==="loading"?"Submitting":"Submit"})}),L.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:L.error})}):null]}):null,we?e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approval Actions"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Approve, reject, or request revision."}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600",children:"Reason (required for reject / revision)"}),e.jsx("textarea",{className:"mt-1 w-full h-24 rounded-md border-slate-300 text-sm",value:B,onChange:K=>Q(K.target.value),placeholder:"Explain your decision"})]}),e.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row items-center justify-end gap-2",children:[e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 bg-white px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 disabled:bg-slate-50",disabled:G.status==="loading"||!B.trim(),onClick:async()=>{await G.run({reason:B.trim()}),Q(""),N()},children:G.status==="loading"?"Sending":"Request Revision"}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-rose-200 bg-rose-50 px-4 py-2 text-sm font-medium text-rose-800 hover:bg-rose-100 disabled:bg-rose-50",disabled:I.status==="loading"||!B.trim(),onClick:async()=>{await I.run({reason:B.trim()}),Q(""),N()},children:I.status==="loading"?"Rejecting":"Reject"}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md bg-emerald-600 px-4 py-2 text-sm font-medium text-white hover:bg-emerald-700 disabled:bg-emerald-300",disabled:_.status==="loading",onClick:async()=>{await _.run(),N()},children:_.status==="loading"?"Approving":"Approve"})]}),_.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:_.error})}):null,I.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:I.error})}):null,G.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:G.error})}):null]}):null]})]}):null,p==="timeline"?e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Approval Timeline"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Submitted"}),e.jsx("div",{className:"mt-1 text-slate-800",children:Qa(E.submittedAt)})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Approved L1"}),e.jsx("div",{className:"mt-1 text-slate-800",children:Qa(E.approvedL1At)})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Approved L2"}),e.jsx("div",{className:"mt-1 text-slate-800",children:Qa(E.approvedL2At)})]})]}),E.rejectedAt?e.jsxs("div",{className:"mt-4 rounded-xl border border-rose-200 bg-rose-50 p-3",children:[e.jsx("div",{className:"text-sm font-semibold text-rose-900",children:"Rejected"}),e.jsx("div",{className:"mt-1 text-sm text-rose-800",children:Qa(E.rejectedAt)}),E.rejectedReason?e.jsxs("div",{className:"mt-1 text-sm text-rose-800",children:["Reason: ",E.rejectedReason]}):null]}):null,E.revisionRequestedAt?e.jsxs("div",{className:"mt-4 rounded-xl border border-amber-200 bg-amber-50 p-3",children:[e.jsx("div",{className:"text-sm font-semibold text-amber-900",children:"Revision Requested"}),e.jsx("div",{className:"mt-1 text-sm text-amber-800",children:Qa(E.revisionRequestedAt)}),E.revisionRequestedReason?e.jsxs("div",{className:"mt-1 text-sm text-amber-800",children:["Reason: ",E.revisionRequestedReason]}):null]}):null]}):null,p==="audit"?e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Audit Trail"}),e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:D.refresh,disabled:D.status==="loading",children:"Refresh"})]}),e.jsx("div",{className:"p-4",children:D.status==="loading"&&!D.data?e.jsx(de,{label:"Loading audit logs"}):D.status==="error"?((xe=D.error)==null?void 0:xe.status)===403?e.jsx(ge,{}):e.jsx(le,{error:D.error}):(((J=D.data)==null?void 0:J.items)||[]).length===0?e.jsx(ye,{title:"No audit logs"}):e.jsx("div",{className:"overflow-x-auto rounded-xl border border-slate-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"At"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Action"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Actor"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600",children:"Reason"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:(((me=D.data)==null?void 0:me.items)||[]).map(K=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:Qa(K.createdAt)}),e.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-slate-900",children:K.action||""}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700 font-mono",children:K.actorId||""}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700",children:K.reason||""})]},K.id))})]})})})]}):null]}):e.jsx(ye,{title:"Timesheet not found"}):e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Timesheet is disabled"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"TIMESHEET_ENABLED must be enabled in system config."})]}):e.jsx(ge,{})},[D,ie,r,we,De,B,ae,E,k,N,w,L,p,u,R,v.length,O,V,M,W,_,I,G]);return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pt-4",children:e.jsxs("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:[e.jsx($e,{to:Z,className:"hover:text-slate-700 hover:underline",children:"Timesheet"}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx("span",{className:"text-slate-600",children:"Detail"})]}),e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50",onClick:()=>{window.history.length>1?s(-1):s(Z)},children:"Back"})]})}),e.jsx(We,{title:"Timesheet Detail"}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-8",children:e.jsx("div",{className:"mt-4",children:ve})})]})}function UN(...t){return t.filter(Boolean).join(" ")}function gr(t){const s=String(t??"").trim().toLowerCase();return s==="true"||s==="1"||s==="yes"||s==="enabled"||s==="on"}function $N(t,s){const a=Number.parseInt(String(t??""),10);return Number.isFinite(a)?a:s}function VN(){const t=new Date,s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${n}`}function zN(t,s){const a=new Date(`${t}T00:00:00.000Z`);return a.setUTCDate(a.getUTCDate()+s),a.toISOString().slice(0,10)}function WN(t,s){if(!t||!s)return 0;const a=new Date(`${String(t).slice(0,10)}T00:00:00.000Z`),n=new Date(`${String(s).slice(0,10)}T00:00:00.000Z`);return Number.isNaN(a.getTime())||Number.isNaN(n.getTime())||a.getTime()>n.getTime()?0:Math.floor((n.getTime()-a.getTime())/(24*60*60*1e3))+1}function HN(){var te,q,Y,xe,J,me,K,be,je;const t=Ue(),{bootstrap:s}=he(),a=((te=s==null?void 0:s.rbac)==null?void 0:te.permissions)||[],n=a.includes("LEAVE_REQUEST_CREATE"),l=a.includes("LEAVE_TYPE_READ"),r=a.includes("LEAVE_ATTACHMENT_UPLOAD"),o=a.includes("LEAVE_BALANCE_READ"),d=(s==null?void 0:s.systemConfig)||{},c=gr(((q=d==null?void 0:d.LEAVE_ENABLED)==null?void 0:q.value)??(d==null?void 0:d.LEAVE_ENABLED)),m=gr(((Y=d==null?void 0:d.LEAVE_ALLOW_HALF_DAY)==null?void 0:Y.value)??(d==null?void 0:d.LEAVE_ALLOW_HALF_DAY)),g=gr(((xe=d==null?void 0:d.LEAVE_ALLOW_BACKDATED_REQUESTS)==null?void 0:xe.value)??(d==null?void 0:d.LEAVE_ALLOW_BACKDATED_REQUESTS)),x=$N(((J=d==null?void 0:d.LEAVE_BACKDATE_LIMIT_DAYS)==null?void 0:J.value)??(d==null?void 0:d.LEAVE_BACKDATE_LIMIT_DAYS),0),j=gr(((me=d==null?void 0:d.LEAVE_ATTACHMENTS_ENABLED)==null?void 0:me.value)??(d==null?void 0:d.LEAVE_ATTACHMENTS_ENABLED)),h=((K=s==null?void 0:s.user)==null?void 0:K.id)||null,f=i.useMemo(()=>VN(),[]),u=i.useMemo(()=>{if(!g)return f;const pe=Number.isFinite(x)?x:0;return pe>0?zN(f,-1*pe):""},[g,x,f]),b=Pe({path:"/api/v1/leave/types",page:1,pageSize:200,enabled:c&&l}),p=((be=b.data)==null?void 0:be.items)||[],w=((je=Pe({path:`/api/v1/leave/balances?employeeId=${encodeURIComponent(h||"")}`,page:1,pageSize:200,enabled:c&&o&&!!h}).data)==null?void 0:je.items)||[],[S,N]=i.useState(""),[E,v]=i.useState(""),[A,T]=i.useState(""),[C,k]=i.useState("FULL_DAY"),[D,R]=i.useState("AM"),[L,_]=i.useState(""),[I,G]=i.useState(""),[O,F]=i.useState(""),[W,$]=i.useState(""),[M,P]=i.useState(""),[V,U]=i.useState(""),[B,Q]=i.useState(null),ae=i.useMemo(()=>p.find(pe=>String(pe.id)===String(S))||null,[S,p]),ie=!!(m&&(ae==null?void 0:ae.supportsHalfDay)!==!1),we=w.length>0,De=ae==null?void 0:ae.isPaid;De&&w.some(pe=>String(pe.leaveTypeId)===String(ae==null?void 0:ae.id));const Z=De&&!we,ve=i.useMemo(()=>C==="HALF_DAY"?.5:WN(E,A),[A,E,C]),ue=Be(async pe=>z("/api/v1/leave/requests",{method:"POST",body:pe})),re=i.useMemo(()=>{if(ue.status!=="error")return null;const pe=ue.error;if(!pe)return null;const Ae=pe==null?void 0:pe.status,Se=(pe==null?void 0:pe.requestId)||"";return Ae>=500?{title:"Unable to submit leave request",message:`Your leave request could not be submitted at this time.
Please try again or contact HR/Admin if the problem persists.`,requestId:Se}:null},[ue.status,ue.error]),Re=Be(async({id:pe,payload:Ae})=>z(`/api/v1/leave/requests/${pe}/attachments`,{method:"POST",body:Ae})),ne=!!(j&&r&&I.trim()&&O.trim()&&W.trim()&&M.trim()),H=i.useMemo(()=>{var Ae;if(!n)return e.jsx(ge,{});if(!c)return e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Leave is disabled"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"LEAVE_ENABLED must be enabled in system config."})]});if(!h)return e.jsx(ye,{title:"Missing user context",description:"No user id found in bootstrap."});if(!l)return e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Leave Types not accessible"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"You need LEAVE_TYPE_READ permission to apply for leave."})]});if(b.status==="loading"&&!b.data)return e.jsx(de,{});if(b.status==="error")return((Ae=b.error)==null?void 0:Ae.status)===403?e.jsx(ge,{}):e.jsx(le,{error:b.error});if(p.length===0)return e.jsx(ye,{title:"No leave types",description:"No active leave types are configured."});const pe=ue.status==="loading"||Re.status==="loading";return e.jsxs("div",{className:"space-y-4",children:[Z?e.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-amber-900",children:"Leave balance is not configured for you"}),e.jsx("div",{className:"mt-1 text-sm text-amber-800",children:"Please contact HR/Admin to set up your leave balance before submitting paid leave requests."})]}):null,B?e.jsxs("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-emerald-900",children:"Leave request submitted"}),e.jsxs("div",{className:"mt-1 text-sm text-emerald-800",children:["Request ID: ",e.jsx("span",{className:"font-mono",children:B.id})]}),e.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row gap-2",children:[e.jsx($e,{to:`/leave/requests/${B.id}`,state:{employeeId:h,item:B},className:"inline-flex items-center justify-center rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-slate-800",children:"View request"}),e.jsx($e,{to:"/leave/my",className:"inline-flex items-center justify-center rounded-md border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Back to My Leave"})]})]}):null,e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Apply Leave"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Submit a leave request for approval."})]}),e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:()=>t(-1),disabled:pe,children:"Back"})]}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Leave Type"}),e.jsxs("select",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:S,onChange:Se=>N(Se.target.value),disabled:pe,children:[e.jsx("option",{value:"",children:"Select"}),p.map(Se=>e.jsxs("option",{value:Se.id,children:[Se.code,"  ",Se.name,Se.isPaid?" (Paid)":""]},Se.id))]}),ae&&ae.isActive===!1?e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:"Selected type is inactive."}):null]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Unit"}),e.jsxs("select",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:C,onChange:Se=>{const Me=Se.target.value;k(Me),Me==="HALF_DAY"&&E&&A&&E!==A&&T(E)},disabled:pe,children:[e.jsx("option",{value:"FULL_DAY",children:"Full day"}),e.jsx("option",{value:"HALF_DAY",disabled:!ie,children:"Half day"})]}),ie?null:e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Half-day is disabled by config or leave type settings."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Start Date"}),e.jsx("input",{type:"date",className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:E,min:u||void 0,onChange:Se=>{const Me=Se.target.value;v(Me),(!A||A<Me)&&T(Me),C==="HALF_DAY"&&T(Me)},disabled:pe}),g?x>0?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Backdate limit: ",x," day(s)."]}):null:e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Backdated requests are disabled."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"End Date"}),e.jsx("input",{type:"date",className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:A,min:E||u||void 0,onChange:Se=>{const Me=Se.target.value;T(Me),C==="HALF_DAY"&&v(Me)},disabled:pe||C==="HALF_DAY"}),C==="HALF_DAY"?e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Half-day requests are single-day only."}):null]}),C==="HALF_DAY"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Half-day Part"}),e.jsxs("select",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:D,onChange:Se=>R(Se.target.value),disabled:pe,children:[e.jsx("option",{value:"AM",children:"AM"}),e.jsx("option",{value:"PM",children:"PM"})]})]}):e.jsx("div",{}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason"}),e.jsx("textarea",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",rows:3,value:L,onChange:Se=>_(Se.target.value),disabled:pe,placeholder:"Provide a clear reason for this leave request"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Summary"}),e.jsxs("div",{className:"mt-1 text-sm text-slate-700",children:[e.jsxs("span",{className:"font-mono",children:[E||"","  ",A||""]}),e.jsx("span",{className:"mx-2",children:"|"}),"Units: ",e.jsx("span",{className:"font-semibold",children:C==="HALF_DAY"?"0.5":String(ve||0)})]}),ae!=null&&ae.isPaid?e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Paid leave: sufficient balance will be validated by the backend."}):e.jsx("div",{className:"mt-1 text-xs text-slate-600",children:"Unpaid leave: balance checks may not apply."})]})}),j?e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Attachment (optional)"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Provide a signed URL as storageKey. File upload is metadata-only."}),r?e.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"File Name"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:I,onChange:Se=>G(Se.target.value),disabled:pe,placeholder:"medical_certificate.pdf"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"MIME Type"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono",value:W,onChange:Se=>$(Se.target.value),disabled:pe,placeholder:"application/pdf"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Storage Key (signed URL)"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono",value:O,onChange:Se=>F(Se.target.value),disabled:pe,placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Size Bytes"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono",value:M,onChange:Se=>P(Se.target.value),disabled:pe,placeholder:"12345"})]})]}):e.jsx("div",{className:"mt-2 text-xs text-slate-600",children:"You do not have LEAVE_ATTACHMENT_UPLOAD permission."})]})}):null,V?e.jsx("div",{className:"md:col-span-2",children:e.jsx("div",{className:"rounded-lg border border-rose-200 bg-rose-50 p-3 text-sm text-rose-800",children:V})}):null,re?e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"rounded-lg border border-rose-200 bg-rose-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-rose-900",children:re.title}),e.jsx("div",{className:"mt-1 text-sm text-rose-800 whitespace-pre-line",children:re.message}),re.requestId?e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Reference ID: ",re.requestId]}):null]})}):null,ue.status==="error"&&!re?e.jsx("div",{className:"md:col-span-2",children:e.jsx(le,{error:ue.error})}):null,Re.status==="error"?e.jsx("div",{className:"md:col-span-2",children:e.jsx(le,{error:Re.error})}):null,e.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2 sm:flex-row sm:justify-end",children:[e.jsx($e,{to:"/leave/my",className:UN("inline-flex items-center justify-center rounded-md border border-slate-300 bg-white px-4 py-3 text-sm font-medium text-slate-700 hover:bg-slate-50 min-h-[44px]",pe?"pointer-events-none opacity-70":""),children:"Cancel"}),e.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-md bg-slate-900 px-4 py-3 text-sm font-medium text-white hover:bg-slate-800 disabled:bg-slate-400 min-h-[44px] w-full sm:w-auto",disabled:pe||!S||!E||!A||L.trim().length===0||C==="HALF_DAY"&&(!D||E!==A)||Z&&De,onClick:async()=>{U(""),Q(null);const Se=L.trim();if(!Se){U("Reason is required");return}if(C==="HALF_DAY"&&E!==A){U("Half-day leave must be for a single date");return}try{const Me={employeeId:h,leaveTypeId:S,startDate:E,endDate:A,unit:C,halfDayPart:C==="HALF_DAY"?D:null,reason:Se},ce=await ue.run(Me),Ce=(ce==null?void 0:ce.item)||null;Ce&&Q(Ce),Ce&&ne&&await Re.run({id:Ce.id,payload:{fileName:I.trim(),storageKey:O.trim(),mimeType:W.trim(),sizeBytes:Number(M)}}),Ce&&t(`/leave/requests/${Ce.id}`,{state:{employeeId:h,item:Ce}})}catch{}},children:ue.status==="loading"?"Submitting":"Submit Request"})]})]})]})]})},[g,m,I,W,M,O,j,x,ne,n,o,l,r,V,ue,B,Z,h,A,re,D,we,c,S,u,t,L,De,ae,E,p,b,C,ve,Re]);return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Apply Leave"}),e.jsx("div",{className:"mx-auto max-w-4xl px-4 sm:px-6 lg:px-8 pb-8",children:e.jsx("div",{className:"mt-4",children:H})})]})}function Hh(...t){return t.filter(Boolean).join(" ")}function nx(t){const s=String(t??"").trim().toLowerCase();return s==="true"||s==="1"||s==="yes"||s==="enabled"||s==="on"}function qN(t){const s=String(t||"").toUpperCase();return s==="SUBMITTED"?"bg-blue-50 text-blue-800":s==="APPROVED"?"bg-emerald-50 text-emerald-800":s==="REJECTED"?"bg-rose-50 text-rose-800":"bg-slate-100 text-slate-800"}function YN({status:t}){const s=String(t||"").toUpperCase();return s?e.jsx("span",{className:Hh("inline-flex rounded-full px-2 py-1 text-xs font-semibold",qN(s)),children:s}):null}function Ja(t){if(!t)return"";try{return new Date(t).toLocaleString()}catch{return String(t)}}function GN(t){const s=Number(t||0);return Number.isFinite(s)?s%1===0?String(s):s.toFixed(1):""}function QN(){var H,te,q,Y,xe,J,me;const{id:t}=Dt(),s=Ue(),a=ct(),{bootstrap:n}=he(),l=((H=n==null?void 0:n.rbac)==null?void 0:H.permissions)||[],r=l.includes("LEAVE_REQUEST_READ"),o=l.includes("LEAVE_REQUEST_CANCEL"),d=l.includes("LEAVE_APPROVE_L1"),c=l.includes("LEAVE_APPROVE_L2"),m=l.includes("LEAVE_ATTACHMENT_READ"),g=l.includes("LEAVE_ATTACHMENT_UPLOAD"),x=(n==null?void 0:n.systemConfig)||{},j=((te=n==null?void 0:n.features)==null?void 0:te.flags)||{},h=nx(((q=x==null?void 0:x.LEAVE_ENABLED)==null?void 0:q.value)??(x==null?void 0:x.LEAVE_ENABLED)),f=nx(((Y=x==null?void 0:x.LEAVE_ATTACHMENTS_ENABLED)==null?void 0:Y.value)??(x==null?void 0:x.LEAVE_ATTACHMENTS_ENABLED)),u=!!(j!=null&&j.MONTH_CLOSE_ENABLED),[b,p]=i.useState("details"),y=((xe=a.state)==null?void 0:xe.item)||null,w=((J=a.state)==null?void 0:J.employeeId)||null,S=Pe({path:w?`/api/v1/leave/requests?employeeId=${encodeURIComponent(w)}`:"/api/v1/leave/requests",page:1,pageSize:200,enabled:h&&r&&!!t&&!y}),N=i.useMemo(()=>{var be;return y&&String(y.id)===String(t)?y:(((be=S.data)==null?void 0:be.items)||[]).find(je=>String(je.id)===String(t))||null},[t,S.data,y]),E=Pe({path:"/api/v1/governance/month-close",page:1,pageSize:200,enabled:u&&!!(N!=null&&N.startDate||N!=null&&N.endDate)}),v=i.useMemo(()=>{var be;const K=new Set;for(const je of((be=E.data)==null?void 0:be.items)||[]){const pe=(je==null?void 0:je.monthEnd)||(je==null?void 0:je.monthStart)||(je==null?void 0:je.month);pe&&String((je==null?void 0:je.status)||"").toUpperCase()==="CLOSED"&&K.add(String(pe).slice(0,10))}return K},[E.data]),A=i.useMemo(()=>{if(!(N!=null&&N.startDate)||!(N!=null&&N.endDate))return!1;const K=new Date(`${N.startDate}T00:00:00.000Z`),be=new Date(`${N.endDate}T00:00:00.000Z`);if(Number.isNaN(K.getTime())||Number.isNaN(be.getTime()))return!1;const je=new Date(K.getTime());for(;je.getTime()<=be.getTime();){const pe=new Date(Date.UTC(je.getUTCFullYear(),je.getUTCMonth()+1,0)).toISOString().slice(0,10);if(v.has(pe))return!0;je.setUTCMonth(je.getUTCMonth()+1),je.setUTCDate(1)}return!1},[v,N==null?void 0:N.endDate,N==null?void 0:N.startDate]),T=Pe({path:t?`/api/v1/leave/requests/${t}/attachments`:"/api/v1/leave/requests/x/attachments",page:1,pageSize:200,enabled:f&&m&&b==="attachments"&&!!t}),C=Be(async({reason:K})=>z(`/api/v1/leave/requests/${t}/cancel`,{method:"POST",body:{reason:K}})),k=Be(async({reason:K})=>z(`/api/v1/leave/requests/${t}/approve`,{method:"POST",body:{reason:K||null}})),D=Be(async({reason:K})=>z(`/api/v1/leave/requests/${t}/reject`,{method:"POST",body:{reason:K}})),R=Be(async({payload:K})=>z(`/api/v1/leave/requests/${t}/attachments`,{method:"POST",body:K})),L=Be(async({attId:K})=>z(`/api/v1/leave/requests/${t}/attachments/${K}/download`)),[_,I]=i.useState(null),[G,O]=i.useState(""),[F,W]=i.useState(!1),[$,M]=i.useState(""),[P,V]=i.useState(""),[U,B]=i.useState(""),[Q,ae]=i.useState(""),ie=String((N==null?void 0:N.status)||"").toUpperCase(),we=!!(N&&String(N.employeeId)===String((me=n==null?void 0:n.user)==null?void 0:me.id)),De=!!((we||o)&&ie&&ie!=="CANCELLED"&&ie!=="REJECTED"),Z=!!((d||c)&&ie==="SUBMITTED"),ve=S.status==="loading"&&!S.data&&!y,ue=i.useMemo(()=>{var be,je,pe;if(!r)return e.jsx(ge,{});if(!h)return e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Leave is disabled"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"LEAVE_ENABLED must be enabled in system config."})]});if(ve)return e.jsx(de,{});if(S.status==="error")return((be=S.error)==null?void 0:be.status)===403?e.jsx(ge,{}):e.jsx(le,{error:S.error});if(!N)return e.jsx(ye,{title:"Leave request not found",description:"This request may not be accessible in your scope."});const K=({id:Ae,label:Se})=>{const Me=b===Ae;return e.jsx("button",{type:"button",className:Hh("rounded-full px-3 py-1.5 text-sm font-medium border transition-colors",Me?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),onClick:()=>p(Ae),children:Se})};return e.jsxs("div",{className:"space-y-4",children:[A?e.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-amber-900",children:"Month is CLOSED"}),e.jsx("div",{className:"mt-1 text-sm text-amber-800",children:"This request falls within a closed payroll month. Actions may require override permission and a reason."})]}):null,e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Leave Request"}),e.jsx("div",{className:"mt-1 text-xs text-slate-500 font-mono",children:N.id})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:()=>s(-1),children:"Back"}),e.jsx($e,{to:we?"/leave/my":"/leave/approvals",className:"inline-flex w-full sm:w-auto items-center justify-center rounded-md border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Go to list"}),De?e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-slate-800 disabled:bg-slate-400",disabled:C.status==="loading",onClick:()=>{O(""),I("cancel")},children:"Cancel"}):null,Z?e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md bg-emerald-600 px-3 py-2 text-sm font-medium text-white hover:bg-emerald-700 disabled:bg-emerald-300",disabled:k.status==="loading",onClick:()=>{O(""),I("approve")},children:"Approve"}):null,Z?e.jsx("button",{type:"button",className:"w-full sm:w-auto rounded-md bg-rose-600 px-3 py-2 text-sm font-medium text-white hover:bg-rose-700 disabled:bg-rose-300",disabled:D.status==="loading",onClick:()=>{O(""),I("reject")},children:"Reject"}):null]})]}),e.jsxs("div",{className:"p-4 flex flex-wrap items-center gap-2",children:[e.jsx(YN,{status:N.status}),e.jsxs("div",{className:"text-xs text-slate-500",children:[N.leaveTypeCode,"  ",N.leaveTypeName]})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(K,{id:"details",label:"Details"}),e.jsx(K,{id:"attachments",label:"Attachments"})]})}),b==="details"?e.jsx("div",{className:"p-4 pt-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Dates"}),e.jsxs("div",{className:"mt-1 font-mono text-sm text-slate-900",children:[N.startDate,"  ",N.endDate]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Unit: ",String(N.unit||"").toUpperCase(),N.unit==="HALF_DAY"?` (${N.halfDayPart})`:""]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-600",children:["Units: ",GN(N.units)]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Reason"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900 whitespace-pre-wrap",children:N.reason||""})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Submitted"}),e.jsx("div",{className:"mt-1 text-sm text-slate-900",children:Ja(N.createdAt)}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Updated: ",Ja(N.updatedAt)]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-4",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Approval Timeline"}),e.jsxs("div",{className:"mt-2 grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-slate-700",children:"Approved L1"}),e.jsx("div",{className:"text-xs text-slate-600 font-mono",children:N.approvedL1At?Ja(N.approvedL1At):""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-slate-700",children:"Approved L2"}),e.jsx("div",{className:"text-xs text-slate-600 font-mono",children:N.approvedL2At?Ja(N.approvedL2At):""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-slate-700",children:"Rejected"}),e.jsx("div",{className:"text-xs text-slate-600 font-mono",children:N.rejectedAt?Ja(N.rejectedAt):""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-slate-700",children:"Cancelled"}),e.jsx("div",{className:"text-xs text-slate-600 font-mono",children:N.cancelledAt?Ja(N.cancelledAt):""})]})]})]}),N.rejectionReason?e.jsxs("div",{className:"md:col-span-2 rounded-lg border border-rose-200 bg-rose-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-rose-900",children:"Rejection Reason"}),e.jsx("div",{className:"mt-1 text-sm text-rose-800 whitespace-pre-wrap",children:N.rejectionReason})]}):null,N.cancelReason?e.jsxs("div",{className:"md:col-span-2 rounded-lg border border-slate-200 bg-slate-50 p-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Cancel Reason"}),e.jsx("div",{className:"mt-1 text-sm text-slate-700 whitespace-pre-wrap",children:N.cancelReason})]}):null]})}):null,b==="attachments"?e.jsx("div",{className:"p-4 pt-0",children:f?m?T.status==="loading"&&!T.data?e.jsx(de,{}):T.status==="error"?e.jsx(le,{error:T.error}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:T.refresh,disabled:T.status==="loading",children:"Refresh"}),g?e.jsx("button",{type:"button",className:"rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-slate-800 disabled:bg-slate-400",onClick:()=>{M(""),V(""),B(""),ae(""),W(!0)},disabled:R.status==="loading",children:"Upload Metadata"}):null]}),(((je=T.data)==null?void 0:je.items)||[]).length===0?e.jsx(ye,{title:"No attachments",description:"No attachments uploaded for this request."}):e.jsx("div",{className:"hidden md:block",children:e.jsx(ha,{columns:[{key:"file",header:"File",render:Ae=>e.jsx("div",{className:"text-sm font-medium text-slate-900",children:Ae.fileName})},{key:"mime",header:"MIME",render:Ae=>e.jsx("div",{className:"text-sm font-mono text-slate-700",children:Ae.mimeType||""})},{key:"size",header:"Size",render:Ae=>e.jsx("div",{className:"text-sm text-slate-700",children:typeof Ae.sizeBytes=="number"?`${Ae.sizeBytes} bytes`:""})},{key:"action",header:"Action",render:Ae=>e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:bg-slate-50",disabled:L.status==="loading",onClick:async()=>{var Se;try{const Me=await L.run({attId:Ae.id}),ce=(Se=Me==null?void 0:Me.item)==null?void 0:Se.storageKey;ce&&(String(ce).startsWith("http://")||String(ce).startsWith("https://"))&&window.open(ce,"_blank","noopener,noreferrer")}catch{}},children:"Download"})})}],rows:(((pe=T.data)==null?void 0:pe.items)||[]).map(Ae=>({key:Ae.id,data:Ae}))})}),L.status==="error"?e.jsx(le,{error:L.error}):null,R.status==="error"?e.jsx(le,{error:R.error}):null]}):e.jsx(ge,{}):e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:"Attachments are disabled"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"LEAVE_ATTACHMENTS_ENABLED must be enabled in system config."})]})}):null]})]})},[T,f,k.status,Z,De,r,m,g,C.status,L,t,A,we,N,h,S,s,D.status,b,ve,R]),re=_==="cancel"?"Cancel Leave Request":_==="reject"?"Reject Leave Request":_==="approve"?"Approve Leave Request":"",Re=_==="approve"?"Reason is optional; it may be required if a month-close override is needed.":"Reason is required.",ne=_==="cancel"||_==="reject";return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(We,{title:"Leave Request"}),e.jsx("div",{className:"mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 pb-8",children:e.jsx("div",{className:"mt-4",children:ue})}),_?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>{C.status==="loading"||D.status==="loading"||k.status==="loading"||I(null)}}),e.jsxs("div",{className:"relative w-full max-w-xl rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:re}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:Re}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Reason"}),e.jsx("textarea",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",rows:4,value:G,onChange:K=>O(K.target.value),placeholder:_==="approve"?"Optional":"Required"})]}),C.status==="error"||D.status==="error"||k.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:C.error||D.error||k.error})}):null,e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-2 sm:justify-end",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:C.status==="loading"||D.status==="loading"||k.status==="loading",onClick:()=>I(null),children:"Close"}),e.jsx("button",{type:"button",className:"rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white disabled:bg-slate-400",disabled:C.status==="loading"||D.status==="loading"||k.status==="loading"||ne&&G.trim().length===0,onClick:async()=>{const K=G.trim();try{_==="cancel"?await C.run({reason:K}):_==="reject"?await D.run({reason:K}):_==="approve"&&await k.run({reason:K||null}),I(null),s(-1)}catch{}},children:"Confirm"})]})]})]}):null,F?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40",onClick:()=>{R.status!=="loading"&&W(!1)}}),e.jsxs("div",{className:"relative w-full max-w-2xl rounded-xl bg-white border border-slate-200 shadow-sm p-5",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:"Upload Attachment (Metadata)"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Provide a signed URL as storageKey."}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"File Name"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm",value:$,onChange:K=>M(K.target.value),placeholder:"document.pdf"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"MIME Type"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono",value:U,onChange:K=>B(K.target.value),placeholder:"application/pdf"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Storage Key (signed URL)"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono",value:P,onChange:K=>V(K.target.value),placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Size Bytes"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-slate-300 text-sm font-mono",value:Q,onChange:K=>ae(K.target.value),placeholder:"12345"})]})]}),R.status==="error"?e.jsx("div",{className:"mt-3",children:e.jsx(le,{error:R.error})}):null,e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-2 sm:justify-end",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:bg-slate-50",disabled:R.status==="loading",onClick:()=>W(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"rounded-md bg-slate-900 px-3 py-2 text-sm font-medium text-white disabled:bg-slate-400",disabled:R.status==="loading"||$.trim().length===0||P.trim().length===0||U.trim().length===0||Q.trim().length===0,onClick:async()=>{try{await R.run({payload:{fileName:$.trim(),storageKey:P.trim(),mimeType:U.trim(),sizeBytes:Number(Q)}}),W(!1),T.refresh()}catch{}},children:R.status==="loading"?"Saving":"Confirm"})]})]})]}):null]})}function JN(){const{data:t,status:s,error:a}=Pe({path:"/api/v1/leave/balances",page:1,pageSize:50,enabled:!0});if(s==="loading")return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(l=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded mb-1"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded"})]},l))});if(a)return e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("div",{className:"text-red-800 text-sm",children:"Failed to load leave balances"})});const n=(t==null?void 0:t.content)||[];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:n.length>0?n.map((l,r)=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600",children:l.leaveType}),e.jsx("span",{className:"text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded",children:l.leaveCode})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:l.availableDays}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["of ",l.totalDays," total"]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:l.totalDays==="Unlimited"?"0%":`${l.availableDays/l.totalDays*100}%`}})})})]},r)):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600",children:"Paid Leave"}),e.jsx("span",{className:"text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded",children:"PL"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:"-"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"No data available"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600",children:"Sick Leave"}),e.jsx("span",{className:"text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded",children:"SL"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:"-"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"No data available"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600",children:"Casual Leave"}),e.jsx("span",{className:"text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded",children:"CL"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:"-"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"No data available"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600",children:"Unpaid Leave"}),e.jsx("span",{className:"text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded",children:"LWP"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:""}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Unlimited"})]})]})})}function KN(){var y,w;const{bootstrap:t}=he(),[s,a]=i.useState(null),[n,l]=i.useState(!1),[r,o]=i.useState({leaveType:"",startDate:"",endDate:"",reason:""}),{data:d,status:c,error:m,refresh:g}=Pe({path:"/api/v1/leave/requests",page:1,pageSize:50,enabled:!0}),x=Be(async S=>{const N=await fetch("/api/v1/leave",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)});if(!N.ok)throw new Error("Failed to submit leave request");return N.json()}),h=(((y=t==null?void 0:t.rbac)==null?void 0:y.roles)||[])[0];if(!["EMPLOYEE","MANAGER","SUPER_ADMIN","HR_ADMIN","FOUNDER","FINANCE_ADMIN"].includes(h))return e.jsx(ge,{});const u=S=>{a(S.id),l(!0)},b=()=>{l(!1),a(null)},p=async()=>{try{await x.run(r),o({leaveType:"",startDate:"",endDate:"",reason:""}),g()}catch(S){console.error("Failed to submit leave:",S)}};return c==="loading"?e.jsx(de,{}):c==="error"?e.jsx(le,{onRetry:g}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(oa,{title:"Leave Balance",defaultOpen:!0,children:e.jsx(JN,{})}),e.jsxs(oa,{title:"Apply for Leave",defaultOpen:!1,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Leave Type"}),e.jsxs("select",{value:r.leaveType,onChange:S=>o({...r,leaveType:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Leave Type"}),e.jsx("option",{value:"PAID_LEAVE",children:"Paid Leave (PL)"}),e.jsx("option",{value:"SICK_LEAVE",children:"Sick Leave (SL)"}),e.jsx("option",{value:"CASUAL_LEAVE",children:"Casual Leave (CL)"}),e.jsx("option",{value:"UNPAID_LEAVE",children:"Unpaid Leave (LWP)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{children:"Multiple Days"}),e.jsx("option",{children:"Single Day"}),e.jsx("option",{children:"Half Day"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:r.startDate,onChange:S=>o({...r,startDate:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:r.endDate,onChange:S=>o({...r,endDate:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason"}),e.jsx("textarea",{rows:3,value:r.reason,onChange:S=>o({...r,reason:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Please provide a reason for your leave request..."})]}),e.jsxs("div",{className:"mt-4 flex gap-3",children:[e.jsx("button",{onClick:p,disabled:x.status==="loading"||(d==null?void 0:d.monthLocked),className:`px-4 py-2 rounded-lg font-medium transition-colors ${d!=null&&d.monthLocked||x.status==="loading"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:x.status==="loading"?"Submitting...":"Submit Leave Request"}),e.jsx("button",{className:"px-4 py-2 rounded-lg font-medium border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Save as Draft"})]})]}),e.jsx(oa,{title:"My Leave History",defaultOpen:!0,children:(w=d==null?void 0:d.content)!=null&&w.length?e.jsx(Lc,{data:d.content,role:h,monthLocked:d.monthLocked,onView:u}):e.jsx(ye,{message:"No leave records found."})}),e.jsx(Dc,{isOpen:n,onClose:b,leaveId:s})]})}function XN(){var C,k,D,R,L,_;const{bootstrap:t}=he(),[s,a]=i.useState(null),[n,l]=i.useState(!1),[r,o]=i.useState(""),[d,c]=i.useState(""),[m,g]=i.useState(""),{data:x,status:j,error:h,refresh:f}=Pe({path:"/api/v1/leave/requests",page:1,pageSize:50,enabled:!0}),b=(((C=t==null?void 0:t.rbac)==null?void 0:C.roles)||[])[0];if(!["MANAGER","SUPER_ADMIN","HR_ADMIN","FOUNDER"].includes(b))return e.jsx(ge,{});i.useEffect(()=>{f()},[r,d,m,f]);const y=I=>{a(I.id),l(!0)},w=()=>{l(!1),a(null)},S=I=>{console.log("Approve leave:",I)},N=I=>{console.log("Reject leave:",I)};if(j==="loading")return e.jsx(de,{});if(j==="error")return e.jsx(le,{onRetry:f});const E=((k=x==null?void 0:x.content)==null?void 0:k.length)||0,v=((D=x==null?void 0:x.content)==null?void 0:D.filter(I=>I.status==="APPROVED").length)||0,A=((R=x==null?void 0:x.content)==null?void 0:R.filter(I=>I.status==="PENDING").length)||0,T=((L=x==null?void 0:x.content)==null?void 0:L.filter(I=>I.status==="REJECTED").length)||0;return e.jsxs("div",{className:"space-y-6",children:[(x==null?void 0:x.monthLocked)&&e.jsx("div",{className:"bg-gray-100 border border-gray-200 text-gray-600 px-4 py-3 rounded-xl",children:" Leave records for this month are locked."}),e.jsx(oa,{title:"Team Leave Statistics",defaultOpen:!0,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:E}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Total Requests"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:v}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Approved"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:A}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Pending"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:T}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Rejected"})]})]})}),e.jsx(oa,{title:"Filters",defaultOpen:!1,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee"}),e.jsx("select",{value:r,onChange:I=>o(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:e.jsx("option",{value:"",children:"All Team Members"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Leave Type"}),e.jsxs("select",{value:m,onChange:I=>g(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"PAID_LEAVE",children:"Paid Leave (PL)"}),e.jsx("option",{value:"SICK_LEAVE",children:"Sick Leave (SL)"}),e.jsx("option",{value:"CASUAL_LEAVE",children:"Casual Leave (CL)"}),e.jsx("option",{value:"UNPAID_LEAVE",children:"Unpaid Leave (LWP)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:d,onChange:I=>c(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"})]})]})]})}),e.jsx(oa,{title:"Team Leave Requests",defaultOpen:!0,children:(_=x==null?void 0:x.content)!=null&&_.length?e.jsx(Lc,{data:x.content,role:b,monthLocked:x.monthLocked,onView:y,onApprove:S,onReject:N}):e.jsx(ye,{message:"No team leave requests found."})}),e.jsx(Dc,{isOpen:n,onClose:w,leaveId:s})]})}function ZN(){var o,d;const{status:t,bootstrap:s}=he(),a=ct();if(t==="idle")return window.location.pathname==="/change-password"?e.jsx(uu,{}):window.location.pathname==="/set-password"?e.jsx(mu,{}):window.location.hash==="#/bootstrap-signup"?e.jsx(Mv,{}):e.jsx(so,{});if(t==="forbidden")return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(59,130,246,0.1),transparent_50%)]"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[linear-gradient(135deg,rgba(59,130,246,0.05)_0%,transparent_50%)]"}),e.jsx("div",{className:"max-w-md w-full relative",children:e.jsxs("div",{className:"bg-white/95 backdrop-blur-sm border border-white/20 rounded-2xl shadow-2xl p-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-blue-500/10 to-purple-500/10"}),e.jsx("div",{className:"relative z-10",children:e.jsx(ge,{})})]})})]});if(t==="loading")return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(59,130,246,0.1),transparent_50%)]"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[linear-gradient(135deg,rgba(59,130,246,0.05)_0%,transparent_50%)]"}),e.jsx("div",{className:"max-w-md w-full relative",children:e.jsxs("div",{className:"bg-white/95 backdrop-blur-sm border border-white/20 rounded-2xl shadow-2xl p-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-blue-500/10 to-purple-500/10"}),e.jsx("div",{className:"relative z-10",children:e.jsx(de,{message:"Initializing CoreOps"})})]})})]});if(t==="error")return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(59,130,246,0.1),transparent_50%)]"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[linear-gradient(135deg,rgba(59,130,246,0.05)_0%,transparent_50%)]"}),e.jsx("div",{className:"max-w-md w-full relative",children:e.jsxs("div",{className:"bg-white/95 backdrop-blur-sm border border-white/20 rounded-2xl shadow-2xl p-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-blue-500/10 to-purple-500/10"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-rose-500 to-pink-600 rounded-2xl mb-4 shadow-lg",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Session Error"}),e.jsx("p",{className:"text-slate-600 font-medium mb-4",children:"There was a problem loading your session"}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-medium rounded-xl transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98]",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reload"]})]})})]})})]});const n=((o=s==null?void 0:s.rbac)==null?void 0:o.roles)||[],r=(((d=s==null?void 0:s.rbac)==null?void 0:d.permissions)||[]).includes("TIMESHEET_APPROVAL_QUEUE_READ");return n.includes("SUPER_ADMIN")&&(a.pathname.startsWith("/finance")||a.pathname.startsWith("/hr")||a.pathname.startsWith("/manager")||a.pathname.startsWith("/employee"))?e.jsx(zt,{to:"/super-admin/dashboard",replace:!0}):e.jsxs(xv,{children:[e.jsx(ee,{path:"/login",element:e.jsx(so,{})}),e.jsx(ee,{path:"/set-password",element:e.jsx(mu,{})}),e.jsx(ee,{path:"/change-password",element:e.jsx(uu,{})}),e.jsx(ee,{path:"/",element:e.jsx(so,{})}),e.jsxs(ee,{path:"/super-admin/*",element:e.jsx(va,{allowedRoles:["SUPER_ADMIN"],children:e.jsx(yu,{})}),children:[e.jsx(ee,{index:!0,element:e.jsx(zt,{to:"dashboard",replace:!0})}),e.jsx(ee,{path:"dashboard",element:e.jsx(eN,{})}),e.jsx(ee,{path:"revenue",element:e.jsx(pN,{})}),e.jsx(ee,{path:"revenue/categories",element:e.jsx(fN,{})}),e.jsx(ee,{path:"revenue/clients",element:e.jsx(gN,{})}),e.jsx(ee,{path:"reports",element:e.jsx(zt,{to:"/finance/reports/dashboard",replace:!0})}),e.jsx(ee,{path:"employees",element:e.jsx(tN,{})}),e.jsx(ee,{path:"employees/add",element:e.jsx(Mh,{})}),e.jsx(ee,{path:"employees/:id",element:e.jsx(Th,{})}),e.jsx(ee,{path:"attendance",element:e.jsx(Lu,{})}),e.jsx(ee,{path:"divisions",element:e.jsx(wo,{})}),e.jsx(ee,{path:"divisions/create",element:e.jsx(wo,{})}),e.jsx(ee,{path:"divisions/:id",element:e.jsx(wo,{})}),e.jsx(ee,{path:"projects",element:e.jsx(oN,{})}),e.jsx(ee,{path:"timesheets",element:e.jsx(xN,{})}),e.jsx(ee,{path:"system-config",element:e.jsx(aN,{})}),e.jsx(ee,{path:"month-close",element:e.jsx(kN,{})}),e.jsx(ee,{path:"audit-logs",element:e.jsx(AN,{})}),e.jsx(ee,{path:"leave/overview",element:e.jsx(nN,{})}),e.jsx(ee,{path:"reimbursements",element:e.jsx(wN,{})}),e.jsx(ee,{path:"reimbursements/:id",element:e.jsx(SN,{})}),e.jsx(ee,{path:"ops",element:e.jsx(zt,{to:"dashboard",replace:!0})}),e.jsx(ee,{path:"ops/dashboard",element:e.jsx(vN,{})}),e.jsx(ee,{path:"ops/inbox",element:e.jsx(bN,{})}),e.jsx(ee,{path:"ops/alerts",element:e.jsx(jN,{})}),e.jsx(ee,{path:"ops/overrides",element:e.jsx(NN,{})}),e.jsx(ee,{path:"ops/data-quality",element:e.jsx(yN,{})})]}),e.jsxs(ee,{path:"/hr/*",element:e.jsx(va,{allowedRoles:["HR_ADMIN"],children:e.jsx(Pv,{})}),children:[e.jsx(ee,{path:"dashboard",element:e.jsx(Xv,{})}),e.jsx(ee,{path:"employees",element:e.jsx(tb,{})}),e.jsx(ee,{path:"employees/add",element:e.jsx(sb,{})}),e.jsx(ee,{path:"employees/:id",element:e.jsx(rb,{})}),e.jsx(ee,{path:"attendance",element:e.jsx(Lu,{})}),e.jsx(ee,{path:"timesheets",element:e.jsx(hb,{})}),e.jsx(ee,{path:"timesheets/approvals",element:e.jsx(wb,{})}),e.jsx(ee,{path:"leave",element:e.jsx(pb,{})}),e.jsx(ee,{path:"leave/approvals",element:e.jsx(bb,{})}),e.jsx(ee,{path:"leave/balances",element:e.jsx(Ru,{})}),e.jsx(ee,{path:"leave/overview",element:e.jsx(fb,{})}),e.jsx(ee,{path:"month-close",element:e.jsx(Tu,{})}),e.jsx(ee,{path:"governance",element:e.jsx(Sb,{})}),e.jsx(ee,{path:"governance/leave-types",element:e.jsx(kb,{})}),e.jsx(ee,{path:"governance/leave-balances",element:e.jsx(Ru,{})}),e.jsx(ee,{path:"governance/month-close",element:e.jsx(Tu,{})}),e.jsx(ee,{path:"ops",element:e.jsx(zt,{to:"inbox",replace:!0})}),e.jsx(ee,{path:"ops/inbox",element:e.jsx(Ab,{})}),e.jsx(ee,{path:"ops/alerts",element:e.jsx(Lb,{})}),e.jsx(ee,{path:"ops/data-quality",element:e.jsx(Db,{})})]}),e.jsxs(ee,{path:"/finance/*",element:e.jsx(va,{allowedRoles:["FINANCE_HEAD","FINANCE_ADMIN"],children:e.jsx(_v,{})}),children:[e.jsx(ee,{index:!0,element:e.jsx(zt,{to:"dashboard",replace:!0})}),e.jsx(ee,{path:"dashboard",element:e.jsx(Ib,{})}),e.jsx(ee,{path:"payroll",element:e.jsx(Uu,{})}),e.jsx(ee,{path:"payroll/:runId",element:e.jsx(Uu,{})}),e.jsx(ee,{path:"ledger",element:e.jsx(Yb,{})}),e.jsx(ee,{path:"revenue",element:e.jsx(dj,{})}),e.jsx(ee,{path:"revenue/create",element:e.jsx(cj,{})}),e.jsx(ee,{path:"revenue/approvals",element:e.jsx(fj,{})}),e.jsx(ee,{path:"revenue/reports",element:e.jsx(gj,{})}),e.jsx(ee,{path:"revenue/categories",element:e.jsx(vj,{})}),e.jsx(ee,{path:"revenue/clients",element:e.jsx(bj,{})}),e.jsx(ee,{path:"revenue/:id",element:e.jsx(uj,{})}),e.jsx(ee,{path:"revenue/:id/payments",element:e.jsx(hj,{})}),e.jsx(ee,{path:"expenses",element:e.jsx(Jb,{})}),e.jsx(ee,{path:"expenses/create",element:e.jsx(tj,{})}),e.jsx(ee,{path:"expenses/categories",element:e.jsx(sj,{})}),e.jsx(ee,{path:"expenses/payments",element:e.jsx(nj,{})}),e.jsx(ee,{path:"expenses/adjustments",element:e.jsx(lj,{})}),e.jsx(ee,{path:"expenses/:expenseId",element:e.jsx(Zb,{})}),e.jsx(ee,{path:"reports",element:e.jsx(zt,{to:"dashboard",replace:!0})}),e.jsx(ee,{path:"reports/dashboard",element:e.jsx(wj,{})}),e.jsx(ee,{path:"reports/revenue",element:e.jsx(kj,{})}),e.jsx(ee,{path:"reports/expense",element:e.jsx(Ej,{})}),e.jsx(ee,{path:"reports/pnl",element:e.jsx(Uh,{})}),e.jsx(ee,{path:"reports/receivables",element:e.jsx(Aj,{})}),e.jsx(ee,{path:"reports/payables",element:e.jsx(Lj,{})}),e.jsx(ee,{path:"reports/cashflow",element:e.jsx(Dj,{})}),e.jsx(ee,{path:"month-close",element:e.jsx(Wb,{})}),e.jsx(ee,{path:"reimbursements",element:e.jsx($j,{})}),e.jsx(ee,{path:"reimbursements/:id",element:e.jsx(qj,{})}),e.jsx(ee,{path:"ops",element:e.jsx(zt,{to:"dashboard",replace:!0})}),e.jsx(ee,{path:"ops/dashboard",element:e.jsx(Mj,{})}),e.jsx(ee,{path:"ops/inbox",element:e.jsx(Rj,{})}),e.jsx(ee,{path:"ops/alerts",element:e.jsx(Tj,{})}),e.jsx(ee,{path:"ops/overrides",element:e.jsx(Ij,{})}),e.jsx(ee,{path:"ops/data-quality",element:e.jsx(Oj,{})})]}),e.jsxs(ee,{path:"/manager/*",element:e.jsx(va,{allowedRoles:["MANAGER"],children:e.jsx(Vv,{})}),children:[e.jsx(ee,{index:!0,element:e.jsx(zt,{to:"dashboard",replace:!0})}),e.jsx(ee,{path:"dashboard",element:e.jsx(Yj,{})}),e.jsx(ee,{path:"revenue",element:e.jsx(x2,{})}),e.jsx(ee,{path:"revenue/create",element:e.jsx(h2,{})}),e.jsx(ee,{path:"revenue/:id",element:e.jsx(f2,{})}),e.jsx(ee,{path:"my-attendance",element:e.jsx(Kj,{})}),e.jsx(ee,{path:"my-leave",element:e.jsx(Xj,{})}),e.jsx(ee,{path:"my-timesheets",element:e.jsx(Zj,{})}),e.jsx(ee,{path:"my-profile",element:e.jsx(e2,{})}),e.jsx(ee,{path:"team-attendance",element:e.jsx(Gj,{})}),e.jsx(ee,{path:"team-leave",element:e.jsx(Qj,{})}),e.jsx(ee,{path:"team-timesheets",element:e.jsx(Jj,{})}),e.jsx(ee,{path:"expenses",element:e.jsx(n2,{})}),e.jsx(ee,{path:"expenses/:expenseId/review",element:e.jsx(m2,{})}),e.jsx(ee,{path:"reports",element:e.jsx(zt,{to:"pnl",replace:!0})}),e.jsx(ee,{path:"reports/pnl",element:e.jsx(g2,{})}),e.jsx(ee,{path:"reimbursements",element:e.jsx(j2,{})}),e.jsx(ee,{path:"reimbursements/:id",element:e.jsx(w2,{})}),e.jsx(ee,{path:"ops",element:e.jsx(zt,{to:"inbox",replace:!0})}),e.jsx(ee,{path:"ops/inbox",element:e.jsx(v2,{})})]}),e.jsxs(ee,{path:"/employee/*",element:e.jsx(va,{allowedRoles:["EMPLOYEE"],children:e.jsx(Hv,{})}),children:[e.jsx(ee,{path:"dashboard",element:e.jsx(S2,{})}),e.jsx(ee,{path:"profile",element:e.jsx(k2,{})}),e.jsx(ee,{path:"attendance",element:e.jsx(E2,{})}),e.jsx(ee,{path:"timesheets",element:e.jsx(A2,{})}),e.jsx(ee,{path:"leave",element:e.jsx(L2,{})}),e.jsx(ee,{path:"documents",element:e.jsx(D2,{})}),e.jsx(ee,{path:"payslips",element:e.jsx(P2,{})}),e.jsx(ee,{path:"expenses",element:e.jsx(B2,{})}),e.jsx(ee,{path:"expenses/create",element:e.jsx(U2,{})}),e.jsx(ee,{path:"expenses/:expenseId",element:e.jsx(q2,{})}),e.jsx(ee,{path:"reimbursements",element:e.jsx(Y2,{})}),e.jsx(ee,{path:"reimbursements/new",element:e.jsx(J2,{})}),e.jsx(ee,{path:"reimbursements/:id",element:e.jsx(X2,{})})]}),e.jsx(ee,{path:"/help",element:e.jsx(M2,{})}),e.jsxs(ee,{path:"/timesheet/*",element:e.jsx(va,{allowedRoles:r?["MANAGER","SUPER_ADMIN","FOUNDER"]:["SUPER_ADMIN"],children:e.jsx(yu,{})}),children:[e.jsx(ee,{path:"approval",element:e.jsx(zt,{to:"/timesheet/approvals",replace:!0})}),e.jsx(ee,{path:"my",element:e.jsx(TN,{})}),e.jsx(ee,{path:"approvals",element:e.jsx(Ih,{})}),e.jsx(ee,{path:":id",element:e.jsx(FN,{})})]}),e.jsxs(ee,{path:"/leave/*",element:e.jsx(va,{allowedRoles:["HR_HEAD","MANAGER","SUPER_ADMIN","FOUNDER","FINANCE_HEAD"],children:e.jsx("div",{})}),children:[e.jsx(ee,{path:"apply",element:e.jsx(HN,{})}),e.jsx(ee,{path:"requests/:id",element:e.jsx(QN,{})}),e.jsx(ee,{path:"approvals",element:e.jsx(Ph,{})}),e.jsx(ee,{path:"overview",element:e.jsx(Mc,{})}),e.jsx(ee,{path:"my",element:e.jsx(KN,{})}),e.jsx(ee,{path:"team",element:e.jsx(XN,{})})]}),e.jsx(ee,{path:"*",element:e.jsx(Gv,{})})]})}function ey(){return e.jsx(yv,{children:e.jsx(Dv,{children:e.jsx(ZN,{})})})}Ao.createRoot(document.getElementById("root")).render(e.jsx(Ca.StrictMode,{children:e.jsx(ey,{})}));
