BEGIN;

INSERT INTO permission (id, code, description) VALUES
  ('11111111-1111-1111-1111-111111111301', 'PAYROLL_RUN_READ', 'Read payroll runs'),
  ('11111111-1111-1111-1111-111111111302', 'PAYROLL_RUN_CREATE', 'Create payroll runs'),
  ('11111111-1111-1111-1111-111111111303', 'PAYROLL_DRAFT_COMPUTE', 'Compute payroll draft'),
  ('11111111-1111-1111-1111-111111111304', 'PAYROLL_STATUS_REVIEW', 'Review payroll run'),
  ('11111111-1111-1111-1111-111111111305', 'PAYROLL_STATUS_LOCK', 'Lock payroll run'),
  ('11111111-1111-1111-1111-111111111306', 'PAYROLL_PAYMENT_MARK', 'Mark payroll payments'),
  ('11111111-1111-1111-1111-111111111307', 'PAYSLIP_GENERATE', 'Generate payslips'),
  ('11111111-1111-1111-1111-111111111308', 'PAYROLL_ITEM_ADJUST', 'Add payroll adjustments'),
  ('11111111-1111-1111-1111-111111111309', 'PAYROLL_STATUS_CLOSE', 'Close payroll run')
ON CONFLICT (code) DO NOTHING;

INSERT INTO role_permission (role_id, permission_id)
SELECT '22222222-2222-2222-2222-222222222222', p.id
FROM permission p
WHERE p.code IN (
  'PAYROLL_RUN_READ','PAYROLL_RUN_CREATE',
  'PAYROLL_DRAFT_COMPUTE','PAYROLL_STATUS_REVIEW','PAYROLL_STATUS_LOCK',
  'PAYROLL_PAYMENT_MARK','PAYSLIP_GENERATE','PAYROLL_ITEM_ADJUST','PAYROLL_STATUS_CLOSE'
)
ON CONFLICT DO NOTHING;

INSERT INTO system_config (key, value, description) VALUES
  ('PAYROLL_ENABLED', 'true', 'Enable payroll module'),
  ('PAYROLL_ALLOW_MANUAL_ADJUSTMENTS', 'true', 'Allow manual adjustments in payroll')
ON CONFLICT (key) DO NOTHING;

COMMIT;
